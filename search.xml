<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>PE-æ»´æ°´é€†å‘-æ‰‹åŠ¨å®ç°</title>
      <link href="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/"/>
      <url>/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»£ç èŠ‚ç©ºç™½èŠ‚åŒºæ·»åŠ ä»£ç "><a href="#ä»£ç èŠ‚ç©ºç™½èŠ‚åŒºæ·»åŠ ä»£ç " class="headerlink" title="ä»£ç èŠ‚ç©ºç™½èŠ‚åŒºæ·»åŠ ä»£ç "></a>ä»£ç èŠ‚ç©ºç™½èŠ‚åŒºæ·»åŠ ä»£ç </h1><p>è¿™é‡Œæˆ‘ä»¬åœ¨notepad++å¢åŠ MessageBoxAå‡½æ•°ï¼Œä¿è¯å…ˆè°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°å†è¿è¡Œnotepad++</p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>åœ¨ä»£ç åŒºå…ˆåŠ å…¥å¯¹å‡½æ•°çš„è°ƒç”¨ï¼Œå†å°†åŸæ¥çš„OEPä¿®æ”¹ä¸ºæˆ‘ä»¬æ’å…¥ä»£ç åœ¨å†…å­˜ä¸­çš„ä½ç½®</p><h2 id="ASLR"><a href="#ASLR" class="headerlink" title="ASLR"></a>ASLR</h2><p> ASLRæŠ€æœ¯ä¼šä½¿PEæ–‡ä»¶æ¯æ¬¡åŠ è½½åˆ°å†…å­˜çš„èµ·å§‹åœ°å€éšæœºå˜åŒ–ï¼Œå¹¶ä¸”è¿›ç¨‹çš„æ ˆå’Œå †çš„èµ·å§‹åœ°å€ä¹Ÿä¼šéšæœºæ”¹å˜ã€‚ æ‰€ä»¥æˆ‘ä»¬è¦å…ˆå…³é—­</p><p><a href="https://baijiahao.baidu.com/s?id=1681048472768096428&amp;wfr=spider&amp;for=pc&amp;searchword=aslr">https://baijiahao.baidu.com/s?id=1681048472768096428&amp;wfr=spider&amp;for=pc&amp;searchword=aslr</a></p><p>åœ¨æ ‡å‡†PEå¤´å±æ€§ä¸­çš„ç¬¬ä¸€ä¸ªå€¼æ”¹ä¸º1å³å¯</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647081337731.png"></p><p>è¿™æ ·PEæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­å°±ä¸ä¼šéšæœºåŒ–äº†</p><h2 id="æå–å…³é”®æ•°æ®"><a href="#æå–å…³é”®æ•°æ®" class="headerlink" title="æå–å…³é”®æ•°æ®"></a>æå–å…³é”®æ•°æ®</h2><h3 id="å¯é€‰PEå¤´"><a href="#å¯é€‰PEå¤´" class="headerlink" title="å¯é€‰PEå¤´"></a>å¯é€‰PEå¤´</h3><p>DWORD AddressOfEntryPoint-10E5DBh</p><p>DWORD ImageBase-400000h</p><h3 id="èŠ‚è¡¨ä¿¡æ¯"><a href="#èŠ‚è¡¨ä¿¡æ¯" class="headerlink" title="èŠ‚è¡¨ä¿¡æ¯"></a>èŠ‚è¡¨ä¿¡æ¯</h3><p>MIsc.DWORD VirtualSize-17C51Eh</p><p>DWORD VirtualAddress-1000h</p><p>DWORD PointerToRawData-400h</p><p>DWORD SizeOfRawData-17C600h</p><h2 id="åˆ¤æ–­èƒ½å¦æ·»åŠ "><a href="#åˆ¤æ–­èƒ½å¦æ·»åŠ " class="headerlink" title="åˆ¤æ–­èƒ½å¦æ·»åŠ "></a>åˆ¤æ–­èƒ½å¦æ·»åŠ </h2><p>å¦‚æœSizeOfRawData-MIsc.DWORD VirtualSize&gt;=0x12ï¼Œå³å¯æ·»åŠ ï¼Œè¿™é‡Œæ˜¯å¯ä»¥çš„</p><h2 id="æ‰¾åˆ°åœ¨æ–‡ä»¶ä¸­ä»£ç ç»“æŸçš„ä½ç½®"><a href="#æ‰¾åˆ°åœ¨æ–‡ä»¶ä¸­ä»£ç ç»“æŸçš„ä½ç½®" class="headerlink" title="æ‰¾åˆ°åœ¨æ–‡ä»¶ä¸­ä»£ç ç»“æŸçš„ä½ç½®"></a>æ‰¾åˆ°åœ¨æ–‡ä»¶ä¸­ä»£ç ç»“æŸçš„ä½ç½®</h2><p>å…ˆæ‰¾åˆ°åœ¨æ–‡ä»¶ä¸­çš„åç§»PointerToRawDataï¼Œå†æ‰¾åˆ°æ•°æ®æ®µå¤§å°MIsc.DWORD VirtualSizeï¼Œä¸¤è€…ç›¸åŠ å°±æ˜¯çœŸå®æ•°æ®æ®µçš„ç»“æŸä½ç½®</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647082425978.png"></p><h2 id="æ·»åŠ ç¡¬ç¼–ç "><a href="#æ·»åŠ ç¡¬ç¼–ç " class="headerlink" title="æ·»åŠ ç¡¬ç¼–ç "></a>æ·»åŠ ç¡¬ç¼–ç </h2><p>MessageBoxAéœ€è¦å››ä¸ªå‚æ•°</p><p>callæŒ‡ä»¤é•¿åº¦ä¸º5</p><p>jmpæŒ‡ä»¤é•¿åº¦ä¸º5</p><blockquote><p>çœŸæ­£è¦è·³è½¬çš„åœ°å€=E8/E9æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ¨å†…å­˜ä¸­çš„åœ°å€+Xï¼ˆXå°±æ˜¯E8åè¾¹è·Ÿç€çš„å››ä¸ªå­—èŠ‚ï¼‰</p></blockquote><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ·»åŠ çš„ç¡¬ç¼–ç ä¸º6A 00 6A 00 6A 00 6A 00 E8 00 00 00 00 E9 00 00 00 00</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647082868490.png"></p><h2 id="è®¡ç®—E8å’ŒE9çš„åå››ä¸ªå­—èŠ‚"><a href="#è®¡ç®—E8å’ŒE9çš„åå››ä¸ªå­—èŠ‚" class="headerlink" title="è®¡ç®—E8å’ŒE9çš„åå››ä¸ªå­—èŠ‚"></a>è®¡ç®—E8å’ŒE9çš„åå››ä¸ªå­—èŠ‚</h2><p>å…ˆæ‰¾åˆ°E8å¯¹åº”çš„çœŸå®åœ°å€ï¼Œä¹Ÿå°±æ˜¯MessageBoxAçš„åœ°å€ï¼Œåœ¨odé‡Œé¢command-&gt;è¾“å…¥bp MessageBoxA-&gt;çŠ¶æ€æ b-&gt;æ‰¾åˆ°MessageBoxAçš„åœ°å€</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647083046046.png"></p><h3 id="E8åå››å­—èŠ‚è®¡ç®—"><a href="#E8åå››å­—èŠ‚è®¡ç®—" class="headerlink" title="E8åå››å­—èŠ‚è®¡ç®—"></a>E8åå››å­—èŠ‚è®¡ç®—</h3><p>çœŸå®åœ°å€ä¸ºMessageBoxAçš„åœ°å€</p><p>Xä¸ºMessageBoxAåœ°å€-VirtualAddress+ImageBase+8+5+Misc.VirtualSize</p><p>76BA5865</p><h3 id="E9åå››å­—èŠ‚è®¡ç®—"><a href="#E9åå››å­—èŠ‚è®¡ç®—" class="headerlink" title="E9åå››å­—èŠ‚è®¡ç®—"></a>E9åå››å­—èŠ‚è®¡ç®—</h3><p>çœŸå®åœ°å€ä¸ºåŸæ¥çš„OEP</p><p>Xä¸ºImageBase+AddressOfEntryPoint-VirtualAddress+ImageBase+8+5+5+Misc.VirtualSize</p><p>ä¸ºFFF910AB</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647083638028.png"></p><h2 id="ä¿®æ”¹AddressOfPoint"><a href="#ä¿®æ”¹AddressOfPoint" class="headerlink" title="ä¿®æ”¹AddressOfPoint"></a>ä¿®æ”¹AddressOfPoint</h2><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647083743309.png"></p><p>è®©ä»–å…ˆæ‰§è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹å…¶ä¸ºæ’å…¥ç¡¬ç¼–ç çš„åœ°å€</p><p>VirtualAddress+Misc.VirtualSize=17D51Eh</p><h2 id="æœ€ç»ˆæ•ˆæœ"><a href="#æœ€ç»ˆæ•ˆæœ" class="headerlink" title="æœ€ç»ˆæ•ˆæœ"></a>æœ€ç»ˆæ•ˆæœ</h2><p>å…ˆæ‰§è¡ŒMessageBoxA</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647084038464.png"></p><p>å†è¿è¡Œç¨‹åº</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647084072618.png"></p><h1 id="æ–°å¢èŠ‚"><a href="#æ–°å¢èŠ‚" class="headerlink" title="æ–°å¢èŠ‚"></a>æ–°å¢èŠ‚</h1><h2 id="å¤§å°åˆ¤æ–­"><a href="#å¤§å°åˆ¤æ–­" class="headerlink" title="å¤§å°åˆ¤æ–­"></a>å¤§å°åˆ¤æ–­</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“èƒ½å¦æ–°å¢èŠ‚SizeofHeaders-æœ€åä¸€ä¸ªèŠ‚è¡¨ çš„ä½ç½®ï¼Œå¦‚æœå¤§äºæˆ–ç­‰äºä¸¤ä¸ªèŠ‚è¡¨çš„å¤§å°ï¼ˆå› ä¸ºèŠ‚è¡¨æœ€åå¿…é¡»æœ‰é•¿åº¦ä¸ºä¸€ä¸ªèŠ‚è¡¨çš„00å¡«å……ï¼‰ï¼Œåˆ™å¯ä»¥æ’å…¥</p><h2 id="ä¿®æ”¹èŠ‚è¡¨æ•°é‡"><a href="#ä¿®æ”¹èŠ‚è¡¨æ•°é‡" class="headerlink" title="ä¿®æ”¹èŠ‚è¡¨æ•°é‡"></a>ä¿®æ”¹èŠ‚è¡¨æ•°é‡</h2><p>æ ‡å‡†PEå¤´-&gt;WORD NumberOfSectionsï¼Œ+1å³å¯</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647140787003.png"></p><h2 id="æ·»åŠ èŠ‚è¡¨ä¿¡æ¯"><a href="#æ·»åŠ èŠ‚è¡¨ä¿¡æ¯" class="headerlink" title="æ·»åŠ èŠ‚è¡¨ä¿¡æ¯"></a>æ·»åŠ èŠ‚è¡¨ä¿¡æ¯</h2><p>è¿™é‡Œç›´æ¥å¤åˆ¶.textæ®µçš„ä¿¡æ¯ï¼Œå› ä¸ºå…¶å¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œåç»­å¯ä»¥ä¸ç”¨å†å»ä¿®æ”¹èŠ‚è¡¨å±æ€§</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647141001170.png"></p><h2 id="ç¡®å®šæ’å…¥çš„å¤§å°"><a href="#ç¡®å®šæ’å…¥çš„å¤§å°" class="headerlink" title="ç¡®å®šæ’å…¥çš„å¤§å°"></a>ç¡®å®šæ’å…¥çš„å¤§å°</h2><p>æ ¹æ®æƒ…å†µè‡ªè¡Œé€‰æ‹©ï¼Œè¿™é‡Œå‡è®¾æˆ‘ä»¬æ’å…¥0x1000å­—èŠ‚</p><h2 id="ä¿®æ”¹å†…å­˜å¯¹é½åçš„å¤§å°"><a href="#ä¿®æ”¹å†…å­˜å¯¹é½åçš„å¤§å°" class="headerlink" title="ä¿®æ”¹å†…å­˜å¯¹é½åçš„å¤§å°"></a>ä¿®æ”¹å†…å­˜å¯¹é½åçš„å¤§å°</h2><p>SizeOfImage+æ’å…¥çš„å¤§å°ï¼ˆæŒ‰ç…§å†…å­˜å¯¹é½ï¼‰</p><h2 id="ä¿®æ­£èŠ‚è¡¨ä¿¡æ¯"><a href="#ä¿®æ­£èŠ‚è¡¨ä¿¡æ¯" class="headerlink" title="ä¿®æ­£èŠ‚è¡¨ä¿¡æ¯"></a>ä¿®æ­£èŠ‚è¡¨ä¿¡æ¯</h2><p>å…ˆçœ‹å…³é”®æ•°æ®</p><p>DWORD VirtualAddress</p><p>DWORD SizeOfRawData</p><p>Misc.DWORD VirtualSize</p><p>DWORD PointerToRawData</p><p>è¿™é‡Œä¸ºäº†æ–¹ä¾¿å°†Misc.DWORD VirtualSizeå’ŒDWORD SizeOfRawDataéƒ½æ”¹ä¸º0x1000ï¼Œæ³¨æ„å¦‚æœæ’å…¥çš„æ˜¯å…¶ä»–å­—èŠ‚æ•°ï¼Œéœ€è¦è®¡ç®—æŒ‰ç…§æ–‡ä»¶å’Œå†…å­˜å¯¹é½æ¥è°ƒæ•´</p><h3 id="è®¡ç®—VirtualAddress"><a href="#è®¡ç®—VirtualAddress" class="headerlink" title="è®¡ç®—VirtualAddress"></a>è®¡ç®—VirtualAddress</h3><p>å‰é¢ä¸€ä¸ªèŠ‚è¡¨çš„VirtualAddress+Max(Misc.DWORD VirtualSize,SizeOfRawData)-æŒ‰å†…å­˜å¯¹é½åçš„</p><p>è¿™é‡ŒSizeOfRawDataå¤§äºå‰è€…ï¼ŒæŒ‰å†…å­˜å¯¹é½åæ˜¯15000hï¼ŒåŠ ä¸Šè¯¥èŠ‚è¡¨çš„VirtualAddresså°±æ˜¯æˆ‘ä»¬æ’å…¥èŠ‚è¡¨åœ¨å†…å­˜ä¸­çš„åç§»åœ°å€</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647141493979.png"></p><h3 id="è®¡ç®—PointerToRawData"><a href="#è®¡ç®—PointerToRawData" class="headerlink" title="è®¡ç®—PointerToRawData"></a>è®¡ç®—PointerToRawData</h3><p>å’Œå‰é¢ç±»ä¼¼SizeOfRawDataï¼ˆæ–‡ä»¶å¯¹é½ï¼‰+PointerToRawData</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647141658195.png"></p><h3 id="æœ€ç»ˆä¿®æ”¹"><a href="#æœ€ç»ˆä¿®æ”¹" class="headerlink" title="æœ€ç»ˆä¿®æ”¹"></a>æœ€ç»ˆä¿®æ”¹</h3><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647141708469.png"></p><h2 id="æ’å…¥ä»£ç "><a href="#æ’å…¥ä»£ç " class="headerlink" title="æ’å…¥ä»£ç "></a>æ’å…¥ä»£ç </h2><p>åœ¨PointerToRawDataæ’å…¥0x1000å­—èŠ‚</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647141776493.png"></p><h2 id="æŸ¥çœ‹ä¿¡æ¯"><a href="#æŸ¥çœ‹ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ä¿¡æ¯"></a>æŸ¥çœ‹ä¿¡æ¯</h2><p>åœ¨PEè§£æå·¥å…·å¯ä»¥çœ‹åˆ°æ’å…¥çš„èŠ‚è¡¨</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647141801656.png"></p><h1 id="æ–°å¢èŠ‚-èŠ‚è¡¨ä¿¡æ¯åä¸å¤Ÿä½ç½®"><a href="#æ–°å¢èŠ‚-èŠ‚è¡¨ä¿¡æ¯åä¸å¤Ÿä½ç½®" class="headerlink" title="æ–°å¢èŠ‚-èŠ‚è¡¨ä¿¡æ¯åä¸å¤Ÿä½ç½®"></a>æ–°å¢èŠ‚-èŠ‚è¡¨ä¿¡æ¯åä¸å¤Ÿä½ç½®</h1><p>æˆ‘ä»¬ç›´åˆ°DOSå’ŒNTå¤´ä¹‹å‰æœ‰ä¸€æ®µåƒåœ¾æ•°æ®ï¼Œå½“èŠ‚è¡¨æœ«å°¾æ²¡ä½ç½®æ’å…¥80ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬éœ€è¦å°†NTå¤´å’ŒèŠ‚è¡¨ä¿¡æ¯å‰ç§»ï¼Œè¿™æ ·å°±å¯ä»¥ç©ºå‡ºä¸€æ®µæ— ç”¨å­—èŠ‚ï¼Œé•¿åº¦ä¸ºåƒåœ¾æ•°æ®é•¿åº¦</p><blockquote><p>æ³¨æ„è¦ä¿®æ”¹LONG AddressOfNewExeHeader-NTå¤´çš„ä½ç½®</p></blockquote><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647142922682.png"></p><p>ç›´æ¥å¤åˆ¶åˆ°åƒåœ¾æ•°æ®çš„èµ·å§‹åœ°å€</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647142986819.png"></p><p>è¿™å°±æ˜¯ç©ºå‡ºæ¥çš„èŠ‚è¡¨ï¼Œåç»­æ“ä½œå’Œå‰é¢æ–°å¢èŠ‚ä¸€æ ·ï¼Œå°±ä¸èµ˜è¿°äº†</p><h1 id="æ‰©å¤§èŠ‚"><a href="#æ‰©å¤§èŠ‚" class="headerlink" title="æ‰©å¤§èŠ‚"></a>æ‰©å¤§èŠ‚</h1><p>å½“å‰é¢ä¸¤ç§åšæ³•éƒ½ä¸èƒ½æ»¡è¶³ï¼Œæˆ‘ä»¬é‡‡å–æ‰©å¤§èŠ‚çš„åŠæ³•ï¼Œå¯ä»¥åœ¨ä»»æ„èŠ‚åŒºæœ«å°¾æ·»åŠ ï¼Œä½†æ˜¯å¦‚æœä¸æ˜¯åœ¨æœ€åä¸€ä¸ªèŠ‚æ·»åŠ ï¼Œåé¢çš„èŠ‚è¡¨åç§»éƒ½è¦ä¿®æ”¹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰©å¤§æœ€åä¸€ä¸ªèŠ‚</p><p>éœ€è¦ä¿®æ”¹çš„æ•°æ®</p><p>DWORD SizeOfRawData</p><p>Misc.DWORD VirtualSize</p><p>DWORD SizeOfImage</p><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><ol><li>å°†æœ€åä¸€ä¸ªèŠ‚çš„SizeOfRawDataå’ŒVirtualSizeæ”¹æˆNï¼ŒN = èŠ‚å†…å­˜å¯¹é½åçš„å¤§å° + è¦æ‰©å¤§çš„å¤§å°</li><li>ä¿®æ”¹ SizeOfImageå¤§å°=SizeOfImageå¤§å°+è¦æ‰©å¤§çš„å¤§å°</li><li>åˆ†é…ä¸€å—æ–°çš„ç©ºé—´ï¼Œå¤§å°ä¸ºï¼šèŠ‚å†…å­˜å¯¹é½å¢åŠ çš„å¤§å°+è¦æ‰©å¤§çš„å¤§å°</li></ol><h2 id="ä¿®æ­£èŠ‚è¡¨ä¿¡æ¯-1"><a href="#ä¿®æ­£èŠ‚è¡¨ä¿¡æ¯-1" class="headerlink" title="ä¿®æ­£èŠ‚è¡¨ä¿¡æ¯"></a>ä¿®æ­£èŠ‚è¡¨ä¿¡æ¯</h2><p>è¿™é‡Œæˆ‘ä»¬å‡è®¾æ‰©å¤§0x1000ä¸ªå­—èŠ‚</p><p>è¦æ”¹ä¸ºMax(DWORD VirtualSize,DWORD SizeOfRawData)å†…å­˜å¯¹é½çš„å¤§å°+æˆ‘ä»¬æ‰©å¤§çš„å¤§å°=16000h</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647147742819.png"></p><h2 id="ä¿®æ­£SizeOfImage"><a href="#ä¿®æ­£SizeOfImage" class="headerlink" title="ä¿®æ­£SizeOfImage"></a>ä¿®æ­£SizeOfImage</h2><p>ç›´æ¥åŠ ä¸Š0x1000å³å¯</p><h2 id="åˆ†é…ç©ºé—´"><a href="#åˆ†é…ç©ºé—´" class="headerlink" title="åˆ†é…ç©ºé—´"></a>åˆ†é…ç©ºé—´</h2><p>èŠ‚å†…å­˜å¯¹é½å¢åŠ çš„å¤§å°=N-DWORD SizeOfRawDataï¼Œå³C00</p><p>åœ¨èŠ‚åŒºå°¾éƒ¨å¢åŠ å³å¯ï¼Œæœ‰æ—¶å€™æœ€åä¸€ä¸ªèŠ‚åŒºå°¾éƒ¨ä¹‹åè¿˜æœ‰åˆ«çš„ç¨‹åºï¼Œé‚£ä¹ˆå°±éœ€è¦è®¡ç®—æœ€åä¸€ä¸ªèŠ‚åŒºçš„ç»“æŸåœ°å€</p><p>æ±‚å’Œå¾—åˆ°2B6C00h</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647147968238.png"></p><h2 id="æœ€ç»ˆ"><a href="#æœ€ç»ˆ" class="headerlink" title="æœ€ç»ˆ"></a>æœ€ç»ˆ</h2><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647148042480.png"></p><h1 id="åˆå¹¶èŠ‚"><a href="#åˆå¹¶èŠ‚" class="headerlink" title="åˆå¹¶èŠ‚"></a>åˆå¹¶èŠ‚</h1><h2 id="ä¿®æ”¹èŠ‚è¡¨ä¸ªæ•°"><a href="#ä¿®æ”¹èŠ‚è¡¨ä¸ªæ•°" class="headerlink" title="ä¿®æ”¹èŠ‚è¡¨ä¸ªæ•°"></a>ä¿®æ”¹èŠ‚è¡¨ä¸ªæ•°</h2><p>åˆå¹¶ä¹‹åèŠ‚æ•°é‡-1ï¼Œè¿™é‡Œæ”¹ä¸º7</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647149630089.png"></p><h2 id="ä¿®æ”¹èŠ‚è¡¨ä¿¡æ¯"><a href="#ä¿®æ”¹èŠ‚è¡¨ä¿¡æ¯" class="headerlink" title="ä¿®æ”¹èŠ‚è¡¨ä¿¡æ¯"></a>ä¿®æ”¹èŠ‚è¡¨ä¿¡æ¯</h2><p>è¦å°†èŠ‚è¿›è¡Œåˆå¹¶ï¼Œå°±éœ€è¦ä¿®æ”¹èŠ‚è¡¨ä¿¡æ¯</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647149670756.png"></p><h3 id="DWORD-SizeOfRawDataå’ŒDWORD-VirtualSize"><a href="#DWORD-SizeOfRawDataå’ŒDWORD-VirtualSize" class="headerlink" title="DWORD SizeOfRawDataå’ŒDWORD VirtualSize"></a>DWORD SizeOfRawDataå’ŒDWORD VirtualSize</h3><p>å°†è¿™ä¸¤ä¸ªå€¼æ”¹ä¸ºè¯¥èŠ‚çš„Max(SizeOfRawData,VirtualSize)+ä¸‹ä¸€ä¸ªèŠ‚çš„Max(SizeOfRawData,VirtualSize)</p><p>æœ€åä¿å­˜å³å¯</p><p>é‚£ä¹ˆå‰©ä¸‹çš„èŠ‚è¡¨ä¿¡æ¯æ²¡ç”¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡æ–°å¢èŠ‚</p><h2 id="æœ€ç»ˆæ•ˆæœ-1"><a href="#æœ€ç»ˆæ•ˆæœ-1" class="headerlink" title="æœ€ç»ˆæ•ˆæœ"></a>æœ€ç»ˆæ•ˆæœ</h2><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647150089815.png"></p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647150123108.png"></p><h1 id="ç§»åŠ¨å¯¼å‡ºè¡¨"><a href="#ç§»åŠ¨å¯¼å‡ºè¡¨" class="headerlink" title="ç§»åŠ¨å¯¼å‡ºè¡¨"></a>ç§»åŠ¨å¯¼å‡ºè¡¨</h1><p>ç§»åŠ¨å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¼€è¾ŸèŠ‚åŒºï¼Œå…ˆå°†åé¢ä¸‰ä¸ªè¡¨æŒ‡å‘çš„æ•°æ®å¤åˆ¶åˆ°æ–°çš„èŠ‚åŒºä¸­ï¼Œå†å¤åˆ¶é‚£ä¸‰ä¸ªè¡¨çš„ä¿¡æ¯è¿‡å»ï¼Œæœ€åå°†æ•°æ®ç›®å½•æŒ‡å‘å¯¼å‡ºè¡¨å¼€å§‹çš„åœ°æ–¹</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647219750918.png" alt="ç§»åŠ¨å‰"></p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647220007029.png" alt="ç§»åŠ¨å"></p><h2 id="å®šä½å¯¼å‡ºè¡¨"><a href="#å®šä½å¯¼å‡ºè¡¨" class="headerlink" title="å®šä½å¯¼å‡ºè¡¨"></a>å®šä½å¯¼å‡ºè¡¨</h2><p>åœ¨æ•°æ®ç›®å½•æ‰¾åˆ°å¯¼å…¥è¡¨çš„RVA</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647228628138.png"></p><p>æ ¹æ®èŠ‚çš„RVAå’Œå¤§å°ç¡®å®šåœ¨å“ªä¸ªè¡¨</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647228686574.png"></p><p>è®¡ç®—FOA=Export .RVA-rdata.RVA+rdata. PointerToRawData</p><p>è®¡ç®—å¾—åˆ°F2270ï¼Œè·³è½¬ï¼Œæ ¹æ®Export.Sizeç¡®å®šå¤§å°</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647228914109.png"></p><h2 id="æ–°å¢èŠ‚-1"><a href="#æ–°å¢èŠ‚-1" class="headerlink" title="æ–°å¢èŠ‚"></a>æ–°å¢èŠ‚</h2><p>å‰é¢è¯´è¿‡ï¼Œå°±ä¸ç»†ğŸ”’äº†</p><h2 id="å¤åˆ¶æ•°æ®"><a href="#å¤åˆ¶æ•°æ®" class="headerlink" title="å¤åˆ¶æ•°æ®"></a>å¤åˆ¶æ•°æ®</h2><p>å‰é¢å››ä¸ªæ˜¯DWORDå‡½æ•°åœ°å€ï¼ŒDWORDå‡½æ•°åç§°è¡¨ï¼ŒWORDå‡½æ•°åºå·-è¿™é‡Œæ¯”è¾ƒå°‘ï¼Œå°±ä¸€ä¸ªå‡½æ•°</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647229009740.png"></p><p>è¿™ä¸¤ä¸ªåˆ†åˆ«æ˜¯dllåå­—å’Œå‡½æ•°åç§°</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647229076116.png"></p><p>ç›´æ¥å¤åˆ¶å‰©ä¸‹çš„å¯¼å‡ºè¡¨ä¿¡æ¯</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647229244730.png"></p><h2 id="ä¿®æ”¹RVA"><a href="#ä¿®æ”¹RVA" class="headerlink" title="ä¿®æ”¹RVA"></a>ä¿®æ”¹RVA</h2><p>è¿™é‡Œæˆ‘å·²ç»æ”¹å¥½äº†ï¼Œå› ä¸ºè¯¥èŠ‚çš„RVA-PointOfRawData=1600ï¼Œæ‰€ä»¥ä¿®æ”¹çš„æ—¶å€™å°†FOA+1600h=RVA</p><p>è¦ä¿®æ”¹çš„æœ‰</p><p><img src="/2022/03/11/PE-%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0/1647229408065.png"></p><h2 id="æ•°æ®ç›®å½•ä¿®æ”¹"><a href="#æ•°æ®ç›®å½•ä¿®æ”¹" class="headerlink" title="æ•°æ®ç›®å½•ä¿®æ”¹"></a>æ•°æ®ç›®å½•ä¿®æ”¹</h2><p>å°†Export.RVAæŒ‡å‘æˆ‘ä»¬å¤åˆ¶å¯¼å‡ºè¡¨çš„åˆå§‹ä½ç½®</p><h1 id="ç§»åŠ¨é‡å®šä½è¡¨"><a href="#ç§»åŠ¨é‡å®šä½è¡¨" class="headerlink" title="ç§»åŠ¨é‡å®šä½è¡¨"></a>ç§»åŠ¨é‡å®šä½è¡¨</h1><p>æ–°å¢èŠ‚-&gt;å¤åˆ¶æ•°æ®-&gt;æ•°æ®ç›®å½•ä¿®æ”¹é‡å®šä½è¡¨ä½ç½®</p><h2 id="ä¿®æ”¹ImageBase"><a href="#ä¿®æ”¹ImageBase" class="headerlink" title="ä¿®æ”¹ImageBase"></a>ä¿®æ”¹ImageBase</h2><p>æˆ‘ä»¬ä¿®æ”¹ImageBaseæ—¶ï¼Œé‡å®šä½è¡¨ä¹Ÿéœ€è¦ä¿®æ”¹ï¼Œå…¶ä»–ä¸ç”¨æ”¹ï¼Œå› ä¸ºå…¶ä»–èŠ‚è¡¨ä¿¡æ¯æ˜ å°„åˆ°å†…å­˜ä¸­æ—¶ï¼Œéƒ½æ˜¯æŒ‰ç…§ImageBaseè¿›è¡Œçš„</p><p>è€Œé‡å®šä½è¡¨æ˜¯æŒ‰ç…§VirtualAddress+å°è¡¨è¿›è¡Œä¿®å¤çš„ï¼Œæ‰€ä»¥ImageBaseä¿®æ”¹äº†ï¼Œé‡å®šä½è¡¨çš„VirtualAddressä¹Ÿéœ€è¦ä¿®æ”¹</p><p>å‡å¦‚ImageBase+1000ï¼Œé‡å®šä½è¡¨çš„VirtualAddressä¹Ÿéœ€è¦+1000</p><h1 id="å¯¼å…¥è¡¨æ³¨å…¥"><a href="#å¯¼å…¥è¡¨æ³¨å…¥" class="headerlink" title="å¯¼å…¥è¡¨æ³¨å…¥"></a>å¯¼å…¥è¡¨æ³¨å…¥</h1><p>æ¯ä¸ªDLLå¯¹åº”ä¸€ä¸ªå¯¼å…¥è¡¨ï¼ŒDLLå­˜æ”¾ç€æˆ‘ä»¬çš„å‡½æ•°</p><p>å¯¼å…¥è¡¨åé¢è¿˜æœ‰ä¸€å †æ•°æ®ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥æ·»åŠ ï¼Œæ‰€ä»¥è¦æ–°å¼€è¾ŸèŠ‚åŒºï¼Œç„¶åå¤åˆ¶åŸæ¥çš„å¯¼å…¥è¡¨ä¹‹åå†åœ¨æœ«å°¾æ·»åŠ å¯¼å…¥è¡¨</p><h2 id="æ–°å¢èŠ‚åŒº"><a href="#æ–°å¢èŠ‚åŒº" class="headerlink" title="æ–°å¢èŠ‚åŒº"></a>æ–°å¢èŠ‚åŒº</h2><h2 id="å¤åˆ¶å¯¼å…¥è¡¨ä¿¡æ¯"><a href="#å¤åˆ¶å¯¼å…¥è¡¨ä¿¡æ¯" class="headerlink" title="å¤åˆ¶å¯¼å…¥è¡¨ä¿¡æ¯"></a>å¤åˆ¶å¯¼å…¥è¡¨ä¿¡æ¯</h2><p> æ‹·è´åŸæ¥çš„å¯¼å…¥è¡¨åˆ°æ–°èŠ‚ä¸­ </p><h2 id="æ–°å¢å¯¼å…¥è¡¨"><a href="#æ–°å¢å¯¼å…¥è¡¨" class="headerlink" title="æ–°å¢å¯¼å…¥è¡¨"></a>æ–°å¢å¯¼å…¥è¡¨</h2><h2 id="æ–°å¢INTè¡¨å’ŒIATè¡¨"><a href="#æ–°å¢INTè¡¨å’ŒIATè¡¨" class="headerlink" title="æ–°å¢INTè¡¨å’ŒIATè¡¨"></a>æ–°å¢INTè¡¨å’ŒIATè¡¨</h2><p>è‡³å°‘å…«å­—èŠ‚</p><h2 id="ä¿®æ”¹Name"><a href="#ä¿®æ”¹Name" class="headerlink" title="ä¿®æ”¹Name"></a>ä¿®æ”¹Name</h2><p> å­˜å‚¨è¦æ³¨å…¥çš„dllçš„åç§° ï¼Œå¹¶ä¸”å°†DLLåç§°çš„RVAèµ‹å€¼ç»™æ–°å¢å¯¼å…¥è¡¨çš„Name</p><h2 id="åˆ›å»ºstruct-IMAGE-IMPORT-BY-NAME"><a href="#åˆ›å»ºstruct-IMAGE-IMPORT-BY-NAME" class="headerlink" title="åˆ›å»ºstruct _IMAGE_IMPORT_BY_NAME"></a>åˆ›å»ºstruct _IMAGE_IMPORT_BY_NAME</h2><p>å°†å‡½æ•°åç§°èµ‹å€¼ç»™ç»“æ„ä½“çš„ç¬¬äºŒä¸ªå˜é‡</p><h2 id="ä¿®æ”¹INTå’ŒIATæŒ‡å‘çš„åœ°å€"><a href="#ä¿®æ”¹INTå’ŒIATæŒ‡å‘çš„åœ°å€" class="headerlink" title="ä¿®æ”¹INTå’ŒIATæŒ‡å‘çš„åœ°å€"></a>ä¿®æ”¹INTå’ŒIATæŒ‡å‘çš„åœ°å€</h2><p>å°†IMAGE_IMPORT_BY_NAMEçš„RVAèµ‹å€¼ç»™INTå’ŒIATçš„ç¬¬ä¸€é¡¹ï¼Œå› ä¸ºINTå’ŒIATéƒ½æŒ‡å‘_IMAGE_IMPORT_BY_NAME</p><h2 id="ä¿®æ”¹æ•°æ®ç›®å½•"><a href="#ä¿®æ”¹æ•°æ®ç›®å½•" class="headerlink" title="ä¿®æ”¹æ•°æ®ç›®å½•"></a>ä¿®æ”¹æ•°æ®ç›®å½•</h2><p>æŒ‡å‘æˆ‘ä»¬çš„æ–°å¢ä½ç½®ï¼Œ ä¿®æ”¹IMAGE_DATA_DIRECTORYç»“æ„çš„VirtualAddresså’ŒSize </p>]]></content>
      
      
      
        <tags>
            
            <tag> PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PEè§£æä»£ç å®ç°</title>
      <link href="/2022/03/11/PE%E8%A7%A3%E6%9E%90%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/"/>
      <url>/2022/03/11/PE%E8%A7%A3%E6%9E%90%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="æ‰“å°PEæ–‡ä»¶å¤´éƒ¨å’ŒèŠ‚åŒºä¿¡æ¯"><a href="#æ‰“å°PEæ–‡ä»¶å¤´éƒ¨å’ŒèŠ‚åŒºä¿¡æ¯" class="headerlink" title="æ‰“å°PEæ–‡ä»¶å¤´éƒ¨å’ŒèŠ‚åŒºä¿¡æ¯"></a>æ‰“å°PEæ–‡ä»¶å¤´éƒ¨å’ŒèŠ‚åŒºä¿¡æ¯</h1><pre class="language-c" data-language="c"><code class="language-c">#define _CRT_SECURE_NO_WARNINGS#include&lt;stdio.h&gt;#include&lt;string.h&gt;#include&lt;malloc.h&gt;#include&lt;Windows.h&gt;//å®å®šä¹‰ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨//å®šä¹‰å˜é‡IMAGE_DOS_HEADER myDOS;LONG elf_new;IMAGE_NT_HEADERS32 myNTheader;IMAGE_OPTIONAL_HEADER32 myOPTIONheader;IMAGE_SECTION_HEADER mysection[100];int NUM_SECTION;int main(){FILE* pfile;pfile = fopen("D:\\new\\Notepadx32\\Notepad++.7.6.1.bin.x32\\Notepad++.7.6.1.bin.x32\\notepad++.exe", "r");//æ‰“å¼€æ–‡ä»¶fseek(pfile, 0, SEEK_SET);//å‚æ•°è¯´æ˜ï¼Œå°†fpæŒ‡é’ˆä»æ–‡ä»¶å¼€å¤´ç§»åŠ¨åˆ°0çš„ä½ç½®fread(&amp;myDOS, sizeof(IMAGE_DOS_HEADER), 1, pfile);//è¡¨ç¤ºä»fpå¼€å§‹çš„åœ°æ–¹è¯»å–ä¸€æ¬¡é•¿åº¦ä¸ºsizeof(IMAGE_DOS_HEADER)çš„å­—èŠ‚ï¼Œå­˜å‚¨åˆ°myDOSä¸­//DOSprintf("==============IMAGE_DOS_HEADER==============\n");printf("DOSå¤´ï¼š          %08X\n", myDOS.e_magic);printf("NTå¤´æ‰€åœ¨ä½ç½®ï¼š   %08X\n", myDOS.e_lfanew);elf_new = myDOS.e_lfanew;//å°†NTå¤´çš„åç§»å­˜å‚¨èµ·æ¥//NTå¤´fseek(pfile, elf_new, SEEK_SET);//æ³¨æ„ä¸æ˜¯sizeof(elf_new)fread(&amp;myNTheader, sizeof(IMAGE_NT_HEADERS), 1, pfile);printf("==============IMAGE_NT_HEADERS==============\n");//æ‰“å°PEæ ‡å¿—printf("PEæ ‡å¿—ï¼š         %08X\n", myNTheader.Signature);//æ‰“å°æ ‡å‡†PEå¤´ä¿¡æ¯printf("==============IMAGE_FILE_HEADERS==============\n");printf("èŠ‚åŒºæ•°é‡ï¼š       %08X\n", myNTheader.FileHeader.NumberOfSections);NUM_SECTION = myNTheader.FileHeader.NumberOfSections;printf("å¯é€‰PEå¤´å¤§å°ï¼š   %08X\n", myNTheader.FileHeader.SizeOfOptionalHeader);//æ‰“å°ASLRçš„ä¿¡æ¯ï¼Œæ–¹ä¾¿æŸ¥çœ‹å’Œä¿®æ”¹printf("ASLRå±æ€§ï¼š       %08X\n", (myNTheader.FileHeader.Characteristics ) &amp; 1);//æ‰“å°å¯é€‰PEå¤´ä¿¡æ¯printf("==============IMAGE_OPTIONAL_HEADERS==============\n");fseek(pfile, elf_new+sizeof(IMAGE_FILE_HEADER)+sizeof(myNTheader.Signature), SEEK_SET);//å› ä¸ºæ ‡å‡†PEå¤´é•¿åº¦ä¸º20fread(&amp;myOPTIONheader, sizeof(IMAGE_OPTIONAL_HEADER), 1, pfile);printf("DWORD AddressOfEntryPointï¼š   %08llX\n", myOPTIONheader.AddressOfEntryPoint);printf("åŸºå€ï¼š%08X\n", myOPTIONheader.ImageBase);//æ³¨æ„è¿™é‡Œçš„å¯é€‰PEå¤´ç±»å‹å¿…é¡»æ˜¯IMAGE_OPTIONAL_HEADER32printf("æ–‡ä»¶å¯¹é½å¤§å°ï¼š%08X\n", myOPTIONheader.FileAlignment);printf("å†…å­˜å¯¹é½å¤§å°ï¼š%08X\n", myOPTIONheader.SectionAlignment);printf("æ–‡ä»¶å¤´å’ŒèŠ‚è¡¨å¤§å°ï¼š  %08X\n", myOPTIONheader.SizeOfHeaders);printf("å†…å­˜æ‹‰ä¼¸å¤§å°ï¼š%08X\n", myOPTIONheader.SizeOfImage);//æ‰“å°èŠ‚è¡¨ä¿¡æ¯ï¼Œå‰é¢æˆ‘ä»¬å·²ç»å­˜å‚¨äº†èŠ‚è¡¨æ•°é‡äº†printf("==============IMAGE_SECTION_HEADER SectionHeaders==============\n");fseek(pfile, elf_new + sizeof(IMAGE_NT_HEADERS32), SEEK_SET);fread(&amp;mysection, sizeof(IMAGE_SECTION_HEADER) * NUM_SECTION, 1, pfile);for (int i = 0; i &lt; NUM_SECTION; ++i){printf("NAMEï¼š        %s\n", mysection[i].Name);printf("DWORD VirtualAddressï¼š        %08X\n", mysection[i].VirtualAddress);printf("DWORD SizeOfRawDataï¼š        %08X\n", mysection[i].SizeOfRawData);printf("DWORD PointerToRawDataï¼š        %08X\n", mysection[i].PointerToRawData);printf("DWORD VirtualSizeï¼š        %08X\n", mysection[i].Misc.VirtualSize);}fclose(pfile);//å…³é—­æ–‡ä»¶return 0;}</code></pre><h1 id="RVAè½¬FOA"><a href="#RVAè½¬FOA" class="headerlink" title="RVAè½¬FOA"></a>RVAè½¬FOA</h1><pre class="language-c" data-language="c"><code class="language-c">#define _CRT_SECURE_NO_WARNINGS#include&lt;stdio.h&gt;#include&lt;windows.h&gt;#include&lt;string.h&gt;#include&lt;stdlib.h&gt;/** RVAè½¬FOAçš„æ€è·¯* 1ã€å…ˆåˆ¤æ–­æ‰€åœ¨èŠ‚åŒºï¼Œè®¾è®¡æ€è·¯ï¼šé¦–å…ˆæˆ‘ä»¬å¿…é¡»æ‹¿çš„æ˜¯å†…å­˜å¯¹é½åçš„æ¥æ¯”è¾ƒå¤§å°ï¼Œå…ˆæŠŠRVA-virtualaddressï¼Œå†å’Œmax(MISC,SizeofRawData)æŒ‰ç…§å†…å­˜å¯¹é½çš„å€¼ä½œæ¯”è¾ƒ* 2ã€å¾ªç¯åˆ¤æ–­èŠ‚åŒº* 3ã€è®¡ç®—FOAï¼Œåç§»æ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±æ˜¯RVA-virtualaddress+èŠ‚åŒºçš„PointerOfdata*/IMAGE_NT_HEADERS32 myNTheader;IMAGE_DOS_HEADER myDOS;//å› ä¸ºPEå¤´é•¿åº¦ä¸å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°elf_newçš„å†…å®¹å°±å¯ä»¥çŸ¥é“èŠ‚åŒºçš„èµ·å§‹åœ°å€IMAGE_SECTION_HEADER mysection[10];int NUM_SECTION;//æˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“èŠ‚åŒºçš„æ•°é‡int elf_new;int RVA = 0x20d000;long long MAX(DWORD a, DWORD b){//è®¡ç®—MISCå’ŒSizeOFRAWDATAï¼Œå¹¶è¿”å›æŒ‰ç…§å†…å­˜å¯¹é½åçš„å€¼if (a &gt; b){return (a%myNTheader.OptionalHeader.SectionAlignment)?((a / myNTheader.OptionalHeader.SectionAlignment)+1) * myNTheader.OptionalHeader.SectionAlignment : ((a / myNTheader.OptionalHeader.SectionAlignment)) * myNTheader.OptionalHeader.SectionAlignment;}elsereturn (b % myNTheader.OptionalHeader.SectionAlignment) ? ((b / myNTheader.OptionalHeader.SectionAlignment) + 1) * myNTheader.OptionalHeader.SectionAlignment : ((b / myNTheader.OptionalHeader.SectionAlignment)) * myNTheader.OptionalHeader.SectionAlignment;;}int main(){FILE* pfile;pfile = fopen("D:\\new\\Notepadx32\\Notepad++.7.6.1.bin.x32\\Notepad++.7.6.1.bin.x32\\notepad++.exe", "r");fseek(pfile,0, SEEK_SET);fread(&amp;myDOS, sizeof(IMAGE_DOS_HEADER), 1, pfile);elf_new = myDOS.e_lfanew;fseek(pfile, elf_new, SEEK_SET);fread(&amp;myNTheader, sizeof(IMAGE_NT_HEADERS32), 1, pfile);NUM_SECTION = myNTheader.FileHeader.NumberOfSections;//å¾—åˆ°èŠ‚åŒºfseek(pfile, elf_new + sizeof(IMAGE_NT_HEADERS32), SEEK_SET);fread(&amp;mysection, sizeof(IMAGE_SECTION_HEADER) * NUM_SECTION, 1, pfile);for (int i = 0; i &lt; NUM_SECTION; ++i){if (RVA - mysection[i].VirtualAddress &lt; MAX(mysection[i].Misc.VirtualSize, mysection[i].SizeOfRawData)){printf("æ‰€åœ¨èŠ‚åŒºä¸ºï¼š%s\n", mysection[i].Name);printf("FOAä¸ºï¼š%08X", RVA - mysection[i].VirtualAddress + mysection[i].PointerToRawData);}}fclose(pfile);return 0;}</code></pre><h1 id="PEæ’å…¥shellcode"><a href="#PEæ’å…¥shellcode" class="headerlink" title="PEæ’å…¥shellcode"></a>PEæ’å…¥shellcode</h1><pre class="language-c" data-language="c"><code class="language-c">#define _CRT_SECURE_NO_WARNINGS#include&lt;stdio.h&gt;#include&lt;string.h&gt;#include&lt;Windows.h&gt;#include&lt;malloc.h&gt;#include&lt;stdlib.h&gt;#define MessageBoxA_ADDR 0x76C20F40//MessageBoxAçš„åœ°å€#define shellcode_len 0x12//å®šä¹‰shellcodeçš„é•¿åº¦//è¾“å…¥è·¯å¾„å’Œè¾“å‡ºè·¯å¾„char file_path[] = "D:\\new\\Notepadx32\\Notepad++.7.6.1.bin.x32\\Notepad++.7.6.1.bin.x32\\notepad++.exe";char final_path[] = "D:\\new\\Notepadx32\\Notepad++.7.6.1.bin.x32\\Notepad++.7.6.1.bin.x32\\5.exe";//æ’å…¥çš„shellcodeBYTE shellcode[] = {0x6A,0x00,0x6A,0x00,0x6A,0x00,0x6A,0x00,0xE8,0x00,0x00,0x00,0x00,0xE9,0x00,0x00,0x00,0x00};int LoadPE(LPVOID*pFileBuffer)//äºŒçº§æŒ‡é’ˆå­˜å‚¨çš„æ˜¯ä¸€çº§æŒ‡é’ˆçš„åœ°å€{FILE* pfile;DWORD FileSize = 0;LPVOID pTempBuffer;pfile = fopen(file_path, "rb");//é€šè¿‡fseekå’Œftellè¿”å›æ–‡ä»¶é•¿åº¦ï¼Œfseekå°†fpæŒ‡é’ˆè®¾ç½®åœ¨æ–‡ä»¶å°¾ï¼Œftellè·å–å½“å‰fpæŒ‡é’ˆçš„ä½ç½®ä¸æ–‡ä»¶é¦–çš„åç§»fseek(pfile, 0, SEEK_END);FileSize = ftell(pfile);//é‡æ–°è®¾ç½®å›å¼€å¤´fseek(pfile, 0, SEEK_SET);//å¼€è¾Ÿç©ºé—´ï¼Œmallocå‡½æ•°è¿”å›å¼€è¾Ÿç©ºé—´çš„èµ·å§‹åœ°å€pTempBuffer = malloc(FileSize);//å°†æ–‡ä»¶ä¸­çš„å†…å®¹è¯»å–åˆ°ä¸´æ—¶Bufferä¸­fread(pTempBuffer, FileSize, 1, pfile);//å°†åˆ†é…è¿”å›çš„åœ°å€å­˜å‚¨åˆ°FileBufferä¸­*pFileBuffer = pTempBuffer;//tempæŒ‡é’ˆæŒ‡å‘ç©ºpTempBuffer = NULL;fclose(pfile);return FileSize;}int CopyFileBufferToImageBuffer(LPVOID pFileBuffer,LPVOID* pImageBuffer)//pImageBufferæ˜¯voidç±»å‹æŒ‡é’ˆï¼ŒæŒ‡å‘çš„æ˜¯è¯»å–åˆ°å†…å­˜ä¸­çš„æ–‡ä»¶å†…å®¹é¦–åœ°å€{//åˆå§‹åŒ–PEç»“æ„ä½“æŒ‡é’ˆPIMAGE_DOS_HEADER pDOSHeader = NULL;PIMAGE_NT_HEADERS pNTHeader = NULL;PIMAGE_FILE_HEADER pFileHeader = NULL;PIMAGE_OPTIONAL_HEADER32 pOptionalHeader = NULL;PIMAGE_SECTION_HEADER pSectionHeader = NULL;//åˆå§‹åŒ–tempBufferLPVOID pTempBuffer = NULL;//é€šè¿‡å¼ºåˆ¶è½¬æ¢ç±»å‹æ¥é™åˆ¶é•¿åº¦,è½¬ä¸ºDoså¤´çš„æŒ‡é’ˆé‚£ä¹ˆå¾—åˆ°çš„å°±æ˜¯Doså¤´çš„ä¿¡æ¯pDOSHeader = PIMAGE_DOS_HEADER(pFileBuffer);pNTHeader = (PIMAGE_NT_HEADERS)((DWORD)pFileBuffer + pDOSHeader-&gt;e_lfanew);//å› ä¸ºvoidç±»å‹çš„æŒ‡é’ˆä¸èƒ½ç›´æ¥è¿ç®—ï¼Œæ‰€ä»¥å°†å…¶è½¬ä¸ºintæ•´å‹ï¼Œå†åšåŠ å‡å¾—åˆ°å…¶ä»–åœ°å€pFileHeader = (PIMAGE_FILE_HEADER)((DWORD)pNTHeader + 4);pOptionalHeader = (PIMAGE_OPTIONAL_HEADER32)((DWORD)pFileHeader + IMAGE_SIZEOF_FILE_HEADER);pSectionHeader = (PIMAGE_SECTION_HEADER)((DWORD)pOptionalHeader + pFileHeader-&gt;SizeOfOptionalHeader);//åˆ†é…ImageBufferå†…å­˜pTempBuffer = malloc(pOptionalHeader-&gt;SizeOfImage);//åˆå§‹åŒ–ImageBufferå†…å­˜memset(pTempBuffer, 0, pOptionalHeader-&gt;SizeOfImage);//æ‹·è´æ•°æ®memcpy(pTempBuffer, pDOSHeader, pOptionalHeader-&gt;SizeOfHeaders);//å‚æ•°è¯´æ˜ï¼Œç›®æ ‡æ•°æ®ã€è¢«ä½¿ç”¨æ•°æ®ï¼Œé•¿åº¦//å¾ªç¯æ‹·è´èŠ‚è¡¨ä¿¡æ¯PIMAGE_SECTION_HEADER pTempSectionHeader = pSectionHeader;for (int i = 0; i &lt; pFileHeader-&gt;NumberOfSections; i++,pTempSectionHeader++){//å› ä¸ºmemcpyåªæ¥å—voidç±»å‹çš„æŒ‡é’ˆï¼Œæ‰€ä»¥è¦å…ˆå¼ºåˆ¶è½¬æ¢memcpy((void*)((DWORD)pTempBuffer + pTempSectionHeader-&gt;VirtualAddress), (void*)((DWORD)pFileBuffer + pTempSectionHeader-&gt;PointerToRawData), pTempSectionHeader-&gt;SizeOfRawData);}//èµ‹å€¼ç»™pImageBuffer*pImageBuffer = pTempBuffer;pTempBuffer = NULL;return pOptionalHeader-&gt;SizeOfImage;}int CopyImageBufferToNewBuffer(LPVOID pImageBuffer,LPVOID* pNewBuffer){//åˆå§‹åŒ–PEç»“æ„ä½“æŒ‡é’ˆPIMAGE_DOS_HEADER pDOSHeader = NULL;PIMAGE_NT_HEADERS pNTHeader = NULL;PIMAGE_FILE_HEADER pFileHeader = NULL;PIMAGE_OPTIONAL_HEADER32 pOptionalHeader = NULL;PIMAGE_SECTION_HEADER pSectionHeader = NULL;//åˆå§‹åŒ–TempBufferLPVOID pTempBuffer = NULL;//ç»“æ„ä½“å¼ºåˆ¶è½¬æ¢pDOSHeader = PIMAGE_DOS_HEADER(pImageBuffer);pNTHeader = (PIMAGE_NT_HEADERS)((DWORD)pImageBuffer + pDOSHeader-&gt;e_lfanew);//å› ä¸ºvoidç±»å‹çš„æŒ‡é’ˆä¸èƒ½ç›´æ¥è¿ç®—ï¼Œæ‰€ä»¥å°†å…¶è½¬ä¸ºintæ•´å‹ï¼Œå†åšåŠ å‡å¾—åˆ°å…¶ä»–åœ°å€pFileHeader = (PIMAGE_FILE_HEADER)((DWORD)pNTHeader + 4);pOptionalHeader = (PIMAGE_OPTIONAL_HEADER32)((DWORD)pFileHeader + IMAGE_SIZEOF_FILE_HEADER);pSectionHeader = (PIMAGE_SECTION_HEADER)((DWORD)pOptionalHeader + pFileHeader-&gt;SizeOfOptionalHeader);//è®¡ç®—NewBufferå¤§å°DWORD new_buffer_size = pOptionalHeader-&gt;SizeOfHeaders;//èŠ‚è¡¨å¤§å°è®¡ç®—PIMAGE_SECTION_HEADER pTempSectionHeader = pSectionHeader;//æ³¨æ„è¿™é‡Œè¦ä½¿ç”¨ä¸´æ—¶å˜é‡ï¼Œå¦åˆ™å¾ªç¯çš„æ—¶å€™ï¼Œç»“æ„ä½“æŒ‡é’ˆåç§»ï¼ŒæŒ‡å‘æ”¹å˜for (int i = 0; i &lt; pFileHeader-&gt;NumberOfSections; i++, pTempSectionHeader++){new_buffer_size += pTempSectionHeader-&gt;SizeOfRawData;//printf("%X\n", pSectionHeader-&gt;SizeOfRawData);}printf("%X\n", new_buffer_size);//å¼€è¾Ÿç©ºé—´å¹¶ä¸”è®¾ç½®ä¸º0pTempBuffer = malloc(new_buffer_size);memset(pTempBuffer, 0, new_buffer_size);//å¤åˆ¶ImageBufferä¿¡æ¯memcpy(pTempBuffer, pDOSHeader, pOptionalHeader-&gt;SizeOfHeaders);//å¤åˆ¶èŠ‚è¡¨ä¿¡æ¯pTempSectionHeader = pSectionHeader;for (int i = 0; i &lt; pFileHeader-&gt;NumberOfSections; i++, ++pTempSectionHeader){//å› ä¸ºmemcpyåªæ¥å—voidç±»å‹çš„æŒ‡é’ˆï¼Œæ‰€ä»¥è¦å…ˆå¼ºåˆ¶è½¬æ¢memcpy((PWORD)((DWORD)pTempBuffer + pTempSectionHeader-&gt;PointerToRawData), (PWORD)((DWORD)pImageBuffer + pTempSectionHeader-&gt;VirtualAddress), pTempSectionHeader-&gt;SizeOfRawData);}//èµ‹å€¼ç»™pImageBuffer*pNewBuffer = pTempBuffer;pTempBuffer = NULL;return new_buffer_size;}void newbuffer_write2_exe(PVOID NewFileBuffer, DWORD FileSize, char* FilePath){FILE* fp1 = fopen(FilePath, "wb");if (fp1 != NULL){fwrite(NewFileBuffer, FileSize, 1, fp1);printf("æˆåŠŸå­˜ç›˜");}fclose(fp1);return ;}void ADD_Opcode(LPVOID pImageBuffer, LPVOID* pNewBuffer){//åˆå§‹åŒ–PEç»“æ„ä½“æŒ‡é’ˆPIMAGE_DOS_HEADER pDOSHeader = NULL;PIMAGE_NT_HEADERS pNTHeader = NULL;PIMAGE_FILE_HEADER pFileHeader = NULL;PIMAGE_OPTIONAL_HEADER32 pOptionalHeader = NULL;PIMAGE_SECTION_HEADER pSectionHeader = NULL;//é€šè¿‡å¼ºåˆ¶è½¬æ¢ç±»å‹æ¥é™åˆ¶é•¿åº¦,è½¬ä¸ºDoså¤´çš„æŒ‡é’ˆé‚£ä¹ˆå¾—åˆ°çš„å°±æ˜¯Doså¤´çš„ä¿¡æ¯pDOSHeader = PIMAGE_DOS_HEADER(pImageBuffer);pNTHeader = (PIMAGE_NT_HEADERS)((DWORD)pImageBuffer + pDOSHeader-&gt;e_lfanew);//å› ä¸ºvoidç±»å‹çš„æŒ‡é’ˆä¸èƒ½ç›´æ¥è¿ç®—ï¼Œæ‰€ä»¥å°†å…¶è½¬ä¸ºintæ•´å‹ï¼Œå†åšåŠ å‡å¾—åˆ°å…¶ä»–åœ°å€pFileHeader = (PIMAGE_FILE_HEADER)((DWORD)pNTHeader + 4);pOptionalHeader = (PIMAGE_OPTIONAL_HEADER32)((DWORD)pFileHeader + IMAGE_SIZEOF_FILE_HEADER);pSectionHeader = (PIMAGE_SECTION_HEADER)((DWORD)pOptionalHeader + pFileHeader-&gt;SizeOfOptionalHeader);//åˆ¤æ–­èƒ½å¦æ’å…¥if (shellcode_len &gt; pSectionHeader-&gt;SizeOfRawData - pSectionHeader-&gt;Misc.VirtualSize){printf("é•¿åº¦ä¸è¶³ï¼Œæ— æ³•æ’å…¥\n");free(pImageBuffer);}//è®¡ç®—ç©ºç™½ä½ç½®ï¼Œè½¬ä¸ºchar*æŒ‡é’ˆPBYTE code_begin = (PBYTE)((DWORD)pImageBuffer + pSectionHeader-&gt;VirtualAddress+ pSectionHeader-&gt;Misc.VirtualSize);//æ’å…¥shellcodememcpy(code_begin, shellcode, shellcode_len);//è®¡ç®—E8åœ°å€DWORD callADDr = (MessageBoxA_ADDR - (pOptionalHeader-&gt;ImageBase + pSectionHeader-&gt;VirtualAddress + pSectionHeader-&gt;Misc.VirtualSize + 0xD));//å°†callADDRæ’å…¥åˆ°E8ä¹‹å,å¡«å……æ•°æ®*(PDWORD)((DWORD)code_begin + 0x09) = callADDr;//è®¡ç®—jmpåœ°å€,è·³è½¬çš„å€¼=çœŸå®åœ°å€-ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€DWORD jmpADDr = pOptionalHeader-&gt;ImageBase + pOptionalHeader-&gt;AddressOfEntryPoint - ((DWORD)code_begin + pOptionalHeader-&gt;ImageBase + shellcode_len-(DWORD)pImageBuffer);*(PDWORD)((code_begin + 14)) = jmpADDr;//ä¿®æ”¹OEPpOptionalHeader-&gt;AddressOfEntryPoint = ((DWORD)code_begin - (DWORD)pImageBuffer);//ä¹Ÿå¯ä»¥ä½¿ç”¨VirtualAddress+VirtualSize//è¿˜åŸä¸ºNewBufferDWORD ret2=CopyImageBufferToNewBuffer(pImageBuffer, pNewBuffer);//å­˜ç›˜newbuffer_write2_exe(*pNewBuffer,ret2, final_path);return ;}void operate_pe(){LPVOID pFileBuffer = NULL;//LPVOIDç›¸å½“äºvoid*LPVOID pNewBuffer = NULL;LPVOID pImageBuffer = NULL;//è¯»å–æ–‡ä»¶å†…å®¹åˆ°FileBufferä¸­dDWORD file_size = LoadPE(&amp;pFileBuffer);//äºŒçº§æŒ‡é’ˆvoid**,å°†å­˜å‚¨æŒ‡é’ˆçš„åœ°å€ä¼ è¿‡å»printf("æ–‡ä»¶é•¿åº¦ä¸ºï¼š  %08X\n", file_size);//å°†FileBufferæ‹‰ä¼¸ä¸ºImageBufferDWORD Image_Size = CopyFileBufferToImageBuffer(pFileBuffer,&amp;pImageBuffer);printf("æ‹‰ä¼¸åçš„å¤§å°ä¸ºï¼š  %08X\n",Image_Size);//æ·»åŠ opcodeADD_Opcode(pImageBuffer, &amp;pNewBuffer);//å¼€è¾Ÿçš„å†…å­˜éœ€è¦freeæ‰free(pFileBuffer);free(pNewBuffer);free(pImageBuffer);return;}int main(){operate_pe();return 0;}</code></pre><h1 id="PEæ–‡ä»¶æ–°å¢èŠ‚"><a href="#PEæ–‡ä»¶æ–°å¢èŠ‚" class="headerlink" title="PEæ–‡ä»¶æ–°å¢èŠ‚"></a>PEæ–‡ä»¶æ–°å¢èŠ‚</h1><pre class="language-c" data-language="c"><code class="language-c">#define _CRT_SECURE_NO_WARNINGS#include&lt;stdio.h&gt;#include&lt;string.h&gt;#include&lt;windows.h&gt;#include&lt;stdlib.h&gt;#include&lt;malloc.h&gt;/*æ€è·¯ï¼š1ã€è¯»å–æ–‡ä»¶ä¿¡æ¯åˆ°bufferä¸­åˆ¤æ–­èŠ‚åŒºä¿¡æ¯å¤Ÿä¸å¤Ÿå¤§å°ï¼Œä¸¤ä¸ªèŠ‚è¡¨çš„å¤§å°2ã€æ‰¾åˆ°èŠ‚åŒºçš„æœ€åä½ç½®ï¼Œå¼€è¾ŸæŒ‡å®šå¤§å°çš„ç©ºé—´3ã€ä¿®æ”¹ä¿¡æ¯-NumberOfSectionã€SizeOfRawDataã€VirtualSizeï¼ˆæ³¨æ„è¦å¯¹é½ï¼‰*/#define New_Buffer_Size 0x1000#define File_Path "D:\\new\\Notepadx32\\Notepad++.7.6.1.bin.x32\\Notepad++.7.6.1.bin.x32\\notepad++.exe"#define Final_Path "D:\\new\\Notepadx32\\Notepad++.7.6.1.bin.x32\\Notepad++.7.6.1.bin.x32\\6++.exe"int Open_File(LPVOID *pFileBuffer){FILE* pfile = NULL;LPVOID TempBuffer = NULL;pfile = fopen(File_Path, "rb");fseek(pfile, 0, SEEK_END);DWORD file_size = ftell(pfile);//è®¾ç½®æ–‡ä»¶æŒ‡é’ˆåˆ°æ–‡ä»¶å¤´fseek(pfile, 0, SEEK_SET);TempBuffer = malloc(file_size);fread(TempBuffer , file_size, 1, pfile);*pFileBuffer = TempBuffer;TempBuffer = NULL;fclose(pfile);return file_size;}int Add_Section(LPVOID FileBuffer, LPVOID* pNewBuffer,DWORD file_size){//å®šä¹‰ç»“æ„ä½“æŒ‡é’ˆPIMAGE_DOS_HEADER pDOSHeader = NULL;PIMAGE_NT_HEADERS32 pNTHeader = NULL;PIMAGE_OPTIONAL_HEADER32 pOptionalHeader = NULL;PIMAGE_SECTION_HEADER pSection = NULL;PIMAGE_FILE_HEADER pFileHeader = NULL;PVOID pNewTempBuffer = NULL;DWORD New_File_Size = 0;//æ–°å¢èŠ‚New_File_Size = file_size + 0x1000;pNewTempBuffer = (PVOID)malloc(New_File_Size);// åˆ¤æ–­å¼€è¾Ÿç©ºé—´æ˜¯å¦æˆåŠŸif (!pNewTempBuffer){printf("pNewTempBufferå¼€è¾Ÿç©ºé—´å¤±è´¥!\n");return 0;}// åˆå§‹åŒ–å†…å­˜memset(pNewTempBuffer, 0, New_File_Size);// å°†æ—§ç©ºé—´çš„å†…å®¹copyåˆ°æ–°çš„ç©ºé—´memcpy(pNewTempBuffer, FileBuffer, file_size);//è¯»å–ä¿¡æ¯pDOSHeader = (PIMAGE_DOS_HEADER)(pNewTempBuffer);pNTHeader = (PIMAGE_NT_HEADERS32)((DWORD)pNewTempBuffer + pDOSHeader-&gt;e_lfanew);pFileHeader = (PIMAGE_FILE_HEADER)((DWORD)pNTHeader + 4);pOptionalHeader = (PIMAGE_OPTIONAL_HEADER32)((DWORD)pFileHeader + sizeof(IMAGE_FILE_HEADER));pSection = (PIMAGE_SECTION_HEADER)((DWORD)pOptionalHeader + sizeof(IMAGE_OPTIONAL_HEADER32));//æ‰¾åˆ°èŠ‚è¡¨çš„æœ€åä½ç½®PIMAGE_SECTION_HEADER pfinal_Section = &amp;(pSection[pFileHeader-&gt;NumberOfSections - 1]);//åˆ¤æ–­èƒ½å¦æ’å…¥èŠ‚è¡¨,å› ä¸ºåœ¨æ–‡ä»¶å’Œå†…å­˜ä¸­PEå¤´å’ŒDOSå¤´å¤§å°ä¸å˜ï¼Œç›´æ¥è®¡ç®—å³å¯DWORD remain_size = (pOptionalHeader-&gt;SizeOfHeaders - pDOSHeader-&gt;e_lfanew - 4 - sizeof(IMAGE_FILE_HEADER) - sizeof(IMAGE_OPTIONAL_HEADER32) - sizeof(IMAGE_SECTION_HEADER) * pFileHeader-&gt;NumberOfSections);if (remain_size &lt; 2 * sizeof(IMAGE_SECTION_HEADER)){printf("ä½ç½®ä¸å¤Ÿæï¼Œæƒ³æƒ³å…¶ä»–åŠæ³•å§~\n");}//ä¿®æ”¹ä¿¡æ¯// åˆå§‹åŒ–æ–°å¢èŠ‚ä¿¡æ¯PVOID pSecName = &amp;pSection[pFileHeader-&gt;NumberOfSections].Name;PDWORD pSecMisc = &amp;pSection[pFileHeader-&gt;NumberOfSections].Misc.VirtualSize;PDWORD pSecVirtualAddress = &amp;pSection[pFileHeader-&gt;NumberOfSections].VirtualAddress;PDWORD pSecSizeofRawData = &amp;pSection[pFileHeader-&gt;NumberOfSections].SizeOfRawData;PDWORD pSecPointerToRawData = &amp;pSection[pFileHeader-&gt;NumberOfSections].PointerToRawData;PDWORD pSecCharacteristic = &amp;pSection[pFileHeader-&gt;NumberOfSections].Characteristics;//åå­—memcpy(pSecName, ".mycode", 8);//Misc*pSecMisc = 0x1000;//è®¡ç®—VirtualAddress=å‰ä¸€ä¸ªèŠ‚çš„VA+sizeofrawdataæˆ–è€…virtualSizeå†…å­˜å¯¹é½å¤§å°DWORD Sec_Size = (pfinal_Section-&gt;SizeOfRawData &gt; pfinal_Section-&gt;Misc.VirtualSize) ? pfinal_Section-&gt;SizeOfRawData : pfinal_Section-&gt;Misc.VirtualSize;//å†…å­˜å¯¹é½Sec_Size= (Sec_Size % pOptionalHeader-&gt;SectionAlignment) ? ((Sec_Size / pOptionalHeader-&gt;SectionAlignment) + 1) * pOptionalHeader-&gt;SectionAlignment : Sec_Size;//ä¿®æ”¹VirtualAddress*pSecVirtualAddress = pfinal_Section-&gt;VirtualAddress + Sec_Size;//ä¿®æ”¹sizeofRawData*pSecSizeofRawData = 0x1000;//ä¿®æ”¹PointerDWORD size = pfinal_Section-&gt;SizeOfRawData;DWORD File_Size= (size % pOptionalHeader-&gt;FileAlignment) ? ((size / pOptionalHeader-&gt;FileAlignment) + 1) * pOptionalHeader-&gt;FileAlignment : size;*pSecPointerToRawData = pfinal_Section-&gt;PointerToRawData + File_Size;*pSecCharacteristic = 0xFFFFFFFF;//å¤´éƒ¨ä¿¡æ¯,å…ˆè®¡ç®—å¢åŠ çš„é•¿åº¦åœ¨å†…å­˜å’Œæ–‡ä»¶æ‹‰ä¼¸çš„é•¿åº¦DWORD Sec_ADD = (New_Buffer_Size % pOptionalHeader-&gt;SectionAlignment) ? ((New_Buffer_Size / pOptionalHeader-&gt;SectionAlignment) + 1) * pOptionalHeader-&gt;SectionAlignment : New_Buffer_Size;DWORD File_ADD = pOptionalHeader-&gt;SizeOfImage += Sec_ADD;pFileHeader-&gt;NumberOfSections += 1;*pNewBuffer = pNewTempBuffer;pNewTempBuffer = NULL;return New_File_Size;}void Write_To_Newfile(DWORD New_File_Size, LPVOID pNewBuffer){FILE* fp;fp = fopen(Final_Path, "wb");fwrite(pNewBuffer, New_File_Size, 1, fp);fclose(fp);return ;}void PE_operate(){DWORD new_file_size = 0;PVOID pNewBuffer = NULL;PVOID FileBuffer = NULL;DWORD file_size = 0;DWORD New_File_Size = 0;//æ‰“å¼€æ–‡ä»¶è¯»å–ä¿¡æ¯file_size = Open_File(&amp;FileBuffer);//æ–°å¢èŠ‚å¹¶ä¸”ä¿®æ”¹ä¿¡æ¯New_File_Size=Add_Section(FileBuffer,&amp;pNewBuffer,file_size);Write_To_Newfile(New_File_Size, pNewBuffer);}int main(){PE_operate();return 0;}</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PEæ–‡ä»¶ç»“æ„</title>
      <link href="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/"/>
      <url>/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h1 id="PEæ–‡ä»¶"><a href="#PEæ–‡ä»¶" class="headerlink" title="PEæ–‡ä»¶"></a>PEæ–‡ä»¶</h1><p>ä¸»è¦æœ‰exeã€dllã€sysæ–‡ä»¶ï¼Œè¿™äº›éƒ½æ˜¯å¯æ‰§è¡Œæ–‡ä»¶</p><p>exeç”±å¤šä¸ªexeæ–‡ä»¶ç»„æˆï¼Œdllä¹‹ç±»çš„</p><h1 id="PEæ–‡ä»¶å¤´è§£æ"><a href="#PEæ–‡ä»¶å¤´è§£æ" class="headerlink" title="PEæ–‡ä»¶å¤´è§£æ"></a>PEæ–‡ä»¶å¤´è§£æ</h1><p>åœ¨å†…å­˜ä¸­å’Œç¡¬ç›˜ä¸­æ•°æ®å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å­˜åœ¨å·®å¼‚ï¼Œä¸”ç¨‹åºå¼€å§‹çš„ä½ç½®ä¸åŒï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“å­˜å‚¨ä¿¡æ¯çš„ä½ç½®æ˜¯å¯ä»¥æ”¹å˜çš„</p><p>æ ¹æ®ä¸åŒçš„åŠŸèƒ½åˆ†äº†ä¸åŒçš„èŠ‚ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºä¸åŒçš„å—ï¼Œè¿™æ ·åš1ã€å¯ä»¥èŠ‚çœç¡¬ç›˜ç©ºé—´ï¼Œåœ¨å†…å­˜ä¸­å ç”¨ç©ºé—´å¤§äºç¡¬ç›˜å ç”¨ç©ºé—´ï¼ˆèŠ‚ä¹‹é—´çš„é—´éš”è¾ƒå°ï¼‰</p><p>2ã€èŠ‚çœå†…å­˜ï¼Œå½“ç¨‹åºéœ€è¦å¤šå¼€çš„æ—¶å€™ï¼Œåªéœ€è¦å°†å¯è¯»å¯å†™çš„æ•°æ®æ®µé‡æ–°å¤åˆ¶ä¸€ä»½å³å¯ï¼Œä¸éœ€è¦å¯¹åªè¯»çš„æ•°æ®è¿›è¡Œå¤åˆ¶</p><h2 id="ç¡¬ç›˜ï¼ˆæ–‡ä»¶ï¼‰å¯¹é½å’Œå†…å­˜å¯¹é½"><a href="#ç¡¬ç›˜ï¼ˆæ–‡ä»¶ï¼‰å¯¹é½å’Œå†…å­˜å¯¹é½" class="headerlink" title="ç¡¬ç›˜ï¼ˆæ–‡ä»¶ï¼‰å¯¹é½å’Œå†…å­˜å¯¹é½"></a>ç¡¬ç›˜ï¼ˆæ–‡ä»¶ï¼‰å¯¹é½å’Œå†…å­˜å¯¹é½</h2><p>ç›®çš„éƒ½æ˜¯ä¸ºäº†æå‡è¯»å†™çš„é€Ÿåº¦</p><p>è€çš„ç¼–è¯‘å™¨ï¼Œç¡¬ç›˜å¯¹é½æ˜¯200hä¸ªå­—èŠ‚<strong>ï¼ˆå½“ä¸å¤Ÿ200hå­—èŠ‚ï¼Œä¼šè‡ªåŠ¨å¡«å……ï¼‰</strong>ï¼Œå†…å­˜å¯¹é½æ˜¯1000hä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥PEç»“æ„æ‰§è¡Œï¼ˆ<strong>æ“ä½œç³»ç»Ÿè¿è¡Œexeæ–‡ä»¶</strong>ï¼‰æ—¶ä¼šå‘ç”Ÿæ‹‰ä¼¸çš„è¿‡ç¨‹ï¼Œå³åœ¨å†…å­˜ä¸­å ç”¨ç©ºé—´å¤§äºç¡¬ç›˜å ç”¨ç©ºé—´</p><p>æ–°çš„ç¼–è¯‘å™¨åœ¨ç¡¬ç›˜å’Œå†…å­˜éƒ½é‡‡ç”¨1000hï¼Œè¿™æ˜¯å› ä¸ºç¼–è¯‘å™¨å‘å±•ï¼Œè¿™æ ·å†…å­˜å’Œç¡¬ç›˜å¯¹é½ä¸€æ ·ï¼Œè¿è¡Œæ—¶å¯ä»¥å‡å°‘è¿ç®—ï¼Œè¿™æ ·è™½ç„¶ç‰ºç‰²äº†ç©ºé—´ï¼Œä½†æ˜¯ç¼©çŸ­äº†æ—¶é—´</p><h2 id="PEç£ç›˜æ–‡ä»¶ä¸å†…å­˜æ˜ åƒç»“æ„å›¾"><a href="#PEç£ç›˜æ–‡ä»¶ä¸å†…å­˜æ˜ åƒç»“æ„å›¾" class="headerlink" title="PEç£ç›˜æ–‡ä»¶ä¸å†…å­˜æ˜ åƒç»“æ„å›¾"></a>PEç£ç›˜æ–‡ä»¶ä¸å†…å­˜æ˜ åƒç»“æ„å›¾</h2><p>å—è¡¨ï¼ˆèŠ‚è¡¨ï¼‰æ¦‚æ‹¬èŠ‚çš„åŸºæœ¬ä¿¡æ¯ï¼ˆèµ·å§‹å’Œç»ˆæ­¢ä½ç½®ï¼ŒèŠ‚çš„å¤§å°ï¼‰ï¼ŒDOSå¤´å’ŒPEå¤´å¯¹å½“å‰exeæ–‡ä»¶åšçš„æ¦‚è¦æ€§æè¿°ï¼ˆæ‹‰ä¼¸å®Œåçš„å¤§å°ï¼Œå †æ ˆå¤§å°ï¼‰ï¼ŒèŠ‚è¡¨å­˜å‚¨ä¿¡æ¯</p><p> <img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/19100019-8692ac67434949cb9ec42764cab75468-1646313270630.jpg"> </p><h2 id="DOSå¤´"><a href="#DOSå¤´" class="headerlink" title="DOSå¤´"></a>DOSå¤´</h2><p>DOSé•¿åº¦ç¡®å®š</p><p>è§£æexeæ–‡ä»¶æ—¶ï¼Œå…ˆè§£æå‰ä¸¤ä¸ªå­—èŠ‚ï¼Œå¹¶é€šè¿‡DOSå¤´æ‰¾åˆ°exeæ–‡ä»¶çœŸæ­£å¼€å§‹çš„åœ°æ–¹</p><p>ç¬¬ä¸€ä¸ªWORD MZSignatureï¼ˆe_magicï¼‰-MZæ ‡è®°</p><p>æœ€åä¸€ä¸ªLONG AddressOfNewExeHeaderï¼ˆe_lfanewï¼‰-æŒ‡å‘äº†PEæ–‡ä»¶çš„çœŸæ­£å¼€å§‹åœ°å€</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646292642401.png"></p><p>è¿™é‡Œçš„0108è¡¨ç¤ºä»æ–‡ä»¶å¼€å§‹çš„åœ°æ–¹è®¡ç®—0108ä¸ªå­—èŠ‚å°±æ˜¯PEç»“æ„å¼€å§‹çš„åœ°æ–¹</p><h2 id="NTå¤´"><a href="#NTå¤´" class="headerlink" title="NTå¤´"></a>NTå¤´</h2><p>DOSå¤´å’ŒNTå¤´ä¸­é—´æ˜¯ä¸€æ®µç©ºé—´ï¼Œå¯ä»¥è‡ªç”±å‘æŒ¥ï¼Œå¤šä¸å°‘ä¸ç¡®å®šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸€æ®µå†™å…¥shellcodeï¼ˆ <strong>åˆ©ç”¨è½¯ä»¶æ¼æ´è€Œæ‰§è¡Œçš„ä»£ç </strong> ï¼‰ï¼Œåœ¨ç¨‹åºä¸­è°ƒç”¨ã€‚æœ‰åœ°å€æˆ‘ä»¬å°±å¯ä»¥è®¿é—®å’Œæ‰§è¡Œ</p><p>PEçš„æ ‡è®°-DWORD Signature-å››ä¸ªå­—èŠ‚</p><h3 id="æ ‡å‡†PEå¤´-20å­—èŠ‚"><a href="#æ ‡å‡†PEå¤´-20å­—èŠ‚" class="headerlink" title="æ ‡å‡†PEå¤´-20å­—èŠ‚"></a>æ ‡å‡†PEå¤´-20å­—èŠ‚</h3><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646295409969.png"></p><p>å…³é”®ä¿¡æ¯</p><p>enum IMAGE_MACHINE Machine-ç¨‹åºè¿è¡Œçš„CPUå‹å·ï¼š0x0 ä»»ä½•å¤„ç†å™¨ /0x14C 386åŠåç»­å¤„ç†å™¨</p><p>WORD NumberOfSections-æ–‡ä»¶ä¸­å­˜åœ¨çš„èŠ‚çš„æ•°é‡ï¼Œå¦‚æœéœ€è¦æ–°å¢æˆ–è€…åˆå¹¶èŠ‚ï¼Œå°±è¦ä¿®æ”¹è¿™ä¸ªå€¼</p><p>time_t TimeDateStamp-æ–‡ä»¶åˆ›å»ºæ—¶é—´ï¼Œç¼–è¯‘å™¨å¡«å†™</p><p><strong>WORD SizeOfOptionalHeader</strong>-å¯é€‰PEå¤´çš„å¤§å°ï¼Œ32ä½PEæ–‡ä»¶é»˜è®¤E0hã€64ä½PEæ–‡ä»¶é»˜è®¤ä¸ºF0h  å¤§å°å¯ä»¥è‡ªå®šä¹‰.</p><p>struct FILE_CHARACTERISTICS Characteristics-æ¯ä¸ªä½æœ‰ä¸åŒçš„å«ä¹‰ï¼Œå¯æ‰§è¡Œæ–‡ä»¶å€¼ä¸º10F å³0 1 2 3 8ä½ç½®1 </p><p>è¿™é‡Œçš„102æ‹†æˆäºŒè¿›åˆ¶</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646296388161.png"></p><p>å‹¾ä¸­å³ä¸º1</p><h3 id="å¯é€‰PEå¤´"><a href="#å¯é€‰PEå¤´" class="headerlink" title="å¯é€‰PEå¤´"></a>å¯é€‰PEå¤´</h3><p>ç»“æ„</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646296662617.png"></p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646296680675.png"></p><p>å…³é”®ä¿¡æ¯</p><p>enum OPTIONAL_MAGIC Magic-è¯´æ˜æ–‡ä»¶ç±»å‹ï¼š10B 32ä½ä¸‹çš„PEæ–‡ä»¶ã€20B 64ä½ä¸‹çš„PEæ–‡ä»¶</p><p>DWORD SectionAlignment-å†…å­˜å¯¹é½</p><p>DWORD FileAlignment-æ–‡ä»¶å¯¹é½</p><p>DWORD SizeOfCode-æ‰€æœ‰ä»£ç èŠ‚çš„å’Œï¼Œå¿…é¡»æ˜¯FileAlignmentçš„æ•´æ•°å€ï¼Œç¼–è¯‘å™¨å¡«çš„ï¼Œä¸ä¼šè¢«ä½¿ç”¨</p><p>DWORD SizeOfInitializedData-å·²åˆå§‹åŒ–æ•°æ®å¤§å°çš„å’Œï¼Œå¿…é¡»æ˜¯FileAlignmentçš„æ•´æ•°å€ï¼Œç¼–è¯‘å™¨å¡«çš„ï¼Œä¸ä¼šè¢«ä½¿ç”¨</p><p>DWORD SizeOfUninitializedData-æœªåˆå§‹åŒ–æ•°æ®å¤§å°çš„å’Œï¼Œå¿…é¡»æ˜¯FileAlignmentçš„æ•´æ•°å€ï¼Œç¼–è¯‘å™¨å¡«çš„ï¼Œä¸ä¼šè¢«ä½¿ç”¨</p><p><em><strong>DWORD AddressOfEntryPoint-ç¨‹åºå…¥å£</strong></em></p><p>DWORD BaseOfCode-ä»£ç å¼€å§‹çš„åŸºå€ï¼Œç¼–è¯‘å™¨å¡«çš„ï¼Œä¸ä¼šè¢«ä½¿ç”¨</p><p>DWORD BaseOfData-æ•°æ®å¼€å§‹çš„åŸºå€ï¼Œç¼–è¯‘å™¨å¡«çš„ï¼Œä¸ä¼šè¢«ä½¿ç”¨</p><p>ï¼ï¼<em><strong>DWORD ImageBase-å†…å­˜é•œåƒåŸºå€</strong></em>ï¼ˆä¸ä»0å¼€å§‹æ˜¯å› ä¸ºéœ€è¦å†…å­˜ä¿æŠ¤ï¼‰</p><p><em><strong>æŠŠæ–‡ä»¶æ‹–å…¥ODæ—¶ä¼šæ–­åœ¨ImageBase+AddressOfEntryPointè¿™ä¸ªåœ°å€ï¼Œä¹Ÿå°±æ˜¯OEP</strong></em></p><blockquote><p>ç¨‹åºå…¥å£å¯ä»¥ä¿®æ”¹-åŠ å£³</p><p>åŠ å£³ä¹‹åå…¥å£ç‚¹EPï¼ˆRVAï¼‰å’ŒOEPï¼ˆRAWï¼‰éƒ½ä¼šæ”¹å˜ï¼Œä½†æ˜¯å†…å­˜é•œåƒåŸºå€ä¸å˜</p></blockquote><blockquote><p>å†…æ ¸é‡è½½ï¼šï¼ˆæœ‰ä¸€äº›è½¯ä»¶ä¼šé€šè¿‡hookæŠ€æœ¯ï¼Œæ£€æµ‹æ˜¯å¦è°ƒç”¨å‡½æ•°ï¼‰ç›¸å½“äºPEloaderï¼ˆåŠ è½½ï¼‰-æŠŠç¡¬ç›˜æ–‡ä»¶æ‹·è´åˆ°å†…å­˜ä¸­è¿›è€Œæ‰§è¡Œexeæ–‡ä»¶ï¼Œä½†æ˜¯åœ¨æ‹·è´è¿‡ç¨‹ä¸­è¿˜ä¼šæœ‰ä¸€ä¸ªæ–‡ä»¶çš„ç¼“å†²åŒºï¼Œè¿™ä¸ªç¼“å†²åŒºä¹Ÿæ˜¯åœ¨å†…å­˜ä¸­çš„ã€‚è£…è½½åˆ°å†…å­˜æ—¶æ˜¯ä»¥ImageBaseä¸ºèµ·ç‚¹çš„</p></blockquote><p>DWORD SizeOfImage-å†…å­˜ä¸­æ•´ä¸ªPEæ–‡ä»¶çš„æ˜ å°„çš„å°ºå¯¸ï¼Œå¯ä»¥æ¯”å®é™…çš„å€¼å¤§ï¼Œä½†å¿…é¡»æ˜¯SectionAlignmentçš„æ•´æ•°å€ï¼Œä¹Ÿå°±æ˜¯PEæ–‡ä»¶åœ¨å†…å­˜ä¸­è¢«æ‹‰ä¼¸åçš„å¤§å°</p><p>DWORD SizeOfHeaders-æ‰€æœ‰å¤´+èŠ‚è¡¨æŒ‰ç…§æ–‡ä»¶å¯¹é½åçš„å¤§å°ï¼Œå¦åˆ™åŠ è½½ä¼šå‡ºé”™</p><p>DWORD CheckSum-æ ¡éªŒå’Œï¼Œä¸€äº›ç³»ç»Ÿæ–‡ä»¶æœ‰è¦æ±‚ï¼Œç”¨æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹</p><p>DWORD SizeOfStackReserve-åˆå§‹åŒ–æ—¶ä¿ç•™çš„å †æ ˆå¤§å°</p><p>DWORD SizeOfStackCommit-åˆå§‹åŒ–æ—¶å®é™…æäº¤çš„å¤§å°</p><p>DWORD SizeOfHeapReserve-åˆå§‹åŒ–æ—¶ä¿ç•™çš„å †çš„å¤§å°</p><p>DWORD SizeOfHeapCommit-åˆå§‹åŒ–æ—¶å®é™…æäº¤çš„å¤§å°</p><p>DWORD NumberOfRvaAndSizes-ç›®å½•é¡¹æ•°ç›®</p><h1 id="èŠ‚è¡¨-æ¯ä¸ªèŠ‚æœ‰28å­—èŠ‚çš„ä¿¡æ¯"><a href="#èŠ‚è¡¨-æ¯ä¸ªèŠ‚æœ‰28å­—èŠ‚çš„ä¿¡æ¯" class="headerlink" title="èŠ‚è¡¨-æ¯ä¸ªèŠ‚æœ‰28å­—èŠ‚çš„ä¿¡æ¯"></a>èŠ‚è¡¨-æ¯ä¸ªèŠ‚æœ‰28å­—èŠ‚çš„ä¿¡æ¯</h1><p>èŠ‚è¡¨å®šä½-DOS+PE+OPTIONPE</p><p>æè¿°æ¯ä¸ªèŠ‚çš„ä¿¡æ¯</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646306378425.png"></p><p>èŠ‚çš„ç»“æ„</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646306828500.png"></p><p>BYTE Name[8]æ˜¯å…«ä¸ªå­—èŠ‚ï¼Œä¸å¤Ÿè¡¥â€™\0â€™ï¼Œåœ¨å†…å­˜æ˜¯0ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨char*ï¼Œè€Œè¦ç”¨char [9]ï¼Œä¸”å¯ä»¥éšä¾¿æ”¹</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646306924262.png"></p><p>ç¬¬äºŒä¸ªæˆå‘˜æ˜¯union Miscï¼ŒåŒå­—ï¼Œæ˜¯è¯¥èŠ‚åœ¨æ²¡æœ‰å¯¹é½å‰çš„çœŸå®å°ºå¯¸ï¼Œè¯¥å€¼å¯ä»¥ä¸å‡†ç¡®ï¼ˆå¯èƒ½è¢«åˆ«çš„è½¯ä»¶åŠ å·¥è¿‡ï¼‰ï¼Œä½†æ˜¯ä¸ä¼šå¦¨ç¢è¿è¡Œï¼Œ<strong>é‡Œé¢çš„æˆå‘˜DWORD VirtualSize-å­˜æ”¾PEæ–‡ä»¶æ”¾å…¥å†…å­˜æ—¶çš„æ•°æ®å®½åº¦ï¼Œä»–çš„å€¼å¯èƒ½å¤§äºæ–‡ä»¶å¯¹é½åçš„æ•°æ®å®½åº¦ï¼ˆSizeofRawDataï¼‰ï¼Œè¿™æ˜¯å› ä¸ºæœªåˆå§‹åŒ–çš„å˜é‡ä¸ä¼šè¢«å­˜å…¥æ–‡ä»¶ä¸­</strong></p><p>ç¬¬ä¸‰ä¸ªæˆå‘˜-DWORD VirtualAddress-èŠ‚åŒºåœ¨å†…å­˜ä¸­çš„ç›¸å¯¹åç§»ï¼ˆæ‹‰ä¼¸-å†…å­˜å¯¹é½åçš„ï¼‰ï¼ŒåŠ ä¸ŠImageBaseæ‰æ˜¯åœ¨å†…å­˜ä¸­çš„çœŸæ­£åœ°å€ï¼ˆè·Ÿæ–‡ä»¶ä¸­æ— å…³ï¼‰</p><p>ç¬¬å››ä¸ªæˆå‘˜-DWORD SizeOfRawData-èŠ‚åœ¨æ–‡ä»¶ä¸­å¯¹é½åçš„å°ºå¯¸</p><p>ç¬¬äº”ä¸ªæˆå‘˜-DWORD PointerToRawData-èŠ‚åŒºåœ¨æ–‡ä»¶ä¸­çš„åç§»,æ‰€ä»¥.textæ˜¯ä»400hå¼€å§‹çš„ï¼ˆè·Ÿå†…å­˜ä¸­æ— å…³ï¼‰</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646309678678.png"></p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646308057578.png"></p><p>ç¬¬äºŒä¸ªå’Œç¬¬å››ä¸ªæ˜¯åœ¨è°ƒè¯•æ—¶ä½¿ç”¨çš„ï¼Œç¼–è¯‘å®Œè¿™å››ä¸ªé»˜è®¤ä¸º0</p><p>struct SECTION_CHARACTERISTICS Characteristics-èŠ‚çš„å±æ€§</p><p>æœ€åä¸€ä¸ªæˆå‘˜struct SECTION_CHARACTERISTICS Characteristics-é‡Œé¢æœ‰32ä½ï¼Œä½†ä¸æ˜¯æ¯ä¸€ä½éƒ½ç”¨</p><pre class="language-c" data-language="c"><code class="language-c">--&gt; æ ‡å¿—(å±æ€§å—) å¸¸ç”¨ç‰¹å¾å€¼å¯¹ç…§è¡¨ï¼š&lt;--[å€¼:00000020h](*åŒ…å«å¯æ‰§è¡Œä»£ç )[å€¼:00000040h](*è¯¥å—åŒ…å«å·²åˆå§‹åŒ–çš„æ•°æ®)[å€¼:00000080h](*è¯¥å—åŒ…å«æœªåˆå§‹åŒ–çš„æ•°æ®)[å€¼:00000200h][Section contains comments or some other type of information.][å€¼:00000800h][Section contents will not become part of image.][å€¼:00001000h][Section contents comdat.][å€¼:00004000h][Reset speculative exceptions handling bits in the TLB entries for this section.][å€¼:00008000h][Section content can be accessed relative to GP.][å€¼:00500000h][Default alignment if no others are specified.][å€¼:01000000h][Section contains extended relocations.][å€¼:02000000h][Section can be discarded.][å€¼:04000000h][Section is not cachable.][å€¼:08000000h][Section is not pageable.][å€¼:10000000h](*è¯¥å—ä¸ºå…±äº«å—).[å€¼:20000000h](*è¯¥å—å¯æ‰§è¡Œ)[å€¼:40000000h](*è¯¥å—å¯è¯»)[å€¼:80000000h](*è¯¥å—å¯å†™)</code></pre><h1 id="è¿è¡ŒçŠ¶æ€"><a href="#è¿è¡ŒçŠ¶æ€" class="headerlink" title="è¿è¡ŒçŠ¶æ€"></a>è¿è¡ŒçŠ¶æ€</h1><p>æ‹‰ä¼¸å®Œä¹‹åè¿˜éœ€è¦è¿›è¡Œä¸€äº›å‡†å¤‡æ­¥éª¤</p><p>å…ˆæŠŠæ–‡ä»¶å¯¹é½åçš„æ•°æ®æ‹·è´åˆ°å†…å­˜ä¸­ï¼Œæ ¹æ®SizeofHeadesï¼Œç›´æ¥copyï¼Œå› ä¸ºå¤´å’ŒèŠ‚è¡¨æ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œä½†æ˜¯èŠ‚è¡¨åé¢ä¸ä¸€å®šæ˜¯èŠ‚åŒºï¼Œè¿™æ˜¯å› ä¸ºæ–‡ä»¶å¯¹é½å’Œå†…å­˜å¯¹é½ä¸åŒ</p><p>å¾ªç¯èµ‹å€¼èŠ‚çš„å†…å®¹ï¼Œå¤åˆ¶åˆ°å†…å­˜çš„åœ°æ–¹ç”±èŠ‚è¡¨ä¿¡æ¯é‡Œé¢çš„VirtualAddresså†³å®šï¼ŒPointerToRawDataå†³å®šäº†æ–‡ä»¶å¤åˆ¶åˆ°å†…å­˜çš„èµ·å§‹ä½ç½®</p><p>å¤åˆ¶æ•°æ®çš„å¤§å°æ ¹æ®SizeofRawDataï¼ˆMiscä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯å¦‚æœMIscå­˜åœ¨å¤§é‡æœªåˆå§‹åŒ–æ•°æ®ï¼Œä¼šå˜å¾—å¾ˆå¤§ï¼Œå¯èƒ½å°†ä¸‹ä¸€èŠ‚çš„ä¿¡æ¯ä¹Ÿcopyåˆ°å†…å­˜ä¸­ï¼‰</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646548848907.png"></p><h2 id="æ ¹æ®å†…å­˜æ•°æ®å­˜å‚¨çš„ä½ç½®æŸ¥æ‰¾åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®"><a href="#æ ¹æ®å†…å­˜æ•°æ®å­˜å‚¨çš„ä½ç½®æŸ¥æ‰¾åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®" class="headerlink" title="æ ¹æ®å†…å­˜æ•°æ®å­˜å‚¨çš„ä½ç½®æŸ¥æ‰¾åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®"></a>æ ¹æ®å†…å­˜æ•°æ®å­˜å‚¨çš„ä½ç½®æŸ¥æ‰¾åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®</h2><p>å‡è®¾å†…å­˜å¼€å§‹ä½ç½®æ˜¯500000ï¼Œæ•°æ®åœ¨å†…å­˜å­˜å‚¨ä½ç½®æ˜¯501234</p><p>1ã€ç¡®å®šèŠ‚</p><p>å…ˆç¡®å®šåç§»501234-500000</p><p>æ ¹æ®èŠ‚çš„ä¸åŒåç§»ï¼ˆVirtualAddressï¼‰</p><p>1234&gt;VirtualAddress</p><p>1234&lt;VirtualAddress+Misc.VirtualSize</p><p>2ã€è®¡ç®—è·ç¦»èŠ‚åˆå§‹ä½ç½®çš„é•¿åº¦</p><p>1234-1000=234h</p><p>3ã€åœ¨æ–‡ä»¶ä¸­å¯»æ‰¾</p><p>å› ä¸ºåœ¨æ–‡ä»¶ä¸­å’Œåœ¨å†…å­˜ä¸­è·ç¦»èŠ‚åˆå§‹ä½ç½®çš„é•¿åº¦ç›¸åŒï¼Œæ‰€ä»¥åœ°å€ä¸º400+234h</p><h1 id="ä»£ç èŠ‚ç©ºç™½åŒºæ·»åŠ ä»£ç "><a href="#ä»£ç èŠ‚ç©ºç™½åŒºæ·»åŠ ä»£ç " class="headerlink" title="ä»£ç èŠ‚ç©ºç™½åŒºæ·»åŠ ä»£ç "></a>ä»£ç èŠ‚ç©ºç™½åŒºæ·»åŠ ä»£ç </h1><p>MessageBoxA-å››ä¸ªå‚æ•°ï¼Œæ‰§è¡Œåä¼šå‡ºç°å¼¹çª—-ä¸€èˆ¬exeéƒ½æœ‰è¿™ä¸ªå‡½æ•°-user32.dllé‡Œé¢</p><p>è®©ç¨‹åºæ‰§è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œéœ€è¦å…ˆæ‰¾åˆ°OEPï¼Œä¿®æ”¹ä¸ºcallæˆ‘ä»¬å‡½æ•°çš„åœ°å€ï¼Œç„¶åå†jmpå›åˆ°åŸç¨‹åºçš„OEP</p><p>call=E8+å››ä¸ªå­—èŠ‚ï¼Œjmp=E9+å››ä¸ªå­—èŠ‚</p><p>ä½†æ˜¯è¿™å››ä¸ªå­—èŠ‚ä¸æ˜¯ç›´æ¥çš„åœ°å€ï¼Œéœ€è¦è¿›è¡Œè®¡ç®—</p><blockquote><p>çœŸæ­£è¦è·³è½¬çš„åœ°å€=E8è¿™æ¡æŒ‡ä»¤çš„ä¸‹ä¸€è¡Œåœ°å€ï¼ˆå½“å‰æŒ‡ä»¤åœ°å€+5ï¼Œå› ä¸ºcallé•¿åº¦æ˜¯5ï¼‰+Xï¼ˆXå°±æ˜¯E8åè¾¹è·Ÿç€çš„å››ä¸ªå­—èŠ‚ï¼‰</p></blockquote><p>push=0x6A</p><p>æ‰€ä»¥æˆ‘ä»¬è¦åŠ çš„ç¨‹åºç¡¬ç¼–ç  = 6A 00  6A 00  6A 00  6A 00  E8 00 00 00 00 E9 00 00 00 00</p><p>æˆ‘ä»¬åŠ å…¥çš„ä»£ç å¿…é¡»åŠ åœ¨æ‹‰ä¼¸åçš„æ–‡ä»¶ä¸­ï¼Œä¹Ÿå°±æ˜¯å†…å­˜ä¸­çš„ï¼Œå› ä¸ºæˆ‘ä»¬è®¡ç®—çš„åœ°å€æ˜¯æ‹‰ä¼¸åçš„åœ°å€</p><h2 id="æ·»åŠ ä»£ç è¿‡ç¨‹-æ–‡ä»¶æ³¨å…¥"><a href="#æ·»åŠ ä»£ç è¿‡ç¨‹-æ–‡ä»¶æ³¨å…¥" class="headerlink" title="æ·»åŠ ä»£ç è¿‡ç¨‹-æ–‡ä»¶æ³¨å…¥"></a>æ·»åŠ ä»£ç è¿‡ç¨‹-æ–‡ä»¶æ³¨å…¥</h2><p>1ã€å…ˆçœ‹ä»£ç ç©ºç™½åŒºèƒ½ä¸èƒ½å¡«å……é‚£åå…«ä¸ªå­—èŠ‚â€”â€”ï¼ˆSizeofRawData-VirtualSizeï¼‰</p><p>2ã€æ‰¾åˆ°æ·»åŠ çš„åœ°æ–¹ï¼Œå‡è®¾æˆ‘ä»¬å¼€å§‹æ˜¯ä»1000hå¼€å§‹çš„ï¼Œè€ŒSizeofRawDataæ˜¯1a0000ï¼Œæ‰€ä»¥ä¸¤è€…ç›¸åŠ å°±æ˜¯å½“å‰èŠ‚ç»“æŸçš„åœ°å€ï¼Œè€Œåœ¨1b0000ä¹‹å‰ä¸º0çš„éƒ¨åˆ†æ˜¯ä»£ç å—çš„ç©ºç™½éƒ¨åˆ†</p><p>3ã€å¼€å§‹å¡«å……æˆ‘ä»¬çš„é‚£åå…«ä¸ªå­—èŠ‚</p><p>4ã€ç®—åœ°å€ï¼Œè¦è®¡ç®—å†…å­˜å¯¹é½çš„åœ°å€ï¼Œè€Œä¸æ˜¯æ–‡ä»¶å¯¹é½çš„ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦çš„æ˜¯è¿è¡Œæ—¶çš„åœ°å€ï¼ˆå†…å­˜å¯¹é½å’Œæ–‡ä»¶å¯¹é½ä¸åŒï¼‰</p><p>å…ˆæ‰¾åˆ°MessageBoxAåœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œåœ¨ODé‡Œé¢ä½¿ç”¨å‘½ä»¤bp MessageBoxAï¼ŒæŒ‰çŠ¶æ€æ çš„Bå¯ä»¥æ‰¾åˆ°å†…å­˜çš„åœ°å€</p><p>5ã€å¡«å……ï¼Œæ³¨æ„å°ç«¯åºï¼ŒE8è·Ÿç€è®¡ç®—åçš„åœ°å€ï¼ŒE9è·Ÿç€è®¡ç®—åçš„OEPï¼ˆImageBase+EntryPointï¼‰</p><p>6ã€å°†åŸæœ¬çš„EntryOfPointæ”¹ä¸ºæˆ‘ä»¬å¡«å……æ•°æ®åœ¨å†…å­˜ä¸­çš„åœ°å€</p><h1 id="ä»»æ„ä»£ç èŠ‚ç©ºç™½åŒºæ·»åŠ ä»£ç "><a href="#ä»»æ„ä»£ç èŠ‚ç©ºç™½åŒºæ·»åŠ ä»£ç " class="headerlink" title="ä»»æ„ä»£ç èŠ‚ç©ºç™½åŒºæ·»åŠ ä»£ç "></a>ä»»æ„ä»£ç èŠ‚ç©ºç™½åŒºæ·»åŠ ä»£ç </h1><p>ä»å†…å­˜è½¬ä¸ºç¡¬ç›˜æ–‡ä»¶è®¡ç®—å¤§å°-æœ€åä¸€ä¸ªèŠ‚çš„åˆå§‹ä½ç½®+æœ€åä¸€ä¸ªèŠ‚çš„å¤§å°</p><h1 id="æ–°å¢èŠ‚-æ·»åŠ ä»£ç "><a href="#æ–°å¢èŠ‚-æ·»åŠ ä»£ç " class="headerlink" title="æ–°å¢èŠ‚-æ·»åŠ ä»£ç "></a>æ–°å¢èŠ‚-æ·»åŠ ä»£ç </h1><p>æ–°å¢ä¹‹åï¼Œä¿®æ”¹NumberOfSectionsï¼ŒèŠ‚è¡¨ä¿¡æ¯ï¼ŒèŠ‚è¡¨åé¢å¿…é¡»è·Ÿç€ä¸€å®šé•¿åº¦çš„00æ•°æ®ï¼ˆç©ºç™½åŒºï¼‰ï¼Œæ‰€ä»¥è¦è®¡ç®—å¢åŠ ä¹‹åSizeofHeadersä¼šä¸ä¼šå¤§äºPointerOfRawDataï¼Œå¹¶ä¸”åœ¨æ–°å¢èŠ‚æœ€ååŠ ä¸Šä¸€ä¸ªèŠ‚è¡¨ä¿¡æ¯é•¿åº¦çš„00</p><p>è®¡ç®—å†…å­˜åç§»VirtualAddressï¼ˆRVAï¼‰æ—¶ï¼Œæ ¹æ®ä¸Šä¸€ä¸ªèŠ‚åŒºçš„VirtualAddress+ï¼ˆSizofRawData/VirtualSize[è°å¤§åŠ è°]ï¼‰æŒ‰ç…§å†…å­˜å¯¹é½åçš„æ•°</p><p>å¦‚æœç¼–è¯‘å™¨åœ¨èŠ‚è¡¨ä¸­åŠ å…¥ä¸€äº›æ•°æ®ï¼Œè€Œæˆ‘ä»¬ä¸èƒ½ä¿®æ”¹ï¼ŒèŠ‚è¡¨åˆä¸èƒ½æ–­ï¼Œåªèƒ½å°†NTå¤´å‰ç§»ï¼ˆåŠ å…¥æ•°æ®ä¹‹å‰çš„ï¼‰ï¼Œè¿™æ ·å†å»æ·»åŠ æ–°çš„èŠ‚è¡¨ä¿¡æ¯ï¼Œå°±ä¸ä¼šå ç”¨ç¼–è¯‘å™¨åŠ å…¥çš„æ•°æ®</p><p>å½“DOSåˆ°NTå¤´å¤§å°ä¸å¤Ÿå¼€è¾Ÿä¸€ä¸ªèŠ‚è¡¨çš„ä¿¡æ¯ï¼Œåªèƒ½æ‰©å……æœ€åä¸€ä¸ªèŠ‚</p><h1 id="æ‰©å¤§èŠ‚-åˆå¹¶èŠ‚-æ•°æ®ç›®å½•"><a href="#æ‰©å¤§èŠ‚-åˆå¹¶èŠ‚-æ•°æ®ç›®å½•" class="headerlink" title="æ‰©å¤§èŠ‚-åˆå¹¶èŠ‚-æ•°æ®ç›®å½•"></a>æ‰©å¤§èŠ‚-åˆå¹¶èŠ‚-æ•°æ®ç›®å½•</h1><p>æ‰©å¤§èŠ‚ï¼šåœ¨å†…å­˜ä¸­è¿›è¡Œæ‰©å¤§ï¼Œç„¶åå†è¿˜åŸå›æ–‡ä»¶ä¸­ï¼Œè¿˜åŸçš„æ—¶å€™è¦ä¿®æ”¹å‚æ•°</p><p>1ã€æ‹‰ä¼¸åˆ°å†…å­˜</p><p>2ã€åˆ†é…æ–°ç©ºé—´N=SizeofImage+Ex</p><p>3ã€å°†æœ€åä¸€ä¸ªèŠ‚çš„SizeOfRawdataå’ŒVirtualSizeæ”¹ä¸ºN</p><p>4ã€ä¿®æ”¹SizeofImage</p><p>åˆå¹¶èŠ‚ï¼šåˆå¹¶ä¹‹åèŠ‚è¡¨æœ‰ç©ºé—´è¿›è¡Œæ·»åŠ èŠ‚åŒº</p><p>VirtualSize=SizeofImage-VIrtualAddress</p><blockquote><p>æ•°æ®ç›®å½•-é‡Œé¢å­˜å‚¨å„ç§è¡¨çš„ä¿¡æ¯</p></blockquote><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646564515662.png"></p><p>ä¸‹é¢ä»‹ç»å‡ ç§æ¯”è¾ƒé‡è¦çš„</p><h1 id="DLL-åŠ¨æ€é“¾æ¥åº“å’Œé™æ€é“¾æ¥åº“"><a href="#DLL-åŠ¨æ€é“¾æ¥åº“å’Œé™æ€é“¾æ¥åº“" class="headerlink" title="DLL-åŠ¨æ€é“¾æ¥åº“å’Œé™æ€é“¾æ¥åº“"></a>DLL-åŠ¨æ€é“¾æ¥åº“å’Œé™æ€é“¾æ¥åº“</h1><p>ä½¿ç”¨çš„æ—¶å€™éƒ½éœ€è¦include</p><p>ç¨‹åºç¼–è¯‘çš„è¿‡ç¨‹ä¸ºå°†.hå’Œ.cppç­‰æ–‡ä»¶è¿›è¡Œé¢„ç¼–è¯‘ï¼Œç„¶åè¿›è¡Œç¼–è¯‘ï¼Œå†è¿›è¡Œæ±‡ç¼–ï¼Œæœ€åé“¾æ¥ä¸Šï¼ˆ.a/.lib/.so/.dllï¼‰æˆä¸ºå¯æ‰§è¡Œæ–‡ä»¶</p><p>é™æ€åº“ã€åŠ¨æ€åº“åŒºåˆ«æ¥è‡ªã€é“¾æ¥é˜¶æ®µã€‘å¦‚ä½•å¤„ç†åº“ï¼ˆå¤„ç†æ–¹å¼ä¸åŒæ¥åŒºåˆ†ï¼‰ï¼Œé“¾æ¥æˆå¯æ‰§è¡Œç¨‹åºã€‚åˆ†åˆ«ç§°ä¸ºé™æ€é“¾æ¥æ–¹å¼ã€åŠ¨æ€é“¾æ¥æ–¹å¼</p><h2 id="é™æ€é“¾æ¥"><a href="#é™æ€é“¾æ¥" class="headerlink" title="é™æ€é“¾æ¥"></a>é™æ€é“¾æ¥</h2><p>ä½¿ç”¨çš„æ—¶å€™éœ€è¦includeå’Œ#pragma comment(lib,â€xxx.libâ€)</p><p>å› ä¸ºå¤´æ–‡ä»¶åªåŒ…å«å‡½æ•°å£°æ˜ï¼Œå‡½æ•°å®ç°åœ¨libæ–‡ä»¶ä¸­</p><p>å³åœ¨é“¾æ¥é˜¶æ®µï¼Œå°†æºæ–‡ä»¶ç”¨åˆ°çš„åº“å‡½æ•°ä¸æ±‡ç¼–ç”Ÿæˆçš„æ–‡ä»¶.oç­‰åˆå¹¶ï¼ˆå³å‡½æ•°è¢«åŒ…å«åœ¨exeæ–‡ä»¶ä¸­ï¼‰ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</p><p>å¥½å¤„ï¼šæ–¹ä¾¿ç¨‹åºç§»æ¤ï¼Œå› ä¸ºå¯æ‰§è¡Œç¨‹åºä¸åº“å‡½æ•°å†æ— å…³ç³»ï¼Œæ”¾å…¥ä»»ä½•ç¯å¢ƒå½“ä¸­éƒ½å¯ä»¥æ‰§è¡Œ</p><p>ç¼ºç‚¹ï¼šå¯æ‰§è¡Œæ–‡ä»¶å¤ªå¤§ï¼ˆå› ä¸ºåŒ…å«äº†åº“å‡½æ•°ï¼‰ï¼Œæ¯æ¬¡åº“æ–‡ä»¶å‡çº§éƒ½éœ€è¦é‡æ–°ç¼–è¯‘æºæ–‡ä»¶ï¼Œæ¯ä¸ªå¯æ‰§è¡Œç¨‹åºéƒ½ä¼šåˆå¹¶åº“å‡½æ•°ï¼Œå­˜åœ¨å¾ˆå¤§çš„é‡å¤æ€§ï¼Œå ç”¨ç©ºé—´å¤§</p><h2 id="åŠ¨æ€é“¾æ¥"><a href="#åŠ¨æ€é“¾æ¥" class="headerlink" title="åŠ¨æ€é“¾æ¥"></a>åŠ¨æ€é“¾æ¥</h2><p>ä¸¤ä¸ªç¨‹åºåº”ç”¨ä¸€ä¸ªåº“ï¼Œç›®æ ‡æ–‡ä»¶åœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä»½ï¼Œä¾›æ‰€æœ‰ç¨‹åºä½¿ç”¨ï¼Œä½†æ˜¯å¯ç§»æ¤æ€§å¤ªå·®ï¼Œå¦‚æœä¸¤å°ç”µè„‘è¿è¡Œç¯å¢ƒä¸åŒï¼ŒåŠ¨æ€åº“å­˜æ”¾ä½ç½®ä¸åŒï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºè¿è¡Œå¤±è´¥</p><h3 id="éšå¼é“¾æ¥"><a href="#éšå¼é“¾æ¥" class="headerlink" title="éšå¼é“¾æ¥"></a>éšå¼é“¾æ¥</h3><p>1ã€å°†dllï¼Œlibæ–‡ä»¶æ·»åŠ åˆ°è°ƒç”¨æ–‡ä»¶ä¸­</p><p>2ã€å°†#pragma comment(lib,â€xxx.libâ€)æ·»åŠ åˆ°è°ƒç”¨æ–‡ä»¶ä¸­</p><p>3ã€åŠ å…¥å‡½æ•°çš„å£°æ˜</p><p>extern â€œCâ€ _declspec(dllimport) _stdcall int Plus(int x,int y);</p><p>å¯¼å‡ºåˆ™ä¸ºdllexportï¼Œdllå¯¼å‡ºå’Œå¯¼å…¥çš„æ–¹å¼å¿…é¡»ä¸€è‡´ï¼Œå³å¯¼å‡ºçš„æ—¶å€™ä½¿ç”¨äº†_stdcallï¼Œå¯¼å…¥çš„æ—¶å€™ä¹Ÿåº”è¯¥æ˜¯__stdcall</p><p>è¿™æ ·çš„è¯å¦‚æœéœ€è¦ä¿®æ”¹å‡½æ•°ï¼Œåªéœ€è¦åœ¨dllæ–‡ä»¶ä¿®æ”¹å³å¯ï¼Œç¨‹åºä¸ç”¨ç¼–è¯‘</p><h3 id="æ˜¾ç¤ºé“¾æ¥"><a href="#æ˜¾ç¤ºé“¾æ¥" class="headerlink" title="æ˜¾ç¤ºé“¾æ¥"></a>æ˜¾ç¤ºé“¾æ¥</h3><p>1ã€å®šä¹‰å‡½æ•°æŒ‡é’ˆ</p><p>typedef int (__stdcall *lpPlus)(int,int);</p><p>2ã€å£°æ˜å‡½æ•°æŒ‡é’ˆå˜é‡</p><p>lpPlus myPlus</p><p>3ã€åŠ¨æ€åŠ è½½dllåˆ°å†…å­˜ä¸­</p><p>HINSTANCE hModule=LoadLibrary(â€œDllDemo.dllâ€);</p><p>4ã€è·å–å‡½æ•°åœ°å€</p><p>myPlus=(lpPlus)GetProcAddress(hModule,â€_Plus@8â€);(__stdcallä¸ºäº†åŒºåˆ†ä¼šè‡ªåŠ¨åŠ ç¬¦å·)ï¼Œå¦‚æœå¯¼å…¥çš„æ—¶å€™æ²¡åŠ stdcallå°±ä¸éœ€è¦åŠ ç¬¦å·ï¼Œå³myPlus=(lpPlus)GetProcAddress(hModule,â€Plusâ€);</p><p>5ã€è°ƒç”¨å‡½æ•°</p><p>int a=myPlus(1,2);</p><h4 id="ç‰¹åˆ«è¯´æ˜"><a href="#ç‰¹åˆ«è¯´æ˜" class="headerlink" title="ç‰¹åˆ«è¯´æ˜"></a>ç‰¹åˆ«è¯´æ˜</h4><p>Handleæ˜¯ä»£è¡¨ç³»ç»Ÿå†…æ ¸çš„å¯¹è±¡ï¼Œå¦‚æ–‡ä»¶å¥æŸ„ã€çº¿ç¨‹å¥æŸ„ã€è¿›ç¨‹å¥æŸ„</p><p>HMODULEä»£è¡¨åº”ç”¨ç¨‹åºè½½å…¥çš„æ¨¡å—-åœ¨å†…å­˜ä¸­æ‹‰ä¼¸çš„èµ·å§‹ä½ç½®</p><p>HINSTANCEåœ¨win32æ˜¯å’Œå‰ä¸€ä¸ªä¸€æ ·çš„ win16é—ç•™</p><p>HWNDæ˜¯çª—å£å¥æŸ„</p><blockquote><p>ä¸Šé¢çš„éƒ½æ˜¯æ— ç¬¦å·æ•´æ•°ï¼Œå››ä¸ªå­—èŠ‚</p></blockquote><p>è¿™æ ·åšæ˜¯ä¸ºäº†æ–¹ä¾¿åŒºåˆ†ï¼Œæ“ä½œç³»ç»Ÿç»™çš„</p><h3 id="defæ–‡ä»¶å¯¼å‡º"><a href="#defæ–‡ä»¶å¯¼å‡º" class="headerlink" title="defæ–‡ä»¶å¯¼å‡º"></a>defæ–‡ä»¶å¯¼å‡º</h3><p>ä¸ºäº†éšè—å‡½æ•°çš„åå­—</p><p>å’Œå‰é¢çš„ç±»ä¼¼ï¼Œå…ˆåˆ›å»ºåŠ¨æ€é“¾æ¥åº“ï¼Œå¤´æ–‡ä»¶åªéœ€è¦å‡½æ•°å£°æ˜</p><p>åˆ›å»ºdefæ–‡ä»¶åï¼Œåœ¨defæ–‡ä»¶ä¸­å†™å…¥</p><blockquote><p>EXPORTS</p><p>(å‡½æ•°å)                ç¼–å·</p><p>Plus                    @12â€”â€”å¯¼å‡ºåºå·æ˜¯12</p><p>åœ¨ç¼–å·åé¢+NONAME å¯ä»¥éšè—å‡½æ•°å</p></blockquote><h2 id="dllå¯¼å‡ºå‡½æ•°çš„æ–¹å¼"><a href="#dllå¯¼å‡ºå‡½æ•°çš„æ–¹å¼" class="headerlink" title="dllå¯¼å‡ºå‡½æ•°çš„æ–¹å¼"></a>dllå¯¼å‡ºå‡½æ•°çš„æ–¹å¼</h2><p>externè¡¨ç¤ºæ˜¯ä¸ªå…¨å±€å‡½æ•°ï¼Œå¯ä»¥ä¾›å„ä¸ªå…¶ä»–çš„å‡½æ•°è°ƒç”¨</p><p>å£°æ˜å¯¼å‡ºï¼š_declspec(dllexport)</p><p>defæ–‡ä»¶å¯¼å‡º</p><p>dllå‡½æ•°è°ƒç”¨</p><p>éšå¼é“¾æ¥</p><p>åŒ…å«å¤´æ–‡ä»¶ï¼Œè½½å…¥libåº“</p><p>æ˜¾å¼é“¾æ¥</p><p>LoadLibaryï¼ŒGetProAddress</p><h1 id="å¯¼å‡ºè¡¨"><a href="#å¯¼å‡ºè¡¨" class="headerlink" title="å¯¼å‡ºè¡¨"></a>å¯¼å‡ºè¡¨</h1><p>ä½œç”¨ï¼šè®°è½½æˆ‘ä»¬å†™çš„dllæˆ–è€…exeå¯¼å‡ºçš„å‡½æ•°</p><h2 id="å¯¼å‡ºè¡¨é‡è¦æˆå‘˜"><a href="#å¯¼å‡ºè¡¨é‡è¦æˆå‘˜" class="headerlink" title="å¯¼å‡ºè¡¨é‡è¦æˆå‘˜"></a>å¯¼å‡ºè¡¨é‡è¦æˆå‘˜</h2><p>1ã€æŒ‡å‘å¯¼å‡ºè¡¨æ–‡ä»¶åçš„å­—ç¬¦ä¸²-DWORD Name</p><p>2ã€å¯¼å‡ºå‡½æ•°çš„èµ·å§‹åºå·-DWORD Base</p><p>3ã€å¯¼å‡ºå‡½æ•°åœ°å€è¡¨RVA-DWORD AddressOfFunctions</p><p>4ã€å‡½æ•°åç§°åœ°å€è¡¨RVA-DWORD AddressOfNames</p><p>5ã€å‡½æ•°åºå·åœ°å€è¡¨RVA-DWORD AddressOfNameOrdinals</p><h2 id="å®šä½å¯¼å‡ºè¡¨"><a href="#å®šä½å¯¼å‡ºè¡¨" class="headerlink" title="å®šä½å¯¼å‡ºè¡¨"></a>å®šä½å¯¼å‡ºè¡¨</h2><p>1ã€æ‰¾å‡ºå¯¼å‡ºè¡¨RVAçš„åç§»</p><p>é¦–å…ˆæˆ‘ä»¬è¦åœ¨æ•°æ®ç›®å½•çš„å¯¼å‡ºè¡¨ä¿¡æ¯çš„ç¬¬ä¸€é¡¹ï¼Œä¹Ÿå°±æ˜¯å¯¼å‡ºè¡¨åœ°å€çš„RVAåç§»æ˜¯å¤šå°‘</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646621065982.png"></p><p>å¯ä»¥çœ‹å‡ºc000hæ˜¯RVAåç§»ï¼Œå¤§å°æ˜¯164ä¸ªå­—èŠ‚</p><h3 id="åˆ¤æ–­å±äºå“ªä¸€ä¸ªèŠ‚"><a href="#åˆ¤æ–­å±äºå“ªä¸€ä¸ªèŠ‚" class="headerlink" title="åˆ¤æ–­å±äºå“ªä¸€ä¸ªèŠ‚"></a>åˆ¤æ–­å±äºå“ªä¸€ä¸ªèŠ‚</h3><p>æ ¹æ®èŠ‚åŒºçš„VIrtualAddressåˆ¤æ–­</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646621026524.png"></p><p>æ‰€ä»¥å¯ä»¥çŸ¥é“åœ¨.edataèŠ‚</p><h3 id="ç®—å‡ºFOAä½ç½®"><a href="#ç®—å‡ºFOAä½ç½®" class="headerlink" title="ç®—å‡ºFOAä½ç½®"></a>ç®—å‡ºFOAä½ç½®</h3><p>æˆ‘ä»¬çŸ¥é“æ˜¯åœ¨.rdataèŠ‚çš„ï¼Œå¯ä»¥ç®—å‡ºFOA</p><p>FOA=RVA-èŠ‚åŒºçš„VAï¼ˆVirtualAddressï¼‰+èŠ‚.PointerOfRawData</p><p>è®¡ç®—å‘ç°ä¸º8200h</p><h3 id="é€šè¿‡FOAæ‰¾åˆ°å¯¼å‡ºè¡¨ä½ç½®"><a href="#é€šè¿‡FOAæ‰¾åˆ°å¯¼å‡ºè¡¨ä½ç½®" class="headerlink" title="é€šè¿‡FOAæ‰¾åˆ°å¯¼å‡ºè¡¨ä½ç½®"></a>é€šè¿‡FOAæ‰¾åˆ°å¯¼å‡ºè¡¨ä½ç½®</h3><p>æ‰¾åˆ°åæ ¹æ®å‰é¢çš„å¯¼å‡ºè¡¨å¤§å°å¯ä»¥çŸ¥é“å¯¼å‡ºè¡¨çš„èŒƒå›´</p><p>è·³è½¬è¿‡å»å³å¯</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646621157564.png"></p><h2 id="å¯¼å‡ºè¡¨çš„å­˜å‚¨æ–¹å¼"><a href="#å¯¼å‡ºè¡¨çš„å­˜å‚¨æ–¹å¼" class="headerlink" title="å¯¼å‡ºè¡¨çš„å­˜å‚¨æ–¹å¼"></a>å¯¼å‡ºè¡¨çš„å­˜å‚¨æ–¹å¼</h2><p>ä¸€ä¸ªå¯¼å‡ºè¡¨å¤§å°ä¸º0x28ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯ä¸¤è¡ŒåŠ</p><p>åˆ†æ®µè®²è§£</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646621661598.png"></p><p>å‰é¢åäºŒä¸ªå­—èŠ‚æ²¡ç”¨ï¼Œå°±ä¸è®²äº†</p><h3 id="Dword-Name"><a href="#Dword-Name" class="headerlink" title="Dword Name"></a>Dword Name</h3><p>ç»¿æ¡†çš„4ä¸ªå­—èŠ‚å­˜å‚¨çš„æ˜¯dllåç§°çš„RVAï¼Œæƒ³æŸ¥çœ‹çš„è¯ï¼Œå¯ä»¥è®¡ç®—FOAï¼Œå’Œå‰é¢ä¸€æ ·çš„ï¼Œå¾—åˆ°8250åœ°å€å­˜å‚¨çš„æ˜¯æˆ‘ä»¬çš„dllåç§°ï¼Œä»¥00ç»“å°¾</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646621843130.png"></p><h3 id="Dword-Base"><a href="#Dword-Base" class="headerlink" title="Dword Base"></a>Dword Base</h3><p>å¯¼å‡ºå‡½æ•°çš„èµ·å§‹åºå·</p><p> DLLå¯¼å‡ºçš„å‡½æ•°å¦‚æœç»™åºå·äº†ï¼Œé‚£ä¹ˆå°±ä»è¿™ä¸ªåºå·å¼€å§‹</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646622459296.png"></p><h3 id="Dword-NumberOfFunctions-æ‰€æœ‰çš„å¯¼å‡ºå‡½æ•°çš„ä¸ªæ•°"><a href="#Dword-NumberOfFunctions-æ‰€æœ‰çš„å¯¼å‡ºå‡½æ•°çš„ä¸ªæ•°" class="headerlink" title="Dword NumberOfFunctions-æ‰€æœ‰çš„å¯¼å‡ºå‡½æ•°çš„ä¸ªæ•°"></a>Dword NumberOfFunctions-æ‰€æœ‰çš„å¯¼å‡ºå‡½æ•°çš„ä¸ªæ•°</h3><p>å‰å››ä¸ª</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646622410901.png"></p><h3 id="DWORD-NumberOfNames-ä»¥åå­—ï¼ˆæœ‰åå­—çš„ï¼‰å¯¼å‡ºçš„å‡½æ•°çš„ä¸ªæ•°"><a href="#DWORD-NumberOfNames-ä»¥åå­—ï¼ˆæœ‰åå­—çš„ï¼‰å¯¼å‡ºçš„å‡½æ•°çš„ä¸ªæ•°" class="headerlink" title="DWORD   NumberOfNames-ä»¥åå­—ï¼ˆæœ‰åå­—çš„ï¼‰å¯¼å‡ºçš„å‡½æ•°çš„ä¸ªæ•°"></a>DWORD   NumberOfNames-ä»¥åå­—ï¼ˆæœ‰åå­—çš„ï¼‰å¯¼å‡ºçš„å‡½æ•°çš„ä¸ªæ•°</h3><p>å¯ä»¥å°†ä¸¤ä¸ªä¸åŒçš„åå­—æŒ‡å‘ç›¸åŒçš„åœ°å€</p><p>æœ‰ä¸€äº›æ˜¯æ— åå‡½æ•°ä¸ä¼šåœ¨é‡Œé¢</p><p>åå››ä¸ª</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646622415877.png"></p><p>ä¸‹é¢å°±æ˜¯å­è¡¨äº†ï¼Œä¸‰ä¸ªå­è¡¨éƒ½æ˜¯RVAï¼Œè¦è½¬ä¸ºFOA</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646622483098.png"></p><p>åˆ†åˆ«æ˜¯å‡½æ•°åœ°å€è¡¨0x8228ï¼Œå‡½æ•°åç§°è¡¨0x8238ï¼Œå‡½æ•°åºå·è¡¨0x8248</p><blockquote><p>å…ˆå»æ‰¾å‡½æ•°åç§°è¡¨ï¼Œæ ¹æ®åç§°çš„ä¸‹æ ‡å†å»åºå·è¡¨æ‰¾å¯¹åº”ï¼Œç„¶åå†å»å‡½æ•°åœ°å€è¡¨æ‰¾</p></blockquote><h4 id="å‡½æ•°åœ°å€è¡¨-AddressOfFunctions"><a href="#å‡½æ•°åœ°å€è¡¨-AddressOfFunctions" class="headerlink" title="å‡½æ•°åœ°å€è¡¨-AddressOfFunctions"></a>å‡½æ•°åœ°å€è¡¨-AddressOfFunctions</h4><p>å‡½æ•°åœ°å€è¡¨æŒ‡å‘ä¸€ä¸ªåç§»ï¼Œè¿™ä¸ªåç§»å­˜æ”¾äº†æ‰€æœ‰å¯¼å‡ºå‡½æ•°çš„åœ°å€ï¼Œæ¯ä¸ªåœ°å€å å››ä¸ªå­—èŠ‚ï¼Œå­˜æ”¾çš„æ˜¯RVAåœ°å€</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646622927186.png"></p><p>ImageBase+å‡½æ•°åç§»å°±æ˜¯å‡½æ•°åœ¨å†…å­˜ä¸­çš„å®é™…åœ°å€</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646623978690.png"></p><p>å¯ä»¥çœ‹åˆ°è¿™å°±æ˜¯å‡½æ•°</p><p> è¿˜éœ€è¦æ³¨æ„çš„å°±æ˜¯ï¼Œå¦‚æœä½ æŒ‰ç…§åºå·å¯¼å‡º1 3 4 5è¿™4ä¸ªå‡½æ•°ï¼Œåœ¨å¯¼å…¥è¡¨ä¸­æˆ‘ä»¬çš„å‡½æ•°åœ°å€è¡¨ä¸­çš„åœ°å€ä¼šæœ‰5ä¸ªï¼ŒåŸå› å°±æ˜¯ï¼šä¸­æ–­çš„åºå·ä¼šç»™æˆ‘ä»¬ç”¨0å¡«å……ï¼Œï¼’è™½ç„¶æ²¡æœ‰ï¼Œä½†æ˜¯ä¹Ÿä¼šç»™æˆ‘ä»¬å¯¼å‡º. </p><h4 id="å‡½æ•°åç§°è¡¨-AddressOfNames"><a href="#å‡½æ•°åç§°è¡¨-AddressOfNames" class="headerlink" title="å‡½æ•°åç§°è¡¨-AddressOfNames"></a>å‡½æ•°åç§°è¡¨-AddressOfNames</h4><p>å‡½æ•°åç§°è¡¨ä¹Ÿæ˜¯å­˜å‚¨åç§°çš„RVAï¼Œå››ä¸ªå­—èŠ‚å­˜å‚¨ä¸€ä¸ªï¼ŒRVAçš„ä¸ªæ•°ç”±ä»¥å‡½æ•°åç§°å¯¼å‡ºå‡½æ•°ä¸ªæ•°æ¥å†³å®šï¼ˆDWORD  NumberOfNamesï¼‰</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646625166524.png"></p><p>è½¬ä¸ºFOAå°±æ˜¯0x805eï¼Œ0x8071,0x8082,0x8093</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646625255683.png"></p><p>æ’åºçš„æ—¶å€™æ˜¯æŒ‰ç…§å­—æ¯é¡ºåºæ’åˆ—çš„ï¼Œè€Œä¸æ˜¯æŒ‰ç…§å¯¼å‡ºæ—¶å‡½æ•°çš„é¡ºåºè¿›è¡Œæ’åºçš„</p><p>ä¾‹å¦‚:</p><p>ã€€ã€€EXPORT</p><p>ã€€ã€€ã€€ã€€SUB</p><p>ã€€ã€€ã€€ã€€ADD</p><p>ã€€ã€€ã€€ã€€MUL</p><p>å¯¼å‡ºä¸‰ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆç¬¬ä¸€é¡¹å°±ä¸º ADDï¼Œå› ä¸ºæŒ‰ç…§å­—æ¯æ’åºï¼ŒAåœ¨å‰è¾¹ï¼Œåé¢ä¾æ¬¡ç±»æ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„å‡½æ•°åç§° ACquireSRW è¿™ä¸ªå‡½æ•°åç§°ï¼Œå¹¶ä¸æ˜¯ç¬¬ä¸€ä¸ªå¯¼å‡ºçš„å‡½æ•°.</p><h4 id="å‡½æ•°åºå·è¡¨-AddressOfNumberOrdinalsï¼å­˜å‚¨çš„æ˜¯RVA"><a href="#å‡½æ•°åºå·è¡¨-AddressOfNumberOrdinalsï¼å­˜å‚¨çš„æ˜¯RVA" class="headerlink" title="å‡½æ•°åºå·è¡¨-AddressOfNumberOrdinalsï¼å­˜å‚¨çš„æ˜¯ï¼²ï¼¶ï¼¡"></a>å‡½æ•°åºå·è¡¨-AddressOfNumberOrdinalsï¼å­˜å‚¨çš„æ˜¯ï¼²ï¼¶ï¼¡</h4><p>ç»™åç§°ç”¨çš„ä¸­è½¬è¡¨</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646625803927.png"></p><p>å’Œå‡½æ•°åç§°è¡¨å¤§å°ç›¸åŒ</p><h4 id="æŒ‰åç§°å¯¼å‡º"><a href="#æŒ‰åç§°å¯¼å‡º" class="headerlink" title="æŒ‰åç§°å¯¼å‡º"></a>æŒ‰åç§°å¯¼å‡º</h4><p>å¾—åˆ°å‡½æ•°åç§°åå»AddressOfNamesä¸­çš„å‡½æ•°åç§°å¯¹æ¯”ï¼Œå¾—åˆ°ç´¢å¼•åæ ¹æ®ç´¢å¼•å–å‡ºAddressOfNameOrdinalså­˜å‚¨çš„å€¼ï¼Œä»¥æ­¤ä¸ºç´¢å¼•å»å‡½æ•°åœ°å€è¡¨æ‰¾åˆ°å‡½æ•°çš„åœ°å€</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1647329750554.png" alt="æŒ‰åç§°å¯¼å‡ºè¿‡ç¨‹"></p><p>å‡½æ•°æ•°é‡è®¡ç®—æ–¹å¼=æœ€å¤§åºå·-æœ€å°åºå·+1ï¼Œï¼ˆè¿ç»­çš„ç®—å¾—å‡†ï¼‰ä¸è¿ç»­çš„è¯åœ¨å‡½æ•°åœ°å€è¡¨ä¼šç•™æœ‰å¤šä½™çš„åœ°å€ï¼Œä½†æ˜¯å¤šä½™çš„åœ°å€æ²¡æœ‰è¢«ä½¿ç”¨</p><h4 id="æŒ‰åºå·å¯¼å‡º"><a href="#æŒ‰åºå·å¯¼å‡º" class="headerlink" title="æŒ‰åºå·å¯¼å‡º"></a>æŒ‰åºå·å¯¼å‡º</h4><blockquote><p>å½“ä½¿ç”¨åºå·å¯¼å‡ºçš„æ—¶å€™ä¸éœ€è¦ä½¿ç”¨åºå·è¡¨ï¼Œç›´æ¥å°†åºå·-Baseä½œä¸ºç´¢å¼•å»å‡½æ•°åœ°å€è¡¨æ‰¾å³å¯</p></blockquote><h4 id="å¯¼å‡ºçš„è¿‡ç¨‹"><a href="#å¯¼å‡ºçš„è¿‡ç¨‹" class="headerlink" title="å¯¼å‡ºçš„è¿‡ç¨‹"></a>å¯¼å‡ºçš„è¿‡ç¨‹</h4><p>ç³»ç»Ÿå’Œæˆ‘ä»¬å‰é¢è¯´çš„ä¸ä¸€æ ·</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646724098510.png" alt="1"></p><p>æ ¹æ®å‡½æ•°åœ°å€è¡¨æ‰¾ï¼Œå¦‚æœç´¢å¼•åœ¨åºå·è¡¨ä¸­ï¼Œè¯´æ˜æ˜¯æŒ‰åå­—å¯¼å‡ºçš„ï¼Œå†å»åç§°è¡¨æ‰¾å¯¹åº”ï¼Œç´¢å¼•å’Œåºå·è¡¨ä¸­çš„ç›¸åŒ</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646724264502.png"></p><p>è¿™é‡Œçš„100aç´¢å¼•æ˜¯3ï¼Œåœ¨åºå·è¡¨ä¸­æ²¡æœ‰ï¼Œæ‰€ä»¥ä¸æ˜¯æŒ‰ç…§åºå·å¯¼å‡ºçš„ï¼Œåºå·å¯ç®—ï¼Œä¸ºç´¢å¼•+Base=005</p><h1 id="é‡å®šä½è¡¨-struct-IMAGE-DATA-DIRECTORY-BaseRelocationTable"><a href="#é‡å®šä½è¡¨-struct-IMAGE-DATA-DIRECTORY-BaseRelocationTable" class="headerlink" title="é‡å®šä½è¡¨-struct IMAGE_DATA_DIRECTORY BaseRelocationTable"></a>é‡å®šä½è¡¨-struct IMAGE_DATA_DIRECTORY BaseRelocationTable</h1><h2 id="ç¨‹åºçš„åŠ è½½è¿‡ç¨‹"><a href="#ç¨‹åºçš„åŠ è½½è¿‡ç¨‹" class="headerlink" title="ç¨‹åºçš„åŠ è½½è¿‡ç¨‹"></a>ç¨‹åºçš„åŠ è½½è¿‡ç¨‹</h2><p>ç³»ç»ŸåŠ è½½çš„dllä¸€èˆ¬åœ¨é«˜ç©ºé—´è¿è¡Œï¼Œä¸€èˆ¬æ˜¯71**************</p><p>å…ˆåƒè´´å›¾ä¸€æ ·æŠŠdllè´´åœ¨å†…å­˜ä¸­ï¼Œæœ€åæŒ‡å‘exeæ–‡ä»¶çš„å…¥å£ç‚¹ï¼Œexeå¼€å§‹è¿è¡Œ</p><p>æˆ‘ä»¬è‡ªå·±å†™çš„dllçš„imageBaseéƒ½æ˜¯1000000ï¼Œæ‰€ä»¥å½“å¤šä¸ªdllåŒæ—¶ä½¿ç”¨ï¼Œä¼šå­˜åœ¨åœ°å€å·²ç»è¢«å ç”¨çš„é—®é¢˜ï¼Œæ‰€ä»¥dlåªèƒ½å¾€åæ”¾ï¼Œä½†æ˜¯ï¼š</p><p>ç¼–è¯‘å™¨ç”Ÿæˆçš„åœ°å€=ImageBase+RVAï¼Œè¿™ä¸ªåœ°å€åœ¨ç¨‹åºç¼–è¯‘å®Œæˆåï¼Œå·²ç»å†™å…¥æ–‡ä»¶äº†ã€‚ä½†æ˜¯å¦‚æœå½“ç¨‹åºåŠ è½½æ—¶æ²¡æœ‰æŒ‰ç…§åŸæ¥çš„ImageBaseè½½å…¥ï¼Œä½†æ˜¯æ­¤æ—¶ç¨‹åºè¿˜æ˜¯ä¼šæŒ‰ç…§å‰é¢ç”Ÿæˆçš„åœ°å€è¿›è¡Œä½¿ç”¨</p><p>æ‰€ä»¥ä¸€èˆ¬exeä¸å­˜åœ¨é‡å®šä½è¡¨ï¼Œè€Œdllä¸€èˆ¬éƒ½æœ‰ï¼Œç”¨äºè®°å½•éœ€è¦ä¿®æ”¹çš„åœ°æ–¹</p><h2 id="é‡å®šä½è¡¨è§£æ"><a href="#é‡å®šä½è¡¨è§£æ" class="headerlink" title="é‡å®šä½è¡¨è§£æ"></a>é‡å®šä½è¡¨è§£æ</h2><p>é‡å®šä½è¡¨æ˜¯åˆ†å—ï¼Œæ ¹æ®RVAè®¡ç®—å¾—åˆ°FOAï¼Œè·³è½¬è¿‡å»å‘ç°æœ‰å‡ ä¸ªé‡å®šä½è¡¨</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646727831045.png"></p><p>è¿™ä¸¤ä¸ªæ•°æ®åˆ†åˆ«å­˜å‚¨RVAå’Œå¤§å°</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646727910599.png"></p><p>ä¸‹é¢çš„æ•°æ®ä¸­ï¼Œæ¯ä¸¤ä¸ªå­—èŠ‚ä»£è¡¨è¿™ä¸€æ®µæœ‰å¤šå°‘ä¸ªæ•°æ®éœ€è¦ä¿®å¤ï¼Œä¸€èˆ¬æ˜¯ç»å¯¹åœ°å€éœ€è¦ä¿®æ”¹</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646728080337.png"></p><p>åªéœ€è¦åŸºç¡€åœ°å€åŠ ä¸Šå°è¡¨çš„å€¼å°±å¯ä»¥å®šä½åˆ°éœ€è¦ä¿®æ”¹çš„åœ°æ–¹ï¼Œè€Œä¸ç”¨å››ä¸ªå­—èŠ‚æ¥å­˜å‚¨åœ°å€ï¼ŒèŠ‚çœäº†ç©ºé—´ï¼Œè€Œè¿™ä¸ªåŸºç¡€åœ°å€å°±æ˜¯å‰é¢è®°å½•çš„RVA</p><p>è€ŒåŸºç¡€åœ°å€å¯ä»¥ä¸åŒï¼Œæ‰€ä»¥æ‰éœ€è¦åˆ†å—æ“ä½œ</p><p>å¯ä»¥å‘ç°æ¯ä¸€å—çš„é—´éš”æ˜¯1000hï¼Œä¹Ÿå°±æ˜¯å†…å­˜å¯¹é½çš„å¤§å°</p><p>ä¸€ä¸ªé¡µæ˜¯1000hï¼Œæ‰€ä»¥åªéœ€è¦1000ä¸ªåå…­è¿›åˆ¶çš„åœ°å€å°±å¯ä»¥è®°å½•å®Œä¸€é¡µçš„æ¯ä¸ªä½ç½®ï¼Œå¯¹åº”åè¿›åˆ¶çš„4096ä¸ª</p><p>2^12=4096ï¼Œæ‰€ä»¥åªéœ€è¦åäºŒä¸ªäºŒè¿›åˆ¶ä½å°±å¯ä»¥è¡¨ç¤ºå®Œæ‰€æœ‰å¯èƒ½ï¼Œä¸¤ä¸ªå­—èŠ‚æœ‰åå…­ä½ï¼Œæ‰€ä»¥æœ€åæ‰¾åœ°å€çš„æ—¶å€™ï¼Œåªç”¨å–ä½åäºŒä½ï¼Œé«˜å››ä½æœ‰åˆ«çš„ç”¨å¤„-å¦‚æœé«˜å››ä½çš„å€¼æ˜¯3å°±è¯´æ˜è¿™ä¸ªåœ°æ–¹éœ€è¦ä¿®æ”¹</p><h3 id="åˆ¤æ–­å—æ•°"><a href="#åˆ¤æ–­å—æ•°" class="headerlink" title="åˆ¤æ–­å—æ•°"></a>åˆ¤æ–­å—æ•°</h3><p>ä¸‹ä¸€å—çš„å¼€å§‹åœ°å€éƒ½å¯ä»¥é€šè¿‡RVA+SizeOfBlockæ¥å¾—åˆ°</p><p>ç›´åˆ°é‡åˆ°å…¨ä¸ºé›¶çš„å—</p><p>è®¡ç®—éœ€è¦ä¿®æ”¹çš„æ•°æ®ä¸ªæ•°ï¼š(SizeOfBlock-8)/2ï¼Œå› ä¸ºå‰é¢ä¸¤ä¸ªæ•°æ®æ˜¯8ä¸ªå­—èŠ‚ï¼Œå‰©ä¸‹çš„ä¸¤ä¸ªå­—èŠ‚ä¸º1ç»„</p><h1 id="ç§»åŠ¨å¯¼å‡ºè¡¨-é‡å®šä½è¡¨"><a href="#ç§»åŠ¨å¯¼å‡ºè¡¨-é‡å®šä½è¡¨" class="headerlink" title="ç§»åŠ¨å¯¼å‡ºè¡¨-é‡å®šä½è¡¨"></a>ç§»åŠ¨å¯¼å‡ºè¡¨-é‡å®šä½è¡¨</h1><p>è¡¨çš„æ•°æ®ä¹Ÿåœ¨èŠ‚åŒºä¸­ï¼ŒåŠ å¯†ä»£ç æ—¶ï¼Œè¡¨çš„ä¿¡æ¯ä¹Ÿä¼šè¢«åŠ å¯†ï¼Œè¿™æ ·ç¨‹åºæ— æ³•åˆå§‹åŒ–ï¼Œæ‰€ä»¥è¦å…ˆå¢èŠ‚ï¼Œå†ç§»åŠ¨è¡¨ï¼Œå­¦ä¼šç§»åŠ¨å„ç§è¡¨æ˜¯å¯¹ç¨‹åºåŠ å¯†å’Œç ´è§£çš„åŸºç¡€</p><h2 id="ç§»åŠ¨å¯¼å‡ºè¡¨"><a href="#ç§»åŠ¨å¯¼å‡ºè¡¨" class="headerlink" title="ç§»åŠ¨å¯¼å‡ºè¡¨"></a>ç§»åŠ¨å¯¼å‡ºè¡¨</h2><p>æ¯”è¾ƒç¹çï¼Œå› ä¸ºè¦ç§»åŠ¨å¤šå¼ è¡¨</p><h3 id="åœ¨DLLæ–‡ä»¶ä¸­æ–°å¢èŠ‚"><a href="#åœ¨DLLæ–‡ä»¶ä¸­æ–°å¢èŠ‚" class="headerlink" title="åœ¨DLLæ–‡ä»¶ä¸­æ–°å¢èŠ‚"></a>åœ¨DLLæ–‡ä»¶ä¸­æ–°å¢èŠ‚</h3><p>å…ˆè®¡ç®—å¤§å°</p><p>å¹¶ä¸”è¿”å›æ–°å¢èŠ‚çš„FOAï¼Œå› ä¸ºåé¢çš„æ•°æ®è¿˜è¦ä»æ–°å¢èŠ‚çš„å¼€å¤´å¼€å§‹</p><h3 id="å¤åˆ¶æ•°æ®"><a href="#å¤åˆ¶æ•°æ®" class="headerlink" title="å¤åˆ¶æ•°æ®"></a>å¤åˆ¶æ•°æ®</h3><p>éœ€è¦å¤åˆ¶çš„æ•°æ®ç±»å‹å’Œé•¿åº¦</p><h4 id="å¤åˆ¶AddressOfFunctions"><a href="#å¤åˆ¶AddressOfFunctions" class="headerlink" title="å¤åˆ¶AddressOfFunctions"></a>å¤åˆ¶AddressOfFunctions</h4><p>é•¿åº¦ï¼š4Ã—NumberOfFunctions</p><h4 id="å¤åˆ¶AddressOfNameOrdinals"><a href="#å¤åˆ¶AddressOfNameOrdinals" class="headerlink" title="å¤åˆ¶AddressOfNameOrdinals"></a>å¤åˆ¶AddressOfNameOrdinals</h4><p>é•¿åº¦ï¼š2Ã—NumberOfNames</p><h4 id="å¤åˆ¶AddressOfNames"><a href="#å¤åˆ¶AddressOfNames" class="headerlink" title="å¤åˆ¶AddressOfNames"></a>å¤åˆ¶AddressOfNames</h4><p>é•¿åº¦ï¼š4Ã—NumberOfNames</p><h4 id="å¤åˆ¶æ‰€æœ‰å‡½æ•°å"><a href="#å¤åˆ¶æ‰€æœ‰å‡½æ•°å" class="headerlink" title="å¤åˆ¶æ‰€æœ‰å‡½æ•°å"></a>å¤åˆ¶æ‰€æœ‰å‡½æ•°å</h4><p>é•¿åº¦ä¸ç¡®å®šï¼Œå¤åˆ¶æ—¶ç›´æ¥ä¿®å¤AddressOfNameï¼ˆå› ä¸ºåå­—çš„åœ°å€ä¹Ÿæ”¹å˜äº†ï¼‰ï¼Œæ¯å¤åˆ¶å®Œä¸€ä¸ªåå­—ï¼Œéƒ½éœ€è¦è®¡ç®—ä¸‹ä¸€ä¸ªå¤åˆ¶çš„åœ°æ–¹</p><h4 id="å¤åˆ¶å¯¼å‡ºè¡¨çš„æ•´ä½“ç»“æ„"><a href="#å¤åˆ¶å¯¼å‡ºè¡¨çš„æ•´ä½“ç»“æ„" class="headerlink" title="å¤åˆ¶å¯¼å‡ºè¡¨çš„æ•´ä½“ç»“æ„"></a>å¤åˆ¶å¯¼å‡ºè¡¨çš„æ•´ä½“ç»“æ„</h4><h3 id="ä¿®å¤åœ°å€"><a href="#ä¿®å¤åœ°å€" class="headerlink" title="ä¿®å¤åœ°å€"></a>ä¿®å¤åœ°å€</h3><p>AddressOfName</p><p>ç›®å½•é¡¹æŒ‡å‘æ–°çš„å¯¼å‡ºè¡¨çš„ä½ç½®</p><p>å‡½æ•°åœ°å€è¡¨ã€åºå·è¡¨ã€åç§°è¡¨éƒ½éœ€è¦ä¿®å¤</p><h3 id="å°†ç›®å½•é¡¹ä¸­çš„RVAä¿®æ­£"><a href="#å°†ç›®å½•é¡¹ä¸­çš„RVAä¿®æ­£" class="headerlink" title="å°†ç›®å½•é¡¹ä¸­çš„RVAä¿®æ­£"></a>å°†ç›®å½•é¡¹ä¸­çš„RVAä¿®æ­£</h3><p>æŒ‡å‘æˆ‘ä»¬æ–°çš„å¯¼å‡ºè¡¨çš„ä½ç½®</p><h2 id="ç§»åŠ¨é‡å®šä½è¡¨"><a href="#ç§»åŠ¨é‡å®šä½è¡¨" class="headerlink" title="ç§»åŠ¨é‡å®šä½è¡¨"></a>ç§»åŠ¨é‡å®šä½è¡¨</h2><p>ç›´æ¥å¤åˆ¶è¿‡å»ï¼Œä¿®æ”¹RVAå³å¯</p><p>åŠ è½½ç¨‹åºï¼šï¼ˆå½“å‰é¢å·²ç»æœ‰DLLè¢«åŠ è½½ï¼‰</p><p>1ã€å°†æ–°çš„DLLå¤åˆ¶åˆ°æ–°çš„ä½ç½®</p><p>2ã€ä¿®å¤é‡å®šä½è¡¨ï¼Œä¿®æ”¹æ¯ä¸€ä¸ªé‡å®šä½è¡¨çš„åç§»</p><h1 id="å¯¼å…¥è¡¨"><a href="#å¯¼å…¥è¡¨" class="headerlink" title="å¯¼å…¥è¡¨"></a>å¯¼å…¥è¡¨</h1><p>ä½œç”¨ï¼šä»å…¶ä»–ç¬¬ä¸‰æ–¹ç¨‹åºå¯¼å…¥APIï¼Œä»¥ä¾›æœ¬ç¨‹åºè°ƒç”¨</p><p>åœ¨exeè¿è¡Œçš„æ—¶å€™åŠ è½½å™¨ä¼šéå†å¯¼å…¥è¡¨ï¼Œå°†å¯¼å…¥è¡¨ä¸­æ‰€æœ‰dllåŠ è½½åˆ°è¿›ç¨‹ä¸­ï¼Œè¢«åŠ è½½çš„DLLçš„DLLMainå°±ä¼šè¢«è°ƒç”¨</p><p>é€šè¿‡å¯¼å…¥è¡¨å¯ä»¥çŸ¥é“ç¨‹åºä½¿ç”¨äº†å“ªäº›å‡½æ•°</p><p> å¯¼å…¥è¡¨ï¼Œæ˜¯ä¸ºäº†æä¾›çš„è¦å¯¼å…¥çš„dllçš„å‡½æ•°çš„åœ°å€ï¼Œåªä¸è¿‡ç”±äºdllåœ°å€ä¸å›ºå®šï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½ä¼šé‡æ–°ä¿®æ­£ </p><h2 id="å¯¼å…¥è¡¨è§£æ"><a href="#å¯¼å…¥è¡¨è§£æ" class="headerlink" title="å¯¼å…¥è¡¨è§£æ"></a>å¯¼å…¥è¡¨è§£æ</h2><h3 id="é‡è¦å­—æ®µ"><a href="#é‡è¦å­—æ®µ" class="headerlink" title="é‡è¦å­—æ®µ"></a>é‡è¦å­—æ®µ</h3><pre class="language-c" data-language="c"><code class="language-c">DWORD OriginalFirstThunk;</code></pre><p>æŒ‡å‘å¯¼å…¥åç§°è¡¨ï¼ˆINTï¼‰çš„RVA</p><pre class="language-c" data-language="c"><code class="language-c">DWORD   FirstThunk;</code></pre><p>æŒ‡å‘å¯¼å…¥åœ°å€è¡¨ï¼ˆIATï¼‰çš„RVA</p><pre class="language-c" data-language="c"><code class="language-c">DWORD   Name;</code></pre><p>æŒ‡å‘å¯¼å…¥æ˜ åƒæ–‡ä»¶çš„åå­—</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646788456499.png"></p><p>è®¡ç®—åè·³è½¬è¿‡å»ï¼Œæ³¨æ„è¦ç®—çš„æ˜¯FOAï¼Œä½†æ˜¯è¿™é‡ŒRVAå’ŒFOAä¸€æ · </p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646788490238.png"></p><p>å…¶ä¸­IATä¸INTéƒ½æŒ‡å‘ IMAGE_THUNK_DATA32ï¼ˆè™½ç„¶äºŒè€…çš„åœ°å€ä¸åŒï¼‰</p><p>INT-ä»¥å…¨0ç»“å°¾</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646788999608.png">          å‡½æ•°åæ•°ç»„(å¯¹åº”IMAGE_THUNK_DATA32ç»“æ„ä½“æ•°ç»„,æ¯ä¸€ä¸ªç»“æ„ä½“å°±æ˜¯ä¸€ä¸ªè”åˆä½“-4å­—èŠ‚) </p><pre class="language-c" data-language="c"><code class="language-c">typedef struct  _IMAGE_THUNK_DATA32{union{//è”åˆä½“ï¼Œå®é™…æ˜¯4å­—èŠ‚DWORD ForwarderString;DWORD Function;//å¯¼å…¥å‡½æ•°çš„åœ°å€,åœ¨åŠ è½½åˆ°å†…å­˜ä¹‹å,è¿™é‡Œæ‰èµ·ä½œç”¨DWORD Ordinal;//å‡å¦‚æ˜¯åºå·å¯¼å…¥çš„,ä¼šç”¨åˆ°è¿™é‡ŒDWORD AddressOfData;//å‡å¦‚æ˜¯å‡½æ•°åå¯¼å…¥,ä¼šç”¨åˆ°è¿™é‡Œ,å®ƒæŒ‡å‘å¦å¤–ä¸€ä¸ªç»“æ„ä½“PIMAGE_IMPORT_BY_NAME}u1;}IMAGE_THUNK_DATA32;//å¦‚æœæ˜¯å‡½æ•°åå¯¼å…¥çš„,AddressOfDataä¼šæŒ‡å‘ä¸‹é¢è¿™ä¸ªç»“æ„ä½“typedef struct _IMAGE_IMPORT_BY_NAME{WORD  Hint;//åºå·CHAR Name[1];//ä¸å®šé•¿,å­—ç¬¦ä¸²}</code></pre><h2 id="å¯¼å…¥è¡¨ç»“æ„"><a href="#å¯¼å…¥è¡¨ç»“æ„" class="headerlink" title="å¯¼å…¥è¡¨ç»“æ„"></a>å¯¼å…¥è¡¨ç»“æ„</h2><p>åœ¨å¯é€‰PEå¤´æœ€åçš„åå…­ä¸ªæ•°ç»„çš„å¯¼å…¥è¡¨ç»“æ„ï¼Œè¿™é‡Œå­˜æ”¾çš„æ˜¯RVA</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646998855451.png"></p><p>è·³è½¬è¿‡å»å‘ç°å­˜å‚¨çš„æ˜¯struct IMAGE_IMPORT_DESCRIPTOR ImportDescriptor[0]ï¼Œè¿™é‡Œå­˜æ”¾çš„æ˜¯çœŸæ­£çš„å¯¼å…¥è¡¨ç»“æ„</p><p>æœ‰å¤šå°‘ä¸ªDLLï¼Œå¯¹åº”çš„ç»“æ„ä½“æ•°ç»„å°±æœ‰å‡ ä¸ª</p><p>å…³é”®çš„æ•°æ®æœ‰ä¸‹é¢ä¸‰ä¸ªï¼Œä¹Ÿè¦æ³¨æ„è¿™é‡Œçš„TimeDateStamp-æ—¶é—´æˆ³</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646999149540.png"></p><h3 id="INTè¡¨"><a href="#INTè¡¨" class="headerlink" title="INTè¡¨"></a>INTè¡¨</h3><p><em><strong>ULONG OriginalFirstThunk-RVA</strong></em>ï¼Œå­˜æ”¾çš„æ˜¯IMAGE_THUNK_DATAè¿™ä¸ªç»“æ„ä½“æ•°ç»„ï¼Œå››å­—èŠ‚æ•°ï¼Œä»¥0ç»“å°¾</p><p>è·³è½¬è¿‡å»</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646999423139.png"></p><p> ä½†æ˜¯ä¹‹å‰å­¦å¯¼å‡ºè¡¨æœ‰äº†è§£åˆ°ï¼Œå¯¼å‡ºå‡½æ•°å¯ä»¥ä»¥åå­—å¯¼å‡ºï¼Œäº¦å¯ä»¥åºå·å¯¼å‡ºã€‚æ‰€ä»¥ä¸ºäº†æ–¹ä¾¿åŒºåˆ†ï¼Œå°±å°†è¿™INTè¡¨çš„æ¯ä¸ªå€¼åšäº†ç»†å¾®è°ƒæ•´ã€‚</p><blockquote><p> å¦‚æœè¿™ä¸ª4å­—èŠ‚æ•°çš„æœ€é«˜ä½ï¼ˆäºŒè¿›åˆ¶ï¼‰ä¸º1ï¼Œé‚£ä¹ˆæŠ¹å»è¿™ä¸ªæœ€é«˜ä½ä¹‹åï¼Œæ‰€è¡¨ç¤ºçš„æ•°å°±æ˜¯è¦å¯¼å…¥çš„å‡½æ•°çš„åºå·ï¼›å¦‚æœæœ€é«˜ä½æ˜¯0ï¼Œé‚£è¿™ä¸ªæ•°å°±ä¹Ÿæ˜¯ä¸€ä¸ªRVAï¼ŒæŒ‡å‘IMAGE_IMPORT_BY_NAMEç»“æ„ä½“ï¼ˆåŒ…å«çœŸæ­£çš„å¯¼å…¥å‡½æ•°çš„åå­—å­—ç¬¦ä¸²ï¼Œä»¥0ç»“å°¾ï¼‰ã€‚INTè¡¨ä»¥4å­—èŠ‚0ç»“å°¾ã€‚ </p></blockquote><p>æ ¹æ®INTå­˜å‚¨çš„RVAè¿›è¡Œè·³è½¬</p><h4 id="struct-IMAGE-IMPORT-BY-NAME"><a href="#struct-IMAGE-IMPORT-BY-NAME" class="headerlink" title="struct _IMAGE_IMPORT_BY_NAME"></a>struct _IMAGE_IMPORT_BY_NAME</h4><p>1ã€WORD Hintï¼Œå¯èƒ½ä¸º0ï¼Œç¼–è¯‘å™¨å†³å®šï¼Œå¦‚æœä¸ä¸º0ï¼Œåˆ™æ˜¯å‡½æ•°åœ¨å¯¼å‡ºè¡¨ä¸­çš„ç´¢å¼•</p><p>2ã€BYTE Name[1]ï¼Œå‡½æ•°åç§°ï¼Œä»¥0ç»“å°¾</p><h3 id="NAME"><a href="#NAME" class="headerlink" title="NAME"></a>NAME</h3><p>DLLçš„åå­—ï¼Œä»¥0ç»“å°¾</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1646999638790.png"></p><h3 id="ULONG-FirstThunk"><a href="#ULONG-FirstThunk" class="headerlink" title="ULONG FirstThunk"></a>ULONG FirstThunk</h3><p>æ ¹æ®RVAè·³è½¬ï¼Œå‘ç°å­˜å‚¨çš„å€¼å’ŒINTçš„ä¸€æ ·ï¼Œè¿™ä¸ªå­˜å‚¨çš„æ˜¯IATï¼Œå½“æ–‡ä»¶åŠ è½½åï¼Œä¼šå‘ç°IATä¼šæ”¹å˜</p><h4 id="IATè¡¨-å¯¼å…¥åœ°å€è¡¨"><a href="#IATè¡¨-å¯¼å…¥åœ°å€è¡¨" class="headerlink" title="IATè¡¨-å¯¼å…¥åœ°å€è¡¨"></a>IATè¡¨-å¯¼å…¥åœ°å€è¡¨</h4><p> è®°å½•ç¨‹åºæ­£åœ¨ä½¿ç”¨å“ªäº›åº“ä¸­çš„å“ªäº›å‡½æ•° </p><p>åˆ†ä¸ºä¸¤ä¸ªè¿‡ç¨‹ï¼Œåœ¨æ–‡ä»¶ä¸­å­˜å‚¨çš„æ˜¯å­˜æ”¾å‡½æ•°çš„åœ°å€ï¼Œåœ¨å†…å­˜ä¸­å­˜æ”¾å‡½æ•°</p><p>åœ¨æ–‡ä»¶è¿è¡Œå‰ç±»ä¼¼äºcall [åœ°å€]</p><p>åœ¨æ–‡ä»¶è¿è¡Œæ—¶ç±»ä¼¼äºcall [ä¸Šé¢åœ°å€å­˜æ”¾çš„å€¼]</p><h4 id="IATè¡¨å­˜åœ¨çš„åŸå› "><a href="#IATè¡¨å­˜åœ¨çš„åŸå› " class="headerlink" title="IATè¡¨å­˜åœ¨çš„åŸå› "></a>IATè¡¨å­˜åœ¨çš„åŸå› </h4><p> ä¸€èˆ¬ç¨‹åºåœ¨è°ƒç”¨è‡ªèº«å‡½æ•°çš„æ—¶å€™ï¼Œè‡ªèº«å‡½æ•°åœ°å€RAVæ˜¯å›ºå®šçš„ï¼›ä½†æ˜¯å½“ç¨‹åºåœ¨è°ƒç”¨dllé‡Œçš„å‡½æ•°çš„æ—¶å€™ï¼Œç”±äºdllçš„åœ°å€ä¼šå‘ç”Ÿé‡å®šä½ï¼Œå¯¼è‡´dllé‡Œçš„å‡½æ•°åœ°å€æ¯æ¬¡éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚ </p><p>ä¸ºäº†å‡†ç¡®è°ƒç”¨dllå‡½æ•°çš„åœ°å€ï¼Œæ„é€ äº†IATè¡¨æ¥å­˜å‚¨ç¨‹åºè¿è¡Œæ—¶ï¼Œå³DLLæ–‡ä»¶é‡å®šä½ä¹‹åçš„dllå‡½æ•°çš„ä½ç½®</p><h2 id="å¯¼å…¥è¡¨åŠ è½½è¿‡ç¨‹"><a href="#å¯¼å…¥è¡¨åŠ è½½è¿‡ç¨‹" class="headerlink" title="å¯¼å…¥è¡¨åŠ è½½è¿‡ç¨‹"></a>å¯¼å…¥è¡¨åŠ è½½è¿‡ç¨‹</h2><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/aHR0cHM6Ly9naXRlZS5jb20vY2h0MS9JbWFnZS9yYXcvbWFzdGVyL2ltZy8yMDIwMDcxNDAzMjg0Ni5wbmc-1647000237348.png" alt="PEæ–‡ä»¶åŠ è½½å‰"></p><p>åŠ è½½è¿‡ç¨‹</p><p>å…ˆæ‰¾ï¼¤ï¼¬ï¼¬ï¼Œå†ç¡®å®šä½¿ç”¨çš„å‡½æ•°</p><h3 id="å¯»æ‰¾DLL"><a href="#å¯»æ‰¾DLL" class="headerlink" title="å¯»æ‰¾DLL"></a>å¯»æ‰¾DLL</h3><p>å…ˆæ ¹æ®å¯¼å…¥è¡¨çš„NAMEæ‰¾åˆ°DLLåç§°å’ŒDLLçš„INTå’ŒIATè¡¨ï¼Œå¼€å§‹çš„æ—¶å€™INTå’ŒIATæ•°æ®ç›¸åŒï¼Œä½†æ˜¯å­˜å‚¨ä½ç½®ä¸åŒ</p><h3 id="æŸ¥INTè¡¨"><a href="#æŸ¥INTè¡¨" class="headerlink" title="æŸ¥ï¼©ï¼®ï¼´è¡¨"></a>æŸ¥ï¼©ï¼®ï¼´è¡¨</h3><p>å› ä¸ºå¯¼å‡ºçš„æ—¶å€™å¯ä»¥æŒ‰åºå·å¯¼å‡ºä¹Ÿå¯ä»¥æŒ‰å‡½æ•°åç§°å¯¼å‡ºï¼Œæ‰€ä»¥ä¸ºäº†åŒºåˆ†ï¼Œï½‰ï½ï½ï½‡ï½…ï¼¿ï½”ï½ˆï½•ï½ï½‹ï¼¿ï½„ï½ï½”ï½æœ€é«˜ä½ä¸ºï¼‘æ—¶ï¼Œè¡¨ç¤ºå…¶å­˜å‚¨çš„æ˜¯åºå·ï¼Œè€Œå‰©ä¸‹çš„ï¼“ï¼‘ä½è¡¨ç¤ºåºå·ï¼Œå¦åˆ™ï½‰ï½ï½ï½‡ï½…ï¼¿ï½”ï½ˆï½•ï½ï½‹ï¼¿ï½„ï½ï½”ï½å­˜å‚¨çš„æ˜¯å‡½æ•°åç§°çš„ï¼²ï¼¶ï¼¡</p><h3 id="ä¿®æ”¹IAT"><a href="#ä¿®æ”¹IAT" class="headerlink" title="ä¿®æ”¹ï¼©ï¼¡ï¼´"></a>ä¿®æ”¹ï¼©ï¼¡ï¼´</h3><p>ä½¿ç”¨ï¼§ï¼¥ï¼´ï¼°ï½’ï½ï¼¡ï½„ï½„ï½’ï¼ˆï½ï½ï½„ï½•ï½Œï½…ï¼Œï¼‰</p><p>å°†å‰é¢æŸ¥æ‰¾åˆ°çš„å‡½æ•°åœ°å€å¡«å……è¿›ï¼©ï¼¡ï¼´è¡¨ä¸­</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/aHR0cHM6Ly9naXRlZS5jb20vY2h0MS9JbWFnZS9yYXcvbWFzdGVyL2ltZy8yMDIwMDcxNDAyNTEwMy5wbmc.png" alt="PEæ–‡ä»¶åŠ è½½å"> </p><p>å¯ä»¥çœ‹åˆ°IATè¡¨å˜æˆäº†å‡½æ•°çš„åœ°å€</p><p> IATè¡¨ä¼šå­˜å‚¨dllçš„å‡½æ•°çš„åœ°å€ï¼Œæ–¹ä¾¿è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œç›´æ¥å–IATè¡¨è¿™ä¸ªåœ°å€å†…çš„å€¼ï¼Œä½œä¸ºå‡½æ•°åœ°å€ï¼Œå»CALLã€‚</p><h1 id="ç»‘å®šå¯¼å…¥è¡¨-struct-IMAGE-BOUND-IMPORT-DESCRIPTOR"><a href="#ç»‘å®šå¯¼å…¥è¡¨-struct-IMAGE-BOUND-IMPORT-DESCRIPTOR" class="headerlink" title="ç»‘å®šå¯¼å…¥è¡¨- struct _IMAGE_BOUND_IMPORT_DESCRIPTOR"></a>ç»‘å®šå¯¼å…¥è¡¨- struct _IMAGE_BOUND_IMPORT_DESCRIPTOR</h1><p>å¯é€‰NTå¤´é‡Œçš„ç»“æ„</p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1647001593786.png"></p><h2 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h2><p> æœ‰äº›windowsç¨‹åºï¼Œå¦‚notepadï¼Œä¸ºäº†æé«˜åŠ è½½é€Ÿåº¦ï¼Œä¼šç›´æ¥æŠŠDLLä¸­çš„å‡½æ•°åœ°å€å†™å…¥åˆ°IATè¡¨ï¼Œçœå»äº†åŠ è½½æ—¶çš„è®¡ç®—ã€‚ </p><h2 id="å¯èƒ½å­˜åœ¨çš„é—®é¢˜"><a href="#å¯èƒ½å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="å¯èƒ½å­˜åœ¨çš„é—®é¢˜"></a>å¯èƒ½å­˜åœ¨çš„é—®é¢˜</h2><p> ç¬¬ä¸€ï¼Œå½“DLLæ²¡æœ‰å ä½ImageBaseæ—¶ï¼ŒIATä¸­çš„åœ°å€å°±æ˜¯é”™çš„ï¼›ç¬¬äºŒï¼Œå½“é“¾æ¥çš„DLLè¢«ä¿®æ”¹äº†ï¼Œé‚£IATé‡Œå†™çš„åœ°å€ä¹Ÿæ˜¯é”™çš„ã€‚é‡åˆ°è¿™ä¸¤ç§æƒ…å½¢ä¹‹ä¸€ï¼ŒåŠ è½½æ—¶å°±å¿…é¡»ä¿®å¤IATäº†ã€‚ </p><p>å¯¹äºç¬¬äºŒç§æƒ…å½¢ï¼ŒDLLæ˜¯å¦è¢«ä¿®æ”¹ï¼Œæ˜¯æ ¹æ®æ¯”è¾ƒDLLçš„æ—¶é—´æˆ³å’Œç»‘å®šå¯¼å…¥è¡¨ä¸­çš„è®°å½•çš„DLLæ—¶é—´æˆ³æ¥åˆ¤æ–­çš„ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œè¯´æ˜DLLè¢«ä¿®æ”¹äº†ã€‚</p><p>åŠ è½½ç¨‹åºæ—¶ï¼Œæ“ä½œç³»ç»Ÿæ ¹æ®å¯¼å…¥è¡¨ä¸­çš„æ—¶é—´æˆ³æ¥åˆ¤æ–­ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ç»‘å®šå¯¼å…¥ã€‚å½“æ—¶é—´æˆ³ä¸º0ï¼Œè¡¨ç¤ºä¸ä½¿ç”¨ç»‘å®šå¯¼å…¥è¡¨ï¼›å½“æ—¶é—´æˆ³ä¸º0xFFFFFFFFï¼Œè¯´æ˜è¯¥ç¨‹åºä½¿ç”¨ç»‘å®šå¯¼å…¥ã€‚</p><h2 id="ç»‘å®šå¯¼å…¥è¡¨ç»“æ„"><a href="#ç»‘å®šå¯¼å…¥è¡¨ç»“æ„" class="headerlink" title="ç»‘å®šå¯¼å…¥è¡¨ç»“æ„"></a>ç»‘å®šå¯¼å…¥è¡¨ç»“æ„</h2><pre class="language-c" data-language="c"><code class="language-c">typedef struct _IMAGE_BOUND_IMPORT_DESCRIPTOR {    DWORD   TimeDateStamp;    WORD    OffsetModuleName;    WORD    NumberOfModuleForwarderRefs;// Array of zero or more IMAGE_BOUND_FORWARDER_REF follows} IMAGE_BOUND_IMPORT_DESCRIPTOR,  *PIMAGE_BOUND_IMPORT_DESCRIPTOR;</code></pre><p> TimeDateStamp æ˜¯æ—¶é—´æˆ³ï¼Œç”¨äºå’ŒDLLä¸­çš„æ—¶é—´æˆ³æ¯”è¾ƒï¼Œåˆ¤æ–­DLLæ˜¯å¦å·²ç»å‘ç”Ÿå˜åŒ–ï¼› </p><p> OffsetModuleName æ˜¯å½“å‰æ¨¡å—åè·ç¦»ç¬¬ä¸€ä¸ª _IMAGE_BOUND_IMPORT_DESCRIPTOR çš„åç§»ã€‚</p><p>  NumberOfModuleForwarderRefs æ˜¯è¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—æ•°é‡ï¼› </p><h3 id="ä¾èµ–æ¨¡å—ç»“æ„"><a href="#ä¾èµ–æ¨¡å—ç»“æ„" class="headerlink" title="ä¾èµ–æ¨¡å—ç»“æ„"></a>ä¾èµ–æ¨¡å—ç»“æ„</h3><pre class="language-c" data-language="c"><code class="language-c">typedef struct _IMAGE_BOUND_FORWARDER_REF {    DWORD   TimeDateStamp;    WORD    OffsetModuleName;    WORD    Reserved;} IMAGE_BOUND_FORWARDER_REF,*PIMAGE_BOUND_FORWARDER_REF;</code></pre><p> é™¤äº†ç¬¬ä¸‰ä¸ªå±æ€§ä¿ç•™ï¼Œå…¶ä»–ä¸ _IMAGE_BOUND_IMPORT_DESCRIPTOR ç›¸åŒã€‚ </p><p><img src="/2022/03/03/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/1647049008006.png" alt="ç»‘å®šå¯¼å…¥è¡¨"></p>]]></content>
      
      
      
        <tags>
            
            <tag> PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hgame2022-WOW-patchæ•°æ®æ®µ</title>
      <link href="/2022/02/22/hgame2022-WOW-patch%E6%95%B0%E6%8D%AE%E6%AE%B5/"/>
      <url>/2022/02/22/hgame2022-WOW-patch%E6%95%B0%E6%8D%AE%E6%AE%B5/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><p><img src="/2022/02/22/hgame2022-WOW-patch%E6%95%B0%E6%8D%AE%E6%AE%B5/1645531507324.png"></p><p>å¯ä»¥çœ‹åˆ°ä¸Šé¢è¿™ä¸€æ®µæ˜¯è¾“å…¥å¹¶ä¸”æŠŠåŠ å¯†åçš„è¾“å…¥èµ‹å€¼ç»™Buf2ï¼Œåœ¨è¿™ä¹‹åå·²ç»ç»“æŸäº†åˆ¤æ–­ï¼Œæ‰€ä»¥ä¸‹é¢çº¢è‰²æ¡†çš„ä»£ç åº”è¯¥æ˜¯è§£å¯†ä»£ç ï¼Œåªéœ€è¦æŠŠBufåœ¨æ ˆä¸­è¿›è¡Œä¿®æ”¹ä¸ºfinalå­—ç¬¦ä¸²å³å¯</p><p><img src="/2022/02/22/hgame2022-WOW-patch%E6%95%B0%E6%8D%AE%E6%AE%B5/1645531624170.png"></p><p>è¿™é‡Œç‚¹è¿‡å»å‘ç°å¹¶æ²¡æœ‰æ•°æ®ï¼Œè¿™å¯èƒ½æ˜¯ä¸€äº›æ•°æ®æ²¡æœ‰åç¼–è¯‘å‡ºæ¥ï¼Œä½†æ˜¯åœ¨å›¾ä¸­è“è‰²éƒ¨åˆ†å¯ä»¥çœ‹åˆ°åœ°å€æ˜¯ebp-54</p><p><img src="/2022/02/22/hgame2022-WOW-patch%E6%95%B0%E6%8D%AE%E6%AE%B5/1645531725452.png">è®¡ç®—ä¸€ä¸‹ï¼Œåœ¨å †æ ˆçª—å£æŒ‰gè¿›è¡Œè·³è½¬</p><p><img src="/2022/02/22/hgame2022-WOW-patch%E6%95%B0%E6%8D%AE%E6%AE%B5/1645531744867.png"></p><p>è·³è½¬ä¹‹å</p><p><img src="/2022/02/22/hgame2022-WOW-patch%E6%95%B0%E6%8D%AE%E6%AE%B5/1645531761124.png"></p><p>ç„¶åå³é”®Editï¼Œæˆ–è€…æŒ‰å¿«æ·é”®F2ï¼Œç„¶åè¿›è¡Œä¿®æ”¹ï¼Œæ³¨æ„å¤§å°ç«¯åºçš„é—®é¢˜ï¼Œè¿™é‡Œä½¿ç”¨lazyidaé€‰æ‹©DWORDå¯¼å‡ºæ¥å°±å¾ˆæ–¹ä¾¿ï¼Œå†æ¬¡å³é”®ï¼Œåº”ç”¨ä¿®æ”¹</p><p>ç„¶åè¿è¡Œå³å¯ï¼Œå°±å¯ä»¥åœ¨inputçœ‹åˆ°flagäº†</p><p><img src="/2022/02/22/hgame2022-WOW-patch%E6%95%B0%E6%8D%AE%E6%AE%B5/1645531871154.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Competition </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hgame-misc</title>
      <link href="/2022/02/19/hgame-misc/"/>
      <url>/2022/02/19/hgame-misc/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ€»ç®—æ˜¯ç»“æŸäº†ï¼Œä¸‹é¢å°±è®°å½•ä¸€ä¸‹miscé‡åˆ°çš„ä¸€äº›é¢˜ç›®</p><h1 id="è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦"><a href="#è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦" class="headerlink" title="è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦"></a>è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦</h1><h2 id="ç›¸å…³çŸ¥è¯†-å‹ç¼©åŒ…"><a href="#ç›¸å…³çŸ¥è¯†-å‹ç¼©åŒ…" class="headerlink" title="ç›¸å…³çŸ¥è¯†-å‹ç¼©åŒ…"></a>ç›¸å…³çŸ¥è¯†-å‹ç¼©åŒ…</h2><h2 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><p><img src="/2022/02/19/hgame-misc/1645212044252.png"></p><p>å¯ä»¥çœ‹åˆ°åœ¨zipç»™å‡ºäº†å¯†ç çš„æç¤ºï¼Œå…­ä½çº¯æ•°å­—ï¼ŒAdvanced Archive Password Recoveryçˆ†ç ´</p><p><img src="/2022/02/19/hgame-misc/1645212152522.png"></p><p><img src="/2022/02/19/hgame-misc/1645212207157.png"></p><p>æ ¹æ®æç¤ºï¼Œç»™å‡ºçš„åº”è¯¥æ˜¯å­—å…¸ï¼Œæˆ‘ä»¬åŒæ ·åœ¨çˆ†ç ´è½¯ä»¶ä¸­é€‰æ‹©å­—å…¸</p><p><img src="/2022/02/19/hgame-misc/1645212320305.png"></p><p>ç»§ç»­ä¸‹ä¸€æ­¥</p><p><img src="/2022/02/19/hgame-misc/1645212429206.png"></p><p>ä»–è®©æˆ‘ä»¬é‡æ–°å‚¨å­˜ï¼ŒæŠŠreadmeæ–‡ä»¶é€‰æ‹©ä»¥å­˜å‚¨çš„æ–¹å¼å‹ç¼©å‘ç°</p><p><img src="/2022/02/19/hgame-misc/1645212573216.png"></p><p>è¿™ä¸¤ä¸ªçš„CRC32çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“CRC32çš„å€¼åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥ä½¿ç”¨æ˜æ–‡æ”»å‡»ï¼Œè¿™é‡Œ4.5æ²¡è·‘å‡ºæ¥ï¼Œ4.0è·‘å‡ºæ¥äº†</p><p>åœ¨jpgæ–‡ä»¶å°¾éƒ¨å‘ç°äº†zipï¼Œå¦å­˜ä¸€ä¸‹ï¼Œæ˜¯ä¼ªåŠ å¯†</p><p><img src="/2022/02/19/hgame-misc/1645213950846.png"></p><p>ä¿®å¤åå¾—åˆ°flag</p><p><img src="/2022/02/19/hgame-misc/1645214098403.png"></p><h1 id="ä½ ä¸Šå½“äº†-æˆ‘çš„å¾ˆå¤§"><a href="#ä½ ä¸Šå½“äº†-æˆ‘çš„å¾ˆå¤§" class="headerlink" title="ä½ ä¸Šå½“äº† æˆ‘çš„å¾ˆå¤§"></a>ä½ ä¸Šå½“äº† æˆ‘çš„å¾ˆå¤§</h1><h2 id="ç›¸å…³çŸ¥è¯†-äºŒç»´ç "><a href="#ç›¸å…³çŸ¥è¯†-äºŒç»´ç " class="headerlink" title="ç›¸å…³çŸ¥è¯†-äºŒç»´ç "></a>ç›¸å…³çŸ¥è¯†-äºŒç»´ç </h2><h2 id="è§£é¢˜è¿‡ç¨‹-1"><a href="#è§£é¢˜è¿‡ç¨‹-1" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><p>è§£å‹ä¹‹åå¾—åˆ°å¾ˆå¤šçš„è§†é¢‘ï¼Œä½†éƒ½æ˜¯é‡å¤çš„ï¼Œæœ‰ç”¨çš„å°±å‡ ä¸ªï¼Œä¸»è¦è®°å½•ä¸€ä¸‹å„ç§äºŒç»´ç çš„æ ·å­ï¼Œä»¥å…ä¹‹åè®¤ä¸å‡ºæ¥</p><p><a href="https://barcode.tec-it.com/zh/CodablockF">https://barcode.tec-it.com/zh/CodablockF</a></p><p>è¿™ä¸ªç½‘ç«™å¯ä»¥ç”Ÿæˆä¸åŒçš„äºŒç»´ç ï¼Œä¾¿äºè¯†åˆ«</p><p><a href="https://products.aspose.app/barcode/recognize#">https://products.aspose.app/barcode/recognize#</a></p><p>è¿™ä¸ªç½‘ç«™è¯†åˆ«æ¯”è¾ƒå…¨</p><p><img src="/2022/02/19/hgame-misc/1645213399267.png"></p><p><img src="/2022/02/19/hgame-misc/1645213453036.png"></p><p><img src="/2022/02/19/hgame-misc/1645213467874.png"></p><h1 id="è°ä¸å–œæ¬¢çŒ«çŒ«å‘¢"><a href="#è°ä¸å–œæ¬¢çŒ«çŒ«å‘¢" class="headerlink" title="è°ä¸å–œæ¬¢çŒ«çŒ«å‘¢"></a>è°ä¸å–œæ¬¢çŒ«çŒ«å‘¢</h1><p><a href="https://blog.csdn.net/mochu7777777/article/details/122631962-%E5%8F%AF%E4%BB%A5%E7%9C%8B%E7%9C%8B%EF%BC%8C%E8%84%9A%E6%9C%AC%E4%B8%8D%E4%BC%9A%E5%86%99">https://blog.csdn.net/mochu7777777/article/details/122631962-å¯ä»¥çœ‹çœ‹ï¼Œè„šæœ¬ä¸ä¼šå†™</a></p><h1 id="æ‘†çƒ‚"><a href="#æ‘†çƒ‚" class="headerlink" title="æ‘†çƒ‚"></a>æ‘†çƒ‚</h1><h2 id="ç›¸å…³çŸ¥è¯†-ç›²æ°´å°ã€APngã€é›¶å®½éšå†™"><a href="#ç›¸å…³çŸ¥è¯†-ç›²æ°´å°ã€APngã€é›¶å®½éšå†™" class="headerlink" title="ç›¸å…³çŸ¥è¯†-ç›²æ°´å°ã€APngã€é›¶å®½éšå†™"></a>ç›¸å…³çŸ¥è¯†-ç›²æ°´å°ã€APngã€é›¶å®½éšå†™</h2><h2 id="è§£é¢˜è¿‡ç¨‹-2"><a href="#è§£é¢˜è¿‡ç¨‹-2" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><p>foremoståˆ†ç¦»å‹ç¼©åŒ…å¾—åˆ°pngæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥å¤åˆ¶æ–‡ä»¶ä¿¡æ¯ä¹‹åå¦å­˜ä¸ºï¼Œå°†pngæ‹–è¿›010å‘ç°å¥‡æ€ªçš„åœ°æ–¹</p><p><img src="/2022/02/19/hgame-misc/1645214249445.png"></p><p>æ­£å¸¸çš„pngæ–‡ä»¶æ˜¯æ²¡æœ‰fdATæ•°æ®æ®µçš„ APng-<a href="https://www.jianshu.com/p/5333bcc20ba7">https://www.jianshu.com/p/5333bcc20ba7</a></p><p>æŸ¥é˜…èµ„æ–™å‘ç°æ˜¯Apngï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªåˆ†è§£Apngçš„ç½‘å€</p><p><a href="https://ezgif.com/split">https://ezgif.com/split</a></p><p>å¾—åˆ°ä¸¤å¼ ä¸€æ¨¡ä¸€æ ·çš„å›¾ç‰‡ï¼Œè¿™æ—¶å€™å°±æƒ³åˆ°äº†ç›²æ°´å°</p><p><img src="/2022/02/19/hgame-misc/1645214469303.png"></p><p>å¾—åˆ°å¸¦æœ‰å¯†ç çš„å›¾ç‰‡</p><p><img src="/2022/02/19/hgame-misc/1645214585213.png"></p><p>å¾—åˆ°å¯†é’¥è§£å‹å‹ç¼©åŒ…ï¼Œæ‹¼æ¥äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°</p><p><img src="/2022/02/19/hgame-misc/1645214612749.png"></p><p>å‘ç°å¾ˆå¤šé—®å·ï¼Œåº”è¯¥å°±æ˜¯é›¶å®½äº†ï¼Œè¿™é‡Œæˆ‘æ‰‹æœºæ‰«ç åçš„ä¿¡æ¯å†æ‹¿å»è§£å¯†-<a href="https://330k.github.io/misc_tools/unicode_steganography.html">https://330k.github.io/misc_tools/unicode_steganography.html</a></p><p><img src="/2022/02/19/hgame-misc/1645214720413.png"></p><h1 id="At0mçš„ç»™ä½ ä»¬çš„-è¿Ÿåˆ°çš„-æƒ…äººèŠ‚ç¤¼ç‰©"><a href="#At0mçš„ç»™ä½ ä»¬çš„-è¿Ÿåˆ°çš„-æƒ…äººèŠ‚ç¤¼ç‰©" class="headerlink" title="At0mçš„ç»™ä½ ä»¬çš„(è¿Ÿåˆ°çš„)æƒ…äººèŠ‚ç¤¼ç‰©"></a>At0mçš„ç»™ä½ ä»¬çš„(è¿Ÿåˆ°çš„)æƒ…äººèŠ‚ç¤¼ç‰©</h1><h2 id="ç›¸å…³çŸ¥è¯†-aviéšå†™ã€NTFSæ•°æ®æµã€-MSU-StegoVideoå·¥å…·"><a href="#ç›¸å…³çŸ¥è¯†-aviéšå†™ã€NTFSæ•°æ®æµã€-MSU-StegoVideoå·¥å…·" class="headerlink" title="ç›¸å…³çŸ¥è¯†-aviéšå†™ã€NTFSæ•°æ®æµã€ MSU StegoVideoå·¥å…·"></a>ç›¸å…³çŸ¥è¯†-aviéšå†™ã€NTFSæ•°æ®æµã€ MSU StegoVideoå·¥å…·</h2><h2 id="è§£é¢˜è¿‡ç¨‹-3"><a href="#è§£é¢˜è¿‡ç¨‹-3" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><p>ä¸€èˆ¬æ•°æ®æµéšå†™éƒ½é‡‡å–winrarï¼Œæ‰€ä»¥è¦å…³æ³¨raræ–‡ä»¶</p><p>è¿™é‡Œè§£å‹ä¹‹åæ—¶å€™NTFSå·¥å…·å¾—åˆ°</p><p><img src="/2022/02/19/hgame-misc/1645214827597.png"></p><p>å››ä¸ªæ–¹å‘å¯¹åº”å››è¿›åˆ¶ï¼Œè§£ç çš„åˆ° 6557225 </p><p>è¿˜æœ‰ä¸€ä¸ªaviæ–‡ä»¶ï¼Œä¸€èˆ¬æ˜¯MSU StegoVideoå·¥å…·</p><p>ä¸‹è½½å¥½ä¹‹åé€‰æ‹©å¥½aviæ–‡ä»¶ï¼Œå¹¶ä¸”æŒ‡å®šå†™å…¥çš„æ–‡æœ¬ ï¼Œè¾“å…¥å¯†ç å³å¯</p><p>hgame{Q1ng_R3n_J1e_Da_Sh4_CTF}                        </p>]]></content>
      
      
      
        <tags>
            
            <tag> Competition </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pycåŠ èŠ±æŒ‡ä»¤</title>
      <link href="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/"/>
      <url>/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="VNCTF2022-BabyMaze"><a href="#VNCTF2022-BabyMaze" class="headerlink" title="VNCTF2022-BabyMaze"></a>VNCTF2022-BabyMaze</h1><p>pycç›¸å…³çŸ¥è¯†-<a href="https://zhuanlan.zhihu.com/p/145811103">https://zhuanlan.zhihu.com/p/145811103</a></p><p>ä½¿ç”¨uncompyle6å‘ç°æ— æ³•åç¼–è¯‘ï¼Œåº”è¯¥æ˜¯æ·»åŠ äº†èŠ±æŒ‡ä»¤</p><p>å…ˆæŸ¥çœ‹å­—èŠ‚ç </p><p>è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">import marshal, disf = open("D:\\new\\AD\\game\\vnctf2022\\re\\BabyMaze.pyc", "rb").read()code = marshal.loads(f[16:]) #è¿™è¾¹ä»16ä½å¼€å§‹å–å› ä¸ºæ˜¯python3 python2ä»8ä½å¼€å§‹å–dis.dis(code)</code></pre><p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644848858641.png"></p><p>å‘ç°è¿™ä¸€æ®µå°±æ˜¯èŠ±æŒ‡ä»¤</p><p>å»pythonçš„åŒ…é‡Œé¢æœç´¢opcode.hï¼Œæ‰¾åˆ°å¯¹åº”çš„å­—èŠ‚ç </p><p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644848986760.png"></p><p>è½¬ä¸ºåå…­è¿›åˆ¶åå»010editorä¿®æ”¹ï¼Œå»æ‰å³å¯</p><p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849226023.png"></p><p>ä½†æ˜¯å‘ç°è¿˜æ˜¯ä¸è¡Œï¼Œè¿™æ˜¯å› ä¸º</p><p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849421077.png"></p><p>pycæ–‡ä»¶æœ‰co_codeï¼Œæ‰€ä»¥ä¿®æ”¹é•¿åº¦ä¹‹åè¦ä¿®æ”¹å®ƒ</p><p>å…ˆæ‰“å°å‡ºæ¥é•¿åº¦ï¼Œç„¶åè®¡ç®—åä¿®æ”¹</p><p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849766935.png"></p><p>2030-6=7E8</p><p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849849453.png"></p><p>é‡æ–°uncompyle6</p><p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849958666.png"></p><p>åç¼–è¯‘æˆåŠŸï¼Œæ¥ä¸‹æ¥å°±æ˜¯mazeå›¾ï¼Œæ‰“å°å‡ºæ¥ä¹‹åæ‰‹æ‰“</p><h1 id="Pycå­—èŠ‚ç é˜…è¯»-unctf2021-pytrade"><a href="#Pycå­—èŠ‚ç é˜…è¯»-unctf2021-pytrade" class="headerlink" title="Pycå­—èŠ‚ç é˜…è¯»-unctf2021-pytrade"></a>Pycå­—èŠ‚ç é˜…è¯»-unctf2021-pytrade</h1><p>å¾—åˆ°ä¸¤ä¸ªtxtæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯pyçš„å­—èŠ‚ç ï¼Œä¸€ä¸ªæ˜¯è¾“å‡º</p><p>å¯¹å­—èŠ‚ç è¿›è¡Œåˆ†æ</p><p><a href="https://www.jianshu.com/p/557cfe36f0f0">https://www.jianshu.com/p/557cfe36f0f0</a></p><p><a href="https://bbs.pediy.com/thread-246683.htm">https://bbs.pediy.com/thread-246683.htm</a></p><p><a href="https://docs.python.org/zh-cn/3/library/dis.html">https://docs.python.org/zh-cn/3/library/dis.html</a>  è¿™æ˜¯python3çš„</p><pre class="language-python" data-language="python"><code class="language-python">0 LOAD_CONST               1 ('XXXXXX')       //This is flag,try to figure it out ! Don't forget to fill it in flag{} !             2 STORE_FAST               0 (flag)</code></pre><p>LOAD_CONSTåŠ è½½constå˜é‡ï¼Œæ¯”å¦‚æ•°å€¼ã€å­—ç¬¦ä¸²ç­‰ï¼Œä¸€èˆ¬ç”¨äºä¼ ç»™å‡½æ•°å‚æ•°</p><p>STORE_FAST ä¸€èˆ¬ç”¨äºä¿å­˜å€¼åˆ°å±€éƒ¨å˜é‡</p><p>è¿™å¥è¯æ„æ€æ˜¯</p><pre class="language-none"><code class="language-none">flag='XXXXXXXX'</code></pre><p>ç¬¬äºŒæ®µ</p><pre class="language-python" data-language="python"><code class="language-python">4 LOAD_CONST               2 (0) constå˜é‡ï¼Œä¸€èˆ¬ç”¨äºä¼ ç»™å‡½æ•°çš„å‚æ•°             6 BUILD_LIST               1  åˆ›å»ºåˆ—è¡¨             8 LOAD_CONST               3 (18)   constå˜é‡  num=[0]*18            10 BINARY_MULTIPLY                12 STORE_FAST               1 (num) ä¿å­˜å€¼åˆ°å±€éƒ¨å˜é‡ä¸­</code></pre><p>BINARY_MULTIPLY æ˜¯äºŒå…ƒè¿ç®—ï¼Œå³å°†æ ˆé¡¶çš„å‰ä¸¤ä¸ªå…ƒç´ å–å‡ºè¿›è¡Œè®¡ç®—ï¼Œç»“æœå‹å›æ ˆä¸­ </p><p>BUILD_LIST åˆ›å»ºåˆ—è¡¨</p><pre class="language-none"><code class="language-none">num=[0]*18</code></pre><p>ç¬¬ä¸‰æ®µ</p><pre class="language-python" data-language="python"><code class="language-python">14 LOAD_CONST               2 (0)             16 STORE_FAST               2 (k)</code></pre><pre class="language-python" data-language="python"><code class="language-python">k=0</code></pre><p>ç¬¬å››æ®µ</p><pre class="language-python" data-language="python"><code class="language-python">18 LOAD_GLOBAL              0 (range) åŠ è½½å…¨å±€å˜é‡             20 LOAD_GLOBAL              1 (len)              22 LOAD_FAST                0 (flag)              24 CALL_FUNCTION            1è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨æ­¤ä¹‹å‰è¦å…ˆèµ‹å€¼ len(flag)             26 CALL_FUNCTION            1  range(len(flag))             28 GET_ITERå–è¿­ä»£å™¨        &gt;&gt;   30 FOR_ITER               112 (to 144)  ä¸€ç›´åˆ°144éƒ½æ˜¯forå¾ªç¯             32 STORE_FAST               3 (i) </code></pre><p> LOAD_GLOBAL ç”¨æ¥åŠ è½½å…¨å±€å˜é‡ï¼ŒåŒ…æ‹¬æŒ‡å®šå‡½æ•°åï¼Œç±»åï¼Œæ¨¡å—åç­‰å…¨å±€ç¬¦å·ã€‚å½“å’Œå‡½æ•°æ­é…æ—¶ï¼Œè¦æ³¨æ„æœ‰CALL_FUNCTION</p><p>LOAD_FASTä¸€èˆ¬åŠ è½½å±€éƒ¨å˜é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯»å–å€¼ï¼Œç”¨äºè®¡ç®—æˆ–è€…å‡½æ•°è°ƒç”¨ä¼ å‚ç­‰ã€‚è¿™é‡Œè°ƒç”¨å®Œlenä¹‹åï¼Œè¦ä½¿ç”¨å…¶ä¼ å€¼ï¼Œè¿™é‡Œä¼ å…¥flag</p><p>å‰åŠæ®µæ„æ€æ˜¯</p><pre class="language-python" data-language="python"><code class="language-python">range(len(flag))</code></pre><p>GET_ITERåˆ›å»ºè¿­ä»£å™¨ï¼Œä¸€èˆ¬æ˜¯forå¾ªç¯</p><p>FOR_ITER(to 144)è¡¨ç¤ºè¿­ä»£å™¨ä¸€ç›´åˆ°144</p><p>STORE_FAST åˆ›å»ºå±€éƒ¨å˜é‡ï¼Œè¿™é‡Œä½œä¸ºforå¾ªç¯çš„ç´¢å¼•</p><pre class="language-python" data-language="python"><code class="language-python">for i in range(len(flag)):</code></pre><p>ç¬¬äº”æ®µ</p><pre class="language-python" data-language="python"><code class="language-python">7          34 LOAD_GLOBAL              2 (ord)             36 LOAD_FAST                0 (flag)            38 LOAD_FAST                3 (i)            40 BINARY_SUBSCRç´¢å¼•è¿ç®—            42 CALL_FUNCTION            1ord(flag[i])            44 LOAD_FAST                3 (i)            46 BINARY_ADD+i            48 LOAD_FAST                2 (k)            50 LOAD_CONST               4 (3)            52 BINARY_MODULO//å–æ¨¡è¿ç®— k%3            54 LOAD_CONST               5 (1)             56 BINARY_ADD(k%3)+1            58 BINARY_XOR(ord(flag[i])+i)^(k%3+1)            60 LOAD_FAST                1 (num)            62 LOAD_FAST                3 (i)            64 STORE_SUBSCR num[i]</code></pre><p>BINARY_SUBSCRä¸‹æ ‡ è®¿é—®æ“ä½œ</p><p>BINARY_ADDä¹Ÿæ˜¯äºŒå…ƒè¿ç®—ï¼Œç›¸åŠ </p><p>BINARY_MODULOï¼ŒäºŒå…ƒè¿ç®—å–æ¨¡</p><p>BINARY_XORäºŒå…ƒè¿ç®—å¼‚æˆ–</p><p>STORE_SUBSCRä¸‹æ ‡è®¿é—®æ“ä½œ</p><pre class="language-python" data-language="python"><code class="language-python">num[i]= (ord(flag[i]) + i) ^ (k % 3 + 1)</code></pre><p>ç¬¬å…­æ®µ</p><pre class="language-python" data-language="python"><code class="language-python">8          66 LOAD_GLOBAL              2 (ord)             68 LOAD_FAST                0 (flag)             70 LOAD_GLOBAL              1 (len)             72 LOAD_FAST                0 (flag)             74 CALL_FUNCTION            1len(flag)             76 LOAD_FAST                3 (i)len(flag)-i             78 BINARY_SUBTRACT             80 LOAD_CONST               5 (1)             82 BINARY_SUBTRACTå‡æ³•len(flag)-i-1             84 BINARY_SUBSCRç´¢å¼•è¿ç®—flag[len(flag)-i-1]             86 CALL_FUNCTION            1ord(flag[len(flag)-i-1])             88 LOAD_GLOBAL              1 (len)             90 LOAD_FAST                0 (flag)             92 CALL_FUNCTION            1len(flag)             94 BINARY_ADDord(flag[len(flag)-i-1])+len(flag)-i-1             96 LOAD_FAST                3 (i)             98 BINARY_SUBTRACT            100 LOAD_CONST               5 (1)            102 BINARY_SUBTRACT            104 LOAD_FAST                2 (k)            106 LOAD_CONST               4 (3)            108 BINARY_MODULOk%3            110 LOAD_CONST               5 (1)            112 BINARY_ADDk%3+1            114 BINARY_XORord(flag[len(flag)-i-1])+(len(flag)-i-1)^(k%3+1)            116 LOAD_FAST                1 (num)            118 LOAD_GLOBAL              1 (len)            120 LOAD_FAST                0 (flag)len(flag)            122 CALL_FUNCTION            1            124 LOAD_FAST                3 (i)            126 BINARY_SUBTRACTlen(flag)-i            128 LOAD_CONST               5 (1)            130 BINARY_SUBTRACTlen(flag)-i-1            132 STORE_SUBSCRnum[len(flag)-i-1]=ord(flag[len(flag)-i-1])+(len(flag)-i-1)^(k%3+1)</code></pre><p>BINARY_SUBTRACTäºŒå…ƒè¿ç®—å‡æ³•</p><pre class="language-python" data-language="python"><code class="language-python">num[len(flag)-i-1]=ord(flag[len(flag)-i-1])+(len(flag)-i-1)^(k%3+1)</code></pre><p>ç¬¬ä¸ƒæ®µ</p><pre class="language-python" data-language="python"><code class="language-python">9         134 LOAD_FAST                2 (k)            136 LOAD_CONST               5 (1)            138 INPLACE_ADDk++            140 STORE_FAST               2 (k)            142 JUMP_ABSOLUTE           30//å¾ªç¯ç»“æŸ</code></pre><p>JUMP_ABSOLUTEç»å¯¹è·³è½¬ï¼Œç»“æŸå¾ªç¯</p><p>INPLACE_ADD  è®¡ç®—ç»“æœå¯ä»¥è¢«æ“ä½œæ•°å¼•ç”¨çš„åˆ°ï¼Œæ¯ä¸€ä¸ª äºŒå…ƒè¿ç®—ï¼Œéƒ½å¯¹åº”ä¸€ä¸ªinplace è¿ç®— </p><pre class="language-python" data-language="python"><code class="language-python">k+=1</code></pre><p>ç¬¬å…«æ®µ</p><pre class="language-python" data-language="python"><code class="language-python">10     &gt;&gt;  144 LOAD_GLOBAL              3 (print)            146 LOAD_FAST                1 (num)            148 CALL_FUNCTION            1 print(num)            150 POP_TOP            152 LOAD_CONST               0 (None)            154 RETURN_VALUE</code></pre><pre class="language-none"><code class="language-none">print(num)</code></pre><h1 id="Easy-Re"><a href="#Easy-Re" class="headerlink" title="Easy_Re"></a>Easy_Re</h1><p>python3.9ï¼Œæ— æ³•uncompyle6ï¼Œä½¿ç”¨pycdcç¿»è¯‘æˆå­—èŠ‚ç </p><pre class="language-python" data-language="python"><code class="language-python">main.pyc (Python 3.9)[Code]    File Name: main.py    Object Name: &lt;module&gt;    Arg Count: 0    Pos Only Arg Count: 0    KW Only Arg Count: 0    Locals: 0    Stack Size: 4    Flags: 0x00000040 (CO_NOFREE)    [Names]        'base64'        'encode'        'enCodeAgain'        'correct'        'flag'        'print'        'input'    [Var Names]    [Free Vars]    [Cell Vars]    [Constants]        0        None        [Code]            File Name: main.py            Object Name: encode            Arg Count: 1            Pos Only Arg Count: 0            KW Only Arg Count: 0            Locals: 4            Stack Size: 5            Flags: 0x00000043 (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)            [Names]                'chr'                'base64'                'b64encode'                'encode'            [Var Names]                'message'                's'                'i'                'x'            [Free Vars]            [Cell Vars]            [Constants]                None                ''                32                16                'utf-8' [Disassembly]                0       LOAD_CONST              1: ''                2       STORE_FAST              1: s       s=''                4       LOAD_FAST               0: message                6       GET_ITER                                8       FOR_ITER                32 (to 42) for i in message:                10      STORE_FAST              2: i                   12      LOAD_FAST               2: i                  14      LOAD_CONST              2: 32                16      BINARY_XOR               i^32                18      STORE_FAST              3: xx=i^32                20      LOAD_FAST               3: x                22      LOAD_CONST              3: 16                24      BINARY_ADD              x+16                26      STORE_FAST              3: xx=x+16                28      LOAD_FAST               1: s                30      LOAD_GLOBAL             0: chr                32      LOAD_FAST               3: x                    34      CALL_FUNCTION           1  chr(x)                36      INPLACE_ADD             s+chr(x)                38      STORE_FAST              1: ss=s+chr(x)                40      JUMP_ABSOLUTE           8    å¾ªç¯ç»“æŸ                42      LOAD_GLOBAL             1: base64                44      LOAD_METHOD             2: b64encodebase64.b64                46      LOAD_FAST               1: s                48      LOAD_METHOD             3: encode   LOAD_METHODæ˜¯åŠ è½½ç±»ï¼ŒCALLè°ƒç”¨                50      LOAD_CONST              4: 'utf-8'                 52      CALL_METHOD             1                  54      CALL_METHOD             1 base64.b64(s.encode('utf-8'))                56      RETURN_VALUE            return  base64.b64(s.encode('utf-8'))        'encode'        [Code]            File Name: main.py            Object Name: enCodeAgain            Arg Count: 2            Pos Only Arg Count: 0            KW Only Arg Count: 0            Locals: 5            Stack Size: 5            Flags: 0x00000043 (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)            [Names]                'str'                'range'                'len'            [Var Names]                'string'                'space'                's'                'i'                'j'            [Free Vars]            [Cell Vars]            [Constants]                None                ''                'utf-8'                0            [Disassembly]                0       LOAD_CONST              1: ''                  2       STORE_FAST              2: ss=''                4       LOAD_GLOBAL             0: str                6       LOAD_FAST               0: string                8       LOAD_CONST              2: 'utf-8'                 10      CALL_FUNCTION           2//å‚æ•°ä¸ªæ•° str(string,'utf-8')                12      STORE_FAST              0: string string=str(string,'utf-8')                14      LOAD_GLOBAL             1: range                 16      LOAD_CONST              3: 0                18      LOAD_FAST               1: space                20      CALL_FUNCTION           2 range(0,space)                22      GET_ITER                //åˆ›å»ºè¿­ä»£å™¨                24      FOR_ITER                50 (to 76)                 26      STORE_FAST              3: ifor i range(0,space):                28      LOAD_GLOBAL             1: range                 30      LOAD_FAST               3: i                32      LOAD_GLOBAL             2: len                34      LOAD_FAST               0: string                36      CALL_FUNCTION           1len(string)                38      LOAD_FAST               1: space                40      CALL_FUNCTION           3                 42      GET_ITER                                44      FOR_ITER                28 (to 74)                46      STORE_FAST              4: j  for j in range(i,len(string),space)                48      LOAD_FAST               4: j                 50      LOAD_GLOBAL             2: len                52      LOAD_FAST               0: string                54      CALL_FUNCTION           1  len(string)                56      COMPARE_OP              0 (&lt;)if(j&lt;len(string))                58      POP_JUMP_IF_FALSE       44è·³è½¬                60      LOAD_FAST               2: s                62      LOAD_FAST               0: string                64      LOAD_FAST               4: j                66      BINARY_SUBSCR           string[j]                68      INPLACE_ADD                             70      STORE_FAST              2: s      s+=string[j]                72      JUMP_ABSOLUTE           44ç¬¬äºŒä¸ªå¾ªç¯                74      JUMP_ABSOLUTE           24ç¬¬ä¸€ä¸ªå¾ªç¯                76      LOAD_FAST               2: s                78      RETURN_VALUE             return s        'enCodeAgain'        'VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ='        ''        'Input flag:'        'utf-8'        2        'correct'        'wrong'    [Disassembly]        0       LOAD_CONST              0: 0        2       LOAD_CONST              1: None        4       IMPORT_NAME             0: base64        6       STORE_NAME              0: base64import base64        8       LOAD_CONST              2: &lt;CODE&gt; encode        10      LOAD_CONST              3: 'encode' //å‡½æ•°        12      MAKE_FUNCTION           0        14      STORE_NAME              1: encode        16      LOAD_CONST              4: &lt;CODE&gt; enCodeAgain        18      LOAD_CONST              5: 'enCodeAgain'        20      MAKE_FUNCTION           0//ç¬¬äºŒä¸ªå‡½æ•°        22      STORE_NAME              2: enCodeAgain        24      LOAD_CONST              6: 'VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ='        26      STORE_NAME              3: correctcorrect=VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ=        28      LOAD_CONST              7: ''        30      STORE_NAME              4: flagflag=''        32      LOAD_NAME               5: print        34      LOAD_CONST              8: 'Input flag:'        36      CALL_FUNCTION           1print('Int flag:')        38      POP_TOP                         40      LOAD_NAME               6: input        42      CALL_FUNCTION           0input()        44      STORE_NAME              4: flagflag=input()        46      LOAD_NAME               4: flag        48      LOAD_METHOD             1: encode        50      LOAD_CONST              9: 'utf-8'        52      CALL_METHOD             1        54      STORE_NAME              4: flagflag=flag.encode('utf-8')        56      LOAD_NAME               5: print        58      LOAD_NAME               2: enCodeAgain        60      LOAD_NAME               1: encode        62      LOAD_NAME               4: flag        64      CALL_FUNCTION           1        66      LOAD_CONST              10: 2 å…¶ä¸­ä¸€ä¸ªå‚æ•°        68      CALL_FUNCTION           2//ä¸¤ä¸ªå‚æ•°        70      CALL_FUNCTION           1print(enCodeAgain(encodee(flag),2))        72      POP_TOP                 å‡½æ•°æ ˆé¡¶å…ƒç´ å‡ºæ ˆ        74      LOAD_NAME               2: enCodeAgain        76      LOAD_NAME               1: encode        78      LOAD_NAME               4: flag        80      CALL_FUNCTION           1        82      LOAD_CONST              10: 2        84      CALL_FUNCTION           2(enCodeAgain(encodee(flag),2))        86      LOAD_NAME               3: correct        88      COMPARE_OP              2 (==)//æ¯”è¾ƒ        90      POP_JUMP_IF_FALSE       102è·³è½¬        92      LOAD_NAME               5: print        94      LOAD_CONST              11: 'correct'        96      CALL_FUNCTION           1print('correct')        98      POP_TOP                         100     JUMP_FORWARD            8 (to 110)ç»“æŸ        102     LOAD_NAME               5: print        104     LOAD_CONST              12: 'wrong'        106     CALL_FUNCTION           1print('wrong)        108     POP_TOP                         110     LOAD_CONST              1: None        112     RETURN_VALUE            </code></pre><pre class="language-python" data-language="python"><code class="language-python">import base64def encode(message):    s = ''    for i in message:        x = i ^ 32        x += 16        s += chr(x)        return (base64.b64encode(s.encode('utf-8')))def enCodeAgain(string, space):    s = ''    string = str(string, 'utf-8')    for i in range(0, space):        for j in range(i, len(string), space):            if j &lt; len(string):                s += string[j]    return scorrect = 'VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ='flag = ''print('Input flag:')flag = input()flag = flag.encode('utf-8')print(enCodeAgain(encode(flag), 2))if enCodeAgain(encode(flag), 2) == correct:    print(correct)else:    print('wrong')</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hgame2022-week3-re</title>
      <link href="/2022/02/13/hgame2022-week3-re/"/>
      <url>/2022/02/13/hgame2022-week3-re/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç®—æ˜¯æ€»ç»“å’Œåæ€å§</p><h1 id="hardened"><a href="#hardened" class="headerlink" title="hardened"></a>hardened</h1><h2 id="è€ƒç‚¹ï¼šåŠ å£³ã€AES-CBCã€Base64é­”æ”¹"><a href="#è€ƒç‚¹ï¼šåŠ å£³ã€AES-CBCã€Base64é­”æ”¹" class="headerlink" title="è€ƒç‚¹ï¼šåŠ å£³ã€AES-CBCã€Base64é­”æ”¹"></a>è€ƒç‚¹ï¼šåŠ å£³ã€AES-CBCã€Base64é­”æ”¹</h2><h2 id="åšé¢˜è¿‡ç¨‹"><a href="#åšé¢˜è¿‡ç¨‹" class="headerlink" title="åšé¢˜è¿‡ç¨‹"></a>åšé¢˜è¿‡ç¨‹</h2><p>é¦–å…ˆå¯ä»¥å…ˆè¯•è¯•ç”¨jebæ‰“å¼€</p><p><img src="/2022/02/13/hgame2022-week3-re/1644828115040.png"></p><p><img src="/2022/02/13/hgame2022-week3-re/1644828621422.png"></p><p>æ²¡æœ‰æ‰¾åˆ°mainactivitityï¼Œä¸”æœ‰applicationï¼Œåº”è¯¥æ˜¯åŠ äº†å£³ï¼Œå»libæ‰¾ä¸€ä¸‹soæ–‡ä»¶ï¼Œè¿›è¡Œè¯†åˆ«</p><pre class="language-none"><code class="language-none">markNameMap.put("libchaosvmp.so", "å¨œè¿¦");markNameMap.put("libddog.so", "å¨œè¿¦");markNameMap.put("libfdog.so", "å¨œè¿¦");markNameMap.put("libedog.so", "å¨œè¿¦ä¼ä¸šç‰ˆ");markNameMap.put("libexec.so", "çˆ±åŠ å¯†");markNameMap.put("libexecmain.so", "çˆ±åŠ å¯†");markNameMap.put("ijiami.dat", "çˆ±åŠ å¯†");markNameMap.put("ijiami.ajm", "çˆ±åŠ å¯†ä¼ä¸šç‰ˆ");markNameMap.put("libsecexe.so", "æ¢†æ¢†å…è´¹ç‰ˆ");markNameMap.put("libsecmain.so", "æ¢†æ¢†å…è´¹ç‰ˆ");markNameMap.put("libSecShell.so", "æ¢†æ¢†å…è´¹ç‰ˆ");markNameMap.put("libDexHelper.so", "æ¢†æ¢†ä¼ä¸šç‰ˆ");markNameMap.put("libDexHelper-x86.so", "æ¢†æ¢†ä¼ä¸šç‰ˆ");markNameMap.put("libprotectClass.so", "360");markNameMap.put("libjiagu.so", "360");markNameMap.put("libjiagu_art.so", "360");markNameMap.put("libjiagu_x86.so", "360");markNameMap.put("libegis.so", "é€šä»˜ç›¾");markNameMap.put("libNSaferOnly.so", "é€šä»˜ç›¾");markNameMap.put("libnqshield.so", "ç½‘ç§¦");markNameMap.put("libbaiduprotect.so", "ç™¾åº¦");markNameMap.put("aliprotect.dat", "é˜¿é‡Œèšå®‰å…¨");markNameMap.put("libsgmain.so", "é˜¿é‡Œèšå®‰å…¨");markNameMap.put("libsgsecuritybody.so", "é˜¿é‡Œèšå®‰å…¨");markNameMap.put("libmobisec.so", "é˜¿é‡Œèšå®‰å…¨");markNameMap.put("libtup.so", "è…¾è®¯");markNameMap.put("libexec.so", "è…¾è®¯");markNameMap.put("libshell.so", "è…¾è®¯");markNameMap.put("mix.dex", "è…¾è®¯");markNameMap.put("lib/armeabi/mix.dex", "è…¾è®¯");markNameMap.put("lib/armeabi/mixz.dex", "è…¾è®¯");markNameMap.put("libtosprotection.armeabi.so", "è…¾è®¯å¾¡å®‰å…¨");markNameMap.put("libtosprotection.armeabi-v7a.so", "è…¾è®¯å¾¡å®‰å…¨");markNameMap.put("libtosprotection.x86.so", "è…¾è®¯å¾¡å®‰å…¨");markNameMap.put("libnesec.so", "ç½‘æ˜“æ˜“ç›¾");markNameMap.put("libAPKProtect.so", "APKProtect");markNameMap.put("libkwscmm.so", "å‡ ç»´å®‰å…¨");markNameMap.put("libkwscr.so", "å‡ ç»´å®‰å…¨");markNameMap.put("libkwslinker.so", "å‡ ç»´å®‰å…¨");markNameMap.put("libx3g.so", "é¡¶åƒç§‘æŠ€");markNameMap.put("libapssec.so", "ç››å¤§");markNameMap.put("librsprotect.so", "ç‘æ˜Ÿ");</code></pre><p>è¿™ä¸ªç¨‹åºæ˜¯è¢«æ¢†æ¢†åŠ å›ºåŠ å›ºè¿‡çš„</p><p>ä½¿ç”¨å·¥å…·è„±å£³-</p><p><img src="/2022/02/13/hgame2022-week3-re/1644829142036.png"></p><p>å®‰è£…åˆ°æ‰‹æœºæˆ–è€…æ¨¡æ‹Ÿå™¨ä¸Šé¢</p><p><img src="/2022/02/13/hgame2022-week3-re/1644829295135.png"></p><p>æ‰¾åˆ°ç›®å½•å†ç§»åŠ¨åˆ°å…±äº«æ–‡ä»¶å¤¹å°±å¯ä»¥äº†</p><p><img src="/2022/02/13/hgame2022-week3-re/1644829809855.png"></p><p>é€‰ä¸­åæ‰“å¼€å…±äº«æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€å®‰å“æ–‡ä»¶å¤¹</p><p><img src="/2022/02/13/hgame2022-week3-re/1644829839920.png"></p><p><img src="/2022/02/13/hgame2022-week3-re/1644829849310.png"></p><p>ç§»åŠ¨åˆ°æ­¤</p><p><img src="/2022/02/13/hgame2022-week3-re/1644829879528.png"></p><p>å†æ‰“å¼€ç”µè„‘æ–‡ä»¶å¤¹å°±å¯ä»¥æ‰¾åˆ°äº†</p><p><img src="/2022/02/13/hgame2022-week3-re/1644829901534.png"></p><p>æŠŠdexä¾æ¬¡æ‹–å…¥jebï¼Œå‘ç°540702æœ‰å…³é”®ä¿¡æ¯</p><p><img src="/2022/02/13/hgame2022-week3-re/1644830177982.png"></p><p>ç¬¬äºŒæ®µæ˜¯å…³é”®æ¯”è¾ƒ</p><p>æŸ¥çœ‹å‰ä¸€ä¸ªæ–¹æ¡†ä¸­å¼•ç”¨çš„ç±»</p><p><img src="/2022/02/13/hgame2022-week3-re/1644830302545.png"></p><p>æ˜¯ç”¨æ¥è°ƒç”¨soçš„ï¼Œæ”¹ä¸ºzipæ–‡ä»¶æŠŠenc.soæ–‡ä»¶æ‹–è¿›idaè¿›è¡Œåˆ†æ</p><p><img src="/2022/02/13/hgame2022-week3-re/1644830479144.png"></p><p>æ‰¾åˆ°å…³é”®çš„å‡½æ•°ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯aes-cbcæ¨¡å¼ï¼ŒæŸ¥çœ‹AESå‡½æ•°è°ƒç”¨çš„å…³é”®å‚æ•°</p><p><img src="/2022/02/13/hgame2022-week3-re/1644830690500.png"></p><p>æ‰¾åˆ°keyå’Œivï¼Œå¯¹ä¸€äº›å…³é”®æ•°æ®æŸ¥çœ‹äº¤å‰å¼•ç”¨</p><p>å‘ç°å…¶ä»–åŠ å¯†å‡½æ•°</p><p><img src="/2022/02/13/hgame2022-week3-re/1644830877369.png"></p><p><img src="/2022/02/13/hgame2022-week3-re/1644830924673.png"></p><p>base64ï¼Œå†çœ‹çœ‹æœ‰æ²¡æœ‰é­”æ”¹ï¼Œå¯¹è¡¨æŸ¥çœ‹äº¤å‰å¼•ç”¨</p><p><img src="/2022/02/13/hgame2022-week3-re/1644830970190.png"></p><p>å‘ç°å¯¹keyå’Œivï¼Œä»¥åŠbase64è¡¨éƒ½è¿›è¡Œäº†å¼‚æˆ–æ“ä½œï¼Œå†™è„šæœ¬</p><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;#include&lt;string.h&gt;int main(){char key[32] = {0x7A, 0x65, 0x63, 0x64, 0x6F, 0x71, 0x6F, 0x7E, 0x7F, 0x62, 0x7D, 0x71, 0x7C, 0x6F, 0x7B, 0x75,0x69, 0x6F, 0x76, 0x7F, 0x62, 0x6F, 0x69, 0x7F, 0x65, 0x6F, 0x64, 0x7F, 0x6F, 0x74, 0x75, 0x73};char iv[16] = {0x06, 0x10, 0x0A, 0x20, 0x19, 0x16, 0x11, 0x1B,0x20, 0x12, 0x1A, 0x5E, 0x5E, 0x5E, 0x5E, 0x5E};char base64_table[63] = {0x79, 0x78, 0x7B, 0x7A, 0x7D, 0x7C, 0x7F, 0x7E, 0x71, 0x70, 0x08, 0x0B, 0x0A, 0x0D, 0x0C, 0x0F,0x0E, 0x01, 0x00, 0x03, 0x02, 0x05, 0x04, 0x07, 0x06, 0x19, 0x18, 0x1B, 0x1A, 0x1D, 0x1C, 0x1F,0x1E, 0x11, 0x10, 0x13, 0x28, 0x2B, 0x2A, 0x2D, 0x2C, 0x2F, 0x2E, 0x21, 0x20, 0x23, 0x22, 0x25,0x24, 0x27, 0x26, 0x39, 0x38, 0x3B, 0x3A, 0x3D, 0x3C, 0x3F, 0x3E, 0x31, 0x30, 0x33, 0x62};for (int i = 0; i &lt; 32; ++i){key[i] ^= 0x30;printf("%c", key[i]);}printf("\n");for (int i = 0; i &lt; 16; ++i){iv[i] ^= 0x7f;printf("%c", iv[i]);}printf("\n");for (int i = 0; i &lt; 63; ++i){base64_table[i] ^= 0x49;printf("%c", base64_table[i]);}return 0;}</code></pre><p><img src="/2022/02/13/hgame2022-week3-re/1644831095464.png"></p><p>æ‰¾åœ¨çº¿ç½‘ç«™è§£å¯†-<a href="https://www.iculture.cc/demo/cyberchef/">https://www.iculture.cc/demo/cyberchef/</a></p><p><img src="/2022/02/13/hgame2022-week3-re/1644831134385.png"></p><h1 id="Answerâ€™s-Windows"><a href="#Answerâ€™s-Windows" class="headerlink" title="Answerâ€™s Windows"></a>Answerâ€™s Windows</h1><h2 id="è€ƒç‚¹ï¼šQTé€†å‘ã€Base64é­”æ”¹"><a href="#è€ƒç‚¹ï¼šQTé€†å‘ã€Base64é­”æ”¹" class="headerlink" title="è€ƒç‚¹ï¼šQTé€†å‘ã€Base64é­”æ”¹"></a>è€ƒç‚¹ï¼šQTé€†å‘ã€Base64é­”æ”¹</h2><h2 id="åšé¢˜è¿‡ç¨‹-1"><a href="#åšé¢˜è¿‡ç¨‹-1" class="headerlink" title="åšé¢˜è¿‡ç¨‹"></a>åšé¢˜è¿‡ç¨‹</h2><p><img src="/2022/02/13/hgame2022-week3-re/1644826230792.png"></p><p>æ ¹æ®å­—ç¬¦ä¸²çš„æœç´¢åŠŸèƒ½ï¼Œå¿«é€Ÿå®šä½åˆ°å…³é”®å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°è¿›è¡Œäº†å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œæ‰€ä»¥å¾€ä¸Šæ‰¾åˆ°å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œçš„å‡½æ•°</p><p><img src="/2022/02/13/hgame2022-week3-re/1644826372187.png"></p><p><img src="/2022/02/13/hgame2022-week3-re/1644826396198.png"></p><p>ä»è¿™äº›å…³é”®ç‰¹å¾å¯ä»¥çŒœæµ‹æ˜¯base64ï¼Œä½†æ˜¯æ ¹æ®æœ€åçš„å­—ç¬¦ä¸²ï¼Œå¯çŸ¥é“åº”è¯¥æ˜¯å¯¹base64è¡¨è¿›è¡Œäº†ä¿®æ”¹</p><p>æŸ¥çœ‹äº¤å‰å¼•ç”¨</p><p><img src="/2022/02/13/hgame2022-week3-re/1644826515161.png"></p><p><img src="/2022/02/13/hgame2022-week3-re/1644826528911.png"></p><p>è¿™æ—¶å€™å¯ä»¥ç»•è¿‡åè°ƒè¯•è¿›è¡ŒåŠ¨è°ƒï¼Œå¾—åˆ°base64è¡¨</p><p><img src="/2022/02/13/hgame2022-week3-re/1644827711098.png"></p><p>ç„¶åå†™è„šæœ¬å³å¯</p><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;#include &lt;string.h&gt;char base64_table[] = {  0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x2A,  0x2B, 0x2C, 0x2D, 0x2E, 0x2F, 0x30, 0x31, 0x32, 0x33, 0x34,  0x35, 0x36, 0x37, 0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D, 0x3E,  0x3F, 0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48,  0x49, 0x4A, 0x4B, 0x4C, 0x4D, 0x4E, 0x4F, 0x50, 0x51, 0x52,  0x53, 0x54, 0x55, 0x56, 0x57, 0x58, 0x59, 0x5A, 0x5B, 0x5C,  0x5D, 0x5E, 0x5F, 0x60, 0x61};void base64_encode(char raw[], char encode[]){int code_len = strlen(raw);int final_len = 0;if (code_len % 3){final_len = (code_len / 3 + 1) * 4;}elsefinal_len = (code_len / 3) * 4;int i = 0, i_ = 0;for (; i &lt; code_len; i += 3, i_ += 4){encode[i_] = base64_table[raw[i] &gt;&gt; 2];encode[i_ + 1] = base64_table[((raw[i] &amp; 0x03) &lt;&lt; 4) | ((raw[i + 1]) &gt;&gt; 4)];encode[i_ + 2] = base64_table[((raw[i + 1] &amp; 0x0f) &lt;&lt; 2) | ((raw[i + 2] ) &gt;&gt; 6)];encode[i_ + 3] = base64_table[raw[i + 2] &amp; 0x3f];}if (code_len % 3 == 1){encode[i_ - 1] = '=';encode[i_ - 2] = '=';}else if (code_len % 3 == 2){encode[i_ - 1] = '=';}return;}int Findindex(char c){for (int i = 0; i &lt; strlen(base64_table); ++i){if (c == base64_table[i])return i;}}void base64_decode(char* encode, char* decode){int decode_len=0;int encode_len = strlen(encode);if (strstr(encode, "=="))decode_len = (encode_len / 4) * 3 - 2;else if (strstr(encode, "="))decode_len = (encode_len / 4) * 3 - 1;elsedecode_len = (encode_len / 4) * 3;int i = 0, i_ = 0;for (; i &lt; encode_len; i_ += 4, i += 3){decode[i] = (Findindex(encode[i_]) &lt;&lt; 2) | (Findindex(encode[i_ + 1]) &amp; 0x30) &gt;&gt; 4;decode[i + 1] = ((Findindex(encode[i_ + 1]) &amp; 0xf) &lt;&lt; 4) | ((Findindex(encode[i_ + 2]) &amp; 0x3c) &gt;&gt; 2);decode[i + 2] = ((Findindex(encode[i_ + 2]) &amp; 0x3) &lt;&lt; 6) | ((Findindex(encode[i_ + 3])));}decode[decode_len] = 0;return;}int main(){char raw[] = ";'&gt;B&lt;76\\=82@-8.@=T\"@-7ZU:8*F=X2J&lt;G&gt;@=W^@-8.@9D2T:49U@1aa";char encode[100] = { 0 };char decode[100] = { 0 };/*base64_encode(raw, encode);printf("%s", encode);*/base64_decode(raw, decode);printf("%s", decode);}</code></pre><h1 id="creakme3"><a href="#creakme3" class="headerlink" title="creakme3"></a>creakme3</h1><h2 id="è€ƒç‚¹ï¼šçŒ´å­æ’åº"><a href="#è€ƒç‚¹ï¼šçŒ´å­æ’åº" class="headerlink" title="è€ƒç‚¹ï¼šçŒ´å­æ’åº"></a>è€ƒç‚¹ï¼šçŒ´å­æ’åº</h2><h2 id="åšé¢˜è¿‡ç¨‹-2"><a href="#åšé¢˜è¿‡ç¨‹-2" class="headerlink" title="åšé¢˜è¿‡ç¨‹"></a>åšé¢˜è¿‡ç¨‹</h2><p>å¼€å§‹ç”¨7.0æ— æ³•åç¼–è¯‘ï¼Œä½¿ç”¨7.5å°±è¡Œ</p><p><img src="/2022/02/13/hgame2022-week3-re/1644827237787.png"></p><p>å› ä¸ºè¦æ»¡è¶³forçš„ç¬¬äºŒä¸ªæ¡ä»¶ï¼Œæ‰€ä»¥å°±æ˜¯è¿›è¡Œæ’åºï¼Œrandè¿™ä¸€æ­¥æ˜¯ä¸ºäº†é™åˆ¶æ•°ç»„å†…çš„å€¼å°äº88ï¼Œè€Œç¬¬äºŒä¸ªæ¡ä»¶æ˜¯ä»¥å¶æ•°ä¸‹æ ‡ä½œä¸ºç´¢å¼•ï¼Œå‰ä¸€ä¸ªè¦å¤§äºåä¸€ä¸ªï¼Œæ‰€ä»¥ä½¿ç”¨ç»“æ„ä½“æ•°ç»„</p><p>è„šæœ¬</p><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;struct data{int asc;int num;};struct data a[89]={{48,20093},{48,26557},{48,31304},{48,33442},{48,37694},{49,39960},{50,23295},{50,27863},{50,42698},{50,48505},{50,52925},{51,12874},{51,12946},{51,14597},{51,17041},{51,23262},{51,28319},{51,42282},{51,48693},{51,52067},{53,32571},{56,14612},{56,45741},{57,14554},{57,20048},{57,27138},{57,45327},{66,30949},{95,32502},{95,35235},{95,36541},{95,38371},{97,29658},{100,21388},{100,25403},{100,40604},{100,46987},{100,51302},{101,12974},{101,30329},{102,10983},{102,19818},{102,22280},{102,26128},{102,41560},{102,47116},{102,51333},{103,28938},{103,31988},{104,16246},{104,28715},{104,41966},{104,44368},{104,47815},{105,16420},{105,35362},{105,49237},{106,11090},{106,50823},{107,24320},{107,50199},{108,24962},{109,30171},{110,15457},{110,18838},{110,24001},{111,11638},{111,32023},{111,43291},{112,39661},{114,17872},{114,33895},{114,43869},{115,20611},{115,25122},{115,36243},{115,37434},{115,38686},{115,46266},{115,51077},{116,13656},{116,34493},{116,38712},{117,14096},{117,38777},{119,12095},{119,17629},{123,30945},{125,40770}};int main(){for (int i = 0; i &lt; 89; ++i){for (int j = i + 1; j &lt; 89; ++j){if (a[i].num &gt;= a[j].num){struct data tmp = a[i];a[i] = a[j];a[j] = tmp;}}}for (int i = 0; i &lt; 89; ++i){printf("%c", a[i].asc);}return 0;}</code></pre><h1 id="fishman"><a href="#fishman" class="headerlink" title="fishman"></a>fishman</h1><h2 id="è€ƒç‚¹ï¼špydé€†å‘ã€Blowfishåˆ†ç»„åŠ å¯†ç®—æ³•"><a href="#è€ƒç‚¹ï¼špydé€†å‘ã€Blowfishåˆ†ç»„åŠ å¯†ç®—æ³•" class="headerlink" title="è€ƒç‚¹ï¼špydé€†å‘ã€Blowfishåˆ†ç»„åŠ å¯†ç®—æ³•"></a>è€ƒç‚¹ï¼špydé€†å‘ã€Blowfishåˆ†ç»„åŠ å¯†ç®—æ³•</h2><h2 id="åšé¢˜è¿‡ç¨‹-3"><a href="#åšé¢˜è¿‡ç¨‹-3" class="headerlink" title="åšé¢˜è¿‡ç¨‹"></a>åšé¢˜è¿‡ç¨‹</h2><p>é™„ä»¶ç»™äº†ä¸€ä¸ªpydæ–‡ä»¶ï¼Œpydæ–‡ä»¶æ˜¯pythonçš„åŠ¨æ€åº“ï¼Œæ‹–è¿›idaåˆ†æ</p><p><img src="/2022/02/13/hgame2022-week3-re/1644835618562.png"></p><p>ä½¿ç”¨Findcryptæ’ä»¶æŸ¥çœ‹å‘ç°æ˜¯BlowfishåŠ å¯†ç®—æ³•</p><p>Blowfish-<a href="https://www.cnblogs.com/iBinary/p/14883752.html">https://www.cnblogs.com/iBinary/p/14883752.html</a></p><p><img src="/2022/02/13/hgame2022-week3-re/1644835958154.png"></p><p>åŠ å¯†åçš„æ•°æ®</p><p>å¯ä»¥åŠ¨è°ƒå¾—åˆ°Sç›’å’ŒPç›’çš„æ•°æ®å†å†™è„šæœ¬ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨ï¼Œåœ¨stringå‘ç°ä¸€ä¸ªç±»ä¼¼keyçš„å­—ç¬¦ä¸²</p><p><img src="/2022/02/13/hgame2022-week3-re/1644836282247.png"></p><h3 id="pydåŠ¨è°ƒ"><a href="#pydåŠ¨è°ƒ" class="headerlink" title="pydåŠ¨è°ƒ"></a>pydåŠ¨è°ƒ</h3><p><img src="/2022/02/13/hgame2022-week3-re/1644836332456.png"></p><p>è¿™æ˜¯é‡Œé¢çš„ä¸€äº›å‡½æ•°ï¼Œinitåˆå§‹åŒ–ï¼Œcheckæ£€æŸ¥å­—ç¬¦ä¸²</p><p><img src="/2022/02/13/hgame2022-week3-re/1644836466799.png"></p><p>cpåé¢æ˜¯pythonçš„ç‰ˆæœ¬ï¼Œè¿™é‡Œæ˜¯3.9ï¼ŒæŠŠpydæ–‡ä»¶ä¿®æ”¹åç§°ä¸ºfishman.pydï¼Œæ”¾å…¥D:\python3.9\Lib\site-packages\</p><p>è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">import fishmanimport osprint(os.getpid())flag=input("input your flag here:")fishman.init()print(fishman.check(flag))</code></pre><p><img src="/2022/02/13/hgame2022-week3-re/1644836396140.png"></p><p>ä¸‹å¥½æ–­ç‚¹å¼€å¯è°ƒè¯•</p><p><img src="/2022/02/13/hgame2022-week3-re/1644836650927.png"></p><p>è¿™æ˜¯çº¿ç¨‹ï¼Œå»idaï¼Œattach to process</p><p><img src="/2022/02/13/hgame2022-week3-re/1644836705113.png"></p><p>æ³¨æ„è¦å…ˆåœ¨idaä¸‹å¥½æ–­ç‚¹</p><p><img src="/2022/02/13/hgame2022-week3-re/1644836779973.png"></p><p>åœåœ¨äº†dllæ–‡ä»¶ï¼Œè¦F9ç»§ç»­è¿è¡Œ</p><p><img src="/2022/02/13/hgame2022-week3-re/1644836830306.png"></p><p>è¿™é‡Œå¤„äºRunningçŠ¶æ€ï¼Œå›å»pythonç¨‹åºï¼ŒF8å•æ­¥æ­¥è¿‡</p><p><img src="/2022/02/13/hgame2022-week3-re/1644836868323.png"></p><p>å›åˆ°idaåˆ†æ</p><p><img src="/2022/02/13/hgame2022-week3-re/1644836914886.png"></p><p>åœåœ¨äº†è¿™é‡Œï¼Œè¿™æ—¶å€™å·²ç»å®Œæˆå¯¹Sç›’å’ŒPç›’çš„åˆå§‹åŒ–ï¼Œæ‰¾åˆ°åæå–å‡ºæ¥å³å¯</p><p>è´´ä¸€ä¸‹å¤§ä½¬çš„è„šæœ¬</p><p>blowfish.cpp</p><pre class="language-c" data-language="c"><code class="language-c">#include"blowfish_head.h"#include&lt;stdio.h&gt;//å˜æ¢åçš„Pç›’unsigned long pbx[18] ={0x6af74079, 0xc87db4da, 0x064b77a4, 0x33a56687, 0x73924432, 0x3a78e859, 0xa0f9451e, 0x6e99ea5f, 0xcb62f79c,0xec009d50, 0x46b85709, 0x3b2bfdf6, 0xd0a0f937, 0x67c4c3e1, 0x80d02257, 0x4162d4de, 0x814dce61, 0x227bde9b};//å˜æ¢åçš„Sç›’unsigned long sbx[4][256] ={{ 0x857e5597, 0x326dad20, 0x2d507f8e, 0x2b80ba2c, 0xd711e661, 0x4b7e9667, 0x7a4b2509, 0x5117c0a3, 0x537791d2,0xbda0ec99, 0x9f5d600, 0x97d7453e, 0x6c3dede1, 0xefbec2ec, 0x31f20650, 0x86ea7ee1, 0x4a380c4e, 0x688500c0,0xc939e94b, 0xee64fe1f, 0xdae4a7bd, 0xafdfe274, 0xef95a497, 0xca5e8fc8, 0xa16220a, 0x9c85d82f, 0x3f411e1f,0x199cd133, 0x52ecbaa8, 0x68886557, 0xf8d4ca71, 0x729c0def, 0x5d6d4eb4, 0x550b9697, 0x77a9b569, 0xae8aacd5,0xa48c80d0, 0xb171f834, 0xd6828c5f, 0xf5219b37, 0x260e8a36, 0x9a8fbeba, 0xdf6ca01, 0x5f5ee56f, 0xc2e21a2f,0x87d75493, 0x87ef74ef, 0xfe01a2da, 0x8326e260, 0x7b3f0f, 0xc21ab19, 0x589f28be, 0x9ff0636, 0x2ac6affc, 0xb8e547d,0x91fa13e2, 0xde9a211f, 0x70b95314, 0x5879cad1, 0x8d38aa78, 0xffae559e, 0x132d25af, 0x4244c5f1, 0x7831cb8d,0x5625d8a2, 0xa99878b6, 0x44dfa664, 0x5b4e43c7, 0xfde79c18, 0xa8f89efb, 0x96a65669, 0xfa7ec977, 0x6438138b,0x63098e28, 0x7048ba4b, 0xc6f0e94, 0xabc7ae87, 0xdce4560, 0x2ee85291, 0xa7e24dd8, 0xdf0b5970, 0x3d8fcbe5,0x55b43ae4, 0x9eceee50, 0x6542e890, 0x4f70b16b, 0x778b58dc, 0xf3f830e4, 0x1b9d5867, 0x7076b41c, 0x6b8386de,0x8b148ce, 0x31c2fb7d, 0x42fe87c5, 0x108eb334, 0x7c40206, 0x2f783c90, 0xe593491f, 0x2b4ace07, 0xeba73a3c,0x44fa6586, 0x56ed2871, 0xd9b3ed4f, 0xb04d3c81, 0x93c1656c, 0xc8044fcb, 0x127ff622, 0x159d9dcf, 0x2fc79936,0x8549ee27, 0x262156cb, 0x721d3364, 0xf5a6f15e, 0x7fe8b137, 0x6cb075da, 0xfaa54cf4, 0x634519ec, 0xde79d57d,0x8b728797, 0x4b994f3e, 0x242eb5e6, 0x274f5cec, 0xc0f072e0, 0xb6928b6f, 0x8922972b, 0x2207de1e, 0xc0236ffa,0xc9dca5e5, 0x8d1286f, 0x90729fa3, 0x6a6ed134, 0x4369fae7, 0xf9ae5610, 0x13398b9e, 0xfdd59299, 0x21a3a98b,0xae6a4a80, 0x6b6e89a6, 0xce85be83, 0xda4c3800, 0x867af755, 0x26b3fb41, 0x96141cce, 0xf176999a, 0x1d844757,0xe27ce11f, 0x18638c21, 0x960ccbf2, 0xe4ccbbae, 0xaa0fab55, 0xf093bd6f, 0x4cb18fad, 0xf27853df, 0x5d5d925b,0xc389a234, 0xa9e9b90b, 0x6f06d9e4, 0xf0389646, 0xc75f5884, 0x9961dd6b, 0x44b1dc6a, 0x7ef092, 0xa4ca52a6,0x5342115d, 0x31d445bb, 0x6cb0b744, 0xd1abcf6, 0x95c6f259, 0xdf719b5d, 0xea51c785, 0xc7303253, 0x1e6a034e,0xf60989f1, 0x93f55b8d, 0xde786239, 0x9d01dfc5, 0xa4cd54ba, 0xfa60804a, 0x3da55ae7, 0x64d673a, 0x5ee1a39c,0x6daa769a, 0xec57802a, 0x7acdc0b0, 0xcdfedc6d, 0x72cb1321, 0x42d07041, 0xa45aa294, 0xdbf5b287, 0xca681d73,0x8d302710, 0x2b1ad68d, 0xc1c6521d, 0x4f40a81c, 0xf4762cb1, 0x8962117f, 0xe33e8bc2, 0xffa7db53, 0xd617f8af,0xd8b1563b, 0x1ed7d3b4, 0x9f998ca6, 0x1c32a736, 0x3513f35f, 0x7a4da8a8, 0x93f43a38, 0x6bf2eac7, 0xfe3041fd,0x8853f184, 0x81c00f3e, 0xc601a409, 0x1ceba826, 0x94bc26cd, 0xd07aaf4e, 0x46884d2, 0x5d4ec036, 0xe5587bf2,0xa3482f3f, 0xdbecc4b2, 0xe5a8e81e, 0x1287e1a3, 0x6e4ef861, 0xb4560ada, 0x5f18f3d5, 0xd9299202, 0xbab5cc00,0x18464f47, 0x58877430, 0xb4335a0a, 0x7a6e33e, 0xe62e23b4, 0x648e0251, 0xdd94b375, 0x719a409f, 0x5d45064d,0x243af927, 0xfbd3ab12, 0xdc74bb88, 0x21a563a8, 0x37b0a314, 0x5da98b1f, 0xfc4d4869, 0xbf0c7320, 0xebf308d3,0x714a3f9a, 0x6606297c, 0x28ff2689, 0xa6779947, 0xfb556d94, 0xb6413de2, 0x21519c0f, 0xb1052485, 0x69c2624b,0xde9cc548, 0xce36df75, 0x5dbfa8a7 },{ 0xaee3df14, 0x399d3136, 0x1c0b3ea1, 0xf8416210, 0x719b0d88, 0x908ce2e5, 0x623e46a2, 0xef7772ec, 0xdbc4da3a,0xe88f6e2e, 0x7fb80562, 0x1a33bfa7, 0xb972b27c, 0xfccb67ab, 0xb53bc933, 0xad99167e, 0x1831a7f0, 0x295e3c91,0x6afb6529, 0xb1d2c1eb, 0x38702ff1, 0xfb03fc16, 0xf85c29e8, 0x154bbcbf, 0xfc10c6d8, 0x1a07656, 0x9ec55090,0x52201a4a, 0x9b0ee83f, 0xe08b560a, 0xaff5a8bc, 0x35c5d6d7, 0x8d1f52f, 0x7b2becf0, 0xaf01ac97, 0x3b8700c9,0xfe56cea4, 0x1c4b14f6, 0xef86351c, 0x27a382c9, 0x28f51829, 0xcdeeee51, 0x3d73d792, 0x152c4a00, 0x7122ccea,0xbe459436, 0x624f6a81, 0xba728d6f, 0xdf7f103d, 0x7faf6a84, 0xd91174e1, 0xef9ca2f5, 0xa0675400, 0x9e0129,0x276f61d4, 0xf6e0bbb, 0x2f5e103d, 0x3d24363f, 0x36f1d769, 0xddabaa4d, 0xbd209d7b, 0x38898cda, 0x59aa0a47,0x3dc28a3b, 0x9374f915, 0x7164635e, 0xa09379f0, 0x462da24e, 0x7a6cd48d, 0xde20ce, 0xeac2f361, 0x9796cbc3,0x2cc87742, 0x2220d2f5, 0xab17e0c2, 0x16cb3b75, 0x5dc0d229, 0x7d14b8c8, 0x86ad060c, 0xfc1ac21c, 0xa25f8e37,0x23e553f1, 0xcfca2eb5, 0xda61f278, 0x7a6d0c2c, 0x10f72c33, 0xb9e7da31, 0xf0271ef1, 0xf6d8d0da, 0xccb9fb54,0x9c16adcc, 0x9c793e5d, 0x308dbae0, 0x8152f53d, 0xb8b02ea8, 0xbb7a73ef, 0x5b52b6e7, 0xda7691a1, 0x6f15166f,0x1bcf2abf, 0xed9eb801, 0xcc07f0d1, 0x30fd146a, 0xed552ed1, 0xfe280048, 0xca519936, 0xc6bb62d3, 0x78eb0ca9,0xde25bf1e, 0x377099d1, 0x9e3d9a2a, 0x58d4fdc5, 0x9ef6d4ba, 0x4c4b801c, 0x8d5c098c, 0x84cad315, 0x43b323ca,0xaff0262, 0x2b3be91f, 0xfd49761b, 0x93671206, 0x2460dd5e, 0x1328fc3, 0xa87f6e1a, 0xceebf4dc, 0x21f7d1d6,0x8dafb785, 0x1f058aa4, 0xf636282e, 0xf5d5c6a2, 0xdcb85ea1, 0xea4ce0f2, 0xb37fcdaa, 0xadb4cd12, 0xa51b34b3,0xb2aa712e, 0xa15f5bd, 0x617f127c, 0x7a5dbd16, 0x8aee5420, 0x4d0af701, 0xb2e113d9, 0xb4d09dcb, 0xd258e319,0x704ec155, 0x533c80be, 0x400c952d, 0xc0dd74a1, 0xa9e5599f, 0xada9e64, 0xa775ef10, 0x35abb495, 0x238b1eb3,0x5c8ea9e9, 0xd63ac5e, 0xecb22c6f, 0x836879b, 0xdb4958b0, 0x26606a34, 0x33fa456d, 0x91dc9940, 0xccbd103, 0x644cf9a7,0x80165230, 0xb0e45576, 0x4d28c64d, 0x8d9841cc, 0x3d42c9d1, 0x6fce26aa, 0xe5bd6421, 0xd0e1eb58, 0xfd61f403,0xdeff165, 0xd5a1bfb1, 0xb3323bbe, 0xdb641c02, 0xbfca7536, 0xb8f5820f, 0xda30db7b, 0xd76a9581, 0x61b8a87f,0x5d8410c2, 0x4b2df093, 0xc96447e9, 0xc4ba2487, 0xb24afc5a, 0x797db008, 0xc362253a, 0xc6bbe115, 0x1cc0ed71,0xabe73320, 0xc4364688, 0x5adef1c2, 0x59af22fb, 0xa9aca101, 0x4b5bac9b, 0xb121e519, 0xd8fcf69e, 0x2f0f0f89,0xef615692, 0xd9fac700, 0x6729f5e, 0x15b5965f, 0x83a0e48a, 0xd80cd549, 0xc85443c6, 0xdb051d9e, 0x8646780f,0x7e1bcd54, 0x7746aafa, 0xbc85c57a, 0x42430bc6, 0x36ab5fb6, 0x92e892ed, 0x87b8897f, 0xefcf526c, 0x6b10f264,0xe72e284, 0x6fe2966, 0x42f18a1f, 0xdff79c2a, 0x77fbe8e7, 0x942c9858, 0x637710f, 0xad12b3b8, 0xcf786ed1, 0xd7cda884,0x2cb1dcf1, 0x94f76ac0, 0xf7c4ebbe, 0x6d5591de, 0x6524ea76, 0x200d037e, 0xeb51ac71, 0x8b37601, 0xc9ac832,0x7721b2a4, 0xca23beee, 0x328c7019, 0xd27fd8c8, 0xc5be7325, 0xe9244524, 0x5b1ea918, 0x74c75201, 0x37621445,0xae75bef7, 0x174937dc, 0xf71c7cef, 0xf41d6ed3, 0x94c2d289, 0x7d68c2f0, 0xbddfcee6, 0x51d86ee8, 0x97379f95,0x4275b8c2, 0xf9b3122c },{ 0x6dbfa6dd, 0x6808c4be, 0x65fb06bd, 0xfde21a89, 0xf4c126b7, 0x438a1cc0, 0x850a843, 0x377114b2, 0x259c0fd,0x5881f166, 0x6e9fa190, 0x899a312e, 0x8001b123, 0x56d91bd5, 0x31b9a6db, 0x5a4f1940, 0x98140dee, 0x73ad8506,0x6649c267, 0x6fd7daa8, 0x682bb9e5, 0x7f9061dc, 0x27732a88, 0xa2755af7, 0x54b1b2ec, 0xc171fe6d, 0x33a31667,0x9afc41e2, 0x396678d5, 0x83cb861, 0xfc473f10, 0x575a023e, 0xfe11cafc, 0xe8ea4057, 0x1289aaa7, 0xa38ef05a,0x502c3f4a, 0xcb0928e9, 0x8d521829, 0x24c29091, 0xc07fbd37, 0x30cad78f, 0xcd8dba45, 0xc8ccbce8, 0xfdaee556,0x2a1fc86f, 0x8206edd4, 0x14c2ec89, 0xf0050d48, 0x31f5c320, 0xa5626fd9, 0x19ca606d, 0x65f46320, 0x43e58985,0xe3f777da, 0x4b9fa89e, 0xf3532d19, 0x1e63ee86, 0xa4c0f1b1, 0x56e691ed, 0xc79b5aa3, 0x1d005b01, 0x7ff86805,0xed4f0ce3, 0x167128ab, 0x96702d6b, 0x6f2cb666, 0x40d6b43d, 0x7f2e27f9, 0x25813783, 0xf06f47fe, 0xa1eb246e,0xe11c9c3f, 0x165237ab, 0xa9719981, 0xe0c072ef, 0xbc1430c8, 0x319018e0, 0x65323013, 0xa6337184, 0xe1c06cf0,0x2c99ecdc, 0xd682f79f, 0x2ebde8d2, 0xbdeca5a8, 0xb85ab458, 0xabc0be15, 0x5ed69b9d, 0x28bf53d3, 0x791d867b,0x86e6a98a, 0xba722e1c, 0x2311281a, 0xc8cce88d, 0x6c2d3743, 0xf868a752, 0xe0b86a8a, 0x70058bb9, 0xba926231,0x86a5a32c, 0x3e907ed6, 0x6f03f61e, 0xa87fbe48, 0xa09e8eaa, 0xdd78f5b, 0x622c29eb, 0x26cce112, 0x57215e0f,0xf9d9b37d, 0xc195133e, 0x703bd721, 0x27f1319b, 0xdccf0b77, 0xb73b7af4, 0xc9f75f9e, 0xf5c62fcb, 0x7293703,0xeed8b98f, 0x4a9bf102, 0x7349d5c7, 0xda6f8b23, 0x34529af2, 0x968579a9, 0x986d4e5f, 0x8d1903a2, 0x8960df2e,0x4dccb15c, 0x6a87f919, 0x8bc8e948, 0x82c8274c, 0x52f8bb80, 0xb3b5512c, 0x6b51a116, 0x16abf8e9, 0x99e48bf6,0xea03be4e, 0xa0766e91, 0x75e2c7e, 0x237be6a5, 0x8c1bd482, 0x473541f5, 0xc4af608b, 0xed686762, 0x1bf0cfc1,0x4844f0ca, 0x6a9a1980, 0x9d01dbf5, 0x10660435, 0x72fb5e04, 0xbf3de5a3, 0x21fbb319, 0xd303ed2f, 0xa30d610a,0x76ff38bb, 0x87136fca, 0xa4d11a77, 0xe6c197fd, 0x4e6bc1d1, 0xf2a87aa9, 0xcc795622, 0xb82be2b4, 0x77487ed2,0x2e7719ad, 0x142854f3, 0xe501258d, 0xb8556c95, 0x4e1a1309, 0x3d74b894, 0xfc1b626d, 0xcff955ec, 0x33bdc46f,0xed6091ef, 0x645f4f02, 0x7707e28a, 0x556f385a, 0xf8758408, 0xb06b762e, 0xa698d074, 0x46147980, 0x22668afc,0xdc1f5fa9, 0x245dc1d5, 0x32c87ded, 0xcfa4f49d, 0x734187b5, 0x700bc670, 0x97beeab3, 0x70f6ad54, 0xf0d6535d,0x76e34811, 0xb734677, 0x7ddbb9d3, 0x2bd695ab, 0xdb2daa29, 0x35c9f605, 0xfc4be706, 0x6e44a54b, 0xa96c5fbe,0x51e51ba6, 0xc4ebe8c7, 0xe103a24a, 0x842b0bac, 0xdfac2d6d, 0x1aed355d, 0xbdeafbde, 0x32338f9d, 0xaa634582,0xe152c83a, 0x84be8504, 0x46291ed, 0x7b863e96, 0xdb6776f8, 0x20f815f2, 0xa82af75d, 0xab76c0f5, 0xd550efa2,0xfd0330f1, 0x22e1fab0, 0x5f4407a3, 0x9b8e9e11, 0xeb1cadde, 0x3d104b1f, 0xc3054713, 0x982eb7fb, 0x543314da,0x13ae6d5d, 0x56594d93, 0x7af9ddb3, 0x5dbd0b3c, 0xeca553d0, 0x5f892e42, 0xdc466104, 0xf3b8fe09, 0xea63cc0e,0xe8187fa1, 0xf587d222, 0x762e3246, 0xe3134afd, 0xc8a909a3, 0x2a1b8843, 0xbcf88b37, 0x106d829d, 0xbc6cb72b,0xba700358, 0x4419c67b, 0x298e5b99, 0x53633710, 0xb4676dfb, 0x5003bfdd, 0x4b1f3fd6, 0xbff5676e, 0xfe221749,0x22769dec, 0xfa874d3f, 0xe3ab93a1, 0x7e7eac49 },{ 0xda47873d, 0xb4067196, 0x35629fff, 0x5f9ba741, 0xfc3b885c, 0x7db96275, 0x4be65d7c, 0xaac5aaff, 0xc48e069f,0xa2b51d88, 0x68efc326, 0x5dc94059, 0xf8fa7b3d, 0xc3e21cc2, 0xa619a16f, 0x46dec824, 0x399fea6, 0x8fc7db62,0x184569be, 0xc5f04731, 0x90c0dea5, 0xc180bf5f, 0xfccbd6c9, 0x49d7a598, 0x96425151, 0xe53c49fb, 0x15713840,0xcea6a8a0, 0x5c360e6b, 0x8278ef53, 0xa45ce852, 0xaf1fa60d, 0xd1d357d4, 0xcac8c677, 0x1258a65b, 0x561cc841,0xe73da602, 0x907e2447, 0xe62e297f, 0x107a743, 0xb0d19719, 0x84bb247a, 0xf8077268, 0xd5f63d60, 0xd9a141de,0x3486e6a4, 0xbe1052bf, 0x5be4fa46, 0xe792c9c8, 0xb9fbf3b0, 0xcfd36c94, 0x726aa896, 0x683cd337, 0x392a533a,0x223657a2, 0xf83da285, 0x16c1a03f, 0x68bdbcf5, 0xada3c5ab, 0x124148a8, 0xe7d2a95c, 0xd11922ac, 0x4c6899fd,0x7d8edf38, 0x118e9247, 0x15c6f2f0, 0x9056dd9f, 0x33520052, 0x7204913c, 0x3171d62d, 0x25d9ff0b, 0x8b629a57,0xc3ea9218, 0x699e2abf, 0xa9ff8e0f, 0x14dd1c3e, 0xee95bbe7, 0xa2e277c9, 0xd3966991, 0xce4fb1c6, 0x62f9c9,0x24bee229, 0xc677cc3e, 0x2163ca36, 0xbf6dd3f1, 0x7ae4222f, 0x4322f038, 0x692542df, 0x6692aca0, 0xf6d4946f,0x89154cfd, 0x9f6a7dbc, 0x104ea9f0, 0x89e3289, 0x87c95990, 0xf945a420, 0xb6a20072, 0x5b630e87, 0x848636c0,0xa48bb210, 0x4d5494bb, 0x7b7fb94f, 0xc48841b7, 0x422a2e4, 0x6d915a09, 0xcdabb5a5, 0xa36a9dd3, 0x2b321655,0xe7bd69cf, 0x8c5a8dd8, 0x74615473, 0x8c143ade, 0x6cb1ce59, 0x4396f842, 0xfccbf901, 0xf39018b0, 0x576ba9f5,0x97aeb15d, 0x6f7df74, 0x30f10bb9, 0x214789d7, 0xdf5edc71, 0xcdd4d413, 0x4e26b481, 0xa96771c4, 0xfbbf9600,0x61b03c10, 0xb41ec41b, 0x50e85e2c, 0x9ae79ae9, 0x1bffa793, 0x18402dde, 0x3a896084, 0x604aca05, 0xf0370269,0x83f6b326, 0xfb64099a, 0xabf943bf, 0xe9aa8b99, 0x54ec3adb, 0xa56b3a46, 0x71c05f89, 0x4a7f1444, 0xdf991094,0x8f5efd28, 0x9ad00ad5, 0x3cbee3c, 0xf5898fc4, 0x692ba57, 0x1928304a, 0x2978de0f, 0x64f85786, 0x62b4f525,0xda78ad05, 0xb3da431b, 0xdde89dde, 0xcc7da3d9, 0xbde46885, 0xd26c42cf, 0xa7850e7c, 0xff3b73d, 0xd60665a5,0x825b2d8c, 0xbce1ba7, 0x12be55de, 0x7cf29faa, 0x71a29eca, 0xbd067b1a, 0x2e33857, 0xf0c7e782, 0x9ac9f181,0x61d9b196, 0x288412eb, 0x756010ba, 0x20f99e06, 0x67e6cb96, 0xd1efb6, 0x1a4dfffb, 0x9d097c31, 0x6890b138,0xa162f385, 0x5038a02a, 0xdcca2edc, 0xd68af382, 0xed5c9bb, 0xe88cf6c4, 0x4c031e98, 0xca08127b, 0xc67a831f,0x306fb3f6, 0x9d7315c5, 0x2c72ae76, 0xdd3b3ecc, 0x2ab71490, 0x6e79ef13, 0xe6aa6316, 0x3729bfbc, 0xa13c9bea,0xa4fa53c, 0xdbafeec6, 0x57a11cc2, 0x8f1be1ba, 0x542a4d3b, 0x8f9c90c4, 0xa2b3ad9f, 0x8951b50, 0xda0641dd,0xd7cdf19b, 0xebe79e9b, 0x7d6ae548, 0x2ae7eb6f, 0x3ebefb7f, 0xb9cf555d, 0x22b46357, 0x963e79b5, 0x81729e6f,0xa0657b30, 0x297d0ea1, 0x2d722676, 0xd7c263c7, 0x8fd31545, 0x74b4d545, 0xc9ddb768, 0xd7af1a95, 0x3b41452d,0xeaa84874, 0x3094af86, 0xc71461f6, 0x8cd49c9b, 0x9d6f96b1, 0x9b45bb4c, 0x58742714, 0x29b19a6a, 0xa85bddc6,0xb1e0cf54, 0xb55e81d4, 0xcb219b85, 0xcea74b66, 0xd28a041e, 0xe28c4803, 0x490de006, 0x19bb91b1, 0x14d67500,0x80243406, 0x1ed8b3e, 0xef5636b3, 0x956f13bd, 0x9ae34304, 0xaea37a2c, 0xc90fe0b9, 0x2301fb8f, 0x55716d77,0xc50297f7, 0x3cabc6a4, 0xa0764bb0, 0xcf38a2a2 } };/*Pç›’å’ŒSç›’æ ¹æ®å¯†é’¥è¿›è¡Œå˜æ¢å› ä¸ºæˆ‘ä»¬ç›´æ¥æ›¿æ¢æˆå˜æ¢åçš„Pç›’å’ŒSç›’ï¼Œæ‰€ä»¥ä¸éœ€è¦è°ƒç”¨*/void getkey(char *keytext){int i = -1, j = 0;unsigned long key[18];while (keytext[++i]);while (i&lt;72) keytext[i++] = 0;memcpy(key, keytext, 72);for (i = 0; i&lt;18; i++) pbx[i] ^= key[i];key[0] = key[1] = 0;for (i = 0; i&lt;18; i += 2){blowfish_encrypt(key, key);memcpy(&amp;pbx[i], key, 8);}for (i = 0; i&lt;4; i++){for (j = 0; j&lt;256; j += 2){blowfish_encrypt(key, key);memcpy(&amp;sbx[i][j], key, 8);}}}void blowfish_encrypt(void *protext, void *ciptext){int i = 0;unsigned long x[2], temp;memcpy(x, protext, 8);for (i = 0; i&lt;16; i++){x[0] ^= pbx[i];x[1] ^= f(x[0]);temp = x[1];x[1] = x[0];x[0] = temp;}temp = x[1];x[1] = x[0];x[0] = temp;x[0] ^= pbx[17];x[1] ^= pbx[16];memcpy(ciptext, x, 8);printf("0x%x,0x%x\n", x[0], x[1]);}void blowfish_decrypt(void *protext, void *ciptext){int i = 0;unsigned long x[2], temp;memcpy(x, ciptext, 8);for (i = 17; i &gt;= 2; i--){x[0] ^= pbx[i];x[1] ^= f(x[0]);temp = x[1];x[1] = x[0];x[0] = temp;}temp = x[1];x[1] = x[0];x[0] = temp;x[0] ^= pbx[0];x[1] ^= pbx[1];memcpy(protext, x, 8);printf("0x%x,0x%x\n", x[0], x[1]);}unsigned long f(unsigned long x){unsigned long a, b, c, d;a = (x &amp; 0xff000000) &gt;&gt; 24;b = (x &amp; 0x00ff0000) &gt;&gt; 16;c = (x &amp; 0x0000ff00) &gt;&gt; 8;d = (x &amp; 0x000000ff) &gt;&gt; 0;return(((sbx[0][a] + sbx[1][b]) ^ sbx[2][c]) + sbx[3][d]);}int main(){char data[] = "abcdefgh";char cipher[]={ 0xBF, 0x4E, 0x6F, 0x54, 0x7B, 0x93, 0xED, 0xB4 };//0x6d616768,0x30447b65//0x7E, 0xA0, 0xD2, 0x82, 0xDD, 0xEF, 0xD3, 0x13-&gt;0x7530795f,0x3465725f//0x0F, 0xAE, 0x09, 0x22, 0x61, 0xDF, 0x4E, 0x59-&gt;0x5f563131,0x336b3131//0x2C, 0x78, 0x33, 0xB9, 0x32, 0xE5, 0x07, 0x1C-&gt;0x7456395f,0x7d6e6f68//blowfish_encrypt(data, cipher);blowfish_decrypt(data, cipher);}</code></pre><p>å°†å¤šç»„æ•°æ®åˆ†åˆ«ä»£å…¥è¿›è¡Œè¿ç®—ï¼Œå†è½¬ä¸ºå­—ç¬¦ä¸²å³å¯ï¼Œæ³¨æ„å°ç«¯åº</p><p>blowfish_head.h</p><pre class="language-c" data-language="c"><code class="language-c">#ifndef BLOWFISHH#define BLOWFISHH#include&lt;stdlib.h&gt;#include&lt;string.h&gt;void blowfish_encrypt(void*, void*);void blowfish_decrypt(void*, void*);void getkey(char*);unsigned long f(unsigned long);#endif#pragma once</code></pre><h3 id="å¦ä¸€ä¸ªè„šæœ¬"><a href="#å¦ä¸€ä¸ªè„šæœ¬" class="headerlink" title="å¦ä¸€ä¸ªè„šæœ¬"></a>å¦ä¸€ä¸ªè„šæœ¬</h3><pre class="language-c" data-language="c"><code class="language-c">#include "BlowFish.h"#include &lt;string.h&gt;#include &lt;stdio.h&gt;// using namespace std;int BlowFishInit(BLOWFISH_CTX* blowCtx, unsigned char* key, unsigned intkeylen){//è®¾ç½®ä¼ å…¥çš„CTXä¸­çš„SBOXå€¼for (int Row = 0; Row &lt; 4; Row++){for (int Col = 0; Col &lt; 256; Col++){blowCtx-&gt;sbox[Row][Col] = ORIG_S[Row][Col];}}/*è®¾ç½®pbox1.å¾ªç¯18è½®2.æ¯è½®éƒ½è®¾ç½®ctx.pboxå€¼ä¸data ^3.data = *(DWORD*)key[0] key[1].....*/int KeyIndex = 0;for (int index = 0; index &lt; N + 2; index++){unsigned int data = 0;//å¡«å……data å°†keyçš„å­—ç¬¦è®¾ç½®åˆ°dataå½“ä¸­for (int k = 0; k &lt; 4; k++){//é€šè¿‡ç§»ä½è®¾ç½®æ¯ä¸ªå­—ç¬¦data = (data &lt;&lt; 8) | key[KeyIndex];KeyIndex++;//å¦‚æœè¶…å‡ºäº†keyé•¿åº¦ é‚£ä¹ˆkeyè¦ä»å¼€å§‹if (KeyIndex &gt;= keylen)KeyIndex = 0;}//å¦åˆ™ä¸æ»¡è¶³blowCtx-&gt;pbox[index] = ORIG_P[index] ^ data;}//å¯¹ä¸€ä¸ª64ä½0 è¿›è¡ŒåŠ å¯†ã€‚åŠ å¯†ç»“æœçš„è¾“å‡ºè®¾ç½®åˆ°pbox[i]ä¸pbox[i+1]ä¸­unsigned int Data1 = 0;unsigned int Data2 = 0;for (int i = 0; i &lt; N + 2; i += 2){BlowFish_Encry(blowCtx, &amp;Data1, &amp;Data2);blowCtx-&gt;pbox[i] = Data1;blowCtx-&gt;pbox[i + 1] = Data2;}//åˆå§‹åŒ–Sboxfor (int i = 0; i &lt; 4; i++){for (int j = 0; j &lt; 256; j += 2){BlowFish_Encry(blowCtx, &amp;Data1, &amp;Data2);blowCtx-&gt;sbox[i][j] = Data1;blowCtx-&gt;sbox[i][j + 1] = Data2;}}return 1;}//unsigned int F(PBLOWFISH_CTX blowCtx, unsigned int Data)//{//// unsigned int a, b, c, d;// /*// åˆ©ç”¨ä½è¿ç®— å–å‡ºä¸‹æ ‡å€¼// *///// a = (Data &gt;&gt; 24) &amp; 0xFF;// b = (Data &gt;&gt; 16) &amp; 0xFF;// c = (Data &gt;&gt; 8) &amp; 0xFf;// d = Data &amp; 0xFF;////// int TempValue = blowCtx-&gt;sbox[0][a] + blowCtx-&gt;sbox[1][b];// TempValue = TempValue ^ blowCtx-&gt;sbox[2][c];// TempValue = TempValue + blowCtx-&gt;sbox[3][d];// //å…¬å¼ ((a+b)^c)+d// return TempValue;//}static unsigned long F(BLOWFISH_CTX* ctx, unsigned long x) {unsigned short a, b, c, d;unsigned long y;/* d = (unsigned short)(x &amp; 0xFF);x &gt;&gt;= 8;c = (unsigned short)(x &amp; 0xFF);x &gt;&gt;= 8;b = (unsigned short)(x &amp; 0xFF);x &gt;&gt;= 8;a = (unsigned short)(x &amp; 0xFF);//éƒ½å¯ä»¥ä½¿ç”¨*/a = (x &gt;&gt; 24) &amp; 0xFF;b = (x &gt;&gt; 16) &amp; 0xFF;c = (x &gt;&gt; 8) &amp; 0xFf;d = x &amp; 0xFF;y = ctx-&gt;sbox[0][a] + ctx-&gt;sbox[1][b];y = y ^ ctx-&gt;sbox[2][c];y = y + ctx-&gt;sbox[3][d];return y;}void BlowFish_Encry(PBLOWFISH_CTX blowCtx, unsigned int* left, unsigned int*right){unsigned long Xl;unsigned long Xr;unsigned long temp;short i;//åŠ å¯†éƒ¨åˆ†é¦–å…ˆå°†å…¶åˆ†ä¸ºleftè·Ÿrightä¸¤ç»„ã€‚ æ¯ä¸€ç»„åˆ†åˆ«32ä½Xl = *left;Xr = *right;for (i = 0; i &lt; N; ++i) {Xl = Xl ^ blowCtx-&gt;pbox[i];Xr = F(blowCtx, Xl) ^ Xr;temp = Xl;Xl = Xr; //äº¤æ¢å·¦å³çš„å€¼ã€‚ l = R r= l ç»§ç»­ä¸‹ä¸€è½®å¾ªç¯ã€‚æ€»å…±16è½®Xr = temp;}temp = Xl;Xl = Xr; //16è½®å®Œæ¯•ä¹‹åäº¤æ¢å˜é‡Xr = temp;Xr = Xr ^ blowCtx-&gt;pbox[N]; //æœ€åè¿›è¡Œä¸€æ¬¡ç–‘æˆ–Xl = Xl ^ blowCtx-&gt;pbox[N + 1];*left = Xl;*right = Xr;}void BlowFish_Decrypt(PBLOWFISH_CTX blowCtx, unsigned int* left, unsigned int*right){unsigned int Xl = *left;unsigned int Xr = *right;//å€’ç€å¾ªç¯for (int i = N + 1; i &gt; 1; --i){Xl = Xl ^ blowCtx-&gt;pbox[i];Xr = Xr ^ F(blowCtx, Xl);//ç»§ç»­å·¦å³äº¤æ¢unsigned int temp = Xl;Xl = Xr;Xr = temp;}//æœ€åä¸€è½®ç»§ç»­äº¤æ¢unsigned int temp = Xl;Xl = Xr;Xr = temp;//è¿”è¿˜åŸXr = Xr ^ blowCtx-&gt;pbox[1];Xl = Xl ^ blowCtx-&gt;pbox[0];//è®¾ç½®å˜é‡è¿”å›*left = Xl;*right = Xr;}// int main()// {// unsigned int L = 1, R = 2;// BLOWFISH_CTX ctx;// BlowFishInit(&amp;ctx,(unsigned char*)"IBinary",strlen("IBinary"));// BlowFish_Encry(&amp;ctx, &amp;L, &amp;R);// BlowFish_Decrypt(&amp;ctx, &amp;L, &amp;R);// }void main(void) {// unsigned int L = 1, R = 2;unsigned int L1 = 0x546F4EBF, R1 = 0x0B4ED937B;BLOWFISH_CTX ctx;BlowFishInit(&amp;ctx, (unsigned char*)"LET_U_D", 7);BlowFish_Decrypt(&amp;ctx, &amp;L1, &amp;R1);printf("%x %x\n", L1, R1);unsigned int L2 = 0x82D2A07E, R2 = 0x13D3EFDD;BlowFishInit(&amp;ctx, (unsigned char*)"LET_U_D", 7);BlowFish_Decrypt(&amp;ctx, &amp;L2, &amp;R2);printf("%x %x\n", L2, R2);unsigned int L3 = 0x2209AE0F, R3 = 0x594EDF61;BlowFishInit(&amp;ctx, (unsigned char*)"LET_U_D", 7);BlowFish_Decrypt(&amp;ctx, &amp;L3, &amp;R3);printf("%x %x\n", L3, R3);unsigned int L4 = 0x0B933782C, R4 = 0x1C07E532;BlowFishInit(&amp;ctx, (unsigned char*)"LET_U_D", 7);BlowFish_Decrypt(&amp;ctx, &amp;L4, &amp;R4);printf("%x %x\n", L4, R4);}</code></pre><p>BlowFish.h</p><pre class="language-c" data-language="c"><code class="language-c">#pragma once#pragma once/*ä½¿ç”¨BlowFishè¿›è¡ŒåŠ è§£å¯†*///å®šä¹‰å…¨å±€æ—§çš„pbox sbox éƒ½æ˜¯æ ¹æ®å°æ•°æ¥çš„ã€‚#define N 16static const unsigned long ORIG_P[16 + 2] = {0x243F6A88L, 0x85A308D3L, 0x13198A2EL, 0x03707344L,0xA4093822L, 0x299F31D0L, 0x082EFA98L, 0xEC4E6C89L,0x452821E6L, 0x38D01377L, 0xBE5466CFL, 0x34E90C6CL,0xC0AC29B7L, 0xC97C50DDL, 0x3F84D5B5L, 0xB5470917L,0x9216D5D9L, 0x8979FB1BL};static const unsigned long ORIG_S[4][256] = {{ 0xD1310BA6L, 0x98DFB5ACL, 0x2FFD72DBL, 0xD01ADFB7L,0xB8E1AFEDL, 0x6A267E96L, 0xBA7C9045L, 0xF12C7F99L,0x24A19947L, 0xB3916CF7L, 0x0801F2E2L, 0x858EFC16L,0x636920D8L, 0x71574E69L, 0xA458FEA3L, 0xF4933D7EL,0x0D95748FL, 0x728EB658L, 0x718BCD58L, 0x82154AEEL,0x7B54A41DL, 0xC25A59B5L, 0x9C30D539L, 0x2AF26013L,0xC5D1B023L, 0x286085F0L, 0xCA417918L, 0xB8DB38EFL,0x8E79DCB0L, 0x603A180EL, 0x6C9E0E8BL, 0xB01E8A3EL,0xD71577C1L, 0xBD314B27L, 0x78AF2FDAL, 0x55605C60L,0xE65525F3L, 0xAA55AB94L, 0x57489862L, 0x63E81440L,0x55CA396AL, 0x2AAB10B6L, 0xB4CC5C34L, 0x1141E8CEL,0xA15486AFL, 0x7C72E993L, 0xB3EE1411L, 0x636FBC2AL,0x2BA9C55DL, 0x741831F6L, 0xCE5C3E16L, 0x9B87931EL,0xAFD6BA33L, 0x6C24CF5CL, 0x7A325381L, 0x28958677L,0x3B8F4898L, 0x6B4BB9AFL, 0xC4BFE81BL, 0x66282193L,0x61D809CCL, 0xFB21A991L, 0x487CAC60L, 0x5DEC8032L,0xEF845D5DL, 0xE98575B1L, 0xDC262302L, 0xEB651B88L,0x23893E81L, 0xD396ACC5L, 0x0F6D6FF3L, 0x83F44239L,0x2E0B4482L, 0xA4842004L, 0x69C8F04AL, 0x9E1F9B5EL,0x21C66842L, 0xF6E96C9AL, 0x670C9C61L, 0xABD388F0L,0x6A51A0D2L, 0xD8542F68L, 0x960FA728L, 0xAB5133A3L,0x6EEF0B6CL, 0x137A3BE4L, 0xBA3BF050L, 0x7EFB2A98L,0xA1F1651DL, 0x39AF0176L, 0x66CA593EL, 0x82430E88L,0x8CEE8619L, 0x456F9FB4L, 0x7D84A5C3L, 0x3B8B5EBEL,0xE06F75D8L, 0x85C12073L, 0x401A449FL, 0x56C16AA6L,0x4ED3AA62L, 0x363F7706L, 0x1BFEDF72L, 0x429B023DL,0x37D0D724L, 0xD00A1248L, 0xDB0FEAD3L, 0x49F1C09BL,0x075372C9L, 0x80991B7BL, 0x25D479D8L, 0xF6E8DEF7L,0xE3FE501AL, 0xB6794C3BL, 0x976CE0BDL, 0x04C006BAL,0xC1A94FB6L, 0x409F60C4L, 0x5E5C9EC2L, 0x196A2463L,0x68FB6FAFL, 0x3E6C53B5L, 0x1339B2EBL, 0x3B52EC6FL,0x6DFC511FL, 0x9B30952CL, 0xCC814544L, 0xAF5EBD09L,0xBEE3D004L, 0xDE334AFDL, 0x660F2807L, 0x192E4BB3L,0xC0CBA857L, 0x45C8740FL, 0xD20B5F39L, 0xB9D3FBDBL,0x5579C0BDL, 0x1A60320AL, 0xD6A100C6L, 0x402C7279L,0x679F25FEL, 0xFB1FA3CCL, 0x8EA5E9F8L, 0xDB3222F8L,0x3C7516DFL, 0xFD616B15L, 0x2F501EC8L, 0xAD0552ABL,0x323DB5FAL, 0xFD238760L, 0x53317B48L, 0x3E00DF82L,0x9E5C57BBL, 0xCA6F8CA0L, 0x1A87562EL, 0xDF1769DBL,0xD542A8F6L, 0x287EFFC3L, 0xAC6732C6L, 0x8C4F5573L,0x695B27B0L, 0xBBCA58C8L, 0xE1FFA35DL, 0xB8F011A0L,0x10FA3D98L, 0xFD2183B8L, 0x4AFCB56CL, 0x2DD1D35BL,0x9A53E479L, 0xB6F84565L, 0xD28E49BCL, 0x4BFB9790L,0xE1DDF2DAL, 0xA4CB7E33L, 0x62FB1341L, 0xCEE4C6E8L,0xEF20CADAL, 0x36774C01L, 0xD07E9EFEL, 0x2BF11FB4L,0x95DBDA4DL, 0xAE909198L, 0xEAAD8E71L, 0x6B93D5A0L,0xD08ED1D0L, 0xAFC725E0L, 0x8E3C5B2FL, 0x8E7594B7L,0x8FF6E2FBL, 0xF2122B64L, 0x8888B812L, 0x900DF01CL,0x4FAD5EA0L, 0x688FC31CL, 0xD1CFF191L, 0xB3A8C1ADL,0x2F2F2218L, 0xBE0E1777L, 0xEA752DFEL, 0x8B021FA1L,0xE5A0CC0FL, 0xB56F74E8L, 0x18ACF3D6L, 0xCE89E299L,0xB4A84FE0L, 0xFD13E0B7L, 0x7CC43B81L, 0xD2ADA8D9L,0x165FA266L, 0x80957705L, 0x93CC7314L, 0x211A1477L,0xE6AD2065L, 0x77B5FA86L, 0xC75442F5L, 0xFB9D35CFL,0xEBCDAF0CL, 0x7B3E89A0L, 0xD6411BD3L, 0xAE1E7E49L,0x00250E2DL, 0x2071B35EL, 0x226800BBL, 0x57B8E0AFL,0x2464369BL, 0xF009B91EL, 0x5563911DL, 0x59DFA6AAL,0x78C14389L, 0xD95A537FL, 0x207D5BA2L, 0x02E5B9C5L,0x83260376L, 0x6295CFA9L, 0x11C81968L, 0x4E734A41L,0xB3472DCAL, 0x7B14A94AL, 0x1B510052L, 0x9A532915L,0xD60F573FL, 0xBC9BC6E4L, 0x2B60A476L, 0x81E67400L,0x08BA6FB5L, 0x571BE91FL, 0xF296EC6BL, 0x2A0DD915L,0xB6636521L, 0xE7B9F9B6L, 0xFF34052EL, 0xC5855664L,0x53B02D5DL, 0xA99F8FA1L, 0x08BA4799L, 0x6E85076AL },{ 0x4B7A70E9L, 0xB5B32944L, 0xDB75092EL, 0xC4192623L,0xAD6EA6B0L, 0x49A7DF7DL, 0x9CEE60B8L, 0x8FEDB266L,0xECAA8C71L, 0x699A17FFL, 0x5664526CL, 0xC2B19EE1L,0x193602A5L, 0x75094C29L, 0xA0591340L, 0xE4183A3EL,0x3F54989AL, 0x5B429D65L, 0x6B8FE4D6L, 0x99F73FD6L,0xA1D29C07L, 0xEFE830F5L, 0x4D2D38E6L, 0xF0255DC1L,0x4CDD2086L, 0x8470EB26L, 0x6382E9C6L, 0x021ECC5EL,0x09686B3FL, 0x3EBAEFC9L, 0x3C971814L, 0x6B6A70A1L,0x687F3584L, 0x52A0E286L, 0xB79C5305L, 0xAA500737L,0x3E07841CL, 0x7FDEAE5CL, 0x8E7D44ECL, 0x5716F2B8L,0xB03ADA37L, 0xF0500C0DL, 0xF01C1F04L, 0x0200B3FFL,0xAE0CF51AL, 0x3CB574B2L, 0x25837A58L, 0xDC0921BDL,0xD19113F9L, 0x7CA92FF6L, 0x94324773L, 0x22F54701L,0x3AE5E581L, 0x37C2DADCL, 0xC8B57634L, 0x9AF3DDA7L,0xA9446146L, 0x0FD0030EL, 0xECC8C73EL, 0xA4751E41L,0xE238CD99L, 0x3BEA0E2FL, 0x3280BBA1L, 0x183EB331L,0x4E548B38L, 0x4F6DB908L, 0x6F420D03L, 0xF60A04BFL,0x2CB81290L, 0x24977C79L, 0x5679B072L, 0xBCAF89AFL,0xDE9A771FL, 0xD9930810L, 0xB38BAE12L, 0xDCCF3F2EL,0x5512721FL, 0x2E6B7124L, 0x501ADDE6L, 0x9F84CD87L,0x7A584718L, 0x7408DA17L, 0xBC9F9ABCL, 0xE94B7D8CL,0xEC7AEC3AL, 0xDB851DFAL, 0x63094366L, 0xC464C3D2L,0xEF1C1847L, 0x3215D908L, 0xDD433B37L, 0x24C2BA16L,0x12A14D43L, 0x2A65C451L, 0x50940002L, 0x133AE4DDL,0x71DFF89EL, 0x10314E55L, 0x81AC77D6L, 0x5F11199BL,0x043556F1L, 0xD7A3C76BL, 0x3C11183BL, 0x5924A509L,0xF28FE6EDL, 0x97F1FBFAL, 0x9EBABF2CL, 0x1E153C6EL,0x86E34570L, 0xEAE96FB1L, 0x860E5E0AL, 0x5A3E2AB3L,0x771FE71CL, 0x4E3D06FAL, 0x2965DCB9L, 0x99E71D0FL,0x803E89D6L, 0x5266C825L, 0x2E4CC978L, 0x9C10B36AL,0xC6150EBAL, 0x94E2EA78L, 0xA5FC3C53L, 0x1E0A2DF4L,0xF2F74EA7L, 0x361D2B3DL, 0x1939260FL, 0x19C27960L,0x5223A708L, 0xF71312B6L, 0xEBADFE6EL, 0xEAC31F66L,0xE3BC4595L, 0xA67BC883L, 0xB17F37D1L, 0x018CFF28L,0xC332DDEFL, 0xBE6C5AA5L, 0x65582185L, 0x68AB9802L,0xEECEA50FL, 0xDB2F953BL, 0x2AEF7DADL, 0x5B6E2F84L,0x1521B628L, 0x29076170L, 0xECDD4775L, 0x619F1510L,0x13CCA830L, 0xEB61BD96L, 0x0334FE1EL, 0xAA0363CFL,0xB5735C90L, 0x4C70A239L, 0xD59E9E0BL, 0xCBAADE14L,0xEECC86BCL, 0x60622CA7L, 0x9CAB5CABL, 0xB2F3846EL,0x648B1EAFL, 0x19BDF0CAL, 0xA02369B9L, 0x655ABB50L,0x40685A32L, 0x3C2AB4B3L, 0x319EE9D5L, 0xC021B8F7L,0x9B540B19L, 0x875FA099L, 0x95F7997EL, 0x623D7DA8L,0xF837889AL, 0x97E32D77L, 0x11ED935FL, 0x16681281L,0x0E358829L, 0xC7E61FD6L, 0x96DEDFA1L, 0x7858BA99L,0x57F584A5L, 0x1B227263L, 0x9B83C3FFL, 0x1AC24696L,0xCDB30AEBL, 0x532E3054L, 0x8FD948E4L, 0x6DBC3128L,0x58EBF2EFL, 0x34C6FFEAL, 0xFE28ED61L, 0xEE7C3C73L,0x5D4A14D9L, 0xE864B7E3L, 0x42105D14L, 0x203E13E0L,0x45EEE2B6L, 0xA3AAABEAL, 0xDB6C4F15L, 0xFACB4FD0L,0xC742F442L, 0xEF6ABBB5L, 0x654F3B1DL, 0x41CD2105L,0xD81E799EL, 0x86854DC7L, 0xE44B476AL, 0x3D816250L,0xCF62A1F2L, 0x5B8D2646L, 0xFC8883A0L, 0xC1C7B6A3L,0x7F1524C3L, 0x69CB7492L, 0x47848A0BL, 0x5692B285L,0x095BBF00L, 0xAD19489DL, 0x1462B174L, 0x23820E00L,0x58428D2AL, 0x0C55F5EAL, 0x1DADF43EL, 0x233F7061L,0x3372F092L, 0x8D937E41L, 0xD65FECF1L, 0x6C223BDBL,0x7CDE3759L, 0xCBEE7460L, 0x4085F2A7L, 0xCE77326EL,0xA6078084L, 0x19F8509EL, 0xE8EFD855L, 0x61D99735L,0xA969A7AAL, 0xC50C06C2L, 0x5A04ABFCL, 0x800BCADCL,0x9E447A2EL, 0xC3453484L, 0xFDD56705L, 0x0E1E9EC9L,0xDB73DBD3L, 0x105588CDL, 0x675FDA79L, 0xE3674340L,0xC5C43465L, 0x713E38D8L, 0x3D28F89EL, 0xF16DFF20L,0x153E21E7L, 0x8FB03D4AL, 0xE6E39F2BL, 0xDB83ADF7L },{ 0xE93D5A68L, 0x948140F7L, 0xF64C261CL, 0x94692934L,0x411520F7L, 0x7602D4F7L, 0xBCF46B2EL, 0xD4A20068L,0xD4082471L, 0x3320F46AL, 0x43B7D4B7L, 0x500061AFL,0x1E39F62EL, 0x97244546L, 0x14214F74L, 0xBF8B8840L,0x4D95FC1DL, 0x96B591AFL, 0x70F4DDD3L, 0x66A02F45L,0xBFBC09ECL, 0x03BD9785L, 0x7FAC6DD0L, 0x31CB8504L,0x96EB27B3L, 0x55FD3941L, 0xDA2547E6L, 0xABCA0A9AL,0x28507825L, 0x530429F4L, 0x0A2C86DAL, 0xE9B66DFBL,0x68DC1462L, 0xD7486900L, 0x680EC0A4L, 0x27A18DEEL,0x4F3FFEA2L, 0xE887AD8CL, 0xB58CE006L, 0x7AF4D6B6L,0xAACE1E7CL, 0xD3375FECL, 0xCE78A399L, 0x406B2A42L,0x20FE9E35L, 0xD9F385B9L, 0xEE39D7ABL, 0x3B124E8BL,0x1DC9FAF7L, 0x4B6D1856L, 0x26A36631L, 0xEAE397B2L,0x3A6EFA74L, 0xDD5B4332L, 0x6841E7F7L, 0xCA7820FBL,0xFB0AF54EL, 0xD8FEB397L, 0x454056ACL, 0xBA489527L,0x55533A3AL, 0x20838D87L, 0xFE6BA9B7L, 0xD096954BL,0x55A867BCL, 0xA1159A58L, 0xCCA92963L, 0x99E1DB33L,0xA62A4A56L, 0x3F3125F9L, 0x5EF47E1CL, 0x9029317CL,0xFDF8E802L, 0x04272F70L, 0x80BB155CL, 0x05282CE3L,0x95C11548L, 0xE4C66D22L, 0x48C1133FL, 0xC70F86DCL,0x07F9C9EEL, 0x41041F0FL, 0x404779A4L, 0x5D886E17L,0x325F51EBL, 0xD59BC0D1L, 0xF2BCC18FL, 0x41113564L,0x257B7834L, 0x602A9C60L, 0xDFF8E8A3L, 0x1F636C1BL,0x0E12B4C2L, 0x02E1329EL, 0xAF664FD1L, 0xCAD18115L,0x6B2395E0L, 0x333E92E1L, 0x3B240B62L, 0xEEBEB922L,0x85B2A20EL, 0xE6BA0D99L, 0xDE720C8CL, 0x2DA2F728L,0xD0127845L, 0x95B794FDL, 0x647D0862L, 0xE7CCF5F0L,0x5449A36FL, 0x877D48FAL, 0xC39DFD27L, 0xF33E8D1EL,0x0A476341L, 0x992EFF74L, 0x3A6F6EABL, 0xF4F8FD37L,0xA812DC60L, 0xA1EBDDF8L, 0x991BE14CL, 0xDB6E6B0DL,0xC67B5510L, 0x6D672C37L, 0x2765D43BL, 0xDCD0E804L,0xF1290DC7L, 0xCC00FFA3L, 0xB5390F92L, 0x690FED0BL,0x667B9FFBL, 0xCEDB7D9CL, 0xA091CF0BL, 0xD9155EA3L,0xBB132F88L, 0x515BAD24L, 0x7B9479BFL, 0x763BD6EBL,0x37392EB3L, 0xCC115979L, 0x8026E297L, 0xF42E312DL,0x6842ADA7L, 0xC66A2B3BL, 0x12754CCCL, 0x782EF11CL,0x6A124237L, 0xB79251E7L, 0x06A1BBE6L, 0x4BFB6350L,0x1A6B1018L, 0x11CAEDFAL, 0x3D25BDD8L, 0xE2E1C3C9L,0x44421659L, 0x0A121386L, 0xD90CEC6EL, 0xD5ABEA2AL,0x64AF674EL, 0xDA86A85FL, 0xBEBFE988L, 0x64E4C3FEL,0x9DBC8057L, 0xF0F7C086L, 0x60787BF8L, 0x6003604DL,0xD1FD8346L, 0xF6381FB0L, 0x7745AE04L, 0xD736FCCCL,0x83426B33L, 0xF01EAB71L, 0xB0804187L, 0x3C005E5FL,0x77A057BEL, 0xBDE8AE24L, 0x55464299L, 0xBF582E61L,0x4E58F48FL, 0xF2DDFDA2L, 0xF474EF38L, 0x8789BDC2L,0x5366F9C3L, 0xC8B38E74L, 0xB475F255L, 0x46FCD9B9L,0x7AEB2661L, 0x8B1DDF84L, 0x846A0E79L, 0x915F95E2L,0x466E598EL, 0x20B45770L, 0x8CD55591L, 0xC902DE4CL,0xB90BACE1L, 0xBB8205D0L, 0x11A86248L, 0x7574A99EL,0xB77F19B6L, 0xE0A9DC09L, 0x662D09A1L, 0xC4324633L,0xE85A1F02L, 0x09F0BE8CL, 0x4A99A025L, 0x1D6EFE10L,0x1AB93D1DL, 0x0BA5A4DFL, 0xA186F20FL, 0x2868F169L,0xDCB7DA83L, 0x573906FEL, 0xA1E2CE9BL, 0x4FCD7F52L,0x50115E01L, 0xA70683FAL, 0xA002B5C4L, 0x0DE6D027L,0x9AF88C27L, 0x773F8641L, 0xC3604C06L, 0x61A806B5L,0xF0177A28L, 0xC0F586E0L, 0x006058AAL, 0x30DC7D62L,0x11E69ED7L, 0x2338EA63L, 0x53C2DD94L, 0xC2C21634L,0xBBCBEE56L, 0x90BCB6DEL, 0xEBFC7DA1L, 0xCE591D76L,0x6F05E409L, 0x4B7C0188L, 0x39720A3DL, 0x7C927C24L,0x86E3725FL, 0x724D9DB9L, 0x1AC15BB4L, 0xD39EB8FCL,0xED545578L, 0x08FCA5B5L, 0xD83D7CD3L, 0x4DAD0FC4L,0x1E50EF5EL, 0xB161E6F8L, 0xA28514D9L, 0x6C51133CL,0x6FD5C7E7L, 0x56E14EC4L, 0x362ABFCEL, 0xDDC6C837L,0xD79A3234L, 0x92638212L, 0x670EFA8EL, 0x406000E0L },{ 0x3A39CE37L, 0xD3FAF5CFL, 0xABC27737L, 0x5AC52D1BL,0x5CB0679EL, 0x4FA33742L, 0xD3822740L, 0x99BC9BBEL,0xD5118E9DL, 0xBF0F7315L, 0xD62D1C7EL, 0xC700C47BL,0xB78C1B6BL, 0x21A19045L, 0xB26EB1BEL, 0x6A366EB4L,0x5748AB2FL, 0xBC946E79L, 0xC6A376D2L, 0x6549C2C8L,0x530FF8EEL, 0x468DDE7DL, 0xD5730A1DL, 0x4CD04DC6L,0x2939BBDBL, 0xA9BA4650L, 0xAC9526E8L, 0xBE5EE304L,0xA1FAD5F0L, 0x6A2D519AL, 0x63EF8CE2L, 0x9A86EE22L,0xC089C2B8L, 0x43242EF6L, 0xA51E03AAL, 0x9CF2D0A4L,0x83C061BAL, 0x9BE96A4DL, 0x8FE51550L, 0xBA645BD6L,0x2826A2F9L, 0xA73A3AE1L, 0x4BA99586L, 0xEF5562E9L,0xC72FEFD3L, 0xF752F7DAL, 0x3F046F69L, 0x77FA0A59L,0x80E4A915L, 0x87B08601L, 0x9B09E6ADL, 0x3B3EE593L,0xE990FD5AL, 0x9E34D797L, 0x2CF0B7D9L, 0x022B8B51L,0x96D5AC3AL, 0x017DA67DL, 0xD1CF3ED6L, 0x7C7D2D28L,0x1F9F25CFL, 0xADF2B89BL, 0x5AD6B472L, 0x5A88F54CL,0xE029AC71L, 0xE019A5E6L, 0x47B0ACFDL, 0xED93FA9BL,0xE8D3C48DL, 0x283B57CCL, 0xF8D56629L, 0x79132E28L,0x785F0191L, 0xED756055L, 0xF7960E44L, 0xE3D35E8CL,0x15056DD4L, 0x88F46DBAL, 0x03A16125L, 0x0564F0BDL,0xC3EB9E15L, 0x3C9057A2L, 0x97271AECL, 0xA93A072AL,0x1B3F6D9BL, 0x1E6321F5L, 0xF59C66FBL, 0x26DCF319L,0x7533D928L, 0xB155FDF5L, 0x03563482L, 0x8ABA3CBBL,0x28517711L, 0xC20AD9F8L, 0xABCC5167L, 0xCCAD925FL,0x4DE81751L, 0x3830DC8EL, 0x379D5862L, 0x9320F991L,0xEA7A90C2L, 0xFB3E7BCEL, 0x5121CE64L, 0x774FBE32L,0xA8B6E37EL, 0xC3293D46L, 0x48DE5369L, 0x6413E680L,0xA2AE0810L, 0xDD6DB224L, 0x69852DFDL, 0x09072166L,0xB39A460AL, 0x6445C0DDL, 0x586CDECFL, 0x1C20C8AEL,0x5BBEF7DDL, 0x1B588D40L, 0xCCD2017FL, 0x6BB4E3BBL,0xDDA26A7EL, 0x3A59FF45L, 0x3E350A44L, 0xBCB4CDD5L,0x72EACEA8L, 0xFA6484BBL, 0x8D6612AEL, 0xBF3C6F47L,0xD29BE463L, 0x542F5D9EL, 0xAEC2771BL, 0xF64E6370L,0x740E0D8DL, 0xE75B1357L, 0xF8721671L, 0xAF537D5DL,0x4040CB08L, 0x4EB4E2CCL, 0x34D2466AL, 0x0115AF84L,0xE1B00428L, 0x95983A1DL, 0x06B89FB4L, 0xCE6EA048L,0x6F3F3B82L, 0x3520AB82L, 0x011A1D4BL, 0x277227F8L,0x611560B1L, 0xE7933FDCL, 0xBB3A792BL, 0x344525BDL,0xA08839E1L, 0x51CE794BL, 0x2F32C9B7L, 0xA01FBAC9L,0xE01CC87EL, 0xBCC7D1F6L, 0xCF0111C3L, 0xA1E8AAC7L,0x1A908749L, 0xD44FBD9AL, 0xD0DADECBL, 0xD50ADA38L,0x0339C32AL, 0xC6913667L, 0x8DF9317CL, 0xE0B12B4FL,0xF79E59B7L, 0x43F5BB3AL, 0xF2D519FFL, 0x27D9459CL,0xBF97222CL, 0x15E6FC2AL, 0x0F91FC71L, 0x9B941525L,0xFAE59361L, 0xCEB69CEBL, 0xC2A86459L, 0x12BAA8D1L,0xB6C1075EL, 0xE3056A0CL, 0x10D25065L, 0xCB03A442L,0xE0EC6E0EL, 0x1698DB3BL, 0x4C98A0BEL, 0x3278E964L,0x9F1F9532L, 0xE0D392DFL, 0xD3A0342BL, 0x8971F21EL,0x1B0A7441L, 0x4BA3348CL, 0xC5BE7120L, 0xC37632D8L,0xDF359F8DL, 0x9B992F2EL, 0xE60B6F47L, 0x0FE3F11DL,0xE54CDA54L, 0x1EDAD891L, 0xCE6279CFL, 0xCD3E7E6FL,0x1618B166L, 0xFD2C1D05L, 0x848FD2C5L, 0xF6FB2299L,0xF523F357L, 0xA6327623L, 0x93A83531L, 0x56CCCD02L,0xACF08162L, 0x5A75EBB5L, 0x6E163697L, 0x88D273CCL,0xDE966292L, 0x81B949D0L, 0x4C50901BL, 0x71C65614L,0xE6C6C7BDL, 0x327A140AL, 0x45E1D006L, 0xC3F27B9AL,0xC9AA53FDL, 0x62A80F00L, 0xBB25BFE2L, 0x35BDD2F6L,0x71126905L, 0xB2040222L, 0xB6CBCF7CL, 0xCD769C2BL,0x53113EC0L, 0x1640E3D3L, 0x38ABBD60L, 0x2547ADF0L,0xBA38209CL, 0xF746CE76L, 0x77AFA1C5L, 0x20756060L,0x85CBFE4EL, 0x8AE88DD8L, 0x7AAAF9B0L, 0x4CF9AA7EL,0x1948C25CL, 0x02FB8A8CL, 0x01C36AE4L, 0xD6EBE1F9L,0x90D4F869L, 0xA65CDEA0L, 0x3F09252DL, 0xC208E69FL,0xB74E6132L, 0xCE77E25BL, 0x578FDFE3L, 0x3AC372E6L }};#define N 16//å®šä¹‰åˆå§‹åŒ–éœ€è¦ç”¨åˆ°çš„åŠ å¯†ç»“æ„typedef struct _BLOWFISH_CTX{//å®šä¹‰åˆå§‹åŒ–çš„pbox ä»¥åŠ sbox åœ¨ç¨‹åºä¸­è¿›è¡Œåˆå§‹åŒ–unsigned int pbox[N + 2]; //æ€»å…±18unsigned int sbox[4][256];}BLOWFISH_CTX, * PBLOWFISH_CTX;/*åˆå§‹åŒ–å‡½æ•° æ­¤å‡½æ•°åŠŸèƒ½å¦‚ä¸‹1.æ¥å—key ä¸ keylenå‚æ•°ï¼ˆå½“ç„¶keylenï¼‰å¯ä»¥è‡ªå·±è®¡ç®—2.åˆå§‹åŒ–sbox å°†å…¨å±€çš„sboxçš„å†…å®¹å¤åˆ¶åˆ°CTXä¸­çš„sboxä¸­3.åˆå§‹åŒ–pbox pboxçš„åˆå§‹åŒ–æ–¹æ³•å¦‚ä¸‹1.è¿­ä»£18è®ºã€‚ç„¶åæ¯ä¸€è½®éƒ½è®¾ç½®CTXçš„pbox2.CTX.pboxéœ€è¦ä½¿ç”¨å…¨å±€pbox ^ data3.dataæ˜¯ä¸€ä¸ªå››å­—èŠ‚æ•´æ•°ã€‚å…¶ä¸­å­˜å‚¨çš„å°±æ˜¯keyçš„å››ä¸ªå­—èŠ‚ã€‚key = "12345678abc"æ¯ä¸€è½®ä¸­ data = "1234"data = "5678"data = "abc1" //æ³¨æ„è¿™é‡Œå½“è¶…å‡ºkeylençš„æ—¶å€™ã€‚ dataè·å–çš„keyè¦ä»0å¼€å§‹ã€‚ã€‚ã€‚ã€‚*/int BlowFishInit(BLOWFISH_CTX* blowCtx, unsigned char* key, unsigned int keylen);/*Få‡½æ•°Få‡½æ•°æ˜¯å°†ä¸€ä¸ª32ä½æ•°åˆ†åˆ«è¿›è¡Œæ‹†åˆ†ã€‚ æ‹†åˆ†ä¸ºå››ç»„ã€‚ æ¯ä¸€ç»„éƒ½ä½œä¸ºsboxçš„ç´¢å¼•å€¼ç„¶åè¿›è¡Œä¸‹åˆ—è¿ç®—(ï¼ˆs1[a] + s2[b]) ^ s3[c]) + s4[d]åœ¨ç¼–ç¨‹ä¸­sboxæ˜¯æ•°ç»„æ˜¯ä»é›¶å¼€å§‹ã€‚ æ‰€ä»¥s1 å¯¹åº”s[0] s2å¯¹åº”s[1]åœ¨ç¼–ç¨‹ä¸­æ€»ç»“ä¸‹å…¬å¼ï¼štemap = s[0][a] + s[1][b]teamp = temp ^ s[2][c]'temp = temp + s[3][d]ç®€å•çš„è®°ä½å°±æ˜¯ ((a+b) ^ c)+d;å½“ç„¶æ¯ä¸ªéƒ½å¯¹åº”ä¸‹æ ‡ä¸º 0 1 2 3 s[0][a] s[1][b] s[2][c] s[3][d]æœ€åè¿”å›ç»“æœå€¼ return temp*/static unsigned long F(BLOWFISH_CTX* ctx, unsigned long x);//signed int F(PBLOWFISH_CTX blowCtx,unsigned int Data);/*åŠ å¯†å‡½æ•°ï¼šé¦–æ¬¡ç”¨åœ¨åˆå§‹åŒ–ä¸­æ˜¯å¯¹ä¸€ä¸ª64ä½0è¿›è¡ŒåŠ å¯†ã€‚ä¸€æ¬¡åŠ å¯†å…«ä¸ªå­—èŠ‚æ ¸å¿ƒæ€æƒ³ä¸º åŠ å¯†å·¦è¾¹ä¸å³è¾¹æ•°æ®å·¦è¾¹æ•°æ®ç›´æ¥ ^ PBOXå³è¾¹æ•°æ® = å³è¾¹æ•°æ® ^ f(å·¦è¾¹æ•°æ®ï¼‰ç„¶åè¿›è¡Œäº¤æ¢ã€‚ä»¥ä¸Šæ˜¯16è½®çš„äº¤æ¢å‰©ä¸‹ä¸€è½®åˆ™æ˜¯å·¦è¾¹ = å·¦è¾¹^PBOX[N+1]å³è¾¹ = å³è¾¹^pbox[N]æœ€åè®¾ç½®ç›¸å…³æ•°å€¼*/void BlowFish_Encry(PBLOWFISH_CTX blowCtx, unsigned int* left, unsigned int*right);/*è·ŸåŠ å¯†ä¸€æ ·ã€‚åªä¸è¿‡ç»“æœç›¸åæ­¥éª¤å¦‚ä¸‹ï¼šé¦–å…ˆéå†ä»æœ€åä¸€è½®å¼€å§‹é€æ¬¡é€’å‡æœ€åä¸€è½®æ•°æ® å³è¾¹= å³è¾¹^PBOX[1] å·¦è¾¹æ•°æ® = å·¦è¾¹æ•°æ® ^pbox[0]*/void BlowFish_Decrypt(PBLOWFISH_CTX blowCtx, unsigned int* left, unsigned int*right);</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Competition </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AES</title>
      <link href="/2022/02/08/AES/"/>
      <url>/2022/02/08/AES/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€å•ä»‹ç»"><a href="#ç®€å•ä»‹ç»" class="headerlink" title="ç®€å•ä»‹ç»"></a>ç®€å•ä»‹ç»</h1><p>AESå±äºåˆ†ç»„åŠ å¯†ç®—æ³•ï¼Œå³åŠ è§£å¯†éƒ½æ˜¯ä½¿ç”¨åŒä¸€å¯†é’¥ï¼Œä½†æ˜¯æ˜¯åˆ†ä¸ºå‡ ç»„è¿›è¡ŒåŠ å¯†</p><p>æ˜æ–‡é•¿åº¦å›ºå®šä¸º128ä½çš„å€æ•°</p><p>å¯†é’¥é•¿åº¦å¯ä»¥æ˜¯128ã€192ã€256ä½</p><h1 id="åŠ å¯†æµç¨‹"><a href="#åŠ å¯†æµç¨‹" class="headerlink" title="åŠ å¯†æµç¨‹"></a>åŠ å¯†æµç¨‹</h1><p><img src="/2022/02/08/AES/%E6%9C%AA%E5%91%BD%E5%90%8D%E6%96%87%E4%BB%B6.png"></p><h2 id="åˆå§‹å˜æ¢"><a href="#åˆå§‹å˜æ¢" class="headerlink" title="åˆå§‹å˜æ¢"></a>åˆå§‹å˜æ¢</h2><p>è¿™é‡Œä»¥16å­—èŠ‚ä¸ºä¾‹å­</p><p>æ˜æ–‡æ”¾å…¥çŸ©é˜µä¸­</p><p><img src="/2022/02/08/AES/1644303811694.png"></p><p>å­å¯†é’¥æ”¾å…¥çŸ©é˜µï¼Œè¿™é‡Œæœ‰çœç•¥å·æ˜¯å› ä¸ºåé¢ä¼šæ ¹æ®å­å¯†é’¥è¿›è¡Œå¯†é’¥æ‰©å±•ï¼Œåˆå§‹å˜æ¢å–å¾—æ˜¯å¯†é’¥æ‰©å±•åçš„ç¬¬0è½®å¯†é’¥</p><p><img src="/2022/02/08/AES/1644303864629.png"></p><p>æ˜æ–‡çŸ©é˜µå’Œå­å¯†é’¥çŸ©é˜µè¿›è¡Œå¼‚æˆ–</p><p>å¯¹åº”ä½ç½®è¿›è¡Œé€å­—èŠ‚å¼‚æˆ–</p><p><img src="/2022/02/08/AES/1644304005507.png"></p><h2 id="å­—èŠ‚ä»£æ¢"><a href="#å­—èŠ‚ä»£æ¢" class="headerlink" title="å­—èŠ‚ä»£æ¢"></a>å­—èŠ‚ä»£æ¢</h2><p>AESç®—æ³•ä¼šç”Ÿæˆä¸€ä¸ªSboxç›’ç”¨äºå­—èŠ‚ä»£æ¢</p><p>ä»£æ¢æ–¹æ³•ï¼šå‡å¦‚æŸä¸ªå­—èŠ‚æ˜¯D4ï¼Œé‚£ä¹ˆæ‰¾åˆ°D4çš„ä½ç½®ï¼Œxyåæ ‡ç»“åˆå°±æ˜¯ä»£æ¢åçš„ç»“æœï¼Œè¿™é‡Œä¸º19</p><p><img src="/2022/02/08/AES/1644304381876.png"></p><h2 id="è¡Œç§»ä½"><a href="#è¡Œç§»ä½" class="headerlink" title="è¡Œç§»ä½"></a>è¡Œç§»ä½</h2><p><img src="/2022/02/08/AES/1644304702612.png"></p><h2 id="åˆ—æ··åˆ"><a href="#åˆ—æ··åˆ" class="headerlink" title="åˆ—æ··åˆ"></a>åˆ—æ··åˆ</h2><p>å°†è¾“å…¥çš„4Ã—4çŸ©é˜µ<strong>å·¦ä¹˜</strong>ä¸€ä¸ªç»™å®šçš„4Ã—4çŸ©é˜µ</p><p>è¿™é‡Œçš„+å’ŒÃ—å’ŒçŸ©é˜µé‡Œé¢çš„è¿ç®—ä¸åŒï¼Œå¾…ä¼šä»‹ç»</p><p>ç»™å®šçš„æ­£çŸ©é˜µ</p><p><img src="/2022/02/08/AES/1644304934448.png"></p><p>è¿‡ç¨‹</p><p><img src="/2022/02/08/AES/1644305201031.png"></p><h3 id="åˆ—æ··åˆè®¡ç®—"><a href="#åˆ—æ··åˆè®¡ç®—" class="headerlink" title="åˆ—æ··åˆè®¡ç®—"></a>åˆ—æ··åˆè®¡ç®—</h3><p>åŸºäºæœ‰é™åŸŸçš„äºŒç»´è¿ç®—</p><h4 id="çŸ©é˜µçš„è¿ç®—"><a href="#çŸ©é˜µçš„è¿ç®—" class="headerlink" title="çŸ©é˜µçš„è¿ç®—"></a>çŸ©é˜µçš„è¿ç®—</h4><p><img src="/2022/02/08/AES/1644308359054.png"></p><p>è¦å¾—åˆ°ç¬¬ä¸€ä¸ªæ•°çš„ç»“æœï¼Œè¦å…ˆå°†ç¬¬ä¸€ä¸ªçŸ©é˜µçš„ç¬¬ä¸€è¡Œä¸ç¬¬äºŒä¸ªçŸ©é˜µçš„ç¬¬ä¸€åˆ—è¿›è¡Œä¹˜æ³•ï¼Œæœ€åç›¸åŠ </p><p>è€Œåœ¨åˆ—æ··åˆä¸­ï¼ŒåŠ æ³•è¢«æ›¿æ¢æˆäº†å¼‚æˆ–</p><p>ä¹˜æ³•ä¹Ÿè¢«ä¿®æ”¹äº†</p><p><img src="/2022/02/08/AES/1644308799475.png"></p><p>è¿™é‡Œä»¥ç¬¬ä¸€ä¸ªæ•°ä¸ºä¾‹</p><p>02Ã—d4+03Ã—bf+01Ã—5d+01Ã—30ï¼Œè¿™é‡Œçš„+æ˜¯å¼‚æˆ–</p><p>02Ã—d4è¿‡ç¨‹</p><p>00000010Ã—11010100ï¼Œå› ä¸ºd4é¦–ä½æ˜¯1ï¼Œæ‰€ä»¥ç»“æœä¸º10101000^00011011,å¾—åˆ°10110011</p><p>åŒç†çš„åˆ°ç¬¬ä¸€ä¸ªæ•°ä¸º04</p><h2 id="è½®å¯†é’¥åŠ "><a href="#è½®å¯†é’¥åŠ " class="headerlink" title="è½®å¯†é’¥åŠ "></a>è½®å¯†é’¥åŠ </h2><p>æ¯ä¸€åˆ—è¿›è¡Œè¿›è¡Œå¼‚æˆ–æ“ä½œ</p><p><img src="/2022/02/08/AES/1644306385450.png"></p><h2 id="å¯†é’¥æ‰©å±•"><a href="#å¯†é’¥æ‰©å±•" class="headerlink" title="å¯†é’¥æ‰©å±•"></a>å¯†é’¥æ‰©å±•</h2><p>é€šè¿‡å­å¯†é’¥ç”Ÿæˆåè½®éœ€è¦çš„å¯†é’¥</p><h3 id="iä¸æ˜¯4çš„å€æ•°"><a href="#iä¸æ˜¯4çš„å€æ•°" class="headerlink" title="iä¸æ˜¯4çš„å€æ•°"></a>iä¸æ˜¯4çš„å€æ•°</h3><p>ç¬¬iåˆ—è®¡ç®—å…¬å¼ï¼š</p><p>W[i]=W[i-4]^W[i-1]</p><p><img src="/2022/02/08/AES/1644307284515.png"></p><h3 id="iæ˜¯4çš„å€æ•°"><a href="#iæ˜¯4çš„å€æ•°" class="headerlink" title="iæ˜¯4çš„å€æ•°"></a>iæ˜¯4çš„å€æ•°</h3><p>W[i]=W[i-4]^T(W[i-1])</p><p>Tå‡½æ•°åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼šå­—å¾ªç¯ã€å­—èŠ‚ä»£æ¢ã€è½®å¸¸é‡å¼‚æˆ–</p><h4 id="å­—å¾ªç¯"><a href="#å­—å¾ªç¯" class="headerlink" title="å­—å¾ªç¯"></a>å­—å¾ªç¯</h4><p>å°†ä¸€åˆ—ä¸­çš„å››ä¸ªå­—èŠ‚å¾ªç¯å·¦ç§»ä¸€ä¸ªå­—èŠ‚ï¼Œå³è¾“å…¥[b0,b1,b2,b3]å˜æ¢æˆ[b1,b2,b3,b0],ç„¶åæ”¾åœ¨ä¸€åˆ—ä¸­</p><p><img src="/2022/02/08/AES/1644307546072.png"></p><h4 id="å­—èŠ‚ä»£æ¢-1"><a href="#å­—èŠ‚ä»£æ¢-1" class="headerlink" title="å­—èŠ‚ä»£æ¢"></a>å­—èŠ‚ä»£æ¢</h4><p>å¯¹å­—å¾ªç¯çš„ç»“æœä½¿ç”¨Sç›’è¿›è¡Œå­—èŠ‚ä»£æ¢</p><p><img src="/2022/02/08/AES/1644307740839.png"></p><h4 id="è½®å¸¸é‡å¼‚æˆ–"><a href="#è½®å¸¸é‡å¼‚æˆ–" class="headerlink" title="è½®å¸¸é‡å¼‚æˆ–"></a>è½®å¸¸é‡å¼‚æˆ–</h4><p>å°†å‰ä¸¤æ­¥çš„ç»“æœåŒè½®å¸¸é‡Rcon[j]è¿›è¡Œå¼‚æˆ–ï¼Œå…¶ä¸­jè¡¨ç¤ºè½®æ•°ã€‚</p><p>è½®å¸¸é‡æ˜¯ç»™å®šçš„ï¼Œå› ä¸ºè¦ç”Ÿæˆåä¸ªè½®å¯†é’¥ï¼Œæ‰€ä»¥æœ‰åä¸ªè½®å¸¸é‡</p><p><img src="/2022/02/08/AES/1644307898552.png"></p><p>è¿‡ç¨‹</p><p><img src="/2022/02/08/AES/1644308032666.png"></p><p>æœ€åï¼Œå°†å¾—åˆ°çš„ç»“æœå’ŒW[i-4]å¼‚æˆ–å³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Teaã€XTeaã€XXTeaåŸç†å’Œå®ç°</title>
      <link href="/2022/02/07/Tea%E3%80%81XTea%E3%80%81XXTea%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/"/>
      <url>/2022/02/07/Tea%E3%80%81XTea%E3%80%81XXTea%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="å…±åŒç‚¹"><a href="#å…±åŒç‚¹" class="headerlink" title="å…±åŒç‚¹"></a>å…±åŒç‚¹</h1><p>1ã€ç‰¹å¾é‡ï¼ˆä¸€èˆ¬æ˜¯0x9e3779b9ï¼Œå®ƒæ˜¯é»„é‡‘åˆ†å‰²æ•°å’Œ232çš„ä¹˜ç§¯ï¼‰ï¼Œå¯ä»¥æ›¿æ¢æˆå…¶ä»–çš„å€¼ï¼Œä½†æ˜¯å¯èƒ½ä¼šå‡ºç°é—®é¢˜</p><p>2ã€ä¸»è¦åŠ å¯†éƒ¨åˆ†è¿›è¡Œå¼‚æˆ–å’Œç§»ä½æ“ä½œï¼ˆä¸€èˆ¬éƒ½å­˜åœ¨&lt;&lt;4ã€&gt;&gt;5ï¼‰</p><p>3ã€keyä¸º128bit</p><h1 id="Tea"><a href="#Tea" class="headerlink" title="Tea"></a>Tea</h1><h2 id="åŠ å¯†æµç¨‹"><a href="#åŠ å¯†æµç¨‹" class="headerlink" title="åŠ å¯†æµç¨‹"></a>åŠ å¯†æµç¨‹</h2><p>æ•°ç»„çš„å¥‡æ•°ä¸‹æ ‡å…ƒç´ ä»å³ä¾§ä¼ å…¥åè¿›è¡Œäº†ç§»ä½å¼‚æˆ–å’Œç›¸åŠ æ“ä½œï¼Œæœ€åå¶æ•°ä¸‹æ ‡åŠ ä¸Šä¸Šé¢æ“ä½œå®Œçš„å€¼ï¼Œæ‰€ä»¥å¯ä»¥æŠŠç­‰å¼å³è¾¹çœ‹æˆä¸€ä¸ªå¸¸æ•°ï¼Œè¿™æ ·å†™é€†å‘è„šæœ¬å¥½ç†è§£</p><p>ç»“æŸç¬¬ä¸€æ­¥ä¹‹åï¼Œå¥‡æ•°ä¸‹æ ‡å…ƒç´ çš„å¶æ•°ä¸‹æ ‡å…ƒç´ è¿›è¡Œç½®æ¢ï¼Œå†å¯¹å¥‡æ•°ä¸‹æ ‡è¿›è¡Œç›¸åŒçš„åŠ å¯†</p><p>ç¬¬ä¸‰æ­¥å°±æ˜¯sum+=Delta</p><p> <img src="/2022/02/07/Tea%E3%80%81XTea%E3%80%81XXTea%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/OIP-C.jfif"> </p><h2 id="åŠ å¯†ä»£ç "><a href="#åŠ å¯†ä»£ç " class="headerlink" title="åŠ å¯†ä»£ç "></a>åŠ å¯†ä»£ç </h2><pre class="language-c" data-language="c"><code class="language-c">int main(){unsigned int Data[8] = { 0 };unsigned int key[4] = { 0 };unsigned int tmp[2] = { 0 };unsigned int sum = 0;unsigned int delta = 0x9e3779b9;for (int i = 0; i &lt; 8; i += 2){tmp[0] = Data[i];tmp[1] = Data[i + 1];        sum=0;for (int i = 0; i &lt; 32; ++i){sum += delta;tmp[0] += ((tmp[1] &lt;&lt; 4) + key[0]) ^ (tmp[1] + sum) ^ ((tmp[1] &gt;&gt; 5) + key[1]);tmp[1] += ((tmp[0] &lt;&lt; 4) + key[2]) ^ (tmp[0] + sum) ^ ((tmp[0] &gt;&gt; 5) + key[3]);}Data[i] = tmp[i];Data[i + 1] = tmp[i + 1];}return 0;}</code></pre><h3 id="è§£å¯†ä»£ç "><a href="#è§£å¯†ä»£ç " class="headerlink" title="è§£å¯†ä»£ç "></a>è§£å¯†ä»£ç </h3><pre class="language-c" data-language="c"><code class="language-c">#include&lt;string.h&gt;#include &lt;stdio.h&gt;int main(){unsigned int Data[8] = { 0 };unsigned int key[4] = { 0 };unsigned int tmp[2] = { 0 };unsigned int sum = 0;unsigned int delta = 0x9e3779b9;for (int i = 0; i &lt; 8; i += 2){tmp[0] = Data[i];tmp[1] = Data[i + 1];sum = delta*32;for (int i = 0; i &lt; 32; ++i){tmp[1] -= ((tmp[0] &lt;&lt; 4) + key[2]) ^ (tmp[0] + sum) ^ ((tmp[0] &gt;&gt; 5) + key[3]);tmp[0] -= ((tmp[1] &lt;&lt; 4) + key[0]) ^ (tmp[1] + sum) ^ ((tmp[1] &gt;&gt; 5) + key[1]);sum -= delta;}Data[i] = tmp[i];Data[i + 1] = tmp[i + 1];}return 0;}</code></pre><p>è§£å¯†çš„æ—¶å€™ä¸»è¦æ˜¯è¦æ‰¾åˆ°Keyå’Œå¯†æ–‡ï¼Œå¹¶ä¸”å¯èƒ½ä¼šæœ‰å¤§å°ç«¯åºçš„é—®é¢˜</p><h1 id="XTea"><a href="#XTea" class="headerlink" title="XTea"></a>XTea</h1><p>Xteaæ˜¯Teaçš„å‡çº§ç‰ˆï¼Œæ·»åŠ äº†ä¸€äº›ç§»ä½å’Œå¼‚æˆ–æ“ä½œ</p><h2 id="åŠ å¯†æµç¨‹-1"><a href="#åŠ å¯†æµç¨‹-1" class="headerlink" title="åŠ å¯†æµç¨‹"></a>åŠ å¯†æµç¨‹</h2><p> <img src="/2022/02/07/Tea%E3%80%81XTea%E3%80%81XXTea%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/20190112131633-3a396138-1629-1.png"> </p><p>å› ä¸ºåŠ å¯†è¿‡ç¨‹å®é™…ä¸Šæ²¡å‘ç”Ÿå¤ªå¤šå˜åŒ–ï¼Œå°±ä¸è´´åŠ å¯†å’Œè§£å¯†çš„ä»£ç äº†</p><h1 id="XXTea"><a href="#XXTea" class="headerlink" title="XXTea"></a>XXTea</h1><h2 id="åŠ å¯†æµç¨‹-2"><a href="#åŠ å¯†æµç¨‹-2" class="headerlink" title="åŠ å¯†æµç¨‹"></a>åŠ å¯†æµç¨‹</h2><p> <img src="/2022/02/07/Tea%E3%80%81XTea%E3%80%81XXTea%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/921830_48K7JHRW383FZWR.jpg"> </p><h2 id="åŠ è§£å¯†ä»£ç "><a href="#åŠ è§£å¯†ä»£ç " class="headerlink" title="åŠ è§£å¯†ä»£ç "></a>åŠ è§£å¯†ä»£ç </h2><pre class="language-c" data-language="c"><code class="language-c">#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#define DELTA 0x9e3779b9            //å›ºå®šçš„ä¸€ä¸ªå¸¸é‡#define MX (((z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))   //å›ºå®šçš„è¿ç®—void btea(uint32_t *v, int n, uint32_t const key[4])   //væ˜¯è¦åŠ å¯†çš„ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„{                                                      //nä¸ºæ•°ç»„çš„é•¿åº¦    uint32_t y, z, sum;                                //æ— ç¬¦å·æ•´å‹         unsigned p, rounds, e;                                if (n &gt; 1)            /* Coding Part */       {        rounds = 6 + 52/n;               //å›ºå®šçš„å¾—å‡ºè½®æ•°        sum = 0;                                z = v[n-1];                             do        {            sum += DELTA;                //æ¯æ¬¡è¿›è¡Œå åŠ             e = (sum &gt;&gt; 2) &amp; 3;          //å›ºå®šè¿ç®—            for (p=0; p&lt;n-1; p++)                   {                y = v[p+1];                v[p] += MX;                      z = v[p];                             }            y = v[0];            z = v[n-1] += MX;        }        while (--rounds);    }    else if (n &lt; -1)      /* Decoding Part */    {        n = -n;        rounds = 6 + 52/n;        sum = rounds*DELTA;        y = v[0];        do        {            e = (sum &gt;&gt; 2) &amp; 3;            for (p=n-1; p&gt;0; p--)            {                z = v[p-1];                y = v[p] -= MX;            }            z = v[n-1];            y = v[0] -= MX;            sum -= DELTA;        }        while (--rounds);    }} int main(){    uint32_t v[2]= {1,2};    uint32_t const k[4]= {2,2,3,4};    int n= 2; //nçš„ç»å¯¹å€¼è¡¨ç¤ºvçš„é•¿åº¦ï¼Œå–æ­£è¡¨ç¤ºåŠ å¯†ï¼Œå–è´Ÿè¡¨ç¤ºè§£å¯†    // vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°  // kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½    printf("åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š%u %u\n",v[0],v[1]);    btea(v, n, k);    printf("åŠ å¯†åçš„æ•°æ®ï¼š%u %u\n",v[0],v[1]);    btea(v, -n, k);    printf("è§£å¯†åçš„æ•°æ®ï¼š%u %u\n",v[0],v[1]);    return 0;}</code></pre><p>è¿˜æ²¡å®ç°è¿‡ï¼Œçœ‹ç€æµç¨‹å›¾ä¸çŸ¥é“æ€ä¹ˆå…¥æ‰‹</p>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RC4åŸç†å’Œå®ç°</title>
      <link href="/2022/02/06/RC4%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/"/>
      <url>/2022/02/06/RC4%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸºæœ¬åŸç†"><a href="#åŸºæœ¬åŸç†" class="headerlink" title="åŸºæœ¬åŸç†"></a>åŸºæœ¬åŸç†</h1><p>RC4å±äºå¯¹ç§°å¯†ç ç®—æ³•ä¸­çš„æµå¯†ç åŠ å¯†ç®—æ³•</p><p>å¯†é’¥é•¿åº¦å¯å˜ï¼Œé¢å‘å­—èŠ‚æ“ä½œ</p><p>ä»¥ä¸€ä¸ªè¶³å¤Ÿå¤§çš„Sè¡¨ä¸ºåŸºç¡€ï¼Œå¯¹è¡¨è¿›è¡Œéçº¿æ€§å˜æ¢ï¼Œäº§ç”Ÿå¯†é’¥æµ</p><p>ä¸¤æ¬¡äº¤æ¢è¿‡ç¨‹æ˜¯ä¸ºäº†å¢åŠ éšæœºæ€§</p><h1 id="åŠ å¯†è¿‡ç¨‹"><a href="#åŠ å¯†è¿‡ç¨‹" class="headerlink" title="åŠ å¯†è¿‡ç¨‹"></a>åŠ å¯†è¿‡ç¨‹</h1><h2 id="åˆå§‹åŒ–Sè¡¨"><a href="#åˆå§‹åŒ–Sè¡¨" class="headerlink" title="åˆå§‹åŒ–Sè¡¨"></a>åˆå§‹åŒ–Sè¡¨</h2><p>1ã€å¯¹Sè¡¨è¿›è¡Œå…ˆè¡Œå¡«å……ï¼Œä¸€èˆ¬ä¸º256å­—èŠ‚ï¼Œä¸”ä¸ºunsignedç±»å‹</p><p>2ã€ç”¨ç§å­å¯†é’¥å¡«å……å¦ä¸€ä¸ª256å­—èŠ‚çš„Kè¡¨</p><p>å¦‚æœç§å­å¯†é’¥é•¿åº¦ä¸ä¸º256ï¼Œå°†å¾ªç¯ä½¿ç”¨ç§å­å¯†é’¥å¯¹Kè¡¨è¿›è¡Œå¡«å……</p><p>3ã€ç”¨ Kè¡¨å¯¹Sè¡¨è¿›è¡Œåˆå§‹ç½®æ¢</p><h3 id="æ ·ä¾‹å±•ç¤º"><a href="#æ ·ä¾‹å±•ç¤º" class="headerlink" title="æ ·ä¾‹å±•ç¤º"></a>æ ·ä¾‹å±•ç¤º</h3><p>è¿™é‡Œæˆ‘ä»¬å‡è®¾Sè¡¨å’ŒKè¡¨éƒ½æ˜¯7ä¸ªå­—èŠ‚çš„ï¼Œå¯†é’¥ä¸º345ï¼Œå¡«å……ç»“æœå¦‚ä¸‹</p><p><img src="/2022/02/06/RC4%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/1644168199163.png"></p><p>ä½¿ç”¨Kè¡¨å¯¹Sè¡¨è¿›è¡Œç½®æ¢</p><pre class="language-c" data-language="c"><code class="language-c">int j = 0;for (int i = 0; i &lt; 7; ++i){j = (j + S[i] + K[i]) % 7;Swap(S[i], S[j]);}</code></pre><p>å¾—åˆ°è¢«ç½®æ¢åçš„Sè¡¨</p><p><img src="/2022/02/06/RC4%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/1644168394862.png"></p><h2 id="ç”Ÿæˆå¯†é’¥æµ"><a href="#ç”Ÿæˆå¯†é’¥æµ" class="headerlink" title="ç”Ÿæˆå¯†é’¥æµ"></a>ç”Ÿæˆå¯†é’¥æµ</h2><p>ä½œç”¨ï¼šä¸ºæ¯ä¸ªå¾…ä»·å¯†çš„å­—èŠ‚ç”Ÿæˆä¸€ä¸ªä¼ªéšæœºæ•°ï¼Œç”¨æ¥å¼‚æˆ–</p><p>æ³¨ï¼šSè¡¨å®Œæˆåˆå§‹åŒ–ä¹‹åï¼Œç§å­å¯†é’¥å°†ä¸ä¼šå†è¢«ä½¿ç”¨</p><p>ä½¿ç”¨ç½®æ¢åçš„Sè¡¨ç”Ÿæˆå¯†é’¥æµ</p><pre class="language-c" data-language="c"><code class="language-c">int i, j = 0;for (int k = 0; k &lt; strlen(raw); ++k){i = (i + 1) % 7;j = (j + S[i]) % 7;Swap(S[i], S[j]);int t = (S[i] + S[j]) % 7;K[k] = S[t];}</code></pre><h1 id="åŠ å¯†è¿‡ç¨‹-1"><a href="#åŠ å¯†è¿‡ç¨‹-1" class="headerlink" title="åŠ å¯†è¿‡ç¨‹"></a>åŠ å¯†è¿‡ç¨‹</h1><p>å¯†é’¥æµå’Œæ˜æ–‡è¿›è¡Œå¼‚æˆ–å¾—åˆ°å¯†æ–‡</p><h1 id="æœ€ç»ˆä»£ç "><a href="#æœ€ç»ˆä»£ç " class="headerlink" title="æœ€ç»ˆä»£ç "></a>æœ€ç»ˆä»£ç </h1><p>åŠ å¯†éƒ¨åˆ†çš„jæ˜¯ç”¨æ¥æ‰“ä¹±çš„ï¼Œå®ç°ä¼ªéšæœº</p><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;#include &lt;string.h&gt;void Rc4_init(unsigned char* S, unsigned char*K,unsigned char* key, unsigned long len){unsigned char  tmp = 0;for (int i = 0; i &lt; 256; ++i){S[i] = i;K[i] = key[i % len];}int j = 0;for (int i = 0; i &lt; 256; ++i){j = (j + S[i] + K[i]) % 256;tmp = S[i];S[i] = S[j];S[j] = tmp;}return;}void Rc4_encrypt(unsigned char* S, unsigned  char* flag,int len){int i = 0, j = 0,t = 0 ;unsigned char key_liu[len] = { 0 };unsigned char tmp = 0;for (unsigned long k = 0; k &lt; len; ++k){i = (i + 1) % 256;j = (j + S[i]) % 256;tmp = S[i];S[i] = S[j];S[j] = tmp;t = (S[i] + S[j]) % 256;key_liu[k] = S[t];}for (int i = 0; i &lt; len; ++i){flag[i] ^= key_liu[i];}}int main(){unsigned char S[256] = { 0 };unsigned char K[256] = { 0 };char flag[512] = { 0xB6, 0x94, 0xFA, 0x8F, 0x3D, 0x5F, 0xB2, 0xE0,0xEA, 0x0F, 0xD2, 0x66, 0x98, 0x6C, 0x9D, 0xE7,0x1B, 0x08, 0x40, 0x71, 0xC5, 0xBE, 0x6F, 0x6D,0x7C, 0x7B, 0x09, 0x8D, 0xA8, 0xBD, 0xF3, 0xF6};char key[] = "w0wy0ugot1t";unsigned long Len = strlen(flag);Rc4_init(S, K,(unsigned char*)key, strlen(key));Rc4_encrypt(S, (unsigned char*)flag, Len);printf("%s", flag);return 0;}</code></pre><p>å¯ä»¥ä¸ä¿å­˜å¯†é’¥æµï¼Œç›´æ¥è¿›è¡Œå¼‚æˆ–ï¼Œé€†å‘çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥åŠ¨è°ƒå¾—åˆ°å¯†é’¥æµï¼Œå†ä¸å¯†æ–‡è¿›è¡Œå¼‚æˆ–å°±å¯ä»¥å¾—åˆ°æ˜æ–‡äº†</p><pre class="language-c" data-language="c"><code class="language-c">void Rc4_encrypt(unsigned char* S, unsigned  char* flag,char*flag1){int len = strlen(flag1);int i = 0, j = 0,t = 0 ;unsigned char tmp = 0;for (unsigned long k = 0; k &lt; len; ++k){i = (i + 1) % 256;j = (j + S[i]) % 256;tmp = S[i];S[i] = S[j];S[j] = tmp;t = (S[i] + S[j]) % 256;flag[k] ^= S[t];}}</code></pre><p>åˆ†åˆ«çœ‹ä¸€ä¸‹åŠ å¯†è¿‡ç¨‹çš„é€†å‘ä»£ç </p><p>ç›´æ¥å¼‚æˆ–ï¼ŒåŠ¨è°ƒæ ¹æ®å­˜å‚¨çš„å¯„å­˜å™¨è¿›è¡Œæå–</p><pre class="language-c" data-language="c"><code class="language-c">__int64 __fastcall Rc4_encrypt(unsigned __int8 *a1, unsigned __int8 *a2, char *a3){  unsigned int v3; // eax  unsigned __int8 v4; // ST2B_1  __int64 result; // rax  unsigned int v6; // [rsp+30h] [rbp-10h]  unsigned int i; // [rsp+34h] [rbp-Ch]  int v8; // [rsp+38h] [rbp-8h]  signed int v9; // [rsp+3Ch] [rbp-4h]  unsigned __int8 *v10; // [rsp+50h] [rbp+10h]  unsigned __int8 *v11; // [rsp+58h] [rbp+18h]  v10 = a1;  v11 = a2;  v6 = strlen(a3);  v9 = 0;  v8 = 0;  for ( i = 0; ; ++i )  {    result = v6;    if ( v6 &lt;= i )      break;    v9 = (unsigned __int8)(((unsigned int)((v9 + 1) &gt;&gt; 31) &gt;&gt; 24) + v9 + 1) - ((unsigned int)((v9 + 1) &gt;&gt; 31) &gt;&gt; 24);    v3 = (unsigned int)((v8 + v10[v9]) &gt;&gt; 31) &gt;&gt; 24;    v8 = (unsigned __int8)(v3 + v8 + v10[v9]) - v3;    v4 = v10[v9];    v10[v9] = v10[v8];    v10[v8] = v4;    v11[i] ^= v10[(unsigned __int8)(v10[v9] + v10[v8])];  }  return result;}</code></pre><p>å…ˆä¿å­˜å†å¼‚æˆ–</p><pre class="language-c" data-language="c"><code class="language-c">__int64 __fastcall Rc4_encrypt(unsigned __int8 *a1, unsigned __int8 *a2, signed int a3){  void *v3; // rsp  char *v4; // rax  signed __int64 i; // rdx  unsigned int v6; // eax  __int64 result; // rax  __int64 v8; // [rsp+0h] [rbp-30h]  __int64 *v9; // [rsp+8h] [rbp-28h]  __int64 v10; // [rsp+10h] [rbp-20h]  int v11; // [rsp+1Ch] [rbp-14h]  unsigned int k; // [rsp+20h] [rbp-10h]  unsigned int j; // [rsp+24h] [rbp-Ch]  unsigned int v14; // [rsp+28h] [rbp-8h]  unsigned int v15; // [rsp+2Ch] [rbp-4h]  unsigned __int8 *v16; // [rsp+58h] [rbp+28h]  v16 = a2;  v15 = 0;  v14 = 0;  v11 = 0;  v10 = a3 - 1i64;  v3 = alloca(16 * ((unsigned __int64)(a3 + 15i64) &gt;&gt; 4));  v9 = &amp;v8;  LOBYTE(v8) = 0;  v4 = (char *)&amp;v8 + 1;  for ( i = a3 - 2i64; i != -1; --i )    *v4++ = 0;  HIBYTE(v8) = 0;  for ( j = 0; a3 &gt; j; ++j )  {    v15 = (unsigned __int8)(((unsigned int)((signed int)(v15 + 1) &gt;&gt; 31) &gt;&gt; 24) + v15 + 1)        - ((unsigned int)((signed int)(v15 + 1) &gt;&gt; 31) &gt;&gt; 24);    v6 = (unsigned int)((signed int)(v14 + a1[v15]) &gt;&gt; 31) &gt;&gt; 24;    v14 = (unsigned __int8)(v6 + v14 + a1[v15]) - v6;    HIBYTE(v8) = a1[v15];    a1[v15] = a1[v14];    a1[v14] = HIBYTE(v8);    v11 = (unsigned __int8)(a1[v15] + a1[v14]);    *((_BYTE *)v9 + j) = a1[v11];  }  for ( k = 0; ; ++k )  {    result = k;    if ( (signed int)k &gt;= a3 )      break;    v16[k] ^= *((_BYTE *)v9 + (signed int)k);  }  return result;}</code></pre><p>å¯ä»¥çœ‹åˆ°å¯†é’¥æµå­˜å‚¨åœ¨v9ï¼ŒåŠ¨è°ƒä¹‹åå¯ä»¥ç›´æ¥æå–</p><p>Vs2022ç”Ÿæˆçš„exeæ–‡ä»¶åç¼–è¯‘</p><pre class="language-c" data-language="c"><code class="language-c">__int64 __fastcall sub_140015E30(__int64 a1, __int64 a2, char *a3){  __int64 result; // rax  __int64 v4; // kr00_8  unsigned __int8 v5; // dl  char v6; // STA4_1  int v7; // edx  unsigned int v8; // [rsp+24h] [rbp+4h]  int v9; // [rsp+44h] [rbp+24h]  int v10; // [rsp+64h] [rbp+44h]  unsigned int i; // [rsp+C4h] [rbp+A4h]  __int64 v12; // [rsp+1C0h] [rbp+1A0h]  __int64 v13; // [rsp+1C8h] [rbp+1A8h]  const char *Str; // [rsp+1D0h] [rbp+1B0h]  Str = a3;  v13 = a2;  v12 = a1;  sub_140011361(&amp;unk_14002200E);  v8 = j_strlen(Str);  v9 = 0;  v10 = 0;  for ( i = 0; ; ++i )  {    result = v8;    if ( i &gt;= v8 )      break;    v4 = v9 + 1;    v9 = (BYTE4(v4) + v9 + 1) - BYTE4(v4);    v5 = (*(v12 + v9) + v10) &gt;&gt; 31;    v10 = (v5 + *(v12 + v9) + v10) - v5;    v6 = *(v12 + v9);    *(v12 + v9) = *(v12 + v10);    *(v12 + v10) = v6;    v7 = (*(v12 + v10) + *(v12 + v9)) &gt;&gt; 31;    *(v13 + i) ^= *(v12 + (v7 + *(v12 + v10) + *(v12 + v9)) - v7);  }  return result;}</code></pre><p>çœ‹ç€è·Ÿåˆ«çš„ä¸ä¸€æ ·</p><h1 id="é¢˜ç›®â€”â€”BUU-GUET-CTF2019-encrypt"><a href="#é¢˜ç›®â€”â€”BUU-GUET-CTF2019-encrypt" class="headerlink" title="é¢˜ç›®â€”â€”BUU-[GUET-CTF2019]encrypt"></a>é¢˜ç›®â€”â€”BUU-[GUET-CTF2019]encrypt</h1><p>æ‹–è¿›idaï¼Œå¯¹ä¸€äº›å˜é‡å’Œå‡½æ•°åè¿›è¡Œè¯†åˆ«å’Œæ”¹å</p><p><img src="/2022/02/06/RC4%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/1644325364867.png"></p><p>ç‚¹è¿›åŠ å¯†å‡½æ•°è¿›è¡ŒæŸ¥çœ‹</p><p><img src="/2022/02/06/RC4%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/1644339350075.png"></p><p><img src="/2022/02/06/RC4%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/1644339358773.png"></p><p><img src="/2022/02/06/RC4%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/1644339366532.png"></p><p>æ•´ä½“å°±æ˜¯å…ˆRC4ï¼Œç„¶åå°†åŠ å¯†åçš„ä¸‰ä¸ªå­—ç¬¦å˜ä¸ºå››ä¸ªå­—ç¬¦</p><p>é€†å‘è¿‡æ¥å…ˆå°†å››ä¸ªå­—ç¬¦è½¬ä¸ºä¸‰ä¸ªå­—ç¬¦ï¼Œç„¶åç›´æ¥å°†è½¬æ¢åçš„ç»“æœå’Œå¯†é’¥æµè¿›è¡Œå¼‚æˆ–å¾—åˆ°æ˜æ–‡</p><p>å¯†é’¥æµå¯ä»¥é€šè¿‡åŠ¨è°ƒå¾—åˆ°</p><p><img src="/2022/02/06/RC4%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/1644339479964.png"></p><p>è„šæœ¬</p><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;#include&lt;string.h&gt;int main(){char raw[52]={0x5a,    0x60, 0x54, 0x7A, 0x7A, 0x54, 0x72, 0x44, 0x7C, 0x66, 0x51, 0x50, 0x5B, 0x5F, 0x56, 0x56, 0x4C,    0x7C, 0x79, 0x6E, 0x65, 0x55, 0x52, 0x79, 0x55, 0x6D, 0x46, 0x6B, 0x6C, 0x56, 0x4A, 0x67, 0x4C,    0x61, 0x73, 0x4A, 0x72, 0x6F, 0x5A, 0x70, 0x48, 0x52, 0x78, 0x49, 0x55, 0x6C, 0x48, 0x5C, 0x76,    0x5A, 0x45, 0x3D};char decode[39]={0};for(int i=0;i&lt;52;++i){raw[i]-=61;}for(int i=0,i_=0;i&lt;52;i+=4,i_+=3){decode[i_]=((raw[i])&lt;&lt;2)|((raw[i+1])&gt;&gt;4);decode[i_+1]=((raw[i+1]&amp;0xf)&lt;&lt;4)|((raw[i+2]&amp;0x3c)&gt;&gt;2);decode[i_+2]=((raw[i+2]&amp;0xF)&lt;&lt;6)|(raw[i+3]);}char v[90]={0x10,0x59,0x9C,0x92,0x06,0x22,0xCF,0xA5,0x72,0x1E,0x45,0x6A,0x06,0xCB,0x08,0xC3,0xE4,0x49,0x5A,0x63,0x0C,0xDF,0xF6,0x5F,0x08,0x28,0xBD,0xE2,0x10,0x15,0x1F,0x6E,0xAA,0x5A,0xCA,0xEC,0x80,0xAF,0x9B,0x16,0xBB,0x3D,0x13,0x2F,0x6A,0xA4,0xC7,0x2E,0xBC,0x4B,0x60,0x9A,0xAF,0xE9,0xCE,0xDA,0x67,0x39,0xBA,0x3B,0x85,0xEB,0xD2,0x6B,0xAB,0x06,0x6B,0x10,0x57,0x2C,0x88,0x70,0xF7,0x4F,0xAA,0x7F,0x12,0x47,0xD6,0xDE,0x74,0xB2,0x1D,0xA4,0xD7,0x76,0x9A,0xE0};for(int i=0;i&lt;39;++i){decode[i]^=v[i];}printf("%s",decode);return 0;}</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>base64å®ç°åŠç»†èŠ‚å‰–æ</title>
      <link href="/2022/02/06/base64%E5%AE%9E%E7%8E%B0%E5%8F%8A%E7%BB%86%E8%8A%82%E5%89%96%E6%9E%90/"/>
      <url>/2022/02/06/base64%E5%AE%9E%E7%8E%B0%E5%8F%8A%E7%BB%86%E8%8A%82%E5%89%96%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h1><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;#include &lt;string.h&gt;char base64_table[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";void base64_encode(char raw[], char encode[]){int code_len = strlen(raw);int final_len = 0;if (code_len % 3){final_len = (code_len / 3 + 1) * 4;}elsefinal_len = (code_len / 3) * 4;int i = 0, i_ = 0;for (; i &lt; code_len; i += 3, i_ += 4){encode[i_] = base64_table[raw[i] &gt;&gt; 2];encode[i_ + 1] = base64_table[((raw[i] &amp; 0x03) &lt;&lt; 4) | ((raw[i + 1] &amp; 0xf0) &gt;&gt; 4)];encode[i_ + 2] = base64_table[((raw[i + 1] &amp; 0x0f) &lt;&lt; 2) | ((raw[i + 2] &amp; 0xc0) &gt;&gt; 6)];encode[i_ + 3] = base64_table[raw[i + 2] &amp; 0x3f];}if (code_len % 3 == 1){encode[i_ - 1] = '=';encode[i_ - 2] = '=';}else if (code_len % 3 == 2){encode[i_ - 1] = '=';}return;}int Findindex(char c){for (int i = 0; i &lt; strlen(base64_table); ++i){if (c == base64_table[i])return i;}}void base64_decode(char* encode, char* decode){int decode_len=0;int encode_len = strlen(encode);if (strstr(encode, "=="))decode_len = (encode_len / 4) * 3 - 2;else if (strstr(encode, "="))decode_len = (encode_len / 4) * 3 - 1;elsedecode_len = (encode_len / 4) * 3;int i = 0, i_ = 0;for (; i &lt; encode_len; i_ += 4, i += 3){decode[i] = (Findindex(encode[i_]) &lt;&lt; 2) | (Findindex(encode[i_ + 1]) &amp; 0x30) &gt;&gt; 4;decode[i + 1] = ((Findindex(encode[i_ + 1]) &amp; 0xf) &lt;&lt; 4) | ((Findindex(encode[i_ + 2]) &amp; 0x3c) &gt;&gt; 2);decode[i + 2] = ((Findindex(encode[i_ + 2]) &amp; 0x3) &lt;&lt; 6) | ((Findindex(encode[i_ + 3])));}decode[decode_len] = 0;return;}int main(){char raw[] = "hgame{123456}";char encode[100] = { 0 };char decode[100] = { 0 };base64_encode(raw, encode);printf("%s", encode);base64_decode(encode, decode);printf("\n%s", decode);}</code></pre><h1 id="ç»†èŠ‚å‰–æ"><a href="#ç»†èŠ‚å‰–æ" class="headerlink" title="ç»†èŠ‚å‰–æ"></a>ç»†èŠ‚å‰–æ</h1><h2 id="ç¼–ç éƒ¨åˆ†"><a href="#ç¼–ç éƒ¨åˆ†" class="headerlink" title="ç¼–ç éƒ¨åˆ†"></a>ç¼–ç éƒ¨åˆ†</h2><h3 id="è®°å½•é•¿åº¦"><a href="#è®°å½•é•¿åº¦" class="headerlink" title="è®°å½•é•¿åº¦"></a>è®°å½•é•¿åº¦</h3><p>é¦–å…ˆè¦å…ˆè®¡ç®—é•¿åº¦ï¼Œbase64å°±æ˜¯å°†ä¸‰ä¸ªå­—èŠ‚æ‰©å±•ä¸ºå››ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è¦åˆ†æˆæœ‰ä½™æ•°å’Œæ•´é™¤ä¸¤ç§æƒ…å†µ</p><pre class="language-c" data-language="c"><code class="language-c">int code_len = strlen(raw);int final_len = 0;if (code_len % 3){final_len = (code_len / 3 + 1) * 4;}elsefinal_len = (code_len / 3) * 4;</code></pre><h3 id="ç¼–ç éƒ¨åˆ†-1"><a href="#ç¼–ç éƒ¨åˆ†-1" class="headerlink" title="ç¼–ç éƒ¨åˆ†"></a>ç¼–ç éƒ¨åˆ†</h3><p>é¦–å…ˆå…ˆä»‹ç»ä¸€ä¸‹ä¸¤ä¸ªå·¥å…·ï¼Œ&amp;å’Œ|ï¼Œå’Œä¸€äº›æ•°æ®åš&amp;è¿ç®—å¯ä»¥å–åˆ°æˆ‘ä»¬æƒ³è¦çš„ä½ï¼Œè€Œ|è¿ç®—å¯ä»¥å°†ä¸¤éƒ¨åˆ†ç»“åˆåœ¨ä¸€èµ·</p><p>ç¼–ç åçš„ç´¢å¼•æœ€å¤šä¸ºå…­ä½ï¼ŒåŸå…ˆçš„æ•°æ®å¯ä»¥æ˜¯å…«ä½çš„</p><h4 id="encode-i"><a href="#encode-i" class="headerlink" title="encode[i]"></a>encode[i]</h4><p>è¿™ä¸ªå…¶å®æ˜¯æœ€å¥½å®ç°çš„ï¼Œå› ä¸ºåªéœ€è¦å–åˆ°å‰å…­ä½ï¼Œæ‰€ä»¥ç›´æ¥&gt;&gt;2å°±å¯ä»¥å®ç°</p><pre class="language-c" data-language="c"><code class="language-c">encode[i_] = base64_table[raw[i] &gt;&gt; 2];</code></pre><h4 id="encode-i-1"><a href="#encode-i-1" class="headerlink" title="encode[i+1]"></a>encode[i+1]</h4><p>å…ˆæ˜ç¡®æˆ‘ä»¬çš„éœ€æ±‚ï¼Œä»ç¬¬ä¸€ä¸ªæ•°æ®è·å–æœ€åçš„ä¸¤ä½ä¸ç¬¬äºŒä¸ªæ•°æ®è·å–çš„å‰å››ä½ç»“åˆã€‚éœ€è¦ç”¨åˆ°&amp;ï¼Œè¿™é‡Œçš„ç»“åˆå°±éœ€è¦ç”¨åˆ°|ã€‚</p><p>é¦–å…ˆè¦ä¿è¯æˆ‘ä»¬å–åˆ°çš„æ˜¯ä¸¤ä½çš„ï¼Œéœ€è¦&amp;0x03</p><table><thead><tr><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>1</th><th>1</th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>å› ä¸ºåªæœ‰æœ€åä¸¤ä½æ˜¯1ï¼Œæ ¹æ®æŒ‰ä½&amp;ï¼Œå½“æœ‰ä¸€ä¸ªæ˜¯0æ—¶è¿ç®—åç»“æœå¿…å®šä¸º0ï¼Œæ‰€ä»¥å°±å¯ä»¥å–åˆ°æœ€åä¸¤ä½</p><p>ä¸‹ä¸€æ­¥æ˜¯ç§»åˆ°æ­£ç¡®çš„ä½ç½®ï¼Œéœ€è¦ç”¨åˆ°ä½ç§»è¿ç®—ç¬¦</p><p>è¿™é‡Œç¬¬ä¸€ä¸ªæ•°çš„æœ€åä¸¤ä½ç¼–ç åæ˜¯æ”¾åœ¨å‰é¢ä¸¤ä½çš„ä½ç½®ï¼Œæ‰€ä»¥éœ€è¦&lt;&lt;4</p><p>æ¥ä¸‹æ¥å–å‰©ä½™çš„å››ä½</p><p>å‰©ä½™çš„å››ä½æ¥è‡ªç¬¬äºŒä¸ªæ•°çš„å‰å››ä½</p><p>å¯ä»¥å…ˆ&amp;0xf0ä½¿å¾—åå››ä½éƒ½ä¸º0ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸ç”¨ï¼Œç›´æ¥&gt;&gt;4</p><p>æœ€åä½¿ç”¨|ç»“åˆèµ·æ¥</p><table><thead><tr><th>0</th><th>0</th><th>0</th><th>1</th><th>1</th><th>0</th><th>0</th><th>1</th><th>1</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>ä¸</td><td>è¿</td><td>ç®—</td><td></td></tr><tr><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td></tr></tbody></table><pre class="language-c" data-language="c"><code class="language-c">encode[i_ + 1] = base64_table[((raw[i] &amp; 0x03) &lt;&lt; 4) | ((raw[i + 1]) &gt;&gt; 4)];</code></pre><h4 id="encode-i-2"><a href="#encode-i-2" class="headerlink" title="encode[i+2]"></a>encode[i+2]</h4><p>è¦ç”¨åˆ°ç¬¬äºŒä¸ªæ•°æ®çš„åå››ä½å’Œç¬¬ä¸‰ä¸ªæ•°æ®çš„å‰ä¸¤ä½</p><p>åŒç†ï¼Œè¦ä¿ç•™ç¬¬äºŒä¸ªæ•°æ®çš„åå››ä½å¹¶ä¸”å»é™¤å‰å››ä½ï¼Œå°±éœ€è¦&amp;0xfï¼Œç§»åˆ°æ­£ç¡®çš„ä½ç½®&lt;&lt;2ï¼Œå‰©ä½™ä¸¤ä½ç•™ç»™ç¬¬ä¸‰ä¸ªæ•°æ®çš„å‰ä¸¤ä½</p><p>è¦å–åˆ°ç¬¬ä¸‰ä¸ªæ•°æ®çš„å‰ä¸¤ä½</p><p>å¯ä»¥ç›´æ¥&gt;&gt;6ä¿è¯å‰ä¸¤ä½ç§»åŠ¨åˆ°æœ€åçš„ä¸¤ä½ï¼Œä¹Ÿå¯ä»¥å…ˆç”¨&amp;0xc0æ¸…é™¤åå››ä½ï¼Œå› ä¸ºæ˜¯00110000ï¼Œæœ€åç»“åˆèµ·æ¥å°±å¯ä»¥äº†</p><pre class="language-c" data-language="c"><code class="language-c">encode[i_ + 2] = base64_table[((raw[i + 1] &amp; 0x0f) &lt;&lt; 2) | ((raw[i + 2] ) &gt;&gt; 6)];</code></pre><h4 id="encode-i-3"><a href="#encode-i-3" class="headerlink" title="encode[i+3]"></a>encode[i+3]</h4><p>åªéœ€è¦å–åˆ°ç¬¬ä¸‰ä¸ªæ•°æ®çš„åå…­ä½å°±å¯ä»¥äº†</p><p>ç›´æ¥&amp;0x3fï¼Œå› ä¸º0x3fçš„äºŒè¿›åˆ¶æ˜¯00111111</p><pre class="language-c" data-language="c"><code class="language-c">encode[i_ + 3] = base64_table[raw[i + 2] &amp; 0x3f];</code></pre><h4 id="å¡«åŠ "><a href="#å¡«åŠ " class="headerlink" title="å¡«åŠ ="></a>å¡«åŠ =</h4><p>å¦‚æœç¼–ç å‰çš„æ•°æ®é•¿åº¦%3ä¸ç­‰äº0ï¼Œéœ€è¦ä½¿ç”¨=å¡«å……</p><p>å¦‚æœå¤šå‡ºä¸€ä½çš„è¯ï¼Œæ ¹æ®ç»è¿‡ä¸Šè¿°è¿‡ç¨‹ä¼šå˜æˆä¸¤ä½ï¼Œæ‰€ä»¥æœ€åä¸¤ä½éœ€è¦ç”¨åˆ°=æ¥å¡«å……</p><p>å¤šå‡ºä¸¤ä½ï¼Œç»è¿‡ä¸Šè¿°è¿‡ç¨‹å˜æˆä¸‰ä½ï¼Œæ‰€ä»¥åªéœ€å¡«å……æœ€åä¸€ä½ä¸º=</p><pre class="language-c" data-language="c"><code class="language-c">if (code_len % 3 == 1){encode[i_ - 1] = '=';encode[i_ - 2] = '=';}else if (code_len % 3 == 2){encode[i_ - 1] = '=';}</code></pre><h3 id="è§£ç éƒ¨åˆ†"><a href="#è§£ç éƒ¨åˆ†" class="headerlink" title="è§£ç éƒ¨åˆ†"></a>è§£ç éƒ¨åˆ†</h3><p>å…­ä½è¿˜åŸä¸ºå…«ä½</p><h4 id="å»é™¤"><a href="#å»é™¤" class="headerlink" title="å»é™¤="></a>å»é™¤=</h4><p>å…ˆè®¡ç®—è§£ç åçš„é•¿åº¦ï¼Œæ¯å››ä¸ªå¯¹åº”ä¸‰ä¸ªï¼Œæœ€åå‡å»=çš„é•¿åº¦</p><pre class="language-c" data-language="c"><code class="language-c">int decode_len=0;int encode_len = strlen(encode);if (strstr(encode, "=="))decode_len = (encode_len / 4) * 3 - 2;else if (strstr(encode, "="))decode_len = (encode_len / 4) * 3 - 1;elsedecode_len = (encode_len / 4) * 3;</code></pre><h4 id="decode-i"><a href="#decode-i" class="headerlink" title="decode[i]"></a>decode[i]</h4><p>å…¶å®å’Œä¸Šé¢è¿‡ç¨‹æ­£å¥½ç›¸åï¼Œå–ç¬¬ä¸€ä¸ªç¼–ç æ•°æ®çš„åå…­ä½ï¼ˆå› ä¸ºå‰ä¸¤ä½æ˜¯å¡«å……çš„0ï¼‰å’Œç¬¬äºŒä¸ªç¼–ç æ•°æ®çš„å‰ä¸¤ä½ï¼Œåœ¨æ­¤ä¹‹å‰éœ€è¦å…ˆå»é™¤å‰ä¸¤ä½å¡«å……çš„0ï¼Œæ‰€ä»¥è¦&amp;0x30ï¼Œæ ¹æ®ä¸Šé¢çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯00110000ï¼Œæ­£å¥½æ˜¯0x30</p><p>å†ç”¨|ç»“åˆ</p><pre class="language-c" data-language="c"><code class="language-c">decode[i] = (Findindex(encode[i_]) &lt;&lt; 2) | (Findindex(encode[i_ + 1]) &amp; 0x30) &gt;&gt; 4;</code></pre><h4 id="decode-i-1"><a href="#decode-i-1" class="headerlink" title="decode[i+1]"></a>decode[i+1]</h4><p>éœ€è¦ç¬¬äºŒä¸ªç¼–ç æ•°æ®çš„åå››ä½å’Œç¬¬ä¸‰ä¸ªç¼–ç æ•°æ®çš„å‰å››ä½ï¼Œä¹Ÿæ˜¯éœ€è¦å…ˆå»é™¤å¡«å……çš„0</p><p>æ‰€ä»¥ç¬¬äºŒä¸ªæ•°æ®&amp;0xfä¿è¯å–åˆ°åå››ä½ï¼Œ&lt;&lt;4ç§»åˆ°å‰å››ä½</p><p>ç¬¬ä¸‰ä¸ªæ•°æ®&amp;0x3cï¼ˆ00111100ï¼‰è¿›è¡Œå»é™¤å¡«å……çš„å‰ä¸¤ä½0ä»¥åŠå–åˆ°éœ€è¦çš„é‚£å››ä½ï¼Œå†&gt;&gt;2ï¼Œæœ€åä½¿ç”¨|ç»“åˆ</p><pre class="language-c" data-language="c"><code class="language-c">decode[i + 1] = ((Findindex(encode[i_ + 1]) &amp; 0xf) &lt;&lt; 4) | ((Findindex(encode[i_ + 2]) &amp; 0x3c) &gt;&gt; 2);</code></pre><h4 id="decode-i-2"><a href="#decode-i-2" class="headerlink" title="decode[i+2]"></a>decode[i+2]</h4><p>ç¬¬ä¸‰ä¸ªç¼–ç æ•°æ®çš„åä¸¤ä½å’Œç¬¬å››ä¸ªç¼–ç æ•°æ®çš„é‚£å…­ä½</p><p>å’Œä¸Šè¿°è¿‡ç¨‹ç±»ä¼¼ï¼Œå°±ä¸èµ˜è¿°äº†</p><h4 id="å­—ç¬¦æ•°ç»„ç»“æŸ"><a href="#å­—ç¬¦æ•°ç»„ç»“æŸ" class="headerlink" title="å­—ç¬¦æ•°ç»„ç»“æŸ"></a>å­—ç¬¦æ•°ç»„ç»“æŸ</h4><p>æœ€åè®°å¾—å¡«åŠ å­—ç¬¦æ•°ç»„ç»“æŸç¬¦</p><pre class="language-c" data-language="c"><code class="language-c">decode[decode_len] = 0;</code></pre><h1 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h1><p>base64è¿˜å¯ä»¥é­”æ”¹ï¼Œè¿›è¡Œå˜è¡¨æ“ä½œæˆ–è€…åœ¨ç¼–ç è¿‡ç¨‹ä¸­å‚æ‚å¼‚æˆ–ï¼ˆDasctf2022ï¼‰</p>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ELFæ–‡ä»¶æ‰‹è„±upxå˜å½¢å£³</title>
      <link href="/2022/02/03/ELF%E6%96%87%E4%BB%B6%E6%89%8B%E8%84%B1upx%E5%8F%98%E5%BD%A2%E5%A3%B3/"/>
      <url>/2022/02/03/ELF%E6%96%87%E4%BB%B6%E6%89%8B%E8%84%B1upx%E5%8F%98%E5%BD%A2%E5%A3%B3/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢˜ç›®-hgame2022-week2-upx-magic1"><a href="#é¢˜ç›®-hgame2022-week2-upx-magic1" class="headerlink" title="é¢˜ç›®-hgame2022-week2-upx magic1"></a>é¢˜ç›®-hgame2022-week2-upx magic1</h1><p>å‘ç°å‘½ä»¤è¡Œè„±å£³æ²¡ç”¨ï¼Œåªèƒ½æ‰‹è„±ï¼Œelfæ–‡ä»¶æ²¡åŠæ³•ä½¿ç”¨espå®šå¾‹ï¼Œidaæ‰‹è„±</p><p>è¿›å…¥ida</p><p><img src="/2022/02/03/ELF%E6%96%87%E4%BB%B6%E6%89%8B%E8%84%B1upx%E5%8F%98%E5%BD%A2%E5%A3%B3/1643878891388.png"></p><p>åœ¨ç¬¬ä¸€ä¸ªcallä¸‹æ–­ç‚¹ï¼Œè¿›è¡ŒåŠ¨æ€è°ƒè¯•</p><p>F7å•æ­¥è¿›å…¥</p><p><img src="/2022/02/03/ELF%E6%96%87%E4%BB%B6%E6%89%8B%E8%84%B1upx%E5%8F%98%E5%BD%A2%E5%A3%B3/1643879064585.png"></p><p>åˆ°äº†ç¬¬äºŒä¸ªcallå†æ¬¡F7è¿›å…¥</p><p><img src="/2022/02/03/ELF%E6%96%87%E4%BB%B6%E6%89%8B%E8%84%B1upx%E5%8F%98%E5%BD%A2%E5%A3%B3/1643879092434.png"></p><p>ä¸€è·¯f8</p><p>retnååˆ°</p><p><img src="/2022/02/03/ELF%E6%96%87%E4%BB%B6%E6%89%8B%E8%84%B1upx%E5%8F%98%E5%BD%A2%E5%A3%B3/1643879119459.png"></p><p>F7è¿›å…¥</p><p><img src="/2022/02/03/ELF%E6%96%87%E4%BB%B6%E6%89%8B%E8%84%B1upx%E5%8F%98%E5%BD%A2%E5%A3%B3/1643879160619.png"></p><p>æœ‰ä¸‰ä¸ªå‘ä¸Šçš„è·³è½¬</p><p>åœ¨ç¬¬ä¸‰ä¸ªè·³è½¬ä¹‹åF4</p><p>ä¸€ç›´F8åˆ°è¾¾ç¨‹åºçœŸæ­£çš„å…¥å£ç‚¹</p><p><img src="/2022/02/03/ELF%E6%96%87%E4%BB%B6%E6%89%8B%E8%84%B1upx%E5%8F%98%E5%BD%A2%E5%A3%B3/1643879196863.png"></p><p>æ­¤æ—¶éœ€è¦dumpfile</p><p>ALT+F7è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬éœ€è¦ä¿®æ”¹åç¼€ä¸ºidc</p><pre class="language-c" data-language="c"><code class="language-c">#include &lt;idc.idc&gt;#define PT_LOAD              1#define PT_DYNAMIC           2static main(void){         auto ImageBase,StartImg,EndImg;         auto e_phoff;         auto e_phnum,p_offset;         auto i,dumpfile;         ImageBase=0x400000;         StartImg=0x400000;         EndImg=0x0;         if (Dword(ImageBase)==0x7f454c46 || Dword(ImageBase)==0x464c457f )  {    if(dumpfile=fopen("D:\\dumpfile2","wb"))//è¿™è·¯å¯ä»¥æ›´æ”¹è·¯å¾„    {      e_phoff=ImageBase+Qword(ImageBase+0x20);      Message("e_phoff = 0x%x\n", e_phoff);      e_phnum=Word(ImageBase+0x38);      Message("e_phnum = 0x%x\n", e_phnum);      for(i=0;i&lt;e_phnum;i++)      {         if (Dword(e_phoff)==PT_LOAD || Dword(e_phoff)==PT_DYNAMIC)                         {                                  p_offset=Qword(e_phoff+0x8);                                 StartImg=Qword(e_phoff+0x10);                                 EndImg=StartImg+Qword(e_phoff+0x28);                                 Message("start = 0x%x, end = 0x%x, offset = 0x%x\n", StartImg, EndImg, p_offset);                                 dump(dumpfile,StartImg,EndImg,p_offset);                                 Message("dump segment %d ok.\n",i);                         }             e_phoff=e_phoff+0x38;      }      fseek(dumpfile,0x3c,0);      fputc(0x00,dumpfile);      fputc(0x00,dumpfile);      fputc(0x00,dumpfile);      fputc(0x00,dumpfile);      fseek(dumpfile,0x28,0);      fputc(0x00,dumpfile);      fputc(0x00,dumpfile);      fputc(0x00,dumpfile);      fputc(0x00,dumpfile);      fputc(0x00,dumpfile);      fputc(0x00,dumpfile);      fputc(0x00,dumpfile);      fputc(0x00,dumpfile);      fclose(dumpfile);        }else Message("dump err."); }}static dump(dumpfile,startimg,endimg,offset) {        auto i;        auto size;        size=endimg-startimg;        fseek(dumpfile,offset,0);        for ( i=0; i &lt; size; i=i+1 )         {        fputc(Byte(startimg+i),dumpfile);        }}</code></pre><p>å¾—åˆ°dumpfile2ï¼Œæ‹–è¿›idaå¾—åˆ°æ­£å¸¸çš„ä»£ç </p><p><img src="/2022/02/03/ELF%E6%96%87%E4%BB%B6%E6%89%8B%E8%84%B1upx%E5%8F%98%E5%BD%A2%E5%A3%B3/1643879324566.png"></p><h3 id="çˆ†ç ´è„šæœ¬"><a href="#çˆ†ç ´è„šæœ¬" class="headerlink" title="çˆ†ç ´è„šæœ¬"></a>çˆ†ç ´è„šæœ¬</h3><p>è¿™é‡Œè¦æŒ‰ä½ä¸ä¸Š0xffffï¼Œå› ä¸ºè¿™é‡Œæœ€ååªèµ‹å€¼äº†æœ€ååå…­ä½ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨&amp;0xffffæ¥é™åˆ¶ä½æ•°ï¼Œä¿è¯å–åˆ°æœ€åçš„åå…­ä½</p><p>æœ‰æ—¶å€™è¿˜å­˜åœ¨å·¦ç§»æº¢å‡ºçš„é—®é¢˜ï¼š</p><p><a href="https://blog.csdn.net/u013658041/article/details/78116449">https://blog.csdn.net/u013658041/article/details/78116449</a></p><p><img src="/2022/02/03/ELF%E6%96%87%E4%BB%B6%E6%89%8B%E8%84%B1upx%E5%8F%98%E5%BD%A2%E5%A3%B3/1644069404698.png"></p><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt; #include &lt;string.h&gt;#include &lt;stdlib.h&gt;int main(){int s[]={0x8d68,0x9d49,0x2a12,0xab1a,0xcbdc,0xb92b,0x2e32,0x9f59,0xddcd,0x9d49,0xa90a,0xe70,0xf5cf,0x5ed5,0x3c03,0x7c87,0x2672,0xab1a,0xa50,0x5af5,0xff9f,0x9f59,0xbd0b,0x58e5,0x3823,0xbf1b,0x78a7,0xab1a,0x48c4,0xa90a,0x2c22,0x9f59,0x5cc5,0x5ed5,0x78a7,0x2672,0x5695};for(int i=0;i&lt;40;++i){for(int j=32;j&lt;=127;++j){int temp=(j&lt;&lt;8)&amp;0xffff;for(int  k=0;k&lt;8;++k){if((temp&amp;0x8000)!=0){temp=((2*temp)^0x1021)&amp;0xffff;}elsetemp=(2*temp)&amp;0xffff;}if(temp==s[i]){printf("%c",j);}}}return 0;}</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hook</title>
      <link href="/2022/02/03/Hook/"/>
      <url>/2022/02/03/Hook/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢˜ç›®-BUUCTF-easystrcmp"><a href="#é¢˜ç›®-BUUCTF-easystrcmp" class="headerlink" title="é¢˜ç›®-BUUCTF-easystrcmp"></a>é¢˜ç›®-BUUCTF-easystrcmp</h1><p>è¿›å…¥ä¸»å‡½æ•°</p><p><img src="/2022/02/03/Hook/1643884712406.png"></p><p>çœ‹ä¼¼æ˜¯ä¸€ä¸ªç®€å•çš„æ¯”è¾ƒï¼Œä½†æ˜¯è¾“å…¥ä¹‹åå‘ç°å¹¶ä¸å¯¹</p><p>åº”è¯¥æ˜¯åšäº†ä»€ä¹ˆå¤„ç†ï¼ŒåŠ¨æ€è°ƒè¯•</p><p>ç‚¹è¿›strcmpå‡½æ•°</p><p><img src="/2022/02/03/Hook/1643884961802.png"></p><p>å‘ç°è·³è½¬åˆ°äº†åŠ å¯†å‡½æ•°</p><p>åŸç†åˆ†æ</p><p>å› ä¸ºå­˜åœ¨initæ®µï¼Œå»æŸ¥çœ‹å‡½æ•°</p><p><img src="/2022/02/03/Hook/1643885017644.png"></p><p>è¿™æ ·å¯ä»¥æŸ¥çœ‹å‡½æ•°åˆ—è¡¨è¿›è¡Œè·³è½¬</p><p><img src="/2022/02/03/Hook/1643885047181.png"></p><p>è¿›å…¥offå‡½æ•°</p><p><img src="/2022/02/03/Hook/1643885073169.png"></p><p>ç¬¬ä¸€ä¸ªå‡½æ•°ç‚¹è¿›å»æ²¡å‘ç°ä»€ä¹ˆï¼Œç¬¬äºŒä¸ªå‡½æ•°ç‚¹è¿›å»</p><p><img src="/2022/02/03/Hook/1643885101701.png"></p><p>å¯ä»¥çœ‹åˆ°å…ˆæŠŠstrcmpå‡½æ•°çš„åœ°å€èµ‹å€¼ç»™qword_201090</p><p>ç„¶åæŠŠsub_6EAå‡½æ•°èµ‹å€¼ç»™off-102028,ç‚¹è¿›å»</p><p><img src="/2022/02/03/Hook/1643885199097.png"></p><p>å‘ç°æ­£å¥½æ˜¯strcmpçš„åœ°å€ï¼Œæ‰€ä»¥çœŸæ­£è¿è¡Œèµ·æ¥ï¼Œå‡½æ•°ä¼šè·³è½¬åˆ°sub_6EAå‡½æ•°ä¸­ï¼Œè€Œä¸æ˜¯strcmpå‡½æ•°ï¼Œè¿™æ ·å°±å®ç°äº†ä¸€ä¸ªç®€å•çš„hook</p><p>è„šæœ¬</p><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;#include &lt;string.h&gt;int main(){char flag[]="********CENSORED********";char s[]={0x42, 0x09,   0x4A, 0x49, 0x35, 0x43, 0x0A, 0x41, 0xF0, 0x19, 0xE6, 0x0B,   0xF5, 0xF2, 0x0E, 0x0B, 0x2B, 0x28, 0x35, 0x4A, 0x06, 0x3A,   0x0A, 0x4F};  for(int i=0;i&lt;strlen(flag);++i)  {  flag[i]+=s[i];  }  printf("%s",flag);return 0; } </code></pre><p><a href="https://www.cnblogs.com/iBinary/p/7599789.html%E5%85%B7%E4%BD%93%E8%AE%B2%E8%A7%A3%E4%BB%80%E4%B9%88%E6%98%AFHook">https://www.cnblogs.com/iBinary/p/7599789.htmlå…·ä½“è®²è§£ä»€ä¹ˆæ˜¯Hook</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Initåˆå§‹åŒ–</title>
      <link href="/2022/02/03/Init%E5%88%9D%E5%A7%8B%E5%8C%96/"/>
      <url>/2022/02/03/Init%E5%88%9D%E5%A7%8B%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="ELFæ–‡ä»¶ç»“æ„"><a href="#ELFæ–‡ä»¶ç»“æ„" class="headerlink" title="ELFæ–‡ä»¶ç»“æ„"></a>ELFæ–‡ä»¶ç»“æ„</h1><p><a href="https://carrychen.website/2021/05/14/elf-format/">https://carrychen.website/2021/05/14/elf-format/</a></p><p> .initèŠ‚å®šä¹‰äº†ä¸€ä¸ª_initå‡½æ•°ï¼Œç”¨äºå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶å¼€å§‹æ—¶çš„åˆå§‹åŒ–å·¥ä½œã€‚å½“è¿›å…¥ä¸»ç¨‹åºä¹‹å‰ï¼Œç³»ç»Ÿå…ˆæ‰§è¡Œ.initèŠ‚çš„æŒ‡ä»¤ä»£ç åˆå§‹åŒ– </p><h1 id="ä¾‹é¢˜-hgame2022-week2-fakeshell"><a href="#ä¾‹é¢˜-hgame2022-week2-fakeshell" class="headerlink" title="ä¾‹é¢˜-hgame2022-week2-fakeshell"></a>ä¾‹é¢˜-hgame2022-week2-fakeshell</h1><p>å…ˆå»çœ‹çœ‹initæ®µè¿›è¡Œäº†ä»€ä¹ˆå¤„ç†</p><p><img src="/2022/02/03/Init%E5%88%9D%E5%A7%8B%E5%8C%96/1643870839069.png"></p><p><img src="/2022/02/03/Init%E5%88%9D%E5%A7%8B%E5%8C%96/1643870867197.png"></p><p><img src="/2022/02/03/Init%E5%88%9D%E5%A7%8B%E5%8C%96/1643870876729.png"></p><p>åœ¨ç¬¬äºŒä¸ªå‡½æ•°å‘ç°äº†å¤„ç†</p><p><img src="/2022/02/03/Init%E5%88%9D%E5%A7%8B%E5%8C%96/1643870922345.png"></p><p>æŸ¥çœ‹aHappyh4meäº¤å‰å¼•ç”¨</p><p><img src="/2022/02/03/Init%E5%88%9D%E5%A7%8B%E5%8C%96/1643870957940.png"></p><p>å¯ä»¥çœ‹åˆ°åé¢è¿˜æœ‰æ“ä½œ</p><p>å®šä½åˆ°åŠ å¯†å‡½æ•°</p><p><img src="/2022/02/03/Init%E5%88%9D%E5%A7%8B%E5%8C%96/1643870991851.png"></p><p><img src="/2022/02/03/Init%E5%88%9D%E5%A7%8B%E5%8C%96/1643871002931.png"></p><p>å¯ä»¥çŸ¥é“æ˜¯rc4åŠ å¯†ï¼Œå¯†é’¥åœ¨initæ®µè¢«ä¿®æ”¹äº†</p><p>å†™è„šæœ¬ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å·¥å…·CaptfEncoder-win-1.1.0</p><p>å¾—åˆ°flag</p><p><img src="/2022/02/03/Init%E5%88%9D%E5%A7%8B%E5%8C%96/1643871135186.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SEHåŸç†å’Œä¾‹é¢˜</title>
      <link href="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/"/>
      <url>/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="WINDOWSä¸‹çš„å¼‚å¸¸å¤„ç†"><a href="#WINDOWSä¸‹çš„å¼‚å¸¸å¤„ç†" class="headerlink" title="WINDOWSä¸‹çš„å¼‚å¸¸å¤„ç†"></a>WINDOWSä¸‹çš„å¼‚å¸¸å¤„ç†</h1><h2 id="å¼‚å¸¸åˆ—è¡¨"><a href="#å¼‚å¸¸åˆ—è¡¨" class="headerlink" title="å¼‚å¸¸åˆ—è¡¨"></a>å¼‚å¸¸åˆ—è¡¨</h2><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20220203125855.jpg"></p><h1 id="SEH"><a href="#SEH" class="headerlink" title="SEH"></a>SEH</h1><p><a href="https://www.cnblogs.com/Sna1lGo/p/14732048.html#:~:text=Windows%E4%B8%AD,%E5%88%99%E7%9B%B4%E6%8E%A5%E7%A8%8B%E5%BA%8F%E5%B4%A9%E6%BA%83%E3%80%82%E4%BB%8B%E7%BB%8D">https://www.cnblogs.com/Sna1lGo/p/14732048.html#:~:text=Windows%E4%B8%AD,%E5%88%99%E7%9B%B4%E6%8E%A5%E7%A8%8B%E5%BA%8F%E5%B4%A9%E6%BA%83%E3%80%82ä»‹ç»</a></p><h2 id="é¢˜ç›®â€”â€”hagme2022â€”â€”week2â€”â€”creakme2"><a href="#é¢˜ç›®â€”â€”hagme2022â€”â€”week2â€”â€”creakme2" class="headerlink" title="é¢˜ç›®â€”â€”hagme2022â€”â€”week2â€”â€”creakme2"></a>é¢˜ç›®â€”â€”hagme2022â€”â€”week2â€”â€”creakme2</h2><p>åœ¨é™æ€åˆ†æä¸­ï¼Œåªæ‰¾åˆ°äº†teaåŠ å¯†ç®—æ³•ï¼Œç›´æ¥å†™è„šæœ¬è§£ä¸å‡ºæ¥ï¼Œå»æŸ¥çœ‹æ±‡ç¼–ä»£ç ï¼ˆå› ä¸ºæœ‰æ—¶å€™idaæ²¡åŠæ³•è¯†åˆ«å‡ºä¸€äº›æ±‡ç¼–ï¼‰</p><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/1643864939414.png"></p><p>ç¬¬ä¸€ä¸ªæ¡†å¯¹åº”ä¸Šä¸Šé¢é‚£å¥ä»£ç ï¼Œè¿™é‡ŒæŒ‰/å°±ä¼šæ˜¾ç¤ºå‡ºæ¥å¯¹åº”åç¼–è¯‘è¿‡æ¥çš„ä¼ªä»£ç </p><p>ä¸‹é¢ä¸¤ä¸ªæ¡†çš„éƒ½æ˜¯æ²¡è¢«è¯†åˆ«çš„è¯­å¥</p><p>åœ¨å›¾ä¸­ä½ç½®ä¸‹æ–­ç‚¹è¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼Œä¼šæŠ¥é”™</p><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/1643865333034.png"></p><p>å› ä¸ºé™¤æ•°ä¸èƒ½ä¸º0ï¼Œå»çœ‹çœ‹æ±‡ç¼–</p><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/1643865908164.png"></p><p>æŒ‰ï¼›å†™ä¸‹æ³¨é‡Š</p><p>å¼€å§‹åŠ¨æ€è°ƒè¯•</p><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/1643866006832.png"></p><p>é€‰æ‹©yesï¼Œå‘ç°è¿›å…¥åˆ°è¿™æ®µæœªè¢«åç¼–è¯‘çš„è¯­å¥</p><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/1643866024820.png"></p><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/1643866787250.png"></p><p>ç¬¬äºŒæ¬¡æ‰§è¡Œåˆ°è¿™ä¸€æ®µä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ecxå¯„å­˜å™¨çš„å€¼ä¸æ˜¯0ï¼Œä¸ä¼šè§¦å‘å¼‚å¸¸</p><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/1643866890816.png"></p><p>å‘ç°æ²¡æœ‰æ‰§è¡Œå¼‚æˆ–ï¼Œè€Œæ˜¯ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œè¿™å°±æ˜¯ä¸‹ä¸€æ­¥è¿›è¡Œçš„åæ±‡ç¼–è¯­å¥</p><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/1643866944920.png"></p><p>å› æ­¤å¯ä»¥çŸ¥é“ï¼Œå½“å˜é‡numçš„æœ€é«˜ä½ä¸º0çš„æ—¶å€™ï¼Œä¼šè§¦å‘å¼‚å¸¸ï¼Œè¿™æ—¶å€™ç³»ç»Ÿä¼šäº¤ç»™SEHè¿›è¡Œå¤„ç†ï¼Œå³__tryä»£ç </p><p>__exceptä¼šæ‰§è¡Œå¼‚å¸¸åä»£ç </p><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/1643867671850.png"></p><p>æŒ‰ç©ºæ ¼æŸ¥çœ‹æ‰§è¡Œé¡ºåº</p><p><img src="/2022/02/03/SEH%E5%8E%9F%E7%90%86%E5%92%8C%E4%BE%8B%E9%A2%98/1643867149242.png"></p><p>ä¼šå‘ç°è¿™æ ·ä¸€æ®µç‹¬ç«‹å‡ºæ¥çš„æ±‡ç¼–ä»£ç </p><p>æ‰€ä»¥å°±å¯ä»¥å†™è„šæœ¬ï¼Œå› ä¸ºæ˜¯unsigned intï¼Œå³ç§»31ä½å°±èƒ½çŸ¥é“æœ€é«˜ä½äº†</p><p>è„šæœ¬</p><pre class="language-c" data-language="c"><code class="language-c">#include &lt;stdio.h&gt;#include &lt;string.h&gt;int main(){    unsigned int tmp1, tmp2;    unsigned int num;    unsigned int init_num=0;    int Buf2[8] = { 0 };    unsigned int key[10] = { 1,2,3,4,5,6,7,8.9,0 };    Buf2[0] = 0x457E62CF;    Buf2[1] = 0x9537896C;    Buf2[2] = 0x1F7E7F72;    Buf2[3] = 0xF7A073D8;    Buf2[4] = 0x8E996868;    Buf2[5] = 0x40AFAF99;    Buf2[6] = 0xF990E34;    Buf2[7] = 0x196F4086;    for (int i = 0; i &lt; 32; i++)    {        init_num += 2654435761;        if ((init_num &gt;&gt;31) == 0)        {            init_num ^= 0x1234567;        }    }//0C78E4D05    for (int j = 0; j &lt; 8; j += 2)    {        tmp1 = Buf2[j], tmp2 = Buf2[j + 1];        num = init_num;        for (int i = 0; i &lt; 32; i++)        {            tmp2 -= (num + key[(num &gt;&gt; 11) &amp; 3]) ^ (tmp1 + ((16 * tmp1) ^ (tmp1 &gt;&gt; 5)));            if ((num&gt;&gt;31) == 0)            {                num ^= 0x01234567;            }            num -= 2654435761;            tmp1 -= (num + key[num &amp; 3]) ^ (tmp2 + ((16 * tmp2) ^ (tmp2 &gt;&gt; 5)));        }        Buf2[j] = tmp1;        Buf2[j + 1] = tmp2;    }    for (int i = 0; i &lt; 8; i++)    {        printf("%x\n", Buf2[i]);    }    printf("%s", Buf2);}</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cè¯­è¨€æ±‡ç¼–2</title>
      <link href="/2022/02/02/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%962/"/>
      <url>/2022/02/02/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%962/</url>
      
        <content type="html"><![CDATA[<h1 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h1>]]></content>
      
      
      
        <tags>
            
            <tag> æ±‡ç¼– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VMé€†å‘</title>
      <link href="/2022/01/23/VM%E9%80%86%E5%90%91/"/>
      <url>/2022/01/23/VM%E9%80%86%E5%90%91/</url>
      
        <content type="html"><![CDATA[<h1 id="Dasctfâ€”â€”EasyVm"><a href="#Dasctfâ€”â€”EasyVm" class="headerlink" title="Dasctfâ€”â€”EasyVm"></a>Dasctfâ€”â€”EasyVm</h1><p>ä¸€å¼€å§‹æœ‰ä¸ªèŠ±æŒ‡ä»¤ï¼Œæ˜¯æ¯”è¾ƒå¸¸è§çš„æ°¸çœŸè·³è½¬ï¼Œå…ˆå¯¹callæŒ‡ä»¤æŒ‰uå–æ¶ˆå®šä¹‰ï¼Œå°†e8æ”¹ä¸º90ï¼Œå†é‡æ–°å¼„æˆå‡½æ•°å°±å¯ä»¥äº†</p><p>å…ˆæ‰¾åˆ°åŠ å¯†çš„å‡½æ•°</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642951424173.png"></p><p>ç‚¹è¿›å»çœ‹çœ‹</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642951469199.png"></p><p>è¿™é‡Œæ˜¯base64å˜ç§ï¼Œåœ¨æœ€ååŠ äº†ä¸€ä¸ªå¼‚æˆ–æ“ä½œï¼Œå…ˆæŠŠè„šæœ¬å†™å‡ºæ¥</p><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;#include&lt;string.h&gt;char base64_table[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";int findIndex(char c, char b64_table[]){for (int i = 0; i &lt; 64; ++i){if (c == b64_table[i])return i;}}char* base64_decode(char code[], char str[], char b64_table[]){char memstr[200] = { 0 };memcpy(memstr, code, strlen(code));int len = strlen(code);/*while (code[len] != '!' &amp;&amp; code[len] != 0){len++;}*/for (int i = 0, i_ = 0; i &lt; len; i += 4, i_ += 3){str[i_] = (findIndex(memstr[i]^0xa, b64_table) &lt;&lt; 2) | (findIndex(memstr[i + 1]^0xb, b64_table) &amp; 0x30) &gt;&gt; 4;str[i_ + 1] = (findIndex(memstr[i + 1]^0xb, b64_table) &amp; 0xf) &lt;&lt; 4 | (findIndex(memstr[i + 2]^0xc, b64_table) &amp; 0x3c) &gt;&gt; 2;str[i_ + 2] = (findIndex(memstr[i + 2]^0xc, b64_table) &amp; 0x03) &lt;&lt; 6 | (findIndex(memstr[i + 3]^0xd, b64_table));}int str_len = (len / 4) * 3 + len % 4;if (len % 4){str_len -= 1;}str[str_len] = 0;return str;}int main(){char code[100] = "";char decode[] = { 0 };base64_decode(code, decode, base64_table);printf("%s", decode);return 0;}</code></pre><p>æ¥ä¸‹æ¥å°±æ˜¯vmçš„éƒ¨åˆ†</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642951694407.png"></p><p>å…ˆçœ‹funcå‡½æ•°çš„ç±»å‹ï¼Œæ˜¯æŒ‡é’ˆæ•°ç»„</p><p>è¿™é‡Œéœ€è¦ç»“åˆåŠ¨è°ƒçœ‹æ¯æ¡æŒ‡ä»¤å¯¹åº”çš„æ“ä½œ</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642953729321.png"></p><p>åœ¨è¿™é‡Œä¸‹æ–­ç‚¹ä¹‹åF7è¿›å…¥å‡½æ•°</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642953871966.png"></p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642955403773.png"></p><p>è¿™å°±æ˜¯funcæ•°ç»„å­˜æ”¾çš„ä¸œè¥¿ï¼Œå› ä¸ºæ˜¯æŒ‡é’ˆï¼Œæ‰€ä»¥è¦å…ˆæŒ‰dè½¬ä¸ºddæ‰ä¼šæ˜¾ç¤º</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642955602049.png"></p><p>å…ˆæŠŠæŒ‡ä»¤æå–å‡ºæ¥</p><pre class="language-c" data-language="c"><code class="language-c">unsigned char ida_chars[] ={  0xCA, 0x00, 0x00, 0x00, 0x00, 0xCB, 0x00, 0x00, 0x00, 0x00,  0xCC, 0xCF, 0xC9, 0xEE, 0x00, 0x00, 0x00, 0xCF, 0xD1, 0xD3,  0x01, 0xFE, 0xC2, 0xD2, 0x39, 0x00, 0x00, 0x00, 0xD4, 0xEC,  0xFF, 0x00};</code></pre><p>F8å•æ­¥è°ƒè¯•</p><p>0xCA</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642955631076.png"></p><p>0xCB</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642955978948.png"></p><p>0xCC</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642955994447.png"></p><p>0xCF</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642956392630.png"></p><p>æ¯æ‰§è¡Œå®Œå†è¿›å…¥func[2]éƒ½èƒ½çŸ¥é“å½“å‰ä½ç½®ï¼Œä¾¿äºæŸ¥çœ‹æŒ‡ä»¤</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642956568041.png"></p><p>0xc9</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642956806744.png"></p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642957130761.png"></p><p>0xd1</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642957467393.png"></p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642957487310.png"></p><p>è¿™é‡Œæœ¬æ¥èµ‹å€¼ä¸º0ï¼Œ1ï¼Œ2ï¼Œä¸ºäº†ä¿æŒå­—ç¬¦ç›¸ç­‰çš„æƒ…å†µï¼ŒæŠŠ this[5]å…¨éƒ¨èµ‹å€¼ä¸º1</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642987459030.png"></p><p>0xd3</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642988305784.png"></p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642988338522.png"></p><p>0xc2</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642988366450.png"></p><p>0xd2</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642988655617.png"></p><p>é•¿åº¦åˆ¤æ–­</p><p>0xd4</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642988824766.png"></p><p>0xcc</p><p>æ¥ä¸‹æ¥åˆå›åˆ°0xccï¼Œæ‰€ä»¥å°±èƒ½çŒœæµ‹æ˜¯å¾ªç¯åšäº†å¼‚æˆ–æ“ä½œï¼Œç„¶ååˆ¤æ–­</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642989162099.png"></p><table><thead><tr><th>func[1]</th><th>æŒ‡ä»¤é›†</th></tr></thead><tbody><tr><td>func[2]</td><td>åŠ å¯†åçš„flagçš„å­—ç¬¦</td></tr><tr><td>func[3]</td><td>0</td></tr><tr><td>func[4]</td><td>ç´¢å¼•</td></tr><tr><td>func[5]</td><td>åˆ¤æ–­å­—ç¬¦ç›¸ç­‰</td></tr><tr><td>func[6]</td><td>å¯¹æ¯”çš„flag</td></tr><tr><td>func[7]</td><td>0</td></tr><tr><td>func[8]</td><td>åŠ å¯†åçš„å­—ç¬¦ä¸²</td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td>0xca</td><td>å…ˆå°†this[1]æŒ‡ä»¤åçš„æ•°æ®å­˜æ”¾åˆ°this[3]ï¼Œç„¶åå¾€åè·³è½¬5ï¼Œæ­£å¥½å¯¹åº”äº†ä¸‹ä¸€æ¡æŒ‡ä»¤,ä¸€å¼€å§‹this[1]åä¸€ä¸ªæ•°æ®ä¸º0ï¼Œè¦å…ˆè½¬ä¸º dword</td></tr><tr><td></td><td></td></tr><tr><td>0xcb</td><td>å…ˆå°†this[1]æŒ‡ä»¤åçš„æ•°æ®å­˜æ”¾åˆ°this[4]ï¼Œç„¶åå¾€åè·³è½¬5ï¼Œè¿™ä¹Ÿæ˜¯ä¸‹ä¸€æ¡æŒ‡ä»¤</td></tr><tr><td></td><td></td></tr><tr><td>0xcc</td><td>æŠŠthis[2]å…ˆèµ‹å€¼ä¸ºthis[8]+this[4]ï¼Œè¿™é‡Œthis[4]æ˜¯ä¸ªæ•´æ•°ï¼Œæ‰€ä»¥çŒœæµ‹this[4]æ˜¯ç´¢å¼•ï¼Œç„¶åç»§ç»­æ‰§è¡Œä¸‹ä¸€æŒ‡ä»¤</td></tr><tr><td></td><td></td></tr><tr><td>0xcf</td><td>å°†this[3]å’Œthis[2]çš„å€¼å¼‚æˆ–åå­˜æ”¾åœ¨this[3],è¿›å…¥ä¸‹ä¸€æ¡æŒ‡ä»¤</td></tr><tr><td></td><td></td></tr><tr><td>0xc9</td><td>å…ˆæŠŠthis[1]ä¸‹ä¸€ä¸ªæ•°æ®èµ‹å€¼ç»™this[2],è¿›å…¥ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯0xee</td></tr><tr><td></td><td></td></tr><tr><td>0xcf</td><td>å°†this[3]å’Œthis[2]çš„å€¼å¼‚æˆ–åå­˜æ”¾åœ¨this[3],è¿›å…¥ä¸‹ä¸€æ¡æŒ‡ä»¤</td></tr><tr><td></td><td></td></tr><tr><td>0xd1</td><td>æ ¹æ®this[4]çš„ç´¢å¼•æ¥è¿›è¡Œå­—ç¬¦æ¯”è¾ƒï¼Œè¿™é‡Œæ˜¯è°ƒè¯•è¿‡ç¨‹ï¼Œæ‰€ä»¥ä¸ºäº†è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œéœ€è¦ä¿®æ”¹æ±‡ç¼–æŒ‡ä»¤</td></tr><tr><td></td><td></td></tr><tr><td>0xd3</td><td>v1æ˜¯æŒ‡é’ˆï¼Œè§£å¼•ç”¨æ˜¯v1ä¸‹ä¸€ä¸ªä½ç½®ï¼Œä¹Ÿå°±æ˜¯0x1ï¼Œæ•´ä¸ªå°±æ˜¯0xeeï¼Œè¿™æ—¶å€™ç„¶åæŒ‡å‘ä¸‹ä¸‰ä¸ªä½ç½®ï¼Œä¹Ÿå°±æ˜¯c2æŒ‡ä»¤</td></tr><tr><td></td><td></td></tr><tr><td>0xc2</td><td>ç´¢å¼•this[4]+1</td></tr><tr><td></td><td></td></tr><tr><td>0xd2</td><td>this[4]æ˜¯ç´¢å¼•ï¼Œæ‰€ä»¥æ˜¯åˆ¤æ–­æ˜¯å¦ç»“æŸï¼Œè¿™é‡Œæ²¡ç»“æŸï¼Œæ‰€ä»¥this[5]èµ‹å€¼ä¸º0</td></tr><tr><td></td><td></td></tr><tr><td>0xd4</td><td>ec+2==ee</td></tr></tbody></table><p>æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯è¿™æ ·</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20220124125427.jpg"></p><p>å› ä¸ºå¶æ•°æ¬¡çš„å¼‚æˆ–ç­‰äºä¸å˜ï¼Œæ‰€ä»¥åªéœ€å¯¹å¥‡æ•°æ¬¡çš„è¿›è¡Œå¼‚æˆ–å³å¯</p><p>æœ€ç»ˆè„šæœ¬</p><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;#include&lt;string.h&gt;char base64_table[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";int findIndex(char c, char b64_table[]){for (int i = 0; i &lt; 64; ++i){if (c == b64_table[i])return i;}}char* base64_decode(char code[], char str[], char b64_table[]){char memstr[200] = { 0 };memcpy(memstr, code, strlen(code));int len = strlen(code);/*while (code[len] != '!' &amp;&amp; code[len] != 0){len++;}*/for (int i = 0, i_ = 0; i &lt; len; i += 4, i_ += 3){str[i_] = (findIndex(memstr[i], b64_table) &lt;&lt; 2) | (findIndex(memstr[i + 1], b64_table) &amp; 0x30) &gt;&gt; 4;str[i_ + 1] = (findIndex(memstr[i + 1], b64_table) &amp; 0xf) &lt;&lt; 4 | (findIndex(memstr[i + 2], b64_table) &amp; 0x3c) &gt;&gt; 2;str[i_ + 2] = (findIndex(memstr[i + 2], b64_table) &amp; 0x03) &lt;&lt; 6 | (findIndex(memstr[i + 3], b64_table));}int str_len = (len / 4) * 3 + len % 4;if (len % 4){str_len -= 1;}str[str_len] = 0;return str;}int main(){char s[] ={  190,  54, 172,  39, 153,  79, 222,  68, 238,  95,  218,  11, 181,  23, 184, 104, 194,  78, 156,  74,  225,  67, 240,  34, 138,  59, 136,  91, 229,  84,  255, 104, 213, 103, 212,   6, 173,  11, 216,  80,  249,  88, 224, 111, 197,  74, 253,  47, 132,  54,  133,  82, 251, 115, 215,  13,0};char s2[] = { 0 };for (int i = 0; i &lt; 56; i+=2){s[i] ^= 0xee;}for (int i = 0; i &lt; 56; ++i){s2[i] = s[i];for (int k = i; k &gt; 0; k--){s2[i] ^= (s2[k - 1]);//è¯¥å­—ç¬¦å‰é¢çš„å…¨éƒ¨éƒ½è¦å¼‚æˆ–ä¸Š}}//printf("%s", s2);for (int i = 0; i &lt; 56; i = i + 4){s2[i] ^= 0xA;s2[i + 1] ^= 0xB;s2[i + 2] ^= 0xC;s2[i + 3] ^= 0xD;}char decode[] = { 0 };base64_decode(s2, decode, base64_table);printf("%s", decode);return 0;}</code></pre><h1 id="hgame2022-week4-easyvm"><a href="#hgame2022-week4-easyvm" class="headerlink" title="hgame2022-week4-easyvm"></a>hgame2022-week4-easyvm</h1><p>ç¬¬ä¸€æ¬¡å°è¯•å†™è§£é‡Šå™¨ï¼Œè·Ÿç€åˆ«äººçš„å¤§è‡´æ€è·¯çš„</p><p>é¦–å…ˆVMå°±æ˜¯æ¨¡ä»¿æ±‡ç¼–ï¼Œç”¨æŒ‡ä»¤ä»£æ›¿æ±‡ç¼–ï¼Œç”¨æ•°æ®æ®µæ¥æ¨¡æ‹Ÿå¯„å­˜å™¨å’Œæ•°æ®æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬å…³é”®æ˜¯è¦æ‰¾åˆ°æ•°æ®æ®µå’Œæ“ä½œæ•°ã€opcodeï¼Œä»¥åŠä¸€äº›æ•°æ®å­˜æ”¾å†…å®¹çš„å«ä¹‰</p><p>å…ˆæ¥ç»™å¯„å­˜å™¨é‡æ–°å‘½å</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645447619996.png"></p><p>æ ¹æ®mainå‡½æ•°ä¸­switchå¯ä»¥æ‰¾åˆ°ç±»å¯„å­˜å™¨çš„ä½ç½®ï¼Œé‡å‘½å</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645447726404.png"></p><p>ä»switchçš„v3å¯ä»¥çŸ¥é“ï¼Œå‰é¢ç»™v3èµ‹å€¼çš„å°±æ˜¯æ“ä½œæ•°</p><p>r0[0]å¼€å§‹æ˜¯0ï¼Œæ‰€ä»¥æ“ä½œæŒ‡ä»¤ç¬¬ä¸€ä¸ªå­˜å‚¨çš„ä½ç½®æ˜¯r0[109]ï¼Œå› ä¸ºæ˜¯intå‹ï¼Œè®¡ç®—çš„æ—¶å€™Ã—4ï¼Œå°±å¯ä»¥æ‰¾åˆ°åœ°å€</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645447904556.png"></p><p>æŒ‰gè·³è½¬ï¼Œä½¿ç”¨lazyida dumpä¸‹æ¥</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645447995063.png"></p><p>æ¥ä¸‹æ¥åŠ¨è°ƒåˆ†ææ¯æ¡æŒ‡ä»¤å¯¹åº”çš„æ±‡ç¼–ä»£ç </p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645448145669.png"></p><p>å…ˆ++ï¼Œå†èµ‹å€¼ç»™å®ƒï¼Œå°±ç›¸å½“äºpushæŒ‡ä»¤çš„å…¥æ ˆæ“ä½œï¼Œç„¶åè¿˜æœ‰ä¸€ä¸ªr4åç§»ä¸€ä½</p><table><thead><tr><th>push</th><th>data[r4++]</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645448615771.png"></p><p>å…ˆâ€“ï¼Œå†èµ‹å€¼ç»™r5ï¼Œç›¸å½“äºpopæ“ä½œ</p><table><thead><tr><th>pop</th><th>r5</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645448764344.png"></p><p>åˆå›åˆ°0x12ï¼Œè¿˜æ˜¯pushï¼Œä½†æ˜¯å› ä¸ºr4++ï¼Œæ‰€ä»¥å·²ç»åç§»ï¼Œæˆ‘ä»¬æ ¹æ®è®¡ç®—ä¹Ÿå¯ä»¥æ‰¾åˆ°å­˜å‚¨æ•°æ®çš„åœ°å€å¹¶æå–å‡ºæ•°æ®</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645448880740.png"></p><p>å›åˆ°æ±‡ç¼–ï¼Œè¿™é‡Œçš„æŒ‡ä»¤pushäº†-5è¿›å…¥åˆ°å †æ ˆï¼Œä¹Ÿå°±æ˜¯å¯„å­˜å™¨ä¸‹é¢çš„ä½ç½®</p><table><thead><tr><th>push</th><th>data[r4++]</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645449458278.png"></p><table><thead><tr><th>pop</th><th>r6</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645449560687.png"></p><p>è·å–è¾“å…¥ï¼Œå¹¶å­˜å‚¨åˆ°a1ä¸­ï¼Œè¿™é‡Œçš„a1å¯¹åº”r3</p><table><thead><tr><th>getchar</th><th>r3</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645449886162.png"></p><p>ç†Ÿæ‚‰çš„æ“ä½œï¼ŒæŠŠè¾“å…¥å‹å…¥å †æ ˆï¼Œè®°å¾—æ ˆé¡¶å¾€ä½å¤„ç§»åŠ¨</p><table><thead><tr><th>push</th><th>r3</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645450099792.png"></p><p>è¿™é‡Œçš„a1æ˜¯r2</p><table><thead><tr><th>add</th><th>r2,1</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645450235632.png"></p><table><thead><tr><th>cmp</th><th>r3,r5</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>æ ¹æ®å‰é¢çš„pop r5å¯ä»¥çŸ¥é“æ­¤æ—¶r5æ˜¯0Aï¼Œè€Œæˆ‘ä»¬çš„è¾“å…¥è¢«å­˜å…¥äº†r3ï¼Œä¹Ÿå°±æ˜¯å¯¹æˆ‘ä»¬çš„è¾“å…¥å­—ç¬¦è¿›è¡Œåˆ¤æ–­ï¼Œé‚£ä¹ˆr8åº”è¯¥å°±å¯¹åº”ZFæ ‡å¿—ä½</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645513351201.png"></p><p>éªŒè¯äº†ä¸Šé¢çš„æƒ³æ³•ï¼Œè¿™é‡Œçš„a1æ˜¯r6ï¼Œä¹Ÿå°±æ˜¯-5ï¼ŒæŒ‡ä»¤è·³è½¬å›å»ï¼Œç›¸å½“äºè¿›è¡Œå¾ªç¯ï¼Œè¾“å…¥å®Œæˆåä¼šæœ‰ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œgetcharä¼šå¸æ”¶ï¼Œè¿™é‡Œä¹Ÿå°±æ˜¯ç»“æŸæˆ‘ä»¬çš„å¾ªç¯</p><table><thead><tr><th>jnz</th><th>r0-5</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>ç›´æ¥åœ¨ä¸‹ä¸€æ¡æŒ‡ä»¤ä¸‹æ–­ç‚¹ï¼ŒF9è¿è¡Œ</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645513742181.png"></p><p>è¿™é‡Œçš„a1æ˜¯r2ï¼Œç”¨äºè®°å½•è¾“å…¥é•¿åº¦ï¼Œå› ä¸ºæœ€åæœ‰ä¸€ä¸ªå›è½¦ç¬¦ï¼Œæ‰€ä»¥è¦â€“</p><table><thead><tr><th>r2â€“</th><th></th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>æ ¹æ®å‰é¢å°±å¯ä»¥å…ˆå¯¹æ•°ç»„è¿›è¡Œæ³¨é‡Š</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514228495.png"></p><p>r4æ²¡å†™ä¸Šå»ï¼Œæ˜¯å†…å­˜ä¸­å­˜å‚¨çš„ä¸€æ®µæ•°æ®</p><p>ç»§ç»­å¾€ä¸‹èµ°</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514299405.png"></p><p>å°†å†…å­˜æ®µçš„ä¸‹ä¸€ä¸ªæ•°æ®å…¥æ ˆï¼Œä¹Ÿå°±æ˜¯0x20</p><table><thead><tr><th>push</th><th>data[r4++]</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514469709.png"></p><table><thead><tr><th>pop</th><th>r5,è¿™é‡Œæ‡’å¾—æ”¹äº†ï¼Œå¯ä»¥ç‚¹è¿‡å»æŸ¥çœ‹</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>æ¥ä¸‹æ¥æ˜¯0x12å’Œ0x9</p><table><thead><tr><th>push</th><th>data[r4++]</th></tr></thead><tbody><tr><td>pop</td><td>r6</td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514666638.png"></p><p>æŠŠr2çš„å€¼èµ‹ç»™r3</p><table><thead><tr><th>mov</th><th>r3,r2</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514774277.png"></p><table><thead><tr><th>push</th><th>r3</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514918356.png"></p><table><thead><tr><th>cmp</th><th>r3,r5</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>ä½†æ˜¯è¿™æ¬¡æ¯”è¾ƒçš„æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²é•¿åº¦æ˜¯32</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515061894.png"></p><table><thead><tr><th>jnz</th><th>r0+r6</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>è¿™é‡Œr6å­˜æ”¾çš„æ˜¯2fï¼Œæ­£å¥½å¯¹åº”ç»“æŸï¼Œæ‰€ä»¥è¿™æ®µå°±ç›¸å½“äºexit</p><p>ä¸‹é¢æ˜¯0x12å’Œ0x09</p><table><thead><tr><th>push</th><th>data[r4++]</th></tr></thead><tbody><tr><td>pop</td><td>r6</td></tr></tbody></table><p>0x12å’Œ0x0A</p><p>è¿™æ˜¯0x0açš„ä»£ç </p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515342308.png"></p><table><thead><tr><th>push</th><th>data[r4++]</th></tr></thead><tbody><tr><td>pop</td><td>r2</td></tr></tbody></table><p>0x13</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515472275.png"></p><p>r2æ­¤æ—¶ä¸º0ï¼Œ+9æ­£å¥½æ˜¯å †æ ˆçš„ä½ç½®ï¼Œä¹Ÿæ˜¯å­˜æ”¾æˆ‘ä»¬è¾“å…¥æ•°æ®çš„ä½ç½®</p><table><thead><tr><th>mov</th><th>r3,stack[count]</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>ä»ä¸‹é¢å¼€å§‹å°±æ˜¯åŠ å¯†çš„éƒ¨åˆ†äº†</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515606892.png"></p><table><thead><tr><th>push</th><th>data[r4++]</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x0B</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515758080.png"></p><table><thead><tr><th>pop</th><th>r7</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x15</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515807493.png"></p><table><thead><tr><th>add</th><th>r3,r3</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x03</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515866224.png"></p><table><thead><tr><th>xor</th><th>r3,r7</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515954359.png"></p><p>æŠŠå¤„ç†å®Œçš„æ•°æ®é‡æ–°æ”¾å…¥æ ˆä¸­</p><table><thead><tr><th>mov</th><th>stack[count],r3</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645516003430.png"></p><table><thead><tr><th>add</th><th>r2,1</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645516131712.png"></p><table><thead><tr><th>mov</th><th>r3,r2</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0xF</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645516166189.png"></p><table><thead><tr><th>cmp</th><th>r3,r5</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645516207834.png"></p><table><thead><tr><th>jnz</th><th>r0+r6</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>æ­¤æ—¶çš„r6æ˜¯-10ï¼Œä¹Ÿå°±æ˜¯è·³è½¬å›åˆ°å‰åæ¡æŒ‡ä»¤ï¼Œè¿™å°±æ˜¯å¾ªç¯åŠ å¯†ï¼Œç°åœ¨å°±å·®æœ€ç»ˆçš„å¯†æ–‡äº†ï¼Œå‰é¢åŠ å¯†çš„éƒ¨åˆ†ç›´æ¥è¿è¡Œè¿‡å»</p><p>å†æ¬¡æ¥åˆ°0x12</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645516848887.png"></p><table><thead><tr><th>push</th><th>data[r4++]</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0xA</p><table><thead><tr><th>pop</th><th>r2</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645517151788.png"></p><p>æ¥ä¸‹æ¥æ˜¯ä¸‰ä¸ª0x12</p><table><thead><tr><th>push</th><th>data[r4++]</th></tr></thead><tbody><tr><td>push</td><td>data[r4++]</td></tr><tr><td>push</td><td>data[r4++]</td></tr></tbody></table><p>åˆ°äº†0x08ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„æ¯”è¾ƒæ•°æ®å·²ç»è¢«å‹å…¥æ ˆä¸­</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645517394177.png"></p><table><thead><tr><th>pop</th><th>r5</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x13ï¼Œå°†å¤„ç†å®Œçš„å€¼é‡æ–°ä»å †æ ˆä¸­å–å‡º</p><table><thead><tr><th>mov</th><th>r3,satck[count]</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0xF</p><table><thead><tr><th>cmp</th><th>r3,r5</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x07</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645517670674.png"></p><table><thead><tr><th>pop</th><th>r3</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x04</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645517727020.png"></p><table><thead><tr><th>mov</th><th>stack[count],r3</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x09</p><table><thead><tr><th>pop</th><th>r6</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x0D</p><p>r6æ˜¯0x15ï¼ŒåŠ ä¸Šä¹‹åæ­£å¥½exitï¼Œå’Œå‰é¢ç±»ä¼¼ï¼Œå‹å…¥æ ˆæ˜¯å› ä¸ºå¾…ä¼šéœ€è¦å¤šæ¬¡ä½¿ç”¨</p><table><thead><tr><th>jnz</th><th>r0+r6</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>è¿™é‡Œæ²¡æœ‰é—®é¢˜å°±ä¼šå¾€ä¸‹</p><p>0x09</p><table><thead><tr><th>pop</th><th>r6</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>æ­¤æ—¶æŠŠ-17ç»™åˆ°r6</p><p>0x08</p><table><thead><tr><th>pop</th><th>r5</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x05</p><table><thead><tr><th>push</th><th>r5</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x06</p><table><thead><tr><th>push</th><th>r6</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x04</p><table><thead><tr><th>push</th><th>r3</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x01</p><table><thead><tr><th>add</th><th>r2,1</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x00</p><table><thead><tr><th>mov</th><th>r3,r2</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0x0F//é•¿åº¦åˆ¤æ–­</p><table><thead><tr><th>cmp</th><th>r3,r5</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>0xdï¼Œé‡æ–°è¿›å…¥å¾ªç¯</p><p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645518636756.png"></p><h2 id="æœ€ç»ˆçš„ä¸€äº›æ•°æ®å’Œåˆ†ç»„å’Œè„šæœ¬"><a href="#æœ€ç»ˆçš„ä¸€äº›æ•°æ®å’Œåˆ†ç»„å’Œè„šæœ¬" class="headerlink" title="æœ€ç»ˆçš„ä¸€äº›æ•°æ®å’Œåˆ†ç»„å’Œè„šæœ¬"></a>æœ€ç»ˆçš„ä¸€äº›æ•°æ®å’Œåˆ†ç»„å’Œè„šæœ¬</h2><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;#include&lt;string.h&gt;int main(){int opcode[65] = {    0x00000012, 0x00000008, 0x00000012, 0x00000009, 0x00000010, 0x00000004, 0x00000001, 0x0000000F, 0x0000000D, //æ¥å—æˆ‘ä»¬çš„è¾“å…¥ 0x00000002, 0x00000012, 0x00000008, 0x00000012, 0x00000009, 0x00000000, 0x00000004, 0x0000000F, 0x0000000D,//å¯¹flagè¿›è¡Œå­˜å‚¨æ“ä½œï¼Œæ¯”è¾ƒé•¿åº¦ï¼Œå› ä¸ºgetcharæœ€åæ˜¯32ï¼Œæ‰€ä»¥flagé•¿åº¦ä¸º32 0x00000012, 0x00000009, 0x00000012, 0x0000000A, 0x00000013, 0x00000012, 0x0000000B, 0x00000015, 0x00000003, 0x00000014, 0x00000001, 0x00000000, 0x0000000F, 0x0000000D, //flagåŠ å¯†ï¼Œflag[i]*2^3cå­˜å‚¨çš„å€¼     0x00000012, 0x0000000A, 0x00000012, 0x00000012, 0x00000012, 0x00000008, 0x00000013, 0x0000000F, 0x00000007, 0x00000004, 0x00000009, 0x0000000D, 0x00000009, 0x00000008, 0x00000005, 0x00000006, 0x00000004, 0x00000001, 0x00000000, 0x0000000F, 0x0000000D, //å­—ç¬¦ä¸²æ¯”è¾ƒ 0x00000012, 0x00000009, 0x00000012,     0x00000008, 0x00000012, 0x0000000A, 0x00000012, 0x00000007, 0x0000000F, 0x0000000C, 0x00000011, //æ‰“å°     0x0000000E};unsigned char xor_table[32]={0x5e,0x46,0x61,0x43,0x0e,0x53,0x49,0x1f,0x51,0x5e,0x36,0x37,0x29,0x41,0x63,0x3b,0x64,0x3b,0x15,0x18,0x5b,0x3e,0x22,0x50,0x46,0x5e,0x35,0x4e,0x43,0x23,0x60,0x3b};unsigned char enc[32]={0x8E, 0x88, 0xA3, 0x99, 0xC4, 0xA5, 0xC3, 0xDD,0x19, 0xEC, 0x6C, 0x9B, 0xF3, 0x1B, 0x8B, 0x5B,0x3E, 0x9B, 0xF1, 0x86, 0xF3, 0xF4, 0xA4, 0xF8,0xF8, 0x98, 0xAB, 0x86, 0x89, 0x61, 0x22, 0xC1};unsigned int data[83] = {//ç”¨äºè·³è½¬å’Œåˆ¤æ–­é•¿åº¦çš„æ•°     0x0000000A, -5, 0x00000020, 0x0000002F, -10, 0x00000000,     //å¼‚æˆ–æ•°æ® 0x0000005E, 0x00000046, 0x00000061, 0x00000043, 0x0000000E, 0x00000053, 0x00000049, 0x0000001F, 0x00000051, 0x0000005E, 0x00000036, 0x00000037, 0x00000029, 0x00000041, 0x00000063, 0x0000003B, 0x00000064, 0x0000003B, 0x00000015, 0x00000018, 0x0000005B, 0x0000003E, 0x00000022, 0x00000050, 0x00000046, 0x0000005E, 0x00000035, 0x0000004E, 0x00000043, 0x00000023, 0x00000060, 0x0000003B, //ç”¨äºè·³è½¬ï¼Œä»¥åŠèµ‹å€¼åˆå§‹ç´¢å¼• 0x00000000, -17, 0x00000015, //å¯†æ–‡ 0x0000008E, 0x00000088, 0x000000A3, 0x00000099, 0x000000C4, 0x000000A5, 0x000000C3, 0x000000DD, 0x00000019, 0x000000EC, 0x0000006C, 0x0000009B, 0x000000F3, 0x0000001B, 0x0000008B, 0x0000005B, 0x0000003E, 0x0000009B, 0x000000F1, 0x00000086, 0x000000F3, 0x000000F4, 0x000000A4, 0x000000F8,0x000000F8, 0x00000098, 0x000000AB, 0x00000086, 0x00000089, 0x00000061, 0x00000022, 0x000000C1, 0x00000002, 0x00000000, -6, 0x00000073, 0x00000075, 0x00000063, 0x00000063,     0x00000065, 0x00000073, 0x00000073};char flag[32]={0};for(int i=0;i&lt;32;++i){enc[i]=(enc[i]^xor_table[i])/2;}printf("%s",enc);return 0;}</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰å“çŸ¥è¯†</title>
      <link href="/2022/01/22/%E5%AE%89%E5%8D%93%E7%9F%A5%E8%AF%86/"/>
      <url>/2022/01/22/%E5%AE%89%E5%8D%93%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="APKåŸºæœ¬ç»“æ„"><a href="#APKåŸºæœ¬ç»“æ„" class="headerlink" title="APKåŸºæœ¬ç»“æ„"></a>APKåŸºæœ¬ç»“æ„</h1><p><a href="https://www.cnblogs.com/zhaijiahui/p/6916556.html">https://www.cnblogs.com/zhaijiahui/p/6916556.html</a></p><p>å› ä¸ºjavaè¯­è¨€æ²¡åŠæ³•ç›´æ¥æ§åˆ¶ç¡¬ä»¶ï¼Œæ‰€ä»¥è¦ä½¿ç”¨C/C++æ¥å†™ä»£ç ï¼Œä¿å­˜åœ¨soæ–‡ä»¶ä¸­ </p><p>åç¼–è¯‘ä¹‹åæ˜¯smaliä»£ç ï¼ŒåŠ¨æ€è°ƒè¯•</p><p>assetsï¼šå­˜æ”¾æœªç¼–è¯‘çš„èµ„æº</p><p>libï¼šå­˜æ”¾soæ–‡ä»¶ï¼Œå³æœ¬åœ°ä»£ç </p><p>libsï¼šç¬¬ä¸‰æ–¹åŒ…</p><p>META-INFï¼šå­˜æ”¾ç­¾å</p><p>resï¼šç¼–è¯‘åçš„èµ„æº</p><p>AndroidManifest.xmlï¼šç”¨äºå­˜æ”¾æ¸…å•</p><p>.dexæ–‡ä»¶ï¼šåç¼–è¯‘åä¸ºsmaliä»£ç </p>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cè¯­è¨€æ±‡ç¼–</title>
      <link href="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/"/>
      <url>/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/</url>
      
        <content type="html"><![CDATA[<h1 id="VC6åŸºç¡€æ“ä½œ"><a href="#VC6åŸºç¡€æ“ä½œ" class="headerlink" title="VC6åŸºç¡€æ“ä½œ"></a>VC6åŸºç¡€æ“ä½œ</h1><p>F7ï¼šç¼–è¯‘ã€F5ï¼šè°ƒè¯•ã€F9ï¼šè®¾ç½®æ–­ç‚¹ã€F10ï¼šå•æ­¥æ­¥è¿‡ã€F11ï¼šå•æ­¥è¿›å…¥ã€shift+F5ï¼šç»“æŸè°ƒè¯•</p><p>è°ƒè¯•è¿‡ç¨‹æ‰“å¼€å¯„å­˜å™¨çª—å£å’Œåæ±‡ç¼–çª—å£</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643095481259.png"></p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643095520646.png"></p><h1 id="è£¸å‡½æ•°"><a href="#è£¸å‡½æ•°" class="headerlink" title="è£¸å‡½æ•°"></a>è£¸å‡½æ•°</h1><p>ç¼–è¯‘å™¨ä¸ä¼šç®¡çš„å‡½æ•°</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643097998389.png"></p><p>__declspec(naked) Func()</p><p>è°ƒç”¨ç©ºçš„è£¸å‡½æ•°ä¼šå‡ºç°é”™è¯¯ï¼Œå› ä¸ºæœ‰callï¼Œå´æ²¡æœ‰ret</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643123413854.png"></p><p>è¿›å…¥åç›´æ¥è·³åˆ°int3ï¼Œè¿è¡Œç¨‹åºä¼šæŠ¥é”™</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643123914848.png"></p><p>è§£å†³è¿™ç§åªéœ€è¦åŠ å…¥æ±‡ç¼–è¯­å¥retï¼Œåœ¨Cè¯­è¨€ç¨‹åºåŠ å…¥æ±‡ç¼–è¯­å¥ï¼Œéœ€è¦ç”¨åˆ°__asm{}ã€‚ä¹Ÿå°±æ˜¯è¯´å¯ä»¥è‡ªå·±åœ¨é‡Œé¢å†™æ±‡ç¼–ä»£ç æ¥å®ç°éœ€æ±‚ã€‚</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643126281063.png"></p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643126324265.png"></p><p>æ‰§è¡Œå®Œè¿™æ®µä»£ç ï¼Œretå›æ¥äº†</p><h1 id="è°ƒç”¨çº¦å®š"><a href="#è°ƒç”¨çº¦å®š" class="headerlink" title="è°ƒç”¨çº¦å®š"></a>è°ƒç”¨çº¦å®š</h1><table><thead><tr><th>__cdeclï¼ˆcã€c++é»˜è®¤ï¼‰</th><th>ä»å³è‡³å·¦å…¥æ ˆ</th><th>è°ƒç”¨è€…æ¸…ç†æ ˆ</th></tr></thead><tbody><tr><td>__stdcall</td><td>ä»å³è‡³å·¦å…¥æ ˆ</td><td>è‡ªèº«æ¸…ç†å †æ ˆï¼ˆå†…å¹³æ ˆï¼‰å­å‡½æ•°å¹³è¡¡å †æ ˆ</td></tr><tr><td>__fastcall</td><td>ECX/EDXä¼ é€å‰ä¸¤ä¸ªï¼Œå‰©ä¸‹çš„ä»å³è‡³å·¦ï¼Œå¯„å­˜å™¨ä¼ é€’é€Ÿåº¦æ›´å¿«ã€‚å½“åªæœ‰ä¸¤ä¸ªå‚æ•°ä¼ é€’è¿›å»ï¼Œä¸éœ€è¦å¹³è¡¡å †æ ˆ</td><td>è‡ªèº«æ¸…ç†å †æ ˆ</td></tr></tbody></table><p>æ‰€ä»¥ä¸èƒ½é€šè¿‡retæ¥åˆ†æå‡½æ•°å‚æ•°çš„ä¸ªæ•°</p><p>__cdecl</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643125931583.png"></p><p>å¤–å¹³æ ˆ</p><p>å†…éƒ¨åªæœ‰ret</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643126021930.png"></p><p>__stdcall</p><p>å³è¾¹çš„å‚æ•°å…ˆå…¥æ ˆ</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643126780828.png"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œcallä¹‹åæ²¡æœ‰addæ¥å›å¤å †æ ˆå¹³è¡¡ï¼Œè¿›å…¥è°ƒç”¨å‡½æ•°</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643126852766.png"></p><p>å¯ä»¥çœ‹åˆ°retå˜æˆäº†ret 8ï¼Œè¿™å°±æ˜¯å†…å¹³æ ˆ</p><p>__fastcall</p><p>ä¸¤ä¸ªå‚æ•°å­˜æ”¾åœ¨å¯„å­˜å™¨</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643127369433.png"></p><p>æ²¡æœ‰ä¿®æ”¹å †æ ˆï¼Œæ‰€ä»¥ä¸éœ€è¦addå›å¤å †æ ˆ</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643127503312.png"></p><p>æœ‰pushå’Œmovï¼Œå¤–é¢æ²¡æœ‰addï¼Œè¿›å»çœ‹</p><p>ä¹Ÿæ˜¯å†…å¹³æ ˆ</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643127554833.png"></p><h1 id="å‚æ•°ä¸ªæ•°"><a href="#å‚æ•°ä¸ªæ•°" class="headerlink" title="å‚æ•°ä¸ªæ•°"></a>å‚æ•°ä¸ªæ•°</h1><p>å…¬å¼ä¸€ï¼šå¯„å­˜å™¨+ret 4=å‚æ•°ä¸ªæ•°</p><p>å…¬å¼äºŒï¼šå¯„å­˜å™¨+[esp+8]+[ebp+0x]=å‚æ•°ä¸ªæ•°</p><h1 id="å¯»æ‰¾ç¨‹åºå…¥å£"><a href="#å¯»æ‰¾ç¨‹åºå…¥å£" class="headerlink" title="å¯»æ‰¾ç¨‹åºå…¥å£"></a>å¯»æ‰¾ç¨‹åºå…¥å£</h1><p>callstackï¼Œè°ƒç”¨çª—å£</p><p>mainæ˜¯æˆ‘ä»¬å†™çš„ç¨‹åºçš„å…¥å£ï¼Œä½†æ˜¯ä¸æ˜¯çœŸæ­£ç¨‹åºçš„å…¥å£</p><p>å› ä¸ºåœ¨mainå‡½æ•°ä¹‹å‰éœ€è¦è°ƒç”¨å¦‚ä¸‹å‡½æ•°</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643127627555.png"></p><p>åœ¨callstackå‘ç°è¿™ä¸ªå‡½æ•°</p><p>Getversion()</p><p>_headp_int()</p><p>GetCommandLineA()</p><p>_crtGetEnvironmentStringA()</p><p>_setargv()</p><p>_setenvp()</p><p>_cinit()  </p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643127791606.png"></p><p>mainå‡½æ•°å…·æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæ‰€ä»¥è¦å¯»æ‰¾å…·æœ‰ä¸‰ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œæ‰¾ä¸‰ä¸ªpushï¼Œå¹¶ä¸”è°ƒç”¨å®Œä¼šadd 0xc</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643127884930.png"></p><p>è¿™é‡Œå¾ˆç¬¦åˆ</p><p>ä¸‹æ–­ç‚¹è¿›å…¥ï¼Œè¿™é‡Œæ‰æ˜¯mainå‡½æ•°</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643127941350.png"></p><h1 id="æ•°æ®ç±»å‹ä¸æ•°æ®å­˜å‚¨"><a href="#æ•°æ®ç±»å‹ä¸æ•°æ®å­˜å‚¨" class="headerlink" title="æ•°æ®ç±»å‹ä¸æ•°æ®å­˜å‚¨"></a>æ•°æ®ç±»å‹ä¸æ•°æ®å­˜å‚¨</h1><p>1ã€å­˜å‚¨æ•°æ®çš„å®½åº¦ </p><p>2ã€å­˜å‚¨æ•°æ®çš„æ ¼å¼</p><p>3ã€ä½œç”¨èŒƒå›´</p><h2 id="åŸºæœ¬ç±»å‹"><a href="#åŸºæœ¬ç±»å‹" class="headerlink" title="åŸºæœ¬ç±»å‹"></a>åŸºæœ¬ç±»å‹</h2><h3 id="æ•´æ•°ç±»å‹"><a href="#æ•´æ•°ç±»å‹" class="headerlink" title="æ•´æ•°ç±»å‹"></a>æ•´æ•°ç±»å‹</h3><p>charã€intã€longã€shortï¼šå­—èŠ‚æ•°1ã€4ã€4ã€2ï¼Œå¯¹åº”ä¸Šbyteã€dwordã€dwordã€wordï¼Œlong longåœ¨VC6å¯¹åº”__int 64</p><p>åªä¼šæ ¹æ®æ•°æ®å®½åº¦è¿›è¡Œæ“ä½œï¼Œè¶…å‡ºæ•°æ®å®½åº¦çš„ä¸ä¼šåšä¿®æ”¹</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643188104181.png"></p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643128939675.png"></p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643128998071.png"></p><p>gå­˜å‚¨çš„åªæœ‰0x56</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643129038958.png"></p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643129130357.png"></p><p>æ•°æ®çª—å£æ˜¯å°ç«¯åº</p><h4 id="æœ‰ç¬¦å·ä¸æ— ç¬¦å·"><a href="#æœ‰ç¬¦å·ä¸æ— ç¬¦å·" class="headerlink" title="æœ‰ç¬¦å·ä¸æ— ç¬¦å·"></a>æœ‰ç¬¦å·ä¸æ— ç¬¦å·</h4><p>Cè¯­è¨€é»˜è®¤æ˜¯æœ‰ç¬¦å·æ•°</p><p>åœ¨å†…å­˜ä¸­å­˜å‚¨æ—¶æ— åŒºåˆ«ï¼Œä½†æ˜¯åœ¨ç±»å‹è½¬æ¢ã€æ¯”è¾ƒå¤§å°å’Œæ•°å­¦è¿ç®—æ—¶éœ€è¦æ³¨æ„</p><h3 id="æµ®ç‚¹ç±»å‹"><a href="#æµ®ç‚¹ç±»å‹" class="headerlink" title="æµ®ç‚¹ç±»å‹"></a>æµ®ç‚¹ç±»å‹</h3><p>floatã€doubleåœ¨å­˜å‚¨æ–¹å¼éµä»IEEEçš„è§„èŒƒ</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643166176045.png"></p><h1 id="å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡çš„åŒºåˆ†"><a href="#å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡çš„åŒºåˆ†" class="headerlink" title="å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡çš„åŒºåˆ†"></a>å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡çš„åŒºåˆ†</h1><p>å±€éƒ¨å˜é‡æ˜¯ä»¥ebp-å¼€å¤´çš„</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643180778946.png"></p><p>å…¨å±€å˜é‡åœ¨ç¼–è¯‘å®Œä¹‹ååœ°å€å°±ä¸ä¼šæ”¹å˜</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643180903634.png"></p><p>ç›´æ¥æ”¾è¿›åœ°å€ï¼Œæ‰€ä»¥å°±æ˜¯å…¨å±€å˜é‡</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643181101615.png"></p><p>åœ¨vs2022ä¼šå› ä¸ºç¼–è¯‘å™¨ç‰ˆæœ¬é—®é¢˜ï¼Œå‡ºç°ä¸åŒçš„æ±‡ç¼–æŒ‡ä»¤ï¼Œä½†éƒ½æ˜¯å¤§åŒå°å¼‚</p><h1 id="ifè¯­å¥"><a href="#ifè¯­å¥" class="headerlink" title="ifè¯­å¥"></a>ifè¯­å¥</h1><p>cmp+jccæŒ‡ä»¤</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643181892321.png"></p><p>cmpç›¸å½“äºå‡æ³•ï¼Œå‰é¢ä¸€ä¸ªå‡åé¢ä¸€ä¸ªï¼Œå› ä¸ºx&gt;yæ—¶ç»§ç»­æ‰§è¡Œï¼Œæ‰€ä»¥è·³è½¬æŒ‡ä»¤çš„æ¡ä»¶æ˜¯å°äºç­‰äº</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643182181368.png"></p><p>æ”¹æˆ&gt;=ä¹‹åï¼Œæ±‡ç¼–æŒ‡ä»¤å˜æˆäº†jlï¼Œæ±‡ç¼–æŒ‡ä»¤æ˜¯å’ŒCè¯­è¨€åç€æ¥çš„</p><p>&lt;</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643182345813.png"></p><p>==</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643182397987.png"></p><h1 id="å¤šåˆ†æ”¯è¯­å¥"><a href="#å¤šåˆ†æ”¯è¯­å¥" class="headerlink" title="å¤šåˆ†æ”¯è¯­å¥"></a>å¤šåˆ†æ”¯è¯­å¥</h1><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643183573683.png"></p><p>x&lt;=yçš„æƒ…å†µç›´æ¥è·³è½¬åˆ°elseä¸­</p><p>x&gt;yåˆ™å¾€åæ‰§è¡Œï¼Œæ‰§è¡Œå®Œä¹‹åjmpè·³è½¬åˆ°elseè¯­å¥çš„åé¢</p><p>å› ä¸ºmovä¸¤è¾¹ä¸èƒ½éƒ½æ˜¯åœ°å€ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°å¯„å­˜å™¨</p><h2 id="ifã€else-ifã€else"><a href="#ifã€else-ifã€else" class="headerlink" title="ifã€else ifã€else"></a>ifã€else ifã€else</h2><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643184460823.png"></p><h1 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h1><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643187985614.png"></p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643187574671.png"></p><p>å†…éƒ¨å¾—åˆ°eaxçš„å€¼ï¼Œeaxä¸€èˆ¬ç”¨æ¥å­˜å‚¨è¿”å›å€¼</p><p>å‚æ•°ä¼ é€’4ä¸ªå­—èŠ‚</p><p>å‹æ ˆçš„æ—¶å€™éƒ½æ˜¯eax</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643188571362.png"></p><h1 id="å¾ªç¯è¯­å¥"><a href="#å¾ªç¯è¯­å¥" class="headerlink" title="å¾ªç¯è¯­å¥"></a>å¾ªç¯è¯­å¥</h1><h2 id="switchè¯­å¥åæ±‡ç¼–"><a href="#switchè¯­å¥åæ±‡ç¼–" class="headerlink" title="switchè¯­å¥åæ±‡ç¼–"></a>switchè¯­å¥åæ±‡ç¼–</h2><p>å½“åˆ†æ”¯è¾ƒå°‘æ—¶é‡‡å–ifâ€¦â€¦else if â€¦â€¦elseçš„æ–¹å¼</p><h3 id="caseè¿ç»­"><a href="#caseè¿ç»­" class="headerlink" title="caseè¿ç»­"></a>caseè¿ç»­</h3><p>åˆ›å»ºå¤§è¡¨</p><p> <img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643726580401.png"></p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643726615144.png"></p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643726837151.png"></p><p>sub</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643727141397.png"></p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643727234505.png"></p><p>è¿™é‡Œä¿®æ”¹å‚æ•°ä¸º103ï¼Œcaseæ¡ä»¶ä¹Ÿä¿®æ”¹ï¼Œå‘ç°subçš„å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“subçš„å€¼å¯¹åº”æœ€å°çš„caseæ¡ä»¶çš„å€¼ï¼Œè¿™æ ·å¯¹åº”ä¸Šäº†å¤§è¡¨çš„ä½ç½®ï¼Œæ‰€ä»¥subæ˜¯ä¸ºäº†è·³è½¬åˆ°ç”Ÿæˆçš„å¤§è¡¨</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643727350589.png"></p><p>æ­£å¥½æ˜¯case 103çš„åœ°å€</p><h3 id="caseè¿ç»­ä½†ä¸­æ–­"><a href="#caseè¿ç»­ä½†ä¸­æ–­" class="headerlink" title="caseè¿ç»­ä½†ä¸­æ–­"></a>caseè¿ç»­ä½†ä¸­æ–­</h3><p>101ã€102ã€103çš„æƒ…å†µä½¿ç”¨defaultçš„åœ°å€å¡«å……</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643727925669.png"></p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643728035747.png"></p><p>åªè¦æœ‰æ–­å¼€çš„ï¼Œå°±ä¼šæµªè´¹ä¸€ç‰‡å†…å­˜åœ°å€ï¼Œæ‰€ä»¥å½“é—´éš”å¤ªè¿œå°±ä¸ä¼šä½¿ç”¨è¿™ç§æ–¹å¼</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643728378338.png"></p><p>ä½†æ˜¯å½“é—´éš”æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œå‡ºç°äº†æ–°æƒ…å†µ</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643728454178.png"></p><p>å› ä¸ºå·²ç»æ¸…ç©ºäº†edxï¼Œæ‰€ä»¥å¯ä½¿ç”¨è¯¥å¯„å­˜å™¨ï¼Œè¿™å¥è¯ç›¸å½“äºæŠŠ0x004010dd+eaxçš„å€¼å¯¹åº”åœ°å€çš„å†…å®¹æ”¾å…¥åˆ°dlä¸­ï¼Œdlæ˜¯å…«ä½ï¼Œå¯¹åº”1ä¸ªå­—èŠ‚ï¼Œè¿™ä¸ªå°±æ˜¯å°è¡¨</p><p>å½“è¿ç»­ä½†ç›¸å·®è¾ƒè¿œæ—¶ä¼šé‡‡ç”¨å°è¡¨</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643728595269.png"></p><h3 id="caseä¸è¿ç»­"><a href="#caseä¸è¿ç»­" class="headerlink" title="caseä¸è¿ç»­"></a>caseä¸è¿ç»­</h3><p>å½“å·®å€¼å¤ªå¤§ï¼Œä¸ä¼šç”Ÿæˆå¤§è¡¨ï¼Œä¼šç›´æ¥é‡‡å–ifâ€¦â€¦elseç»“æ„</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643727643051.png"></p><p>å…ˆåˆ¤æ–­å¤§äºjeï¼Œå†åˆ¤æ–­ç­‰äºcmp+jmp</p><h2 id="whileå¾ªç¯åæ±‡ç¼–"><a href="#whileå¾ªç¯åæ±‡ç¼–" class="headerlink" title="whileå¾ªç¯åæ±‡ç¼–"></a>whileå¾ªç¯åæ±‡ç¼–</h2><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643730937945.png"></p><p>jeæ˜¯å½“ZFæ ‡å¿—ä½ä¸º0æ˜¯è·³è½¬ï¼Œtestæ˜¯æŒ‰ä½ä¸æ“ä½œï¼Œç”¨äºåˆ¤æ–­å¯„å­˜å™¨çš„å€¼æ˜¯å¦ä¸º0</p><h2 id="doâ€¦â€¦whileåæ±‡ç¼–"><a href="#doâ€¦â€¦whileåæ±‡ç¼–" class="headerlink" title="doâ€¦â€¦whileåæ±‡ç¼–"></a>doâ€¦â€¦whileåæ±‡ç¼–</h2><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643731312416.png"></p><h2 id="forå¾ªç¯åæ±‡ç¼–"><a href="#forå¾ªç¯åæ±‡ç¼–" class="headerlink" title="forå¾ªç¯åæ±‡ç¼–"></a>forå¾ªç¯åæ±‡ç¼–</h2><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643730507558.png"></p><h1 id="æ•°ç»„åœ¨å†…å­˜çš„å­˜å‚¨å’Œå¯»å€"><a href="#æ•°ç»„åœ¨å†…å­˜çš„å­˜å‚¨å’Œå¯»å€" class="headerlink" title="æ•°ç»„åœ¨å†…å­˜çš„å­˜å‚¨å’Œå¯»å€"></a>æ•°ç»„åœ¨å†…å­˜çš„å­˜å‚¨å’Œå¯»å€</h1><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643368384236.png"></p><p>è¿™é‡Œæ•°ç»„çš„å­˜å‚¨æ˜¯ä»é«˜ä½å¾€ä½ä½å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯ä»å³åˆ°å·¦å¼€å§‹å­˜å‚¨åˆ°ç¼“å†²åŒºä¸­ï¼Œæ›¿æ¢ç¼“å†²åŒºçš„æ•°å€¼</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643368588775.png"></p><p>å¯ä»¥çœ‹åˆ°æ•°ç»„çš„å­˜å‚¨</p><p>å†çœ‹çœ‹æ•°ç»„å¼•ç”¨</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643368768572.png"></p><p>[ebp-4]æ˜¯ç¬¬ä¸€ä¸ªå½¢å‚çš„åœ°å€</p><p>[ebp-1ch]å¯¹åº”ä¸Šæ•°ç»„é¦–å…ƒç´ çš„åœ°å€ï¼Œeaxæ˜¯å­˜å‚¨ç€ç¬¬ä¸€ä¸ªå½¢å‚ï¼Œ****<em>4æ˜¯å› ä¸ºæ˜¯intå‹æ•°ç»„ï¼Œå¦‚æœæ˜¯shortï¼Œåˆ™</em>2</p><p>ï¼Œæ•°ç»„æ¯”è¾ƒå¸¸è§çš„å½¢å¼å°±æ˜¯[ebp+å¯„å­˜å™¨*æ•°ç»„ç±»å‹å¯¹åº”çš„å­—èŠ‚å¤§å°-æ•°å­—]</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643369846681.png"></p><p>å› ä¸ºæ•°ç»„ä¸‹æ ‡å­˜åœ¨å˜é‡ï¼Œè€Œmovä¸¤è¾¹ä¸èƒ½åŒæ—¶æ˜¯åœ°å€ï¼Œæ‰€ä»¥éœ€è¦å…ˆç”¨å¯„å­˜å™¨å­˜å‚¨ä¸‹æ ‡ï¼Œè€Œç›´æ¥å¼•ç”¨å°±ä¸éœ€è¦ï¼Œå³arr[1]</p><h2 id="å­—ç¬¦ä¸²å­˜å‚¨"><a href="#å­—ç¬¦ä¸²å­˜å‚¨" class="headerlink" title="å­—ç¬¦ä¸²å­˜å‚¨"></a>å­—ç¬¦ä¸²å­˜å‚¨</h2><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643371348362.png"></p><p>å› ä¸ºæ¯ä¸ªå¯„å­˜å™¨æœ€å¤šå­˜å‚¨å››ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°å¤šä¸ªå¯„å­˜å™¨æ¥å­˜å‚¨</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643371421546.png"></p><p>åœ¨æ•°æ®çª—å£ä¸­æ˜¯è¿™æ ·å­˜æ”¾çš„</p><p>å¯„å­˜å™¨å¯ä»¥é‡å¤ä½¿ç”¨ï¼Œæ¯”å¦‚é•¿åº¦ä¸å¤Ÿçš„æƒ…å†µ</p><p><img src="/2022/01/20/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%96/1643371753305.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ±‡ç¼– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ±‡ç¼–</title>
      <link href="/2022/01/19/%E6%B1%87%E7%BC%96/"/>
      <url>/2022/01/19/%E6%B1%87%E7%BC%96/</url>
      
        <content type="html"><![CDATA[<h1 id="å †æ ˆå›¾"><a href="#å †æ ˆå›¾" class="headerlink" title="å †æ ˆå›¾"></a>å †æ ˆå›¾</h1><p>è°ƒç”¨å‡½æ•°å®ç°ä¸¤æ•°ç›¸åŠ </p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642592553591.png"></p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642592569833.png"></p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642592579671.png"></p><p>å› ä¸ºpopä¹‹åï¼Œæœ‰ä¸€éƒ¨åˆ†çš„å€¼è¿˜æ˜¯ä¹‹å‰ä¿ç•™ä¸‹æ¥çš„ï¼Œæ‰€ä»¥è¦è¿›è¡Œå¡«å……</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642592639529.png"></p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642592648442.png"></p><h1 id="LEAå’ŒMOVçš„åŒºåˆ«"><a href="#LEAå’ŒMOVçš„åŒºåˆ«" class="headerlink" title="LEAå’ŒMOVçš„åŒºåˆ«"></a>LEAå’ŒMOVçš„åŒºåˆ«</h1><p>leaæ˜¯â€œload effective addressâ€çš„ç¼©å†™ï¼Œç®€å•çš„è¯´ï¼ŒleaæŒ‡ä»¤å¯ä»¥ç”¨æ¥å°†ä¸€ä¸ªå†…å­˜åœ°å€ç›´æ¥èµ‹ç»™ç›®çš„æ“ä½œæ•°ï¼Œä¾‹å¦‚ï¼š</p><p>lea eax,[ebx+8]å°±æ˜¯å°†ebx+8è¿™ä¸ªå€¼ç›´æ¥èµ‹ç»™eaxï¼Œè€Œä¸æ˜¯æŠŠebx+8å¤„çš„å†…å­˜åœ°å€é‡Œçš„æ•°æ®èµ‹ç»™eaxã€‚</p><p>è€ŒmovæŒ‡ä»¤åˆ™æ°æ°ç›¸åï¼Œä¾‹å¦‚ï¼š</p><p>mov eax,[ebx+8]åˆ™æ˜¯æŠŠå†…å­˜åœ°å€ä¸ºebx+8å¤„çš„æ•°æ®èµ‹ç»™eaxã€‚</p><h1 id="å‡½æ•°åœ¨æ±‡ç¼–çš„ç»“æ„"><a href="#å‡½æ•°åœ¨æ±‡ç¼–çš„ç»“æ„" class="headerlink" title="å‡½æ•°åœ¨æ±‡ç¼–çš„ç»“æ„"></a>å‡½æ•°åœ¨æ±‡ç¼–çš„ç»“æ„</h1><p>å‡½æ•°è°ƒç”¨å‰ï¼Œå †æ ˆç»“æ„å¦‚ä¸‹</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642649724413.png"></p><p>EBPæ ˆåº•é«˜ä½ï¼ŒESPæ ˆé¡¶ä½ä½</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642649843226.png"></p><p>ä¸‹é¢çš„ä¸‰ä¸ªPUSHæ˜¯æŠŠå‡½æ•°çš„å‚æ•°å‹å…¥æ ˆä¸­ï¼Œè¿™é‡Œæ˜¯ç«‹å³æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯„å­˜å™¨é‡Œé¢çš„å€¼ï¼Œæ³¨æ„PUSHæŒ‡ä»¤æ‰§è¡Œå®ŒESP-4ï¼Œå³æ ˆé¡¶å¾€ä½ä½ç§»åŠ¨</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642650060363.png"></p><p>å †æ ˆå›¾å¦‚ä¸‹</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642650200472.png"></p><p>ä¸‹ä¸€æ­¥æ˜¯CALLæŒ‡ä»¤ï¼ŒF7å•æ­¥æ­¥å…¥ï¼ŒCALLæŒ‡ä»¤ä¼šä¿®æ”¹EIPçš„å€¼ï¼Œå°†CALLæŒ‡ä»¤ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å‹å…¥æ ˆé¡¶ ï¼Œå¹¶ä¸”ä¿®æ”¹EIPçš„å€¼ï¼Œç›¸å½“äºä¸€æ¡PUSHå’ŒJMPæŒ‡ä»¤ï¼ŒJMPåªä¼šä¿®æ”¹EIPçš„å€¼ï¼ŒEIPå­˜æ”¾ä¸‹ä¸€æ¡ä¼šæ‰§è¡ŒæŒ‡ä»¤çš„åœ°å€</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642650793595.png"></p><p>å †æ ˆå›¾</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642651074289.png"></p><p>è¿™é‡ŒJMPç›´æ¥F8è·³è½¬è¿‡å»ï¼Œè¿›å…¥å‡½æ•°ï¼Œå…¥å£æ˜¯PUSH EBP</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642651212988.png"></p><p>å¯ä»¥çœ‹åˆ°ESPæ²¡æœ‰å˜åŒ–</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642651299175.png"></p><p>åœ¨å‡½æ•°è°ƒç”¨ä¸­ï¼Œè¿™ä¸‰æ­¥æ˜¯æå‡æ ˆé¡¶ï¼Œå¼€è¾Ÿç©ºé—´</p><p>è¿è¡Œå®Œå †æ ˆåº”è¯¥å¦‚ä¸‹</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642651845629.png"></p><p>è¿è¡Œçœ‹çœ‹</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642651761171.png"></p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642651894330.png"></p><p>æ¥ä¸‹æ¥è¿™ä¸‰æ­¥æ˜¯ä¿å­˜ç°åœºï¼Œå› ä¸ºåœ¨å‡½æ•°è°ƒç”¨ä¸­ï¼Œè¿™äº›å¯„å­˜å™¨å¯èƒ½è¢«ç”¨åˆ°ï¼Œæ‰€ä»¥è¦å…ˆæŠŠé‡Œé¢åŸæœ¬çš„å€¼å‹å…¥æ ˆä¸­ï¼Œæ­¤æ—¶å †æ ˆå›¾ä¸º</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642652121644.png"></p><p>EBPæ˜¯FED0</p><p>è¿è¡Œ</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642652204239.png"></p><p>å·²ç»è¢«å‹å…¥æ ˆä¸­ </p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642652304817.png"></p><p>æ¥ä¸‹æ¥è¿™æ­¥æ˜¯å¡«å……ç¼“å†²åŒº</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642652335865.png"></p><p>å¯ä»¥çœ‹åˆ°å †æ ˆå›¾ä¸­å¼€è¾Ÿçš„ç©ºé—´é‡Œé¢çš„å€¼å¹¶ä¸æ˜¯ä¸º0ï¼Œè¿™æ˜¯å› ä¸ºåœ¨è°ƒç”¨å®Œå‡½æ•°ä¹‹åï¼Œè¿™äº›ç©ºé—´çš„å€¼æ²¡æœ‰è¢«æ¸…é™¤ï¼Œæ‰€ä»¥éœ€è¦å¡«å……</p><p>å †æ ˆå›¾</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642656762839.png"></p><p>è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦è¯´æ˜ï¼Œlocal.18æ˜¯ä»€ä¹ˆæ„æ€å‘¢</p><p>çœ‹ä¸‹å›¾</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642656813955.png"></p><p>æˆ‘ä»¬å»ODä¿®æ”¹è®¾ç½®</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642656868498.png"></p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642656879655.png"></p><p>å–æ¶ˆæ‰å°±å¯ä»¥äº†ï¼Œåˆšæ‰çš„æŒ‡ä»¤å‘ç”Ÿäº†å˜åŒ–</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642656905307.png"></p><p>æ¥ä¸‹æ¥è§£é‡Šè¿™å‡ å¥æŒ‡ä»¤</p><p>leaæ˜¯å–åœ°å€ï¼Œæ„æ€æ˜¯å°†ebp-0x48çš„åœ°å€å­˜å…¥EDIä¸­</p><p>ECXä¸€èˆ¬ç”¨æ¥å­˜æ”¾å¾ªç¯æ¬¡æ•°ï¼Œè¿™é‡Œæ˜¯0x12ï¼Œå³18æ¬¡ï¼Œè¿™ä¸ªå¯¹åº”å¼€è¾Ÿç©ºé—´çš„å¤§å°</p><p>mov eaxï¼Œ0xCCCCCCCCæ˜¯å¡«å……ç¼“å†²åŒº</p><p>æœ€åä¸€å¥repè¡¨ç¤ºé‡å¤æ¬¡æ•°ï¼Œæ¬¡æ•°ç”±ECXå†³å®šï¼Œstos dwordè¿™æ¡æŒ‡ä»¤è¡¨ç¤ºå°†EAXå†…çš„å€¼æ”¾å…¥EDIæŒ‡å®šçš„å†…å­˜å•å…ƒä¸­ï¼Œæ³¨æ„æ‰§è¡Œä¸€æ¬¡åEDIä¼šç§»åŠ¨4ï¼ŒåŠ å‡ç”±DFæ ‡å¿—ä½å†³å®š</p><p>DFå†³å®šmovsæ‰§è¡Œå®Œåesiå’Œediçš„ç§»åŠ¨æ–¹å‘ï¼Œå½“ä¸º0æ—¶ï¼ŒåŠ ï¼Œå¦åˆ™ä¸ºå‡ã€‚</p><p>è¿è¡Œ</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642657323715.png"></p><p>çœ‹æ¥ä¸‹æ¥çš„å‡ è¡ŒæŒ‡ä»¤</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642657469555.png"></p><p>1ã€å°†0x2èµ‹ç»™ebpåœ°å€çš„å‰ä¸€ä¸ªå†…å­˜å•å…ƒï¼Œ<strong>è¿™é‡Œçš„0x2å°±æ˜¯å±€éƒ¨å˜é‡</strong></p><p>2ã€å°†EBP+0xcçš„å€¼èµ‹ç»™eaxï¼Œeaxçš„å€¼å‹å…¥æ ˆä¸­ï¼Œä¸‹é¢ä¹Ÿæ˜¯ï¼Œç”»å †æ ˆå›¾</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642657989835.png"></p><p>è¿™é‡Œå‹å…¥æ ˆçš„æ•°å€¼ï¼Œå°†ä½œä¸ºå†…éƒ¨åµŒå¥—å‡½æ•°çš„å‚æ•°</p><p>æ‰§è¡Œå®Œä¹‹å</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642658026768.png"></p><p>æ¥ä¸‹æ¥åˆæ˜¯è°ƒç”¨å‡½æ•°ï¼Œå°†CALLæŒ‡ä»¤ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å‹å…¥æ ˆé¡¶ï¼ŒEIPä¿®æ”¹</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642658203867.png"></p><p>F7æ­¥å…¥</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642658261575.png"></p><p>F8ä¹‹å</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642658343466.png"></p><p>çº¢æ¡†éƒ¨åˆ†å’Œå‰é¢ä¸€æ ·ï¼Œéƒ½æ˜¯è°ƒç”¨å‡½æ•°å‰æå‡æ ˆé¡¶ã€å¼€è¾Ÿç©ºé—´ã€ä¿å­˜ç°åœºã€å¡«å……ç¼“å†²åŒºï¼Œä¸»è¦çœ‹æ“ä½œéƒ¨åˆ†</p><p>å…ˆæŠŠå †æ ˆå›¾ç”»å¥½</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642659116555.png"></p><p>æ¥ä¸‹æ¥çœ‹æ“ä½œ</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642659284922.png"></p><p>è¿™äº›éƒ½æ²¡æœ‰æ”¹å˜å †æ ˆçš„å€¼ï¼Œç¬¬ä¸€æ¡å°†0xAèµ‹ç»™EBP-0x4çš„å†…å­˜å•å…ƒï¼Œå¯¹åº”å †æ ˆå†™å‡ºæ“ä½œæ–¹å¼ EAXçš„å€¼ä¸º1+2ï¼Œæœ€å+0xAï¼Œæ‰€ä»¥æœ€åEAXçš„å€¼ä¸º0xD</p><p>è¿è¡Œ</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642659505718.png"></p><p>æ­¤æ—¶å‡½æ•°çš„æ“ä½œéƒ¨åˆ†å·²ç»ç»“æŸï¼Œæ¥ä¸‹æ¥å°±æ˜¯é€€å‡ºå‡½æ•°äº†</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642659609650.png"></p><p>å¯¹æ¯”ä¸€ä¸‹ï¼Œè·Ÿå‡½æ•°å¼€å§‹æ­£å¥½æ˜¯åè¿‡æ¥çš„</p><p>POPæ˜¯å…ˆå‡ºæ ˆå†ç§»åŠ¨ ï¼Œè¿™å‡ ä¸ªPOPå°±ç›¸å½“äºæ¢å¤ç°åœºï¼Œè¦æ¢å¤åˆ°æœªè°ƒç”¨å‡½æ•°å‰ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦å…ˆæŠŠè¿™äº›å€¼å‹å…¥æ ˆä¸­çš„åŸå› ã€‚</p><p>movå°±æ˜¯é™ä½æ ˆåº•ï¼Œæ¢å¤åˆ°åŸæ¥çš„ä½ç½®</p><p>retnæŒ‡ä»¤ç›¸å½“äºPOP EIPï¼Œå…ˆå°†æ ˆé¡¶çš„å€¼èµ‹ç»™EIPï¼Œç„¶åæ ˆé¡¶æŒ‡é’ˆç§»åŠ¨</p><p>å †æ ˆå›¾å¦‚ä¸‹</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642660789466.png"></p><p>æ‰§è¡Œå</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642660837614.png"></p><p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œå®Œä¹‹åï¼Œç¼“å†²åŒºçš„å†…å®¹ä¸ä¼šæ¸…ç†ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆéœ€è¦å¡«å……ç¼“å†²åŒº</p><p>å›åˆ°åæˆ‘ä»¬å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å‡½æ•°è°ƒç”¨å‰åå †æ ˆä¸å¹³è¡¡ï¼Œå †æ ˆå¹³è¡¡æ˜¯æŒ‡è°ƒç”¨å‡½æ•°å‰åå †æ ˆåº”è¯¥ç›¸ç­‰ï¼Œè¿™é‡Œæ˜¯å› ä¸ºå°†å‡½æ•°çš„å‚æ•°å‹å…¥äº†æ ˆï¼Œæ‰€ä»¥éœ€è¦æ¥ä¸‹æ¥çš„ADDå¹³è¡¡å †æ ˆ</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642660910037.png"></p><p>æ‰§è¡Œå®Œä¹‹å</p><p><img src="/2022/01/19/%E6%B1%87%E7%BC%96/1642661042648.png"></p><p>å’Œè°ƒç”¨å‰ä¸€è‡´ï¼Œæ‰€ä»¥æ²¡é—®é¢˜äº†</p><p>å‰©ä¸‹çš„å°±æ˜¯é‡å¤ä¹‹å‰çš„æ“ä½œäº†ï¼Œå…ˆæ‰§è¡Œå‡½æ•°æ“ä½œæŒ‡ä»¤ï¼Œç„¶åPOPè¿˜åŸç°åœºï¼ŒretnåADDæ¢å¤å †æ ˆå¹³è¡¡</p><p>å‡½æ•°çš„å‚æ•°å­˜æ”¾åœ¨ebp+0x8å¼€å§‹å› ä¸ºcallæŒ‡ä»¤ä¼šå°†ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€å‹å…¥æ ˆä¸­ï¼Œè€Œå±€éƒ¨å˜é‡ä»ebp-0x4å¼€å§‹</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ±‡ç¼– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Z3</title>
      <link href="/2022/01/17/Z3/"/>
      <url>/2022/01/17/Z3/</url>
      
        <content type="html"><![CDATA[<p>å…ˆæ¥çœ‹å®˜æ–¹æ–‡æ¡£</p><p><a href="https://ericpony.github.io/z3py-tutorial/guide-examples.htm">https://ericpony.github.io/z3py-tutorial/guide-examples.htm</a></p><p>è¿™ä¸ªåšå®¢ä¹Ÿä¸é”™</p><p><a href="https://blog.csdn.net/qq_38154820/article/details/108656598">https://blog.csdn.net/qq_38154820/article/details/108656598</a></p><h1 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h1><p>  åŸºæœ¬è¯­å¥</p><p>Op    Mnmonics    Description<br>            0    true    æ’çœŸ<br>            1    flase    æ’å‡<br>            2    =    ç›¸ç­‰<br>            3    distinct    ä¸åŒ<br>            4    ite    if-then-else<br>            5    and    nå…ƒ åˆå–ï¼ˆå…¶ä¸­æ¡ä»¶å¿…é¡»å…¨éƒ¨æ»¡è¶³ï¼‰<br>            6    or    nå…ƒ æå–ï¼ˆå…¶ä¸­æ¡ä»¶æ»¡è¶³ä¹‹ä¸€å³å¯ï¼‰<br>            7    iff    implication<br>            8    xor    å¼‚æˆ–<br>            9    not    å¦å®š<br>            10    implies    Bi-implications</p><p>1ã€åˆ›å»ºå®¹å™¨</p><p>s=Solver()</p><p>2ã€åˆ›å»ºå˜é‡ï¼Œå˜é‡æœ‰Int(æ•´å‹)ã€BitVector(å­—èŠ‚)ã€æ•°ç»„</p><p>3ã€æ·»åŠ çº¦æŸæ¡ä»¶</p><p>s.add(çº¦æŸæ¡ä»¶)ï¼Œéœ€è¦æ³¨æ„Intä¸èƒ½è¿›è¡Œç§»ä½è¿ç®—ï¼Œpythoné™¤æ˜¯//</p><p>4ã€åˆ¤æ–­æ˜¯å¦å­˜åœ¨</p><pre class="language-python" data-language="python"><code class="language-python">if s.check() == sat:      m = s.model()      print(m)else:      print("no answer")</code></pre><h1 id="å˜é‡ä¸ºæ•´å‹"><a href="#å˜é‡ä¸ºæ•´å‹" class="headerlink" title="å˜é‡ä¸ºæ•´å‹"></a>å˜é‡ä¸ºæ•´å‹</h1><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><a href="https://buuoj.cn/challenges#[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]Universe_final_answer">https://buuoj.cn/challenges#[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]Universe_final_answer</a></p><h2 id="å…³é”®ä»£ç "><a href="#å…³é”®ä»£ç " class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h2><p><img src="/2022/01/17/Z3/1642416626641.png"></p><p>è¿™é‡Œå°±ç›´æ¥æ”¾è„šæœ¬äº†</p><pre class="language-python" data-language="python"><code class="language-python">from z3 import*s=Solver()v1=Int('v1')v2=Int('v2')v3=Int('v3')v4=Int('v4')v5=Int('v5')v6=Int('v6')v7=Int('v7')v8=Int('v8')v9=Int('v9')v11=Int('v11')s.add(-85 * v9 + 58 * v8 + 97 * v6 + v7 + -45 * v5 + 84 * v4 + 95 * v2 - 20 * v1 + 12 * v3 == 12613)s.add(-85 * v9 + 58 * v8 + 97 * v6 + v7 + -45 * v5 + 84 * v4 + 95 * v2 - 20 * v1 + 12 * v3 == 12613)s.add(-103 * v11 + 120 * v8 + 108 * v7 + 48 * v4 + -89 * v3 + 78 * v1 - 41 * v2 + 31 * v5 - (v6 *64) - 120 * v9 == -10283)s.add(71 * v6 + (v7 *128) + 99 * v5 + -111 * v3 + 85 * v1 + 79 * v2 - 30 * v4 - 119 * v8 + 48 * v9 - 16 * v11 == 22855)s.add(5 * v11 + 23 * v9 + 122 * v8 + -19 * v6 + 99 * v7 + -117 * v5 + -69 * v3 + 22 * v1 - 98 * v2 + 10 * v4 == -2944)s.add(-54 * v11 + -23 * v8 + -82 * v3 + -85 * v2 + 124 * v1 - 11 * v4 - 8 * v5 - 60 * v7 + 95 * v6 + 100 * v9 == -2222)s.add(-83 * v11 + -111 * v7 + -57 * v2 + 41 * v1 + 73 * v3 - 18 * v4 + 26 * v5 + 16 * v6 + 77 * v8 - 63 * v9 == -13258)s.add(81 * v11 + -48 * v9 + 66 * v8 + -104 * v6 + -121 * v7 + 95 * v5 + 85 * v4 + 60 * v3 + -85 * v2 + 80 * v1 == -1559)s.add(101 * v11 + -85 * v9 + 7 * v6 + 117 * v7 + -83 * v5 + -101 * v4 + 90 * v3 + -28 * v1 + 18 * v2 - v8 == 6308)s.add(99 * v11 + -28 * v9 + 5 * v8 + 93 * v6 + -18 * v7 + -127 * v5 + 6 * v4 + -9 * v3 + -93 * v1 + 58 * v2 == -1697)if s.check()==sat:    result=s.model()print(result)</code></pre><h1 id="å˜é‡ä¸ºæ•°ç»„"><a href="#å˜é‡ä¸ºæ•°ç»„" class="headerlink" title="å˜é‡ä¸ºæ•°ç»„"></a>å˜é‡ä¸ºæ•°ç»„</h1><h2 id="é¢˜ç›®-1"><a href="#é¢˜ç›®-1" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><a href="https://buuoj.cn/challenges#[GWCTF%202019]xxor">https://buuoj.cn/challenges#[GWCTF%202019]xxor</a></p><h2 id="å…³é”®ä»£ç -1"><a href="#å…³é”®ä»£ç -1" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h2><p><img src="/2022/01/17/Z3/1642417350041.png"></p><pre class="language-python" data-language="python"><code class="language-python">from z3 import*#æ·»åŠ å…­ä¸ªIntæ•°æ®åˆ°så˜é‡ä¸­s = [Int('s%d' % i) for i in range(6)]a=Solver()#å¤šä¸ªçº¦æŸæ¡ä»¶å¯ä»¥ä½¿ç”¨é€—å·é—´éš”a.add(s[2]-s[3]==2225223423,s[3]+s[4]==4201428739,s[2]-s[4]==1121399208,s[0]==0xdf48ef7e,s[5]==0x84f30420,s[1]==0x20caacf4)if a.check() == sat:    print(a.model())</code></pre><p>è¿™æ ·å¾—åˆ°çš„ç»“æœä¸ä¼šæ˜¯æ•°ç»„çš„å½¢å¼ï¼Œå¦‚ä¸‹å¾—åˆ°çš„æ˜¯æ•°ç»„å½¢å¼</p><p><img src="/2022/01/17/Z3/1642418166049.png"></p><h1 id="æ•°ç‹¬é—®é¢˜"><a href="#æ•°ç‹¬é—®é¢˜" class="headerlink" title="æ•°ç‹¬é—®é¢˜"></a>æ•°ç‹¬é—®é¢˜</h1><p>æ•°ç‹¬é—®é¢˜å°±æ˜¯9Ã—9çš„æ–¹å—å¡«æ•°ï¼ˆåªèƒ½æ˜¯1-9ï¼‰ï¼Œåˆ†æˆ3Ã—3çš„å°æ–¹å—ï¼Œè¡Œåˆ—æ•°å­—ä¸åŒï¼Œæ¯ä¸ªå°æ–¹å—æ•°å­—ä¸èƒ½é‡å¤</p><p>å…ˆè´´ä¸€ä¸‹</p><pre class="language-python" data-language="python"><code class="language-python">from z3 import *# 9x9æ•´æ•°å˜é‡çŸ©é˜µX = [ [ Int("x_%s_%s" % (i+1, j+1)) for j in range(9) ]      for i in range(9) ]  # æ¯ä¸ªå•å…ƒæ ¼åŒ…å«{1ï¼Œâ€¦ï¼Œ9}ä¸­çš„å€¼cells_c  = [ And(1 &lt;= X[i][j], X[i][j] &lt;= 9)             for i in range(9) for j in range(9) ]  # æ¯è¡Œæœ€å¤šåŒ…å«ä¸€ä¸ªæ•°å­—ä¸€æ¬¡rows_c   = [ Distinct(X[i]) for i in range(9) ]  # æ¯åˆ—æœ€å¤šåŒ…å«ä¸€ä¸ªæ•°å­—cols_c   = [ Distinct([ X[i][j] for i in range(9) ])             for j in range(9) ]  # æ¯ä¸ª3x3æ­£æ–¹å½¢æœ€å¤šåŒ…å«ä¸€ä¸ªæ•°å­—sq_c     = [ Distinct([ X[3*i0 + i][3*j0 + j]                        for i in range(3) for j in range(3) ])             for i0 in range(3) for j0 in range(3) ]  sudoku_c = cells_c + rows_c + cols_c + sq_c  # æ•°ç‹¬å®ä¾‹ï¼Œæˆ‘ä»¬ç”¨'0'è¡¨ç¤ºç©ºå•å…ƒæ ¼instance = ((0,0,0,0,9,4,0,3,0),            (0,0,0,5,1,0,0,0,7),            (0,8,9,0,0,0,0,4,0),            (0,0,0,0,0,0,2,0,8),            (0,6,0,2,0,1,0,5,0),            (1,0,2,0,0,0,0,0,0),            (0,7,0,0,0,0,5,2,0),            (9,0,0,0,6,5,0,0,0),            (0,4,0,9,7,0,0,0,0))  instance_c = [ If(instance[i][j] == 0,                  True,                  X[i][j] == instance[i][j])               for i in range(9) for j in range(9) ]  s = Solver()s.add(sudoku_c + instance_c)if s.check() == sat:    m = s.model()    r = [ [ m.evaluate(X[i][j]) for j in range(9) ]          for i in range(9) ]    print_matrix(r)else:    print("failed to solve")</code></pre><h2 id="é¢˜ç›®-2"><a href="#é¢˜ç›®-2" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>è¿™æ˜¯æ”¹äº†çš„æ•°ç‹¬ï¼Œæ¯”è¾ƒç®€å•ï¼Œæ‹¿æ¥ç»ƒç»ƒæ‰‹</p><p><a href="https://buuoj.cn/challenges#[GUET-CTF2019]number_game">https://buuoj.cn/challenges#[GUET-CTF2019]number_game</a></p><h2 id="Z3åœ¨é¢˜ç›®çš„è¿ç”¨"><a href="#Z3åœ¨é¢˜ç›®çš„è¿ç”¨" class="headerlink" title="Z3åœ¨é¢˜ç›®çš„è¿ç”¨"></a>Z3åœ¨é¢˜ç›®çš„è¿ç”¨</h2><pre class="language-python" data-language="python"><code class="language-python">from z3 import *# 5*5æ•´æ•°å˜é‡çŸ©é˜µX = [[Int("x_%s_%s" % (i + 1, j + 1)) for j in range(5)]     for i in range(5)]# æ¯ä¸ªå•å…ƒæ ¼åŒ…å«{0ï¼Œâ€¦ï¼Œ4}ä¸­çš„å€¼cells_c = [And(0 &lt;= X[i][j], X[i][j] &lt;= 4)           for i in range(5) for j in range(5)]# æ¯è¡Œæœ€å¤šåŒ…å«ä¸€ä¸ªæ•°å­—ä¸€æ¬¡rows_c = [Distinct(X[i]) for i in range(5)]# æ¯åˆ—æœ€å¤šåŒ…å«ä¸€ä¸ªæ•°å­—cols_c = [Distinct([X[i][j] for i in range(5)])          for j in range(5)]# æ¯ä¸ª5x5æ­£æ–¹å½¢æœ€å¤šåŒ…å«ä¸€ä¸ªæ•°å­—,i0å’Œj0è¡¨ç¤ºåˆ†ä¸ºå‡ ç»„sq_c = [Distinct([X[5 * i0 + i][5 * j0 + j]                  for i in range(5) for j in range(5)])        for i0 in range(0) for j0 in range(0)]sudoku_c = cells_c + rows_c + cols_c + sq_c# æ•°ç‹¬å®ä¾‹ï¼Œæˆ‘ä»¬ç”¨'5'è¡¨ç¤ºç©ºå•å…ƒæ ¼instance = ((1,4,5,2,3),(3,0,5,1,5),(0,5,2,3,5),(5,3,5,5,5),(4,2,5,5,1))instance_c = [If(instance[i][j] == 5,                 True,                 X[i][j] == instance[i][j])              for i in range(5) for j in range(5)]s = Solver()s.add(sudoku_c + instance_c)if s.check() == sat:    m = s.model()    r = [[m.evaluate(X[i][j]) for j in range(5)]         for i in range(5)]    print_matrix(r)else:    print("failed to solve")</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èŠ±æŒ‡ä»¤</title>
      <link href="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/"/>
      <url>/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.anquanke.com/post/id/208682">https://www.anquanke.com/post/id/208682</a></p><h1 id="èŠ±æŒ‡ä»¤åŸç†"><a href="#èŠ±æŒ‡ä»¤åŸç†" class="headerlink" title="èŠ±æŒ‡ä»¤åŸç†"></a>èŠ±æŒ‡ä»¤åŸç†</h1><p>idaé‡‡ç”¨çš„æ˜¯çº¿æ€§æ‰«æåæ±‡ç¼–ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯ä¸€æ­¥ä¸€æ­¥å¾€ä¸‹è¯†åˆ«ï¼Œä¸€æ—¦åœ¨ä¸­é—´æ’å…¥å¥‡æ€ªçš„ç«‹å³æ•°ï¼Œidaå¯èƒ½å°±ä¼šè¯†åˆ«å‡ºé”™ï¼Œè¿›è€Œä¸èƒ½æ­£ç¡®åç¼–è¯‘</p><h1 id="èŠ±æŒ‡ä»¤å®ç°"><a href="#èŠ±æŒ‡ä»¤å®ç°" class="headerlink" title="èŠ±æŒ‡ä»¤å®ç°"></a>èŠ±æŒ‡ä»¤å®ç°</h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ’å…¥èŠ±æŒ‡ä»¤ä¸èƒ½é˜»ç¢æˆ‘ä»¬ç¨‹åºçš„æ­£å¸¸è¿è¡Œï¼Œè¿™æ˜¯æœ€åŸºæœ¬çš„</p><p>ä¸‹é¢ä½¿ç”¨ä¸€æ®µå¸¸è§„ä»£ç è¿›è¡ŒèŠ±æŒ‡ä»¤çš„æ·»åŠ </p><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;#include&lt;windows.h&gt;int main(int argc, char* argv[]){char s[] = "1234234";int i = 0, k = 1;for (; i &lt; 10; ++i){k += i;}printf("%d", k);return 0;}</code></pre><p>æ²¡æ’èŠ±æŒ‡ä»¤å‰çš„åç¼–è¯‘</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/MF%5DH0@C0%5BLZFAI%7BX83MEI.png"></p><h2 id="æ°¸çœŸè·³è½¬"><a href="#æ°¸çœŸè·³è½¬" class="headerlink" title="æ°¸çœŸè·³è½¬"></a>æ°¸çœŸè·³è½¬</h2><pre class="language-c" data-language="c"><code class="language-c">__asm {    push eax;xor eax, eax;test eax, eax;jz LABEL1;jnz  LABLE2;LABLE2:__emit 0xe8;LABEL1:    pop eax;}</code></pre><p>å…ˆæ¥çœ‹çœ‹æ•ˆæœ</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646113378508.png"></p><p>å¯ä»¥çœ‹åˆ°idaä¸èƒ½æ­£ç¡®åç¼–è¯‘</p><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>xor eax,eaxèƒ½å¤Ÿä¿è¯eaxçš„å€¼ä¸º0ï¼Œå¼‚æˆ–è‡ªå·±ï¼Œç›¸åŒä¸º0</p><p>æ ¹æ®ç›®æ ‡æ“ä½œæ•°ä¿®æ”¹ç¬¦å·æ ‡å¿—ä½ã€å¥‡å¶æ ‡å¿—ä½ã€é›¶æ ‡å¿—ä½ï¼Œç»è¿‡è¿™ä¸€æ­¥åï¼ŒZFä¸º1</p><p>test eax,eaxæ˜¯æŒ‰ä½ä¸æ“ä½œï¼Œå¹¶ä¸”ä¼šæ ¹æ®å€¼ä¿®æ”¹ZFæ ‡å¿—ä½ï¼Œå¹¶ä¸”åªæœ‰å½“ä½éƒ½æ¸… 0 æ—¶ï¼Œé›¶æ ‡å¿—ä½æ‰ç½® 1 </p><p>ZFä¸º1æ—¶ï¼Œjzè¿›è¡Œè·³è½¬ï¼Œåˆ°LABEL1ï¼Œå› ä¸ºé‡Œé¢æ²¡æœ‰å…¶ä»–å€¼ï¼Œæ‰€ä»¥ä»£ç æ­£å¸¸æ‰§è¡Œï¼Œä½†æ˜¯åœ¨ åç¼–è¯‘çš„æ—¶å€™ï¼Œå› ä¸ºæ˜¯çº¿æ€§æ‰«æï¼Œæ‰€ä»¥é‡åˆ°äº†LABEL2é‡Œé¢çš„0xe8ï¼ˆcallçš„æœºå™¨ç ï¼‰ï¼Œå°±ä¼šå°†å…¶åé¢çš„æœºå™¨ç å½“ä½œè¦è°ƒç”¨çš„åœ°å€ï¼Œè¿™æ ·ä¸€æ¥ï¼Œjzå°±ç›´æ¥è·³è½¬åˆ°è¢«é”™è¯¯è¯†åˆ«çš„æ±‡ç¼–ä»£ç ä¸­ï¼Œæ‰€ä»¥ä¼šå‡ºç°é”™è¯¯</p><h3 id="å»é™¤"><a href="#å»é™¤" class="headerlink" title="å»é™¤"></a>å»é™¤</h3><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646114167483.png"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œé¢çš„jzå’Œjnzåé¢çš„åœ°å€å­˜åœ¨+1ï¼Œè¿™å°±åŸºæœ¬å¯ä»¥çœ‹å‡ºæ˜¯èŠ±æŒ‡ä»¤äº†ï¼Œæ‰¾åˆ°å¯¹åº”çš„åœ°å€ï¼ŒæŒ‰uå–æ¶ˆå®šä¹‰</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646114596608.png"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œä¹Ÿæ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œå¯¹ä¸‹é¢çš„æŒ‰Cå¼„æˆä»£ç </p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646114739199.png"></p><p>ç„¶åä¸ºäº†åç¼–è¯‘ï¼Œè¦æŠŠ0xe8ä½¿ç”¨90å¡«å……ï¼Œä¹Ÿå°±æ˜¯nopï¼Œå¡«å……åæŒ‰Cå³å¯</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646114800614.png"></p><p>æŒ‰På¼„æˆå‡½æ•°ååç¼–è¯‘ï¼Œå’Œä¸Šé¢çš„åŸºæœ¬ä¸€è‡´</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646114856426.png"></p><h2 id="æ’å…¥ç«‹å³æ•°"><a href="#æ’å…¥ç«‹å³æ•°" class="headerlink" title="æ’å…¥ç«‹å³æ•°"></a>æ’å…¥ç«‹å³æ•°</h2><pre class="language-c" data-language="c"><code class="language-c">__asm {xor eax, eax;jz LABEL1;__emit 0x11;__emit 0x22;__emit 0x33;LABEL1:}</code></pre><p>æ•ˆæœ</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646115623618.png"></p><p>è¯†åˆ«å‡ºé”™ï¼ŒåŸç†å’Œä¸Šé¢ä¸€æ ·ï¼Œæ„Ÿè§‰è¿™ç§ç¨å¾®æ¶å¿ƒä¸€ç‚¹ï¼Œå› ä¸ºæœ‰ä¸€æ®µå¯èƒ½æ˜¯æ­£å¸¸çš„ï¼Œéœ€è¦ä¸€ä¸ªä¸€ä¸ªè¯•</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646115805153.png"></p><p>ç›´æ¥nopæ‰å³å¯</p><h2 id="ç ´åå †æ ˆ"><a href="#ç ´åå †æ ˆ" class="headerlink" title="ç ´åå †æ ˆ"></a>ç ´åå †æ ˆ</h2><p>æˆ‘ä»¬å¯ä»¥æ’å…¥å¯¹espå’Œeipçš„æ“ä½œè¿›è€Œç ´åå †æ ˆ</p><pre class="language-c" data-language="c"><code class="language-c">__asm {xor eax, eax;jz LABEL1;add esp, 8;LABEL1:}</code></pre><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646116696374.png"></p><p>idaèƒ½å¤Ÿæ­£å¸¸åç¼–è¯‘ï¼Œä½†æ˜¯åœ¨å‡½æ•°æœ«ç«¯ä¼šå‘ç°å †æ ˆé”™è¯¯æç¤º</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646116781788.png"></p><h2 id="call-amp-retæ„é€ èŠ±æŒ‡ä»¤"><a href="#call-amp-retæ„é€ èŠ±æŒ‡ä»¤" class="headerlink" title="call&amp;retæ„é€ èŠ±æŒ‡ä»¤"></a>call&amp;retæ„é€ èŠ±æŒ‡ä»¤</h2><p>callæœ¬è´¨æ˜¯å…ˆå°†å…¶ ä¸‹ä¸€æ¡æŒ‡ä»¤å‹å…¥æ ˆä¸­ï¼Œå†jmpå‡½æ•°åœ°å€</p><p>retåˆ™æ˜¯pop eip</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿®æ”¹è¿”å›åœ°å€ï¼Œç„¶ååœ¨ä¸­å‰æ’å…¥åƒåœ¾æ•°</p><pre class="language-c" data-language="c"><code class="language-c">__asm {call LABEL1;__emit 0x83;LABEL1:add dword ptr ss : [esp] , 8;ret;    __emit 0xf3;}</code></pre><p>æ•ˆæœ</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646118501242.png"></p><p>è¿™é‡Œæˆ‘ä»¬æ’å…¥çš„ä¸æ˜¯æœºå™¨ç ï¼Œæ‰€ä»¥æ²¡æœ‰è¯†åˆ«æˆå¥‡æ€ªçš„ä»£ç ï¼Œä½†æ˜¯è¿˜æ˜¯è®©idaå‡ºç°äº†é”™è¯¯</p><h3 id="å»é™¤-1"><a href="#å»é™¤-1" class="headerlink" title="å»é™¤"></a>å»é™¤</h3><p>å…¨éƒ¨nopæ‰å³å¯</p><h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h3><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646122556219.png"></p><p>è¿™é‡Œä¹‹æ‰€ä»¥ç¨‹åºèƒ½å¤Ÿè¿›è¡Œæ­£å¸¸çš„è¿è¡Œï¼Œæ˜¯å› ä¸ºcallä¼šæŠŠå…¶ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å‹å…¥æ ˆä¸­ï¼Œä¹Ÿå°±æ˜¯41459Fï¼Œï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™é‡Œä¼šå¤šå‡ºä¸€ä¸ªdb 36h -.-)ï¼Œæ¥ä¸‹æ¥æ‰§è¡Œå°†å½“å‰espåœ°å€çš„å€¼+8ï¼Œä¹Ÿå°±æ˜¯æ ˆé¡¶å­˜å‚¨çš„å€¼+8ï¼Œä¹Ÿå°±æ˜¯è¿”å›åœ°å€åŠ 8ï¼Œæ­£å¥½å¯¹åº”4145A7ï¼Œä¸‹é¢çš„ä»£ç cä¹‹åæ˜¯æ­£å¸¸çš„ä»£ç ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºé”™</p><p>åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å„ç§èŠ±æŒ‡ä»¤</p><p>ä¸‹é¢è¿æ¥æœ‰ä¸€äº›èŠ±æŒ‡ä»¤</p><p><a href="https://www.bilibili.com/read/cv13177757">https://www.bilibili.com/read/cv13177757</a></p><h2 id="callåµŒå¥—"><a href="#callåµŒå¥—" class="headerlink" title="callåµŒå¥—"></a>callåµŒå¥—</h2><pre class="language-c" data-language="c"><code class="language-c">__asm {call LABEL1;_emit 0xE8;LABEL2:jmp LABEL3;_emit 0;_emit 0;_emit 0xE8;_emit 0xf6;_emit 0xff;_emit 0xff;_emit 0xff;LABEL1:call LABEL2;LABEL3:add esp, 8;}</code></pre><p>æ•ˆæœ</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646123989260.png"></p><h3 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>è¿™é‡Œä¹‹æ‰€ä»¥ç¨‹åºèƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œæ˜¯å› ä¸ºåªæœ‰ä¸¤ä¸ªcallå¯¹å †æ ˆæœ‰å½±å“ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨æœ€åesp+8å°±å¯ä»¥å›åˆ°åŸæ¥çš„å †æ ˆ</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646124342486.png"></p><p>è¿™é‡Œå…ˆcallA9ï¼Œç„¶å0xE8å’Œåé¢çš„ç»“åˆæˆäº†callæŒ‡ä»¤ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°callåˆ°äº†å…¨æ˜¯int 3çš„åœ°æ–¹</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646124399722.png"></p><p>ç„¶åè¿™ä¸ª9fä¸€ç›´åœ¨callè‡ªå·±ï¼Œæ‰€ä»¥å¯ä»¥åˆ¤æ–­æ˜¯èŠ±æŒ‡ä»¤</p><p>æŠŠè¿™ä¸¤ä¸ªå‡½æ•°nopæ‰ä¹‹å</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646124643631.png"></p><p>æ‰€ä»¥è¿™ä¸ªè°ƒç”¨ä¹Ÿæ²¡ç”¨äº†</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646124712766.png"></p><p>åŒç†è¿™ä¸ªä¹Ÿå¯ä»¥nopæ‰ï¼Œé‚£ä¹ˆå †æ ˆä¼šä¸å¹³è¡¡ï¼Œadd esp,8ä¹Ÿè¦nop</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646124803779.png"></p><p>å¾—åˆ°æ­£å¸¸ä»£ç </p><h2 id="jmpå˜å½¢-SUSCTF2022-tttree"><a href="#jmpå˜å½¢-SUSCTF2022-tttree" class="headerlink" title="jmpå˜å½¢-SUSCTF2022-tttree"></a>jmpå˜å½¢-SUSCTF2022-tttree</h2><p>æ„Ÿè§‰å¾ˆå·§å¦™ï¼Œæ‹¿å‡ºæ¥çœ‹çœ‹</p><p>åŠ¨è°ƒå¯ä»¥çœ‹å¾—æ›´æ¸…æ¥š</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646126953595.png"></p><p>å‰é¢çš„pushæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå…³é”®åœ¨callä¹‹åçš„</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646127104589.png"></p><p>å½“å‰çš„æ ˆé¡¶ï¼Œcallä¼šå°†å…¶ä¹‹åçš„åœ°å€å‹å…¥æ ˆé¡¶</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646127228921.png"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯B7D82FF9B0</p><p>ä¸‹é¢ä¸¤æ­¥å°±æ˜¯å°†å½“å‰æ ˆé¡¶çš„å…ƒç´ å…ˆ+0x191bç»™åˆ°rax</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646127367726.png"></p><p>ä¸‹ä¸€æ­¥æ˜¯æŠŠraxé‡Œçš„å€¼ç»™åˆ°rsp+16</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646127416441.png" alt="1646127416441"></p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646127424928.png"></p><p>ç»è¿‡ä¸¤æ­¥popï¼Œå¯ä»¥å‘ç°æ¥åˆ°äº†å­˜å‚¨åŸæœ¬è¿”å›å€¼+0x191bçš„æ ˆçš„ä½ç½®</p><p><img src="/2022/01/17/%E8%8A%B1%E6%8C%87%E4%BB%A4/1646127512911.png"></p><p>retnå…ˆå°†æ ˆé¡¶å…ƒç´ popåˆ°eipï¼Œå†jmpï¼Œè€Œeipæ­£å¥½è®°å½•æˆ‘ä»¬ä¸‹ä¸€æ­¥æ‰§è¡Œçš„æŒ‡ä»¤</p><p>è¿™æ ·å°±æ˜¯ä¸€ä¸ªç®€å•çš„jmp</p><p>è§£å†³æ–¹æ³•å°±æ˜¯å…ˆè®¡ç®—è·³è½¬çš„åœ°å€ï¼Œç„¶åæ”¹æˆjmpå³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SMC</title>
      <link href="/2022/01/17/SMC/"/>
      <url>/2022/01/17/SMC/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.anquanke.com/post/id/238645">https://www.anquanke.com/post/id/238645</a></p><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>SMCï¼Œæ˜¯self-modifying-codeçš„ç¼©å†™ ï¼Œå³è‡ªæˆ‘ä¿®æ”¹çš„ä»£ç ï¼Œé€šè¿‡ç¨‹åºè¿è¡Œåæ‰§è¡Œç›¸å…³ä»£ç åŠŸèƒ½ï¼Œå¯¹åŠ å¯†çš„ä»£ç æ•°æ®è¿›è¡Œè§£å¯†ï¼Œè®©å…¶æ¢å¤æ­£å¸¸åŠŸèƒ½</p><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><p>1ã€è¦æœ‰ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªç”¨äºåŠ å¯†ï¼Œä¸€ä¸ªç”¨äºè§£å¯†ï¼Œä¸¤ä¸ªæ˜¯å¯¹åº”çš„</p><p>2ã€æ‰¾åˆ°è¦SMCçš„ä»£ç åœ°å€ï¼Œç„¶åæå‰åœ¨ç¨‹åºå¼€å§‹çš„åœ°æ–¹è®¾ç½®å¯¹è¯¥åœ°å€æ•°æ®çš„è§£å¯†å‡½æ•°</p><p>3ã€å–å‡ºè¦è¿›è¡ŒSMCçš„ä»£ç çš„å­—èŠ‚ç ï¼Œå¯¹å…¶ä½¿ç”¨å‡†å¤‡å¥½çš„åŠ å¯†å‡½æ•°è¿›è¡ŒåŠ å¯†</p><p>4ã€ç”¨è¿™ä¸²åŠ å¯†çš„æ•°æ®æ›¿æ¢åŸä»£ç çš„å­—èŠ‚ç </p><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><p><a href="https://buuoj.cn/challenges#[%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84]jocker">https://buuoj.cn/challenges#[%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84]jocker</a></p><h1 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h1><p>æ‰“å¼€idaåç¼–è¯‘çœ‹åˆ°</p><p><img src="/2022/01/17/SMC/1642563702820.png"></p><p>ç‚¹è¿›è¿™ä¸ªå‡½æ•°idaç›´æ¥æŠ¥é”™</p><p><img src="/2022/01/17/SMC/1642563778289.png"></p><p>æŸ¥çœ‹æ±‡ç¼–ä»£ç </p><p><img src="/2022/01/17/SMC/1642563800178.png"></p><p>ç‚¹å‡»å‡½æ•°è·Ÿè¿›</p><p><img src="/2022/01/17/SMC/1642563901545.png"></p><p>å‘ç°ä¸€é•¿ä¸²æ²¡è¢«è¯†åˆ«çš„æ•°æ®æ®µï¼Œè¿™ç§æƒ…å†µå¯èƒ½æ˜¯èŠ±æŒ‡ä»¤å¯¼è‡´ï¼Œä¹Ÿå¯èƒ½æ˜¯SMCï¼Œç»“åˆä¹‹å‰æœ‰ä¸€ä¸ªå¾ªç¯å¼‚æˆ–ï¼Œå¯ä»¥çŒœæµ‹æ˜¯SMCï¼Œæ¥ä¸‹æ¥æœ‰ä¸¤ç§æ–¹æ³•è§£å¯† </p><h2 id="ä½¿ç”¨IDCå¯¹åŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†"><a href="#ä½¿ç”¨IDCå¯¹åŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†" class="headerlink" title="ä½¿ç”¨IDCå¯¹åŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†"></a>ä½¿ç”¨IDCå¯¹åŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†</h2><p>é¦–å…ˆè¦æ‰¾åˆ°è¢«åŠ å¯†æ•°æ®æ®µçš„åˆå§‹åœ°å€ä»¥åŠåŠ å¯†æ•°æ®æ®µçš„é•¿åº¦ï¼Œè¿™é‡Œé•¿åº¦åœ¨forå¾ªç¯é‡Œé¢ï¼Œåˆå§‹ä½ç½®</p><p><img src="/2022/01/17/SMC/1642566995107.png"></p><p>ç‚¹å‡»å‡½æ•°è·³è½¬</p><p><img src="/2022/01/17/SMC/1642567097998.png"></p><p>é»„è‰²æ®µå°±æ˜¯åˆå§‹åœ°å€ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œå‡½æ•°å…¥å£å¹¶ä¸æ˜¯popå¼€å§‹ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥çŒœåˆ°è¢«åŠ å¯†äº†</p><p>idcè„šæœ¬å¦‚ä¸‹(shift+f2)æ‰“å¼€</p><pre class="language-c" data-language="c"><code class="language-c">#include &lt;idc.idc&gt;static main(){    auto addr = 0x401500;    auto i = 0;    for(i=0;i&lt;187;i++)    {        PatchByte(addr+i,Byte(addr+i)^0x41);    }}</code></pre><p>å¾—åˆ°äº†è§£å¯†çš„æ•°æ®æ®µ</p><p><img src="/2022/01/17/SMC/1642567365432.png"></p><h2 id="åŠ¨æ€è°ƒè¯•"><a href="#åŠ¨æ€è°ƒè¯•" class="headerlink" title="åŠ¨æ€è°ƒè¯•"></a>åŠ¨æ€è°ƒè¯•</h2><p>å› ä¸ºç¨‹åºè‡ªå¸¦è§£å¯†å‡½æ•°ï¼Œåªéœ€è¦åœ¨è§£å¯†å‡½æ•°åé¢ä¸‹æ–­ç‚¹ï¼Œè¿è¡Œåˆ°æ–­ç‚¹å¤„ï¼Œè¢«åŠ å¯†çš„æ•°æ®æ®µå°±èƒ½æˆåŠŸè§£å¯†</p><p><img src="/2022/01/17/SMC/1642565058450.png"></p><p>è¿™æ˜¯æœªè§£å¯†çš„ï¼Œè¿è¡Œå</p><p><img src="/2022/01/17/SMC/1642565236932.png"></p><p>è¿™æ—¶å€™åªéœ€è¦å…ˆå¯¹å‡½æ•°æŒ‰Uï¼Œå–æ¶ˆå®šä¹‰ï¼Œç„¶åé€‰ä¸­æŒ‰Câ€”â€”forceè½¬ä¸ºæ±‡ç¼–ä»£ç </p><p><img src="/2022/01/17/SMC/1642565348450.png"></p><p>ç„¶åæŒ‰på®šä¹‰æˆå‡½æ•°ï¼Œå†æŒ‰F5å°±å¯ä»¥æ­£å¸¸åç¼–è¯‘äº†</p><p><img src="/2022/01/17/SMC/1642565393714.png"></p><h1 id="SMC-åè°ƒè¯•æŠ€æœ¯"><a href="#SMC-åè°ƒè¯•æŠ€æœ¯" class="headerlink" title="SMC+åè°ƒè¯•æŠ€æœ¯"></a>SMC+åè°ƒè¯•æŠ€æœ¯</h1><p>å› ä¸ºsmcå¯ä»¥é‡‡å–åŠ¨æ€è°ƒè¯•æ¥è¿˜åŸåŠ å¯†ä»£ç ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨åè°ƒè¯•æŠ€æœ¯æ¥é˜»æ­¢åŠ¨æ€è°ƒè¯•ï¼Œæ‰€ä»¥è¿™æ—¶å€™å°±éœ€è¦ç»•è¿‡</p><h2 id="ç‹—ç‹—çš„ç§˜å¯†"><a href="#ç‹—ç‹—çš„ç§˜å¯†" class="headerlink" title="ç‹—ç‹—çš„ç§˜å¯†"></a>ç‹—ç‹—çš„ç§˜å¯†</h2><p><img src="/2022/01/17/SMC/1643034259013.png"></p><p>åœ¨æ•°æ®æ®µå‘ç°è¿™é‡Œç±»å‹SMCï¼ŒçŒœæµ‹æ˜¯SMCè‡ªä¿®æ”¹ï¼Œæ‰€ä»¥éœ€è¦å®šä½åˆ°è§£å¯†å‡½æ•°</p><p>åœ¨exportså‘ç°äº†ä¸€ä¸ªå‡½æ•°</p><p>TLSå›è°ƒå‡½æ•°ä¼šåœ¨oepä¹Ÿå°±æ˜¯ç¨‹åºå…¥å£å‰æ‰§è¡Œ</p><p><img src="/2022/01/17/SMC/1643034347085.png"></p><p>è¿™ä¸ªå‡½æ•°ä¼šåœ¨mainå‡½æ•°ä¹‹å‰æ‰§è¡Œï¼Œæ‰€ä»¥å…ˆè¿›å»çœ‹çœ‹</p><p><img src="/2022/01/17/SMC/1643034411621.png"></p><p>æŠŠé¼ æ ‡æ”¾åœ¨ä¸Šé¢å‘ç°ä»–æ˜¯ä¸ªæŒ‡é’ˆï¼Œè¢«èµ‹å€¼ä¸ºsmcçš„å‡½æ•°æ®µï¼Œv8åŒç†ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥è¿™ä¸€æ®µåº”è¯¥å°±æ˜¯smcè§£å¯†ä»£ç </p><p><img src="/2022/01/17/SMC/1643034535760.png"></p><p>å¾ˆæ˜æ˜¾æ˜¯teaï¼Œä¸ä¼šå†™idcteaè„šæœ¬ï¼Œæ‰€ä»¥æ‰“ç®—é‡‡å–åŠ¨è°ƒï¼Œä½†æ˜¯å‰é¢æœ‰å‡ ä¸ªåè°ƒè¯•ï¼Œéœ€è¦ç»•è¿‡ï¼Œä¿è¯èƒ½èµ°åˆ°è§£å¯†ä»£ç è¿™ä¸€æ­¥ </p><p><img src="/2022/01/17/SMC/1643034646186.png"></p><p>å¯¹äºifè¯­å¥ï¼Œåªéœ€è¦ç”¨jnzæˆ–jzæ›¿æ¢å³å¯</p><p>æ‰€ä»¥ç›¸å¯¹æ¥è¯´è¿˜è¡Œï¼Œä¸»è¦æ˜¯è¦å…ˆå®šä½åˆ°è¿™é‡Œ</p><p><img src="/2022/01/17/SMC/1643034751964.png"></p><p>ä¹Ÿå¯ä»¥å»è¿™äº›å‡½æ•°åˆ—è¡¨çœ‹ä¸€çœ‹</p><p>åŠ¨è°ƒå®Œæˆè¿˜æ˜¯å‘ç°å‡ºé”™ï¼Œæ‰€ä»¥é‡Œé¢çš„å€¼å¯èƒ½è¢«å¼•ç”¨ä¿®æ”¹ï¼Œå¯¹ç€å˜é‡æŒ‰xæŸ¥çœ‹äº¤å‰å¼•ç”¨</p><p><img src="/2022/01/17/SMC/1643034871276.png"></p><p>å‘ç°åœ¨æ­¤ä¹‹å‰è¢«ä¿®æ”¹è¿‡ï¼Œä½†æ˜¯åŠ¨è°ƒçš„æ—¶å€™æ˜¾ç¤ºæ˜¯0ï¼Œå¾ˆå¥‡æ€ªï¼Œä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™èµ‹å€¼çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡è¿›å…¥ teaå‡½æ•°éœ€è¦å…ˆå¯¹dword_915168çš„å€¼åœ¨hexçª—å£è¿›è¡Œä¿®æ”¹</p><p><img src="/2022/01/17/SMC/1643035000708.png"></p><p>è¦æ³¨æ„åœ¨è¿™ä¸ªçª—å£ä¸­æ•°æ®ä»¥å°ç«¯åºå­˜å‚¨</p><p>ä¿®æ”¹å¥½ä¹‹åï¼Œä¸‹å¥½æ–­ç‚¹åf9è®©ç¨‹åºè·‘èµ·æ¥å°±å¯ä»¥äº†</p><p><img src="/2022/01/17/SMC/1643035086013.png"></p><p>ä¹‹åå°±æ˜¯å‰é¢è¯´çš„ï¼Œå…ˆå–æ¶ˆå®šä¹‰ï¼Œç„¶åè½¬ä¸ºä»£ç ï¼Œå†å®šä¹‰å‡½æ•°</p><p>å¯»æ‰¾æ€ä¹ˆä¿®æ”¹hexå€¼çš„æ—¶å€™å‘ç°äº† å¯ä»¥æ·»åŠ æŸ¥çœ‹çª—å£ï¼Œå°±å¾ˆæ–¹ä¾¿ï¼Œåœ¨VMé€†å‘é‡Œé¢å¯èƒ½ä¼šçœ‹èµ·æ¥æ›´æ–¹ä¾¿</p><p><img src="/2022/01/17/SMC/1643035222239.png"></p><p><img src="/2022/01/17/SMC/1643035235237.png"></p><h1 id="SMCå®ç°"><a href="#SMCå®ç°" class="headerlink" title="SMCå®ç°"></a>SMCå®ç°</h1><p>ä¸‹é¢æ‰€è¯´çš„æ®µå°±æ˜¯èŠ‚</p><p>å…ˆè´´æºç </p><pre class="language-c" data-language="c"><code class="language-c">#define _CRT_SECURE_NO_WARNINGS#include&lt;stdio.h&gt;#include&lt;string.h&gt;#include&lt;stdlib.h&gt;#include&lt;Windows.h&gt;#include&lt;malloc.h&gt;#pragma code_seg(".scode")void _declspec(naked) Func()//æˆ‘è¿™é‡Œå£°æ˜ä¸€ä¸ªè£¸å‡½æ•°ï¼Œè‡ªå·±å¼€è¾Ÿå †æ ˆå’Œé‡Šæ”¾å †æ ˆï¼Œé¿å¼€æ£€æµ‹å †æ ˆçš„å‡½æ•°ï¼Œé˜²æ­¢å‡½æ•°åœ°å€é‡å®šä½çš„å½±å“{//é€šè¿‡ç‰¹å¾å—å®šä½åˆ°å‡½æ•°å¼€å¤´    __asm {        nop        nop        nop        nop    }    __asm    {        push        ebp        mov         ebp, esp        sub         esp, 0C0h    }    printf("helloworld");    __asm {        add         esp, 0C0h        pop         ebp        ret    }}#pragma code_seg()#pragma comment(linker, "/SECTION:.scode,ERW")void decode(){   //é€šè¿‡è·å–çº¿ç¨‹å¥æŸ„å¯ä»¥å¾—åˆ°æˆ‘ä»¬çš„åŸºåœ°å€    LPVOID pModule = GetModuleHandle(NULL);//ä¼ å…¥å‚æ•°ä¸ºNULLæ—¶ï¼Œè¡¨ç¤ºè·å–å½“å‰ç¨‹åºçš„åŸºå€ï¼Œä¹Ÿå°±æ˜¯MZ    //åˆå§‹åŒ–ç»“æ„ä½“æŒ‡é’ˆ    PIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)(pModule);    PIMAGE_NT_HEADERS32 pNTheader = (PIMAGE_NT_HEADERS32)((DWORD)pModule + pDosHeader-&gt;e_lfanew);    PIMAGE_FILE_HEADER pFileHeader = (PIMAGE_FILE_HEADER)((DWORD)pNTheader + 4);    PIMAGE_OPTIONAL_HEADER32 pOptionHeader = (PIMAGE_OPTIONAL_HEADER32)((DWORD)pFileHeader + sizeof(IMAGE_FILE_HEADER));    PIMAGE_SECTION_HEADER pSectionHeader = (PIMAGE_SECTION_HEADER)((DWORD)pOptionHeader + sizeof(IMAGE_OPTIONAL_HEADER32));        //éå†èŠ‚è¡¨å¾—åˆ°æˆ‘ä»¬çš„è§£å¯†èŠ‚è¡¨    for (int i = 0; i &lt; pFileHeader-&gt;NumberOfSections; i++, pSectionHeader++)    {        if (!strcmp((const char*)pSectionHeader-&gt;Name, ".scode"))        {            PBYTE pSection = (PBYTE)((DWORD)pModule + pSectionHeader-&gt;VirtualAddress);            for (DWORD k = 0; k &lt; pSectionHeader-&gt;SizeOfRawData; ++k)            {                if (*(PDWORD)pSection == 0xC4C4C4C4)                {                    char comp[] = {0xcc,0xcc,0xcc,0xcc,0xcc,0xcc};                    printf("æ‰¾åˆ°å‡½æ•°æ®µ");                    for (;; ++k)                    {                        if (strncmp((const char*)(pSection), comp, 6))                        {                            *(pSection) ^= 0x54;                            printf("%02X", *(pSection));                            pSection++;                        }                        else                        {                            printf("ä¸åœ¨å‡½æ•°æ®µå†…,é€€å‡ºåŠ å¯†");                            return;                        }                   }               }                pSection += 4;            }            printf("è§£å¯†æˆåŠŸ\n");        }    }}int main(){    decode();    Func();return 0;}</code></pre><p>è¿™é‡Œåªåšäº†ä¸€ä¸ªç®€å•çš„å¼‚æˆ–åŠ å¯†</p><p>è§£é‡Šä¸€ä¸‹ä¸€äº›å®ç°çš„æ­¥éª¤ï¼Œå¦‚æœè¦å®ç°æ¯”è¾ƒéš¾çš„åŠ å¯†ç®—æ³•ï¼Œéœ€è¦å…ˆå°†åŸæœ¬æ•°æ®DUMPä¸‹æ¥ï¼ŒåŠ å¯†åå†é‡æ–°æ”¾å…¥exeæ–‡ä»¶ä¸­ï¼Œexeæ–‡ä»¶å­˜æ”¾è§£å¯†ä»£ç </p><h2 id="æ’å…¥æ®µ"><a href="#æ’å…¥æ®µ" class="headerlink" title="æ’å…¥æ®µ"></a>æ’å…¥æ®µ</h2><p>1ã€ç”Ÿæˆæ®µ</p><p>ç”Ÿæˆåç§°ä¸º.socdeçš„æ®µï¼Œå¦‚æœä¸å¡«å†™åˆ™é»˜è®¤æ·»åŠ åˆ°.textæ®µåé¢</p><pre class="language-c" data-language="c"><code class="language-c">#pragma code_seg(".scode")</code></pre><p>2ã€æ®µç»“å°¾</p><pre class="language-c" data-language="c"><code class="language-c">#pragma code_seg()</code></pre><p>é€šè¿‡ä¸Šé¢ä¸¤è¡Œä»£ç å¯ä»¥ç”Ÿæˆä¸€ä¸ªæ®µ</p><p>3ã€è®¾ç½®æ®µçš„å±æ€§</p><pre class="language-c" data-language="c"><code class="language-c">#pragma comment(linker, "/SECTION:.scode,ERW")</code></pre><p>ä¸‰ä¸ªå­—æ¯åˆ†åˆ«å¯¹åº”å¯æ‰§è¡Œã€å¯è¯»å’Œå¯å†™</p><h2 id="åœ¨æ®µä¸­æ’å…¥å‡½æ•°"><a href="#åœ¨æ®µä¸­æ’å…¥å‡½æ•°" class="headerlink" title="åœ¨æ®µä¸­æ’å…¥å‡½æ•°"></a>åœ¨æ®µä¸­æ’å…¥å‡½æ•°</h2><p>å‰é¢ç¬¬ä¸€å’Œç¬¬äºŒè¡Œä»£ç ä¹‹é—´æ’å…¥ä»£ç -å‡½æ•°ï¼Œå½“ç„¶æ˜¯å¯ä»¥ç›´æ¥æ’å…¥å‡½æ•°çš„ï¼Œè¿™é‡Œæ˜¯è‡ªå·±ç”¨æ±‡ç¼–ä»£ç æ„é€ çš„å‡½æ•°</p><p>è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆå‰é¢å…ˆæ’äº†å‡ ä¸ªnopï¼Œé¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ä¸åŒç¼–è¯‘å™¨ä½¿ç”¨ç”Ÿæˆæ®µçš„ä»£ç å¾—åˆ°ç»“æœæ˜¯ä¸åŒçš„</p><p><img src="/2022/01/17/SMC/1647950648709.png" alt="VC6ç”Ÿæˆæ®µ"></p><p><img src="/2022/01/17/SMC/1647950674759.png" alt="VS2022ç”Ÿæˆæ®µ"></p><p>å¯ä»¥çœ‹åˆ°VS2022ä¸­æˆ‘ä»¬å†™çš„å‡½æ•°åœ¨ç”Ÿæˆæ®µçš„ä¸­é—´ï¼Œé‚£ä¹ˆå°±éœ€è¦å®šä½ï¼Œè€ŒVC6åˆä¸ä¸€æ ·äº†ï¼Œå…·ä½“æƒ…å†µå…·ä½“åˆ†æå§</p><p>æ‰€ä»¥åœ¨VS2022ä¸­ï¼Œæˆ‘ä»¬è¦å…ˆå®šä½åˆ°æ’å…¥çš„å‡½æ•°ï¼Œè€Œä¸èƒ½ç›´æ¥å°†æ•´ä¸ªæ®µåŠ å¯†ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ’å…¥nopçš„åŸå› ï¼Œnopå¯ä»¥ç”¨ä½œç‰¹å¾ç æ¥è¯†åˆ«ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ›¿æ¢æˆ–ä¸ç”¨</p><h2 id="å®šä½åˆ°æ®µçš„ä½ç½®"><a href="#å®šä½åˆ°æ®µçš„ä½ç½®" class="headerlink" title="å®šä½åˆ°æ®µçš„ä½ç½®"></a>å®šä½åˆ°æ®µçš„ä½ç½®</h2><p>å…ˆæ¥ä»‹ç»ä¸€ä¸ªå‡½æ•°ï¼ŒGetModuleHandleå¯ä»¥å¾—åˆ°è¿›ç¨‹çš„å¥æŸ„ï¼Œå½“ä¼ å…¥çš„å‚æ•°ä¸ºNULLæ—¶ï¼Œå¯ä»¥å¾—åˆ°å½“å‰è¿è¡Œç¨‹åºçš„åŸºå€ï¼Œä¹Ÿå°±æ˜¯ImageBaseï¼Œè¿™ä¸€å—è¿˜éœ€è¦å¤šäº†è§£ï¼Œå°±å…ˆç®€å•ä»‹ç»</p><p>å¾—åˆ°åŸºå€ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®windows.hæä¾›çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œå¾—åˆ°PEå¤´ã€DOSå¤´ã€èŠ‚è¡¨çš„ä¿¡æ¯</p><pre class="language-c" data-language="c"><code class="language-c">//é€šè¿‡è·å–çº¿ç¨‹å¥æŸ„å¯ä»¥å¾—åˆ°æˆ‘ä»¬çš„åŸºåœ°å€    LPVOID pModule = GetModuleHandle(NULL);//ä¼ å…¥å‚æ•°ä¸ºNULLæ—¶ï¼Œè¡¨ç¤ºè·å–å½“å‰ç¨‹åºçš„åŸºå€ï¼Œä¹Ÿå°±æ˜¯MZ    //åˆå§‹åŒ–ç»“æ„ä½“æŒ‡é’ˆ    PIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)(pModule);    PIMAGE_NT_HEADERS32 pNTheader = (PIMAGE_NT_HEADERS32)((DWORD)pModule + pDosHeader-&gt;e_lfanew);    PIMAGE_FILE_HEADER pFileHeader = (PIMAGE_FILE_HEADER)((DWORD)pNTheader + 4);    PIMAGE_OPTIONAL_HEADER32 pOptionHeader = (PIMAGE_OPTIONAL_HEADER32)((DWORD)pFileHeader + sizeof(IMAGE_FILE_HEADER));    PIMAGE_SECTION_HEADER pSectionHeader = (PIMAGE_SECTION_HEADER)((DWORD)pOptionHeader + sizeof(IMAGE_OPTIONAL_HEADER32));</code></pre><p>æ¥ç€å°±æ˜¯éå†ï¼Œæ¯”è¾ƒæ®µçš„åå­—ï¼Œè¿™æ ·å°±å¯ä»¥å®šä½åˆ°æˆ‘ä»¬æ’å…¥çš„æ®µ</p><h2 id="å®šä½æ®µä½ç½®"><a href="#å®šä½æ®µä½ç½®" class="headerlink" title="å®šä½æ®µä½ç½®"></a>å®šä½æ®µä½ç½®</h2><p>æˆ‘ä»¬å…ˆå‰å¾—åˆ°çš„å¥æŸ„+è¯¥èŠ‚çš„VirtualAddresså°±æ˜¯èŠ‚å¼€å§‹çš„åœ°æ–¹</p><p>å› ä¸ºæˆ‘ä»¬åŠ å¯†æ—¶æ˜¯å•å­—èŠ‚åŠ å¯†ï¼Œæ‰€ä»¥è½¬ä¸º(PBYTE)å‹</p><h2 id="æ ¹æ®ç‰¹å¾ä»£ç å®šä½"><a href="#æ ¹æ®ç‰¹å¾ä»£ç å®šä½" class="headerlink" title="æ ¹æ®ç‰¹å¾ä»£ç å®šä½"></a>æ ¹æ®ç‰¹å¾ä»£ç å®šä½</h2><p>å› ä¸ºSMCä¼šåœ¨ç¨‹åºè¿è¡Œä¸­è¿›è¡Œè§£å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å®šä½åˆ°å‡½æ•°ä½ç½®</p><p>nopçš„æœºå™¨ç æ˜¯0x90ï¼Œå¼‚æˆ–åŠ å¯†åæ˜¯0xC4ï¼Œæ³¨æ„è¿™é‡Œçš„å°æ®µåºé—®é¢˜</p><h2 id="åˆ¤æ–­ç»“æŸä½ç½®"><a href="#åˆ¤æ–­ç»“æŸä½ç½®" class="headerlink" title="åˆ¤æ–­ç»“æŸä½ç½®"></a>åˆ¤æ–­ç»“æŸä½ç½®</h2><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç»“æŸä»£ç ä¹‹åéƒ½æ˜¯0xCCï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œç„¶ååˆ¤æ–­æ˜¯å¦åˆ°è¾¾æœ«å°¾</p><pre class="language-c" data-language="c"><code class="language-c">if (strncmp((const char*)(pSection), comp, 6))                        {                            *(pSection) ^= 0x54;                            printf("%02X", *(pSection));                            pSection++;                        }                        else                        {                            printf("ä¸åœ¨å‡½æ•°æ®µå†…,é€€å‡ºåŠ å¯†");                            return;                        }</code></pre><h2 id="ä¿®æ”¹exeæ–‡ä»¶"><a href="#ä¿®æ”¹exeæ–‡ä»¶" class="headerlink" title="ä¿®æ”¹exeæ–‡ä»¶"></a>ä¿®æ”¹exeæ–‡ä»¶</h2><p>è¿™é‡Œæˆ‘æŠŠåŠ å¯†åçš„æ•°æ®æ‰“å°äº†å‡ºæ¥ï¼Œæ–¹ä¾¿è´´åˆ°exeä¸­</p><p><img src="/2022/01/17/SMC/1647951555438.png" alt="ä¿®æ”¹åçš„å­—èŠ‚"></p><h2 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h2><p>è¿è¡Œexeå‘ç°</p><p><img src="/2022/01/17/SMC/1647951602713.png"></p><p>æœ€åæ‰“å°çš„å°±æ˜¯æ®µä¸­çš„ä»£ç ç»“æœ</p><p>idaä¸­ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ— æ³•æ­£å¸¸åç¼–è¯‘</p><p><img src="/2022/01/17/SMC/1647951757121.png" alt="idaä¸­å‡½æ•°æƒ…å†µ"></p><h1 id="å¦å¤–å®ç°"><a href="#å¦å¤–å®ç°" class="headerlink" title="å¦å¤–å®ç°"></a>å¦å¤–å®ç°</h1><p>æ›´å¤šçš„å¯ä»¥çœ‹å»æ–‡ç« å¤´éƒ¨çš„é“¾æ¥çœ‹çœ‹</p><p>æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å®šä½åˆ°åŠ å¯†çš„ä½ç½®ï¼Œè¿™æ ·å°±æ¯”è¾ƒéº»çƒ¦ï¼Œå› ä¸ºè¿˜è¦è®¡ç®—å¤§å°ï¼Œä¸è¿‡ä»£ç å€’æ˜¯æ¯”è¾ƒç®€å•</p><pre class="language-c" data-language="c"><code class="language-c">for (DWORD i = 0; i &lt; 30; ++i)   {       *(unsigned char*)(0x00411780 + i) ^= 0x54;       printf("%02X", *(unsigned char*)(0x00411780 + i));   }   printf("è§£å¯†æˆåŠŸ\n");</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>zip</title>
      <link href="/2022/01/15/zip/"/>
      <url>/2022/01/15/zip/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¼ªåŠ å¯†"><a href="#ä¼ªåŠ å¯†" class="headerlink" title="ä¼ªåŠ å¯†"></a>ä¼ªåŠ å¯†</h1><h2 id="ä¼ªåŠ å¯†åŸç†åŠæ“ä½œ"><a href="#ä¼ªåŠ å¯†åŸç†åŠæ“ä½œ" class="headerlink" title="ä¼ªåŠ å¯†åŸç†åŠæ“ä½œ"></a>ä¼ªåŠ å¯†åŸç†åŠæ“ä½œ</h2><h3 id="zipæ–‡ä»¶ç»„æˆ"><a href="#zipæ–‡ä»¶ç»„æˆ" class="headerlink" title="zipæ–‡ä»¶ç»„æˆ"></a>zipæ–‡ä»¶ç»„æˆ</h3><p>å¯ä»¥å»é‡Œé¢çœ‹çœ‹ï¼ŒæŒºå…¨çš„</p><p><a href="https://blog.csdn.net/qq_26187985/article/details/83654197">https://blog.csdn.net/qq_26187985/article/details/83654197</a></p><h3 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h3><p>è¿™é‡Œæ‰¾äº†ä¸€é“å¤§ä½¬å‡ºçš„é¢˜ï¼Œé€‚åˆç»ƒç»ƒæ‰‹</p><p>ã€Šç¾ä¸½çš„çƒŸç«ã€‹</p><p>é“¾æ¥ï¼š<a href="http://ctf.bugku.com/challenges/detail/id/350.html">http://ctf.bugku.com/challenges/detail/id/350.html</a></p><p>ç›´æ¥æ‰“å¼€å‹ç¼©åŒ…ï¼Œå¯ä»¥å¾—åˆ°è¢«åŠ å¯†çš„æ–‡ä»¶</p><p><img src="/2022/01/15/zip/1642245880907.png"></p><p>ç—›è‹¦ï¼Œä¸€èˆ¬è¿™ç§æ²¡æœ‰æç¤ºçš„(ä¸‹é¢ä¼šæœ‰ä»‹ç»)ï¼Œä¸€èˆ¬å°±æ˜¯ä¼ªåŠ å¯†äº†ã€‚</p><p>æ‹–è¿›winhexï¼Œæœç´¢504b0102ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆçš„é€Ÿé€Ÿå»çœ‹å‰é¢é‚£ç¯‡æ–‡ç« ï¼‰ï¼Œè¿™ä¸ªæŒ‰é’®</p><p><img src="/2022/01/15/zip/1642246321198.png"></p><p>æŠŠ09æ”¹æˆ00ï¼Œè¦ä»”ç»†ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªï¼Œæˆ‘å¼€å§‹åªçœ‹åˆ°ä¸€ä¸ª</p><p><img src="/2022/01/15/zip/1642246469204.png"></p><p><img src="/2022/01/15/zip/1642246506196.png"></p><p>é‡æ–°æ‰“å¼€å‹ç¼©åŒ…</p><p><img src="/2022/01/15/zip/1642246638206.png"></p><p>å¿ƒæƒ…æ„‰æ‚¦~</p><p>æ¥ä¸‹æ¥å°±æ˜¯è¿›è¡Œè§£å¯†äº†</p><p>è¿™é‡Œä¸ç»†è®²äº†ï¼Œä¸ç„¶å°±è·‘åäº†ï¼Œpngæ–‡ä»¶æ˜¯stegpyéšå†™ï¼Œå¯†ç æ˜¯shumuï¼Œstegpyå®‰è£…åº”è¯¥ä¼šæœ‰é—®é¢˜ï¼Œå…·ä½“å®‰è£…è¯·çœ‹å›¾ç‰‡éšå†™</p><p><img src="/2022/01/15/zip/1642246877362.png"></p><p>passwordè§£å¯†æ˜¯base64ï¼Œbase58ï¼Œæ …æ ï¼Œ</p><p>è¿™é‡Œæ¨èä¸€ç¯‡åšå®¢</p><p>å¾—åˆ°çš„å­—ç¬¦ä¸²æ˜¯aesçš„keyï¼Œç„¶åç›´æ¥aesåœ¨çº¿è§£å¯†</p><p><img src="/2022/01/15/zip/1642247152438.png"></p><p>flagï¼šflag{yX73nAutbBozYhge6d2flG}</p><p>ç½‘ç«™ä¹Ÿæ”¾è¿™äº†ï¼š<a href="https://the-x.cn/cryptography/Aes.aspx">https://the-x.cn/cryptography/Aes.aspx</a></p><h3 id="æ³¨"><a href="#æ³¨" class="headerlink" title="æ³¨"></a>æ³¨</h3><p>winrarå¯ä»¥ä¿®å¤ä¼ªåŠ å¯†ï¼Œä¸è¿‡æ˜¯éƒ¨åˆ†çš„</p><p><img src="/2022/01/15/zip/1642251859085.png"></p><p>ç‚¹å¼€ä¸Šé¢çš„å·¥å…·-&gt; ä¿®å¤å‹ç¼©æ–‡ä»¶</p><h1 id="å¥—å¨ƒå‹ç¼©åŒ…"><a href="#å¥—å¨ƒå‹ç¼©åŒ…" class="headerlink" title="å¥—å¨ƒå‹ç¼©åŒ…"></a>å¥—å¨ƒå‹ç¼©åŒ…</h1><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å‹ç¼©åŒ…å¥—å¨ƒ</p><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p><a href="https://buuoj.cn/challenges#[MRCTF2020]%E5%8D%83%E5%B1%82%E5%A5%97%E8%B7%AF">https://buuoj.cn/challenges#[MRCTF2020]%E5%8D%83%E5%B1%82%E5%A5%97%E8%B7%AF</a></p><h3 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h3><pre class="language-python" data-language="python"><code class="language-python">from PIL import Imagex = y = 200img = Image.new("RGB",(x,y))file = open('./qr.txt','r')for width in range(0,x):    for height in range(0,y):        line = file.readline()        rgb = line.replace('(','').replace(')','').split(',')        img.putpixel((width,height),(int(rgb[0]),int(rgb[1]),int(rgb[2])))img.save('flag.jpg')</code></pre><h1 id="CRC32çˆ†ç ´"><a href="#CRC32çˆ†ç ´" class="headerlink" title="CRC32çˆ†ç ´"></a>CRC32çˆ†ç ´</h1><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>CRCæ ¡éªŒå®ç”¨ç¨‹åºåº“ åœ¨æ•°æ®å­˜å‚¨å’Œæ•°æ®é€šè®¯é¢†åŸŸï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„æ­£ç¡®ï¼Œå°±ä¸å¾—ä¸é‡‡ç”¨æ£€é”™çš„æ‰‹æ®µã€‚åœ¨è¯¸å¤šæ£€é”™æ‰‹æ®µä¸­ï¼ŒCRCæ˜¯æœ€è‘—åçš„ä¸€ç§ã€‚CRCçš„å…¨ç§°æ˜¯å¾ªç¯å†—ä½™æ ¡éªŒã€‚(è¿™é‡Œè¿˜ä¸æ˜¯å¾ˆæ‡‚ï¼Œåç»­å†çœ‹)</p><p>æ€»ä¹‹æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰å”¯ä¸€çš„CRC32å€¼ï¼Œå³ä¾¿æ•°æ®ä¸­ä¸€ä¸ªbitå‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿä¼šå¯¼è‡´CRC32å€¼ä¸åŒã€‚è‹¥æ˜¯çŸ¥é“ä¸€æ®µæ•°æ®çš„é•¿åº¦å’ŒCRC32å€¼ï¼Œä¾¿å¯ç©·ä¸¾æ•°æ®ï¼Œä¸å…¶CRC32å¯¹ç…§ï¼Œä»¥æ­¤è¾¾åˆ°æš´åŠ›çŒœè§£çš„ç›®çš„ã€‚ä½†é€šå¸¸åªé€‚ç”¨äºè¾ƒå°æ–‡æœ¬æ–‡ä»¶ã€‚</p><h3 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h3><p>æ‰“å¼€é‡Œé¢æœ‰å¾ˆå¤šå‹ç¼©åŒ…ï¼Œé‡Œé¢å­˜å‚¨çš„éƒ½æ˜¯å°æ•°æ®æ–‡ä»¶</p><p><img src="/2022/01/15/zip/1642249237942.png"></p><p><img src="/2022/01/15/zip/1642249207274.png"></p><p>ç›´æ¥ä¸Šè„šæœ¬(ä¸æ˜¯å¾ˆä¼š)</p><pre class="language-python" data-language="python"><code class="language-python">#python3import zipfileimport stringimport binasciidef CrackCrc(crc):for i in dic:for j in dic:for k in dic:for h in dic:s = i + j + k + hif crc == (binascii.crc32(s.encode())):f.write(s)returndef CrackZip():for i in range(0,68):file = 'D:\\new\\æ–°å»ºæ–‡ä»¶å¤¹\\out'+str(i)+'.zip'crc = zipfile.ZipFile(file,'r').getinfo('data.txt').CRCCrackCrc(crc)print('\r'+"loadingï¼š{:%}".format(float((i+1)/68)),end='')dic = string.ascii_letters + string.digits + '+/='f = open('printaaa.txt','w')print("\nCRC32begin")CrackZip()print("CRC32finished")f.close()</code></pre><p>å¾—åˆ°base64ç¼–ç çš„ä¸œè¥¿</p><pre class="language-none"><code class="language-none">z5BzAAANAAAAAAAAAKo+egCAIwBJAAAAVAAAAAKGNKv+a2MdSR0zAwABAAAAQ01UCRUUy91BT5UkSNPoj5hFEVFBRvefHSBCfG0ruGnKnygsMyj8SBaZHxsYHY84LEZ24cXtZ01y3k1K1YJ0vpK9HwqUzb6u9z8igEr3dCCQLQAdAAAAHQAAAAJi0efVT2MdSR0wCAAgAAAAZmxhZy50eHQAsDRpZmZpeCB0aGUgZmlsZSBhbmQgZ2V0IHRoZSBmbGFnxD17AEAHAA==</code></pre><p>ç½‘ç«™åœ¨çº¿è§£ç ï¼Œè¿™ä¸ªç½‘ç«™æŒºå¥½çš„ï¼Œå¯ä»¥ç›´æ¥è½¬æ¢æ–‡ä»¶</p><p><a href="https://the-x.cn/base64/">https://the-x.cn/base64/</a></p><p>è§£ç ååœ¨å°¾éƒ¨çœ‹åˆ°è¿™å¥è¯</p><p><img src="/2022/01/15/zip/1642250774952.png"></p><p>ä»–è®©æˆ‘ä»¬ä¿®å¤æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆè¦å…ˆäº†è§£æ–‡ä»¶å¤´å’Œå°¾</p><p><a href="https://blog.csdn.net/Ahuuua/article/details/109165473?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-2.queryctrv2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-2.queryctrv2">https://blog.csdn.net/Ahuuua/article/details/109165473?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-2.queryctrv2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-2.queryctrv2</a></p><p>ä¿®è¡¥å¥½raræ–‡ä»¶å¤´åœ¨æ³¨é‡Šé‡Œå¾—åˆ°flag</p><p>flag{nev3r_enc0de_t00_sm4ll_fil3_w1th_zip}</p><h1 id="å‹ç¼©æ–‡ä»¶å¸¦æ³¨é‡Š"><a href="#å‹ç¼©æ–‡ä»¶å¸¦æ³¨é‡Š" class="headerlink" title="å‹ç¼©æ–‡ä»¶å¸¦æ³¨é‡Š"></a>å‹ç¼©æ–‡ä»¶å¸¦æ³¨é‡Š</h1><p>æœ‰ä¸€äº›é¢˜ç›®ä¼šåœ¨æ³¨é‡Šé‡Œé¢æ·»åŠ ä¿¡æ¯ï¼Œç›´è§‚çš„å°±ä¸è¯´äº†ï¼Œç°åœ¨è¯´ä¸¤ç§ç©ºç™½ç¬¦ï¼ŒWhitespace <a href="https://vii5ard.github.io/whitespace/">https://vii5ard.github.io/whitespace/</a> å’Œsnowéšå†™ï¼Œsnowéœ€è¦å¯†ç ï¼Œæœ‰å¯æ‰§è¡Œæ–‡ä»¶</p><h2 id="é¢˜ç›®-1"><a href="#é¢˜ç›®-1" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><a href="https://www.yunyansec.com/#/experiment/expdetail/3">https://www.yunyansec.com/#/experiment/expdetail/3</a></p><p>æ— å­—å¤©ä¹¦</p><h2 id="è§£é¢˜è¿‡ç¨‹-1"><a href="#è§£é¢˜è¿‡ç¨‹-1" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><p>å¾—åˆ°æµé‡åŒ…ï¼Œå¯¼å‡ºHTTPå¯¹è±¡</p><p>å¾—åˆ°å‡ ä¸ªæ–‡ä»¶ï¼Œä¾æ¬¡æŸ¥çœ‹ï¼Œæ³¨æ„è¦ä»”ç»†çœ‹ï¼Œæµé‡åŒ…æ–‡ä»¶æœ‰æ—¶å€™ä¼šå¾ˆå¤š</p><p><img src="/2022/01/15/zip/1642254197336.png"></p><p>å‘ç°äº†504b0304ï¼Œå¯ä»¥å†™è„šæœ¬ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç½‘ç«™è§£ç å¾—åˆ°å‹ç¼©åŒ…</p><p><a href="https://the-x.cn/zh-cn/encodings/Hex.aspx">https://the-x.cn/zh-cn/encodings/Hex.aspx</a></p><p><img src="/2022/01/15/zip/1642254255927.png"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">s='å¡«å†™16è¿›åˆ¶æ•°æ®'import binasciiout=open('2.jpg','wb')out.write(binascii.unhexlify(s))out.close()#Author: MoChu7import structa = open("str.txt","r")#åå…­è¿›åˆ¶æ•°æ®æ–‡ä»¶lines = a.read()res = [lines[i:i+2] for i in range(0,len(lines),2)]with open("res.jpg","wb") as f:for i in res:s = struct.pack('B',int(i,16))f.write(s)</code></pre><p>æ‰“å¼€ä¹‹åå¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€é‡Œé¢ä»€ä¹ˆéƒ½çœ‹ä¸åˆ°ï¼Œå…¨é€‰å°±ä¼šæœ‰æ˜¾ç¤ºï¼Œkey.wsåº”è¯¥æ˜¯snowçš„å¯†ç ï¼Œæ‹¿å»whitespaceè§£å¯†</p><p><img src="/2022/01/15/zip/1642254325041.png"></p><p>ç„¶åsnowè§£å¯† å‘½ä»¤ï¼šSNOW.EXE -p å¯†ç  -C æ–‡ä»¶</p><p><img src="/2022/01/15/zip/1642254470293.png"></p><p>cazy{C4n_y0u_underSt4nd_th3_b0oK_With0ut_Str1ng}</p><h1 id="çˆ†ç ´å‹ç¼©åŒ…"><a href="#çˆ†ç ´å‹ç¼©åŒ…" class="headerlink" title="çˆ†ç ´å‹ç¼©åŒ…"></a>çˆ†ç ´å‹ç¼©åŒ…</h1><p>ä½¿ç”¨å·¥å…·çˆ†ç ´ï¼Œå¦‚Advanced Archive Password Recovery</p><h2 id="å·²çŸ¥æ˜æ–‡æ”»å‡»"><a href="#å·²çŸ¥æ˜æ–‡æ”»å‡»" class="headerlink" title="å·²çŸ¥æ˜æ–‡æ”»å‡»"></a>å·²çŸ¥æ˜æ–‡æ”»å‡»</h2><h2 id="æ©ç æ”»å‡»"><a href="#æ©ç æ”»å‡»" class="headerlink" title="æ©ç æ”»å‡»"></a>æ©ç æ”»å‡»</h2>]]></content>
      
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡æ¡£éšå†™</title>
      <link href="/2022/01/15/%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99/"/>
      <url>/2022/01/15/%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99/</url>
      
        <content type="html"><![CDATA[<p>å¯ä»¥çœ‹çœ‹è¿™ç¯‡<a href="https://xz.aliyun.com/t/1883/">https://xz.aliyun.com/t/1883/</a></p><h1 id="WORD"><a href="#WORD" class="headerlink" title="WORD"></a>WORD</h1><h2 id="xmléšè—ä¿¡æ¯"><a href="#xmléšè—ä¿¡æ¯" class="headerlink" title="xmléšè—ä¿¡æ¯"></a>xmléšè—ä¿¡æ¯</h2><h2 id="éšè—æ–‡å­—"><a href="#éšè—æ–‡å­—" class="headerlink" title="éšè—æ–‡å­—"></a>éšè—æ–‡å­—</h2><h2 id="éšè—æ–‡ä»¶"><a href="#éšè—æ–‡ä»¶" class="headerlink" title="éšè—æ–‡ä»¶"></a>éšè—æ–‡ä»¶</h2><h1 id="PDF"><a href="#PDF" class="headerlink" title="PDF"></a>PDF</h1><h2 id="å›¾ç‰‡é®æŒ¡"><a href="#å›¾ç‰‡é®æŒ¡" class="headerlink" title="å›¾ç‰‡é®æŒ¡"></a>å›¾ç‰‡é®æŒ¡</h2>]]></content>
      
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§†é¢‘éšå†™</title>
      <link href="/2022/01/15/%E8%A7%86%E9%A2%91%E9%9A%90%E5%86%99/"/>
      <url>/2022/01/15/%E8%A7%86%E9%A2%91%E9%9A%90%E5%86%99/</url>
      
        <content type="html"><![CDATA[<h1 id="Kinovea"><a href="#Kinovea" class="headerlink" title="Kinovea"></a>Kinovea</h1><p>å¯ä»¥ä¸€å¸§ä¸€å¸§åœ°çœ‹è§†é¢‘ï¼Œè§†é¢‘éšå†™ç›®å‰åªæ¥è§¦åˆ°åœ¨è§†é¢‘ä¸€äº› å¸§é‡Œé¢è—ä¿¡æ¯</p><p><a href="https://mochu.blog.csdn.net/article/details/109461931">https://mochu.blog.csdn.net/article/details/109461931</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµé‡åˆ†æ</title>
      <link href="/2022/01/15/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
      <url>/2022/01/15/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1><p>åªè¯•è¿‡ç›´æ¥å¯¼å‡ºHTTPæµå¯¹è±¡</p><p><img src="/2022/01/15/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/1642297780618.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…å­˜å–è¯</title>
      <link href="/2022/01/15/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/"/>
      <url>/2022/01/15/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/</url>
      
        <content type="html"><![CDATA[<h1 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h1><p>volatilityæ˜¯å†…å­˜å–è¯çš„å·¥å…·ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯æ‰“åŒ…å¥½äº†çš„å¯æ‰§è¡Œæ–‡ä»¶</p><p>volatilityä¸‹è½½åœ°å€ï¼š<a href="https://www.volatilityfoundation.org/releases">https://www.volatilityfoundation.org/releases</a></p><p><img src="/2022/01/15/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/1642229196730.png"></p><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><p>é¢˜ç›®é“¾æ¥ï¼š</p><p><a href="https://www.yunyansec.com/#/experiment/expdetail/3">https://www.yunyansec.com/#/experiment/expdetail/3</a></p><p>æœ´å®æ— åçš„å–è¯</p><h1 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h1><h2 id="æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯"><a href="#æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯"></a>æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</h2><p>å…ˆä½¿ç”¨å‘½ä»¤volatility -f æœ´å®æ— åçš„å–è¯.raw iamgeinfoæŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</p><p><img src="/2022/01/15/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/1642230119786.png"></p><p>ä¸Šé¢çš„ç³»ç»Ÿéƒ½æœ‰å¯èƒ½ï¼Œä¸»è¦æ˜¯ç¬¬ä¸€ä¸ª</p><h2 id="æŸ¥çœ‹è¿è¡Œç¨‹åºåˆ—è¡¨"><a href="#æŸ¥çœ‹è¿è¡Œç¨‹åºåˆ—è¡¨" class="headerlink" title="æŸ¥çœ‹è¿è¡Œç¨‹åºåˆ—è¡¨"></a>æŸ¥çœ‹è¿è¡Œç¨‹åºåˆ—è¡¨</h2><p>å‘½ä»¤ï¼švolatility -f æœ´å®æ— åçš„å–è¯.raw â€“profile=WinXPSP2x86 pslist</p><p><img src="/2022/01/15/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/1642230482092.png"></p><p>è¿™é‡Œæœ‰ä¸‰å¤„éœ€è¦æ³¨æ„ï¼Œmspaintæ˜¯ç”»å›¾å·¥å…·ï¼Œ360zipæ˜¯è§£å‹å·¥å…·ï¼Œnotepadæ˜¯ç¬”è®°æœ¬ï¼Œæ¥ä¸‹æ¥é‡ç‚¹æ”¾åœ¨è¿™å‡ å¤„</p><h2 id="æŸ¥çœ‹æ–‡ä»¶"><a href="#æŸ¥çœ‹æ–‡ä»¶" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶"></a>æŸ¥çœ‹æ–‡ä»¶</h2><p>å‘½ä»¤ï¼švolatility -f æœ´å®æ— åçš„å–è¯.raw â€“profile=WinXPSP2x86  filescanï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨grepæ¥æŒ‡å®šæœç´¢çš„å­—ç¬¦ä¸² æ ¼å¼å¦‚ä¸‹ï¼švolatility -f æœ´å®æ— åçš„å–è¯.raw â€“profile=WinXPSP2x86  filescan | grep flag</p><p><img src="/2022/01/15/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/1642230787104.png"></p><p>å¯ä»¥çœ‹åˆ°è¿‡æ»¤å‡ºäº†flagçš„ç›¸å…³æ•°æ®</p><h2 id="æå–æ–‡ä»¶"><a href="#æå–æ–‡ä»¶" class="headerlink" title="æå–æ–‡ä»¶"></a>æå–æ–‡ä»¶</h2><p>æ¥ä¸‹æ¥éœ€è¦æŠŠæ–‡ä»¶dumpä¸‹æ¥ï¼Œå‘½ä»¤ï¼švolatility -f æœ´å®æ— åçš„å–è¯.raw â€“profile=WinXPSP2x86 dumpfiles -Q åç§»é‡ -D ./(-DæŒ‡å®šæ–‡ä»¶å¤¹ï¼Œè¿™é‡Œaaaè¡¨ç¤ºå­˜å‚¨åˆ°aaaæ–‡ä»¶å¤¹ä¸­)</p><p><img src="/2022/01/15/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/1642231017652.png"></p><p>å¯ä»¥åœ¨aaaæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°dumpä¸‹æ¥çš„æ–‡ä»¶</p><p>å¾—åˆ°<img src="/2022/01/15/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/1642231186454.png"></p><p>è¿˜æœ‰ä¸€ä¸ªåŠ äº†å¯†çš„zipæ–‡ä»¶ï¼Œè¿™æ—¶å€™æ³¨æ„æˆ‘ä»¬çš„notepadè¿˜æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œå¯ä»¥å»çœ‹çœ‹ä¿¡æ¯</p><h2 id="æ‰“å¼€è¿›ç¨‹"><a href="#æ‰“å¼€è¿›ç¨‹" class="headerlink" title="æ‰“å¼€è¿›ç¨‹"></a>æ‰“å¼€è¿›ç¨‹</h2><p>å‘½ä»¤ï¼švolatility -f æœ´å®æ— åçš„å–è¯.raw â€“profile=WinXPSP2x86 notepad</p><p><img src="/2022/01/15/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/1642231403984.png"></p><p>è¿™æ ·å°±å¾—åˆ°äº†encryptçš„å¯†ç </p><h2 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h2><pre class="language-c" data-language="c"><code class="language-c">#include &lt;stdio.h&gt;#include &lt;string.h&gt; int main(){char str[]="FDCB[8LDQ?ZLOO?FHUWDLQ)B?VXFFHHG?LQ?ILJKWLQJ?WKH?HSLGHPLF]";for(int i = 0; i &lt; strlen(str); i++){str[i] += 32;if(str[i] &gt;='a'+3 &amp;&amp; str[i]&lt;='w'+3)str[i]-=3;else if(str[i]=='a')str[i]='x';else if(str[i]=='b')str[i]='y';else if(str[i]=='c')str[i]='z';else if(str[i]=='|')str[i]='_';}printf("%s",str);return 0;}</code></pre><p>å¾—åˆ°flagï¼šcazy{Xian_will_certainIy_succeed_in_fighting_the_epidemic}</p>]]></content>
      
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éŸ³é¢‘éšå†™</title>
      <link href="/2022/01/15/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/"/>
      <url>/2022/01/15/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/</url>
      
        <content type="html"><![CDATA[<p>åœ¨è¿™ç¯‡æ–‡ç« ï¼š<a href="https://blog.csdn.net/vanarrow/article/details/105667244">https://blog.csdn.net/vanarrow/article/details/105667244</a></p><h1 id="æ‘©æ–¯ç”µç "><a href="#æ‘©æ–¯ç”µç " class="headerlink" title="æ‘©æ–¯ç”µç "></a>æ‘©æ–¯ç”µç </h1><h1 id="MP3steg"><a href="#MP3steg" class="headerlink" title="MP3steg"></a>MP3steg</h1>]]></content>
      
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç‰‡éšå†™</title>
      <link href="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/"/>
      <url>/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/</url>
      
        <content type="html"><![CDATA[<h1 id="PNGå’ŒJPGæ–‡ä»¶ç»“æ„"><a href="#PNGå’ŒJPGæ–‡ä»¶ç»“æ„" class="headerlink" title="PNGå’ŒJPGæ–‡ä»¶ç»“æ„"></a>PNGå’ŒJPGæ–‡ä»¶ç»“æ„</h1><p>PNGï¼š<a href="https://www.cnblogs.com/ECJTUACM-873284962/p/8986391.html">https://www.cnblogs.com/ECJTUACM-873284962/p/8986391.html</a>   ï¼ˆæœ‰é¢˜ç›®éœ€è¦ä¿®æ”¹PNGå®½é«˜ï¼‰ï¼Œç»“å°¾æ˜¯IEND</p><p><a href="https://en.wikipedia.org/wiki/Portable_Network_Graphics#File_format">https://en.wikipedia.org/wiki/Portable_Network_Graphics#File_format</a></p><p>JPGï¼š<a href="https://www.cnblogs.com/bandy/p/4956086.html">https://www.cnblogs.com/bandy/p/4956086.html</a></p><p>jpgçš„ä¸€äº›éšå†™ï¼š<a href="https://zhuanlan.zhihu.com/p/24054040">https://zhuanlan.zhihu.com/p/24054040</a></p><p>æ— è®ºæ˜¯pngè¿˜æ˜¯jpgï¼Œåªä¼šè¯†åˆ«åˆ°æ–‡ä»¶å°¾ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æ–‡ä»¶å°¾åŠ å…¥ä¿¡æ¯</p><h1 id="F5éšå†™"><a href="#F5éšå†™" class="headerlink" title="F5éšå†™"></a>F5éšå†™</h1><h1 id="Stegpyéšå†™"><a href="#Stegpyéšå†™" class="headerlink" title="Stegpyéšå†™"></a>Stegpyéšå†™</h1><p>ä¹‹å‰æœ‰è¿‡é¢˜äº†ï¼Œå°±ä¸è¯´äº†ï¼Œè®²è®²ä¸‹è½½</p><p>çœ‹è¿™ç¯‡å°±å¤Ÿäº†</p><p><a href="https://blog.csdn.net/Amherstieae/article/details/109010064">https://blog.csdn.net/Amherstieae/article/details/109010064</a></p><h1 id="Steghide"><a href="#Steghide" class="headerlink" title="Steghide"></a>Steghide</h1><p><a href="https://www.jianshu.com/p/c3679f805a0c">https://www.jianshu.com/p/c3679f805a0c</a></p><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><a href="https://buuoj.cn/challenges#%E4%B9%9D%E8%BF%9E%E7%8E%AF">https://buuoj.cn/challenges#%E4%B9%9D%E8%BF%9E%E7%8E%AF</a></p><h2 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><p>binwalkåˆ†è§£æ–‡ä»¶</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642302431480.png"></p><p>ä¼ªåŠ å¯†</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642302894034.png"></p><p>å¾—åˆ°å›¾ç‰‡å’ŒåŠ å¯†å‹ç¼©åŒ…</p><p>å¯¹å›¾ç‰‡ä½¿ç”¨steghide</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642302996915.png"></p><p>steghide info æ–‡ä»¶æŸ¥çœ‹éšè—ä¿¡æ¯ï¼Œè¾“å…¥yåæå–ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ï¼šsteghide extract æ–‡ä»¶ </p><p>æ‰¾åˆ°ko.txt,å¾—åˆ°å‹ç¼©åŒ…å¯†ç </p><p>flag{1RTo8w@&amp;4nK@z*XL}</p><h1 id="Binwalkã€Winrarâ€”â€”å›¾ç‰‡éšè—æ–‡ä»¶"><a href="#Binwalkã€Winrarâ€”â€”å›¾ç‰‡éšè—æ–‡ä»¶" class="headerlink" title="Binwalkã€Winrarâ€”â€”å›¾ç‰‡éšè—æ–‡ä»¶"></a>Binwalkã€Winrarâ€”â€”å›¾ç‰‡éšè—æ–‡ä»¶</h1><p>binwalkä½¿ç”¨ï¼š<a href="https://blog.csdn.net/wxh0000mm/article/details/85683661">https://blog.csdn.net/wxh0000mm/article/details/85683661</a></p><p>å¯ä»¥ç›´æ¥binwalkæå–æ–‡ä»¶ï¼Œå‘½ä»¤ï¼šbinwalk -e æ–‡ä»¶ï¼Œè¿™ä¸ªæ¯”è¾ƒå¸¸è§ï¼Œå°±ä¸è¯´äº†</p><p>winrarä¹Ÿå¯ä»¥ç›´æ¥æ‰“å¼€è¢«éšè—çš„æ–‡ä»¶</p><h1 id="ä¿®æ”¹å›¾ç‰‡å®½é«˜"><a href="#ä¿®æ”¹å›¾ç‰‡å®½é«˜" class="headerlink" title="ä¿®æ”¹å›¾ç‰‡å®½é«˜"></a>ä¿®æ”¹å›¾ç‰‡å®½é«˜</h1><pre class="language-python" data-language="python"><code class="language-python">import binasciiimport structimport sysfile = input("å›¾ç‰‡åœ°å€ï¼š")fr = open(file,'rb').read()data = bytearray(fr[0x0c:0x1d])crc32key = eval('0x'+str(binascii.b2a_hex(fr[0x1d:0x21]))[2:-1])#åŸæ¥çš„ä»£ç : crc32key = eval(str(fr[29:33]).replace('\\x','').replace("b'",'0x').replace("'",''))n = 4095for w in range(n):    width = bytearray(struct.pack('&gt;i', w))    for h in range(n):        height = bytearray(struct.pack('&gt;i', h))        for x in range(4):            data[x+4] = width[x]            data[x+8] = height[x]        crc32result = binascii.crc32(data) &amp; 0xffffffff        if crc32result == crc32key:            print(width,height)            newpic = bytearray(fr)            for x in range(4):                newpic[x+16] = width[x]                newpic[x+20] = height[x]            fw = open(file+'.png','wb')            fw.write(newpic)            fw.close            sys.exit()</code></pre><h1 id="äºŒè¿›åˆ¶è½¬äºŒç»´ç "><a href="#äºŒè¿›åˆ¶è½¬äºŒç»´ç " class="headerlink" title="äºŒè¿›åˆ¶è½¬äºŒç»´ç "></a>äºŒè¿›åˆ¶è½¬äºŒç»´ç </h1><pre class="language-python" data-language="python"><code class="language-python">from PIL import Imagefrom zlib import *MAX = 25pic = Image.new("RGB",(MAX,MAX))str ='''0000000001110010000000000000000000001111010000000000000000011100010000000000000000010111100000000000000000001010101000000000000000000011000101000000000000000010101010100000000000000000100000110000000011000111011101101000110000001000010110010010010100010011110100001110111001100111101001010110010010011000001001100001001101000111100011111101110010100010110111110011011111101111000110110010010101101100100011110011111111111011100000000101100011000101000000000010010100101010001000000001010101010001100100000000001001111111100100000000000011001011110111000000000100110010010000100000000110000110110110010000000011010000101110101'''i=0for y in range(0,MAX):    for x in range(0,MAX):        if(str[i] == '1'):            pic.putpixel([x,y],(0,0,0))        else:pic.putpixel([x,y],(255,255,255))        i = i+1pic.show()pic.save("flag.png")</code></pre><h1 id="åæ ‡ç”»å›¾"><a href="#åæ ‡ç”»å›¾" class="headerlink" title="åæ ‡ç”»å›¾"></a>åæ ‡ç”»å›¾</h1><h2 id="gnuplot"><a href="#gnuplot" class="headerlink" title="gnuplot"></a>gnuplot</h2><p>linuxï¼Œç›´æ¥sudo apt install gnuplotï¼Œä½¿ç”¨ ç›´æ¥gnuplotè¿›å…¥åï¼Œplot æ–‡ä»¶åï¼Œå°±å¯ä»¥äº†</p><h2 id="é¢˜ç›®-1"><a href="#é¢˜ç›®-1" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><a href="https://buuoj.cn/challenges#%E6%A2%85%E8%8A%B1%E9%A6%99%E4%B9%8B%E8%8B%A6%E5%AF%92%E6%9D%A5">https://buuoj.cn/challenges#%E6%A2%85%E8%8A%B1%E9%A6%99%E4%B9%8B%E8%8B%A6%E5%AF%92%E6%9D%A5</a></p><h2 id="è§£é¢˜è¿‡ç¨‹-1"><a href="#è§£é¢˜è¿‡ç¨‹-1" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642300357300.png"></p><p>åœ¨æ–‡ä»¶å°¾ä¹‹åå‘ç°å¤§é‡åå…­è¿›åˆ¶æ•°æ®ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨010editorå¤åˆ¶ï¼Œè¿™æ ·æ¯”è¾ƒå¿«ï¼Œå¤åˆ¶åè½¬ä¸ºå­—ç¬¦</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642300558126.png"></p><p>è¿™æ ·çš„æ ¼å¼ä¸èƒ½è¢«è¯†åˆ«ï¼Œæ‰€ä»¥éœ€è¦æ›¿æ¢ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯VS</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642301030524.png"></p><p>æ›¿æ¢è¿™é‡Œä¸ç”¨å¡«å†™ï¼Œç›´æ¥æ›¿æ¢å…¨éƒ¨ï¼Œç„¶åä¿å­˜åˆ°txtä¸­ï¼Œå†ä½¿ç”¨å·¥å…·</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642301392143.png"></p><h1 id="GIF"><a href="#GIF" class="headerlink" title="GIF"></a>GIF</h1><p>åœ¨stegsolveå¯ä»¥å®ç°ï¼Œé€å¸§æŸ¥çœ‹ï¼Œæ³¨æ„ä¸è¦æ¼äº†</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642304858835.png"></p><h1 id="LSBéšå†™"><a href="#LSBéšå†™" class="headerlink" title="LSBéšå†™"></a>LSBéšå†™</h1><h1 id="æ–‡ä»¶å¤´å°¾å€’ç½®"><a href="#æ–‡ä»¶å¤´å°¾å€’ç½®" class="headerlink" title="æ–‡ä»¶å¤´å°¾å€’ç½®"></a>æ–‡ä»¶å¤´å°¾å€’ç½®</h1><h2 id="é¢˜ç›®-2"><a href="#é¢˜ç›®-2" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><a href="https://www.yunyansec.com/#/experiment/expdetail/3">https://www.yunyansec.com/#/experiment/expdetail/3</a></p><p>pipicc</p><h2 id="è§£é¢˜è¿‡ç¨‹-2"><a href="#è§£é¢˜è¿‡ç¨‹-2" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><p>å¾—åˆ°ä¸€å¼ å›¾ç‰‡</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642303873774.png"></p><p>æœ‰å™ªç‚¹ï¼Œåº”è¯¥æ˜¯ä¿®æ”¹äº†åƒç´ ç‚¹ï¼Œæ˜¯éœ€è¦ä¿®å¤çš„</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642306122403.png"></p><p>ç¼ºå°‘pngæ–‡ä»¶å¤´ï¼Œä¿®è¡¥æ–‡ä»¶å¤´</p><p>æ¥ä¸‹æ¥æ‰¾åˆ°IENDå—,å°†å¤šä½™éƒ¨åˆ†åˆ å»ï¼Œæ”¹ä¸ºpng</p><p>å¾—åˆ°</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642306518311.png"></p><p>æ‹–è¿›stegsolve</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642306719043.png"></p><p>åœ¨è“è‰²ä½ä½å‘ç°äº†d9ffï¼Œè¿™æ­£å¥½æ˜¯jpgçš„æ–‡ä»¶å°¾åè¿‡æ¥ï¼Œsave bin ä¸‹æ¥ï¼Œæœç´¢d8ffï¼Œå¯¹åº”å€’ç½®çš„æ–‡ä»¶å¤´</p><p>010editoræœ‰å·¥å…·</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642306907507.png"></p><p>éœ€è¦å®‰è£…</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642306934016.png"></p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642306975753.png"></p><p>é€†åºåä¿å­˜æ”¹ä¸ºjpgåç¼€ï¼Œå¾—åˆ°å›¾ç‰‡</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642307072291.png"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">input = open('D:\\new\\5', 'rb')input_all = input.read()ss = input_all[::-1]output = open('m0re.jpg', 'wb')output.write(ss)input.close()output.close()</code></pre><h1 id="Base64éšå†™"><a href="#Base64éšå†™" class="headerlink" title="Base64éšå†™"></a>Base64éšå†™</h1><pre class="language-python" data-language="python"><code class="language-python">import base64path = input("è¯·è¾“å…¥åŠ å¯†æ–‡ä»¶è·¯å¾„\n")file = open(path)a = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"aaa = ''while True:    text = file.readline()  # åªè¯»å–ä¸€è¡Œå†…å®¹    # åˆ¤æ–­æ˜¯å¦è¯»å–åˆ°å†…å®¹    text = text.replace("\n", "")    if not text:        break    if text.count('=') == 1:        aaa = aaa + \            str('{:02b}'.format((a.find(text[len(text)-2])) % 4))    if text.count('=') == 2:        aaa = aaa + \            str('{:04b}'.format((a.find(text[len(text)-3])) % 16))file.close()t = ""ttt = len(aaa)ttt = ttt//8*8for i in range(0,ttt,8):    t = t + chr(int( aaa[i:i+8],2))print(t)</code></pre><h1 id="StegSolve"><a href="#StegSolve" class="headerlink" title="StegSolve"></a>StegSolve</h1><h2 id="ä¸¤å¼ å›¾ç‰‡æ‹¼æ¥"><a href="#ä¸¤å¼ å›¾ç‰‡æ‹¼æ¥" class="headerlink" title="ä¸¤å¼ å›¾ç‰‡æ‹¼æ¥"></a>ä¸¤å¼ å›¾ç‰‡æ‹¼æ¥</h2><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642312404099.png"></p><p>æå–httpå¯¹è±¡</p><p>æŠŠscanlinesæ‹–è¿›stegsolveï¼Œåœ¨å¤šä¸ªé€šé“å‘ç°äº†ä¸€æ¡æ¨ªçº¿</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642312485498.png"></p><p>è€Œlogoæ­£å¥½ç¼ºäº†ä¸€æ®µ</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642312592372.png"></p><p>ä½¿ç”¨stegsolveçš„å›¾åƒç»“åˆ</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642312633974.png"></p><p>å¾—åˆ°flag</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642312671617.png"></p><h1 id="æ·»åŠ æ–‡ä»¶å¤´"><a href="#æ·»åŠ æ–‡ä»¶å¤´" class="headerlink" title="æ·»åŠ æ–‡ä»¶å¤´"></a>æ·»åŠ æ–‡ä»¶å¤´</h1><h1 id="æ–‡ä»¶å±æ€§è—ä¿¡æ¯"><a href="#æ–‡ä»¶å±æ€§è—ä¿¡æ¯" class="headerlink" title="æ–‡ä»¶å±æ€§è—ä¿¡æ¯"></a>æ–‡ä»¶å±æ€§è—ä¿¡æ¯</h1><p>å›¾ç‰‡å±æ€§å¯ä»¥éšè—ä¿¡æ¯</p><h1 id="outguesséšå†™"><a href="#outguesséšå†™" class="headerlink" title="outguesséšå†™"></a>outguesséšå†™</h1><h2 id="é¢˜ç›®-3"><a href="#é¢˜ç›®-3" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><a href="https://buuoj.cn/challenges#[WUSTCTF2020]alison_likes_jojo">https://buuoj.cn/challenges#[WUSTCTF2020]alison_likes_jojo</a></p><h2 id="è§£é¢˜è¿‡ç¨‹-3"><a href="#è§£é¢˜è¿‡ç¨‹-3" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><p>binwalkåˆ†è§£boki.pngå¾—åˆ°å‹ç¼©åŒ…ï¼Œæ˜¯çœŸåŠ å¯†</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642311449760.png"></p><p>å°è¯•çˆ†ç ´</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642311499706.png"></p><p>å¾—åˆ°ä¸€æ®µå­—ç¬¦ä¸²</p><p>base64ä¸‰æ¬¡å¾—åˆ°killerqueen</p><p>å¦ä¸€å¼ å›¾ç‰‡æ˜¯outguesséšå†™</p><p><img src="/2022/01/15/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/1642311787198.png"></p><p>æ‰“å¼€flag1.txtæ–‡ä»¶</p><p>wctf2020{pretty_girl_alison_likes_jojo}</p><h1 id="ç›²æ°´å°"><a href="#ç›²æ°´å°" class="headerlink" title="ç›²æ°´å°"></a>ç›²æ°´å°</h1><h2 id="BlindWaterMark"><a href="#BlindWaterMark" class="headerlink" title="BlindWaterMark"></a>BlindWaterMark</h2><h1 id="ç‚¹é˜µæå–"><a href="#ç‚¹é˜µæå–" class="headerlink" title="ç‚¹é˜µæå–"></a>ç‚¹é˜µæå–</h1><pre class="language-python" data-language="python"><code class="language-python"># from PIL import Image## img = Image.open('D:\\new\\cat.png')# width, height = img.size# pixs_list = []# for w in range(5, width, 11):# for h in range(5, height, 11):# pix = img.getpixel((w, h))# pixs_list.append(pix)# #åˆ†è§£ä¸‹pixs_listçš„é•¿åº¦ï¼Œå°±å¯ä»¥å¾—åˆ°ç”Ÿæˆå›¾ç‰‡çš„å®½é«˜# new_width, new_height = 215, 215# new_img = Image.new('RGB', (new_width, new_height))# idx = 0# for n_w in range(new_width):# for n_h in range(new_height):# new_img.putpixel((n_w, n_h), pixs_list[idx])# idx += 1# new_img.save('ok.png')# new_img.show()# from PIL import Image## img = Image.open('ok.png')# width, height = img.size# pixs_list = []# for w in range(2, width, 5):# for h in range(2, height, 5):# pix = img.getpixel((w, h))# pixs_list.append(pix)# #åˆ†è§£pixs_listçš„é•¿åº¦ï¼Œ# new_width, new_height = 43, 43# new_img = Image.new('RGB', (new_width, new_height))# idx = 0# for n_w in range(new_width):# for n_h in range(new_height):# new_img.putpixel((n_w, n_h), pixs_list[idx])# idx += 1# new_img.save('ok1.png')# new_img.show()from PIL import Imageimg = Image.open('ok1.png')if img.mode == "P":    img = img.convert("RGB")assert img.size[0] == img.size[1]dim = width, height = img.sizest = 1a = 9b = 39for _ in range(st):    with Image.new(img.mode, dim) as canvas:        for nx in range(img.size[0]):            for ny in range(img.size[0]):                y = (ny - nx * a) % width                x = (nx - y * b) % height                canvas.putpixel((y, x), img.getpixel((ny, nx)))canvas.show()canvas.save('ok2.png')</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>A&amp;D1</title>
      <link href="/2021/12/27/A-D1/"/>
      <url>/2021/12/27/A-D1/</url>
      
        <content type="html"><![CDATA[<h1 id="IsDebugger-Present"><a href="#IsDebugger-Present" class="headerlink" title="IsDebugger Present"></a>IsDebugger Present</h1><p><strong>åŸç†</strong></p><hr><p>â€‹          åè°ƒè¯•ï¼Œè¯¥APIæŸ¥è¯¢PEBç»“æ„ä¸­çš„IsDebuggeræ ‡å¿—ä½ï¼Œ æœªè°ƒè¯•è¿”å›0ï¼Œè°ƒè¯•çŠ¶æ€è¿”å›1ã€‚</p><p><strong>ç»•è¿‡</strong></p><hr><ol><li><p>nopæŒ‡ä»¤</p> <pre class="language-none"><code class="language-none">mov rax ; IsDebuggerPresentcall rax ; IsDebuggerPresent</code></pre></li><li><p>jnzå’Œjz</p><hr><p> jnzåœ¨ç»“æœä¸ä¸º0æ—¶è·³è½¬ï¼Œjzåœ¨ç»“æœä¸º0æ—¶è·³è½¬</p> <pre class="language-none"><code class="language-none">sub_4019F4(){    return ISDebuggerPresent;}if(!sub_4019F4){     puts();}</code></pre><p> è¿™ä¸ªæ—¶å€™å¦‚æœå¤„äºè°ƒè¯•çŠ¶æ€ï¼Œè¿”å›1ï¼Œä¸ä¼šæ‰§è¡Œputï¼Œè¿™æ—¶å€™åªéœ€è¦å»æ±‡ç¼–æŒ‡ä»¤å¤„æŠŠjnzæ”¹ä¸ºjzï¼Œé‡æ–°æ±‡ç¼–åä¼šå˜æˆ</p> <pre class="language-none"><code class="language-none">sub_4019F4(){    return ISDebuggerPresent;}if(sub_4019F4){     puts();}</code></pre><p> 3.Attach to process</p> <pre class="language-none"><code class="language-none">sub_4019F4();printf("%d",n);scanf("%d",&amp;m);</code></pre><p> å¯ä»¥å…ˆè®©ç¨‹åºè¿è¡Œï¼Œè¿™æ—¶å€™å·²ç»æ­¥è¿‡äº†åè°ƒè¯•å‡½æ•°ï¼Œç„¶åAttach to processå°±å¯ä»¥è°ƒè¯•äº†</p><p> 4.ä¿®æ”¹EIPï¼šjumpã€callã€retæŒ‡ä»¤</p></li></ol><h1 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h1><ol><li><p>å‡½æ•°ä»‹ç»</p> <pre class="language-none"><code class="language-none">1 CreateThread åˆ›å»ºçº¿ç¨‹2 CloseHandle å…³é—­çº¿ç¨‹3 WaitForSingleObject() å®ç°çº¿ç¨‹è½¬æ¢</code></pre></li></ol><p>â€‹      2.é¢˜ç›®â€”â€”Youngter drive</p><pre class="language-none"><code class="language-none">int __cdecl main_0(int argc, const char **argv, const char **envp){  HANDLE v4; // [esp+D0h] [ebp-14h]  HANDLE hObject; // [esp+DCh] [ebp-8h]  ((void (*)(void))sub_4110FF)();  ::hObject = CreateMutexW(0, 0, 0);  j_strcpy(Destination, &amp;Source);  hObject = CreateThread(0, 0, StartAddress, 0, 0, 0);  v4 = CreateThread(0, 0, sub_41119F, 0, 0, 0);  CloseHandle(hObject);  CloseHandle(v4);  while ( dword_418008 != -1 )    ;  sub_411190();  CloseHandle(::hObject);  return 0;}</code></pre><pre class="language-none"><code class="language-none">void __stdcall StartAddress_0(int a1){  while ( 1 )  {    WaitForSingleObject(hObject, 0xFFFFFFFF);    if ( dword_418008 &gt; -1 )    {      sub_41112C(&amp;Source, dword_418008);      --dword_418008;      Sleep(0x64u);    }    ReleaseMutex(hObject);  }}</code></pre><pre class="language-none"><code class="language-none">void __stdcall sub_411B10(int a1){  while ( 1 )  {    WaitForSingleObject(hObject, 0xFFFFFFFF);    if ( dword_418008 &gt; -1 )    {      Sleep(0x64u);      --dword_418008;    }    ReleaseMutex(hObject);  }}</code></pre><p>å®é™…ä¸Šå°±æ˜¯æ¯éš”ä¸¤ä½å¯¹æ•°ç»„å…ƒç´ åšä¸€æ¬¡å¤„ç†</p><h1 id="Z3"><a href="#Z3" class="headerlink" title="Z3"></a>Z3</h1><ol><li><p>åŸºç¡€</p> <pre class="language-none"><code class="language-none">1 å£°æ˜æ•´æ•°x = Int('x')2 å£°æ˜å®æ•°x = Real('x')3 å£°æ˜å¸ƒå°”ç±»å‹x = Bool('x')1 åˆ›å»ºsolveræ±‚è§£å™¨   ä¾‹ï¼šs = Solver()2 æ·»åŠ çº¦æŸæ¡ä»¶   ä¾‹ï¼šs.add(x+y==10)3 æ£€æŸ¥solverä¸­çš„çº¦æŸæ˜¯å¦æ»¡è¶³   ä¾‹ï¼šs.check()4 åˆ©ç”¨model()è¾“å‡ºè¿ç®—ç»“æœ   ä¾‹ï¼šs.model()</code></pre><p> 2.é¢˜ç›®â€”â€”Universe_final_answer</p> <pre class="language-none"><code class="language-none">__int64 __fastcall main(int a1, char **a2, char **a3){  char v4[32]; // [rsp+0h] [rbp-A8h] BYREF  char input[104]; // [rsp+20h] [rbp-88h] BYREF  unsigned __int64 v6; // [rsp+88h] [rbp-20h]  v6 = __readfsqword(0x28u);  __printf_chk(1LL, "Please give me the key string:", a3);  scanf("%s", input);  if ( sub_860(input) )  {    sub_C50(input, v4);    __printf_chk(1LL, "Judgement pass! flag is actf{%s_%s}\n", input);  }  else  {    puts("False key!");  }  return 0LL;}</code></pre> <pre class="language-none"><code class="language-none">bool __fastcall sub_860(char *input){  int v1; // ecx  int v2; // esi  int v3; // edx  int v4; // er9  int v5; // er11  int v6; // ebp  int v7; // ebx  int v8; // er8  int v9; // er10  bool result; // al  int v11; // [rsp+0h] [rbp-38h]  v1 = input[1];  v2 = *input;  v3 = input[2];  v4 = input[3];  v5 = input[4];  v6 = input[6];  v7 = input[5];  v8 = input[7];  v9 = input[8];  result = 0;  if ( -85 * v9 + 58 * v8 + 97 * v6 + v7 + -45 * v5 + 84 * v4 + 95 * v2 - 20 * v1 + 12 * v3 == 12613 )  {    v11 = input[9];    if ( 30 * v11 + -70 * v9 + -122 * v6 + -81 * v7 + -66 * v5 + -115 * v4 + -41 * v3 + -86 * v1 - 15 * v2 - 30 * v8 == -54400      &amp;&amp; -103 * v11 + 120 * v8 + 108 * v7 + 48 * v4 + -89 * v3 + 78 * v1 - 41 * v2 + 31 * v5 - (v6 &lt;&lt; 6) - 120 * v9 == -10283      &amp;&amp; 71 * v6 + (v7 &lt;&lt; 7) + 99 * v5 + -111 * v3 + 85 * v1 + 79 * v2 - 30 * v4 - 119 * v8 + 48 * v9 - 16 * v11 == 22855      &amp;&amp; 5 * v11 + 23 * v9 + 122 * v8 + -19 * v6 + 99 * v7 + -117 * v5 + -69 * v3 + 22 * v1 - 98 * v2 + 10 * v4 == -2944      &amp;&amp; -54 * v11 + -23 * v8 + -82 * v3 + -85 * v2 + 124 * v1 - 11 * v4 - 8 * v5 - 60 * v7 + 95 * v6 + 100 * v9 == -2222      &amp;&amp; -83 * v11 + -111 * v7 + -57 * v2 + 41 * v1 + 73 * v3 - 18 * v4 + 26 * v5 + 16 * v6 + 77 * v8 - 63 * v9 == -13258      &amp;&amp; 81 * v11 + -48 * v9 + 66 * v8 + -104 * v6 + -121 * v7 + 95 * v5 + 85 * v4 + 60 * v3 + -85 * v2 + 80 * v1 == -1559      &amp;&amp; 101 * v11 + -85 * v9 + 7 * v6 + 117 * v7 + -83 * v5 + -101 * v4 + 90 * v3 + -28 * v1 + 18 * v2 - v8 == 6308 )    {      result = 99 * v11 + -28 * v9 + 5 * v8 + 93 * v6 + -18 * v7 + -127 * v5 + 6 * v4 + -9 * v3 + -93 * v1 + 58 * v2 == -1697;    }  }  return result;}</code></pre><p> è„šæœ¬</p> <pre class="language-none"><code class="language-none">from z3 import*s=Solver()v1=Int('v1')v2=Int('v2')v3=Int('v3')v4=Int('v4')v5=Int('v5')v6=Int('v6')v7=Int('v7')v8=Int('v8')v9=Int('v9')v11=Int('v11')s.add(-85 * v9 + 58 * v8 + 97 * v6 + v7 + -45 * v5 + 84 * v4 + 95 * v2 - 20 * v1 + 12 * v3 == 12613)s.add(-85 * v9 + 58 * v8 + 97 * v6 + v7 + -45 * v5 + 84 * v4 + 95 * v2 - 20 * v1 + 12 * v3 == 12613)s.add(-103 * v11 + 120 * v8 + 108 * v7 + 48 * v4 + -89 * v3 + 78 * v1 - 41 * v2 + 31 * v5 - (v6 *64) - 120 * v9 == -10283)s.add(71 * v6 + (v7 *128) + 99 * v5 + -111 * v3 + 85 * v1 + 79 * v2 - 30 * v4 - 119 * v8 + 48 * v9 - 16 * v11 == 22855)s.add(5 * v11 + 23 * v9 + 122 * v8 + -19 * v6 + 99 * v7 + -117 * v5 + -69 * v3 + 22 * v1 - 98 * v2 + 10 * v4 == -2944)s.add(-54 * v11 + -23 * v8 + -82 * v3 + -85 * v2 + 124 * v1 - 11 * v4 - 8 * v5 - 60 * v7 + 95 * v6 + 100 * v9 == -2222)s.add(-83 * v11 + -111 * v7 + -57 * v2 + 41 * v1 + 73 * v3 - 18 * v4 + 26 * v5 + 16 * v6 + 77 * v8 - 63 * v9 == -13258)s.add(81 * v11 + -48 * v9 + 66 * v8 + -104 * v6 + -121 * v7 + 95 * v5 + 85 * v4 + 60 * v3 + -85 * v2 + 80 * v1 == -1559)s.add(101 * v11 + -85 * v9 + 7 * v6 + 117 * v7 + -83 * v5 + -101 * v4 + 90 * v3 + -28 * v1 + 18 * v2 - v8 == 6308)s.add(99 * v11 + -28 * v9 + 5 * v8 + 93 * v6 + -18 * v7 + -127 * v5 + 6 * v4 + -9 * v3 + -93 * v1 + 58 * v2 == -1697)if s.check()==sat:    result=s.model()print(result)</code></pre><p> è¿™é‡Œçš„ç§»ä½æ“ä½œä¸èƒ½è¢«è¯†åˆ«ï¼Œéœ€è¦æ‰‹åŠ¨è½¬æ¢ã€‚</p><p> å…¶å®è¿™é“é¢˜å¸¦äº†ä¸ªç®€å•çš„æ··æ·†</p> <pre class="language-none"><code class="language-none">unsigned __int64 __fastcall sub_C50(const char *a1, _BYTE *a2){  size_t v4; // rax  unsigned int v5; // edx  int v6; // edi  int v7; // ecx  __int64 v8; // r8  __int128 *v9; // rsi  unsigned int v10; // ecx  int v11; // eax  int v12; // edi  int v13; // edx  int v14; // eax  _BYTE *v15; // rsi  _BYTE *v16; // rcx  _BYTE *v17; // r8  int *i; // rax  unsigned __int64 result; // rax  __int128 v20[2]; // [rsp+0h] [rbp-48h] BYREF  __int64 v21; // [rsp+20h] [rbp-28h]  unsigned __int64 v22; // [rsp+28h] [rbp-20h]  v22 = __readfsqword(0x28u);  v20[0] = 0LL;  v21 = 0LL;  v20[1] = 0LL;  v4 = strlen(a1);  v5 = 0;  v6 = 9;  while ( v5 &lt; v4 )  {    v7 = a1[v5++];    v6 ^= v7;  }  if ( v6 )  {    v8 = 0LL;    v9 = v20;    while ( 1 )    {      v9 = (__int128 *)((char *)v9 + 4);      v10 = v8 + 1;      v11 = v6 / 10;      v12 = v6 % 10;      *((_DWORD *)v9 - 1) = v12;      LOBYTE(v13) = v12;      v6 = v11;      if ( !v11 )        break;      v8 = v10;    }    v14 = v8 - 1;    v15 = a2;    v16 = &amp;a2[v10];    v17 = &amp;a2[v8];    for ( i = (int *)v20 + v14; ; --i )    {      *v15 = v13 + 48;      if ( v17 == v15 )        break;      v13 = *i;      ++v15;    }  }  else  {    v16 = a2;  }  result = __readfsqword(0x28u) ^ v22;  *v16 = 0;  return result;}</code></pre><p> è¿™é‡Œé¢çš„å‡½æ•°æ²¡æœ‰å¯¹è¾“å…¥è¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥ä¸ç”¨ç®¡</p></li></ol><h1 id="ä¿®æ”¹äºŒè¿›åˆ¶æ–‡ä»¶æ±‡ç¼–æŒ‡ä»¤"><a href="#ä¿®æ”¹äºŒè¿›åˆ¶æ–‡ä»¶æ±‡ç¼–æŒ‡ä»¤" class="headerlink" title="ä¿®æ”¹äºŒè¿›åˆ¶æ–‡ä»¶æ±‡ç¼–æŒ‡ä»¤"></a>ä¿®æ”¹äºŒè¿›åˆ¶æ–‡ä»¶æ±‡ç¼–æŒ‡ä»¤</h1><p>1.é¢˜ç›®â€”â€”Overlong</p><p>è¿è¡Œç¨‹åºï¼Œå¾—åˆ°</p><pre class="language-none"><code class="language-none">I never broke the encodingï¼š</code></pre><pre class="language-none"><code class="language-none">int __stdcall start(int a1, int a2, int a3, int a4){  CHAR Text[128]; // [esp+0h] [ebp-84h] BYREF  int v6; // [esp+80h] [ebp-4h]  v6 = sub_401160(Text, &amp;unk_402008, 28);  Text[v6] = 0;  MessageBoxA(0, Text, Caption, 0);  return 0;}</code></pre><p>è¿™é‡Œåªå–å‡ºäº†TEXTçš„å‰28ä½ï¼Œè€Œç¨‹åºè¿è¡Œåçš„è¾“å‡ºé•¿åº¦æ­£å¥½æ˜¯28ï¼ŒåŠ ä¸Šé¢˜ç›®overlongæç¤ºå’Œï¼šç»“å°¾ï¼ŒçŒœæµ‹éƒ¨åˆ†é•¿åº¦æ²¡æ˜¾ç¤º</p><p>æ‰€ä»¥éœ€è¦ä¿®æ”¹äºŒè¿›åˆ¶æ–‡ä»¶æ±‡ç¼–æŒ‡ä»¤</p><pre class="language-none"><code class="language-none">.text:004011C0                 push    ebp.text:004011C1                 mov     ebp, esp.text:004011C3                 sub     esp, 84h.text:004011C9                 push    1Ch.text:004011CB                 push    offset unk_402008.text:004011D0                 lea     eax, [ebp+Text]</code></pre><p>1cå¯¹åº”28ï¼Œæ‰€ä»¥éœ€è¦å°†1cæ”¹å¤§</p><p>1ã€idaä¿®æ”¹â€“&gt; ç‚¹å‡»èœå•é¡¹â€œEditâ€â€“â€œPatch programâ€â€“â€œAssembleâ€ â€“&gt; ç‚¹å‡»èœå•é¡¹â€œEditâ€â€“â€œPatch programâ€â€“â€œApply patches to input fileâ€ï¼Œåœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ç‚¹å‡»OKæŒ‰é’®ï¼Œåˆ™æˆåŠŸå®ŒæˆæŒ‡ä»¤ä¿®æ”¹ã€‚</p><p>ç‚¹å‡»ç¡®è®¤æŒ‰é’®æ—¶ï¼Œå¯èƒ½ä¼šå¼¹å‡ºæ— æ³•å†™å…¥å¯¹è¯æ¡†ï¼Œåªéœ€å»é™¤è¯¥æ–‡ä»¶çš„åªè¯»å±æ€§ï¼Œå†æ¬¡æ‰§è¡Œç¬¬ä¸‰æ­¥å³å¯ã€‚</p><p>2ã€ODä¿®æ”¹â€“&gt;æ ¹æ®æ±‡ç¼–æŒ‡ä»¤å®šä½â€“&gt;å³é”®â€“&gt;äºŒè¿›åˆ¶â€“&gt;ç¼–è¾‘ ,å…¶ä»–çš„å¯ä»¥ç›´æ¥ä¿®æ”¹æŒ‡ä»¤ï¼Œä½†æ˜¯è¿™é‡Œä¿®æ”¹ä¹‹ååé¢çš„æ±‡ç¼–ä»£ç å…¨å˜äº†ï¼Œè™½ç„¶ä¸çŸ¥é“ä¸ºå•¥ã€‚</p><p>3ã€winhexä¿®æ”¹â€“&gt;å®šä½â€”â€”å…ˆå»idaçš„patch byteæ‰¾åˆ°push 1cå¯¹åº”6A 1C 68 08 20 40 00 8D 85 7C FF FF FF 50 E8 84â€“&gt;å»winhexä¿®æ”¹1cï¼Œç„¶åé‡æ–°ä¿å­˜è¿è¡Œ</p><h1 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h1><p>1ã€é¢˜ç›®â€”â€”Signin</p><pre class="language-none"><code class="language-none">__int64 __fastcall main(int a1, char **a2, char **a3){  char v4[16]; // [rsp+0h] [rbp-4A0h] BYREF  char v5[16]; // [rsp+10h] [rbp-490h] BYREF  char v6[16]; // [rsp+20h] [rbp-480h] BYREF  char v7[16]; // [rsp+30h] [rbp-470h] BYREF  char v8[112]; // [rsp+40h] [rbp-460h] BYREF  char v9[1000]; // [rsp+B0h] [rbp-3F0h] BYREF  unsigned __int64 v10; // [rsp+498h] [rbp-8h]  v10 = __readfsqword(0x28u);  puts("[sign in]");  printf("[input your flag]: ");  __isoc99_scanf("%99s", v8);  sub_96A(v8, v9);//åŠ å¯†å‡½æ•°ç›´æ¥linuxè¿œè°ƒå°±å¯ä»¥çŸ¥é“æ˜¯è½¬åå…­è¿›åˆ¶æ•°ï¼›  __gmpz_init_set_str(v7, "ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35", 16LL);//åå…­è¿›åˆ¶  __gmpz_init_set_str(v6, v9, 16LL);  __gmpz_init_set_str(v4, "103461035900816914121390101299049044413950405173712170434161686539878160984549", 10LL);//åè¿›åˆ¶  __gmpz_init_set_str(v5, "65537", 10LL);  __gmpz_powm(v6, v6, v5, v4);  if ( (unsigned int)__gmpz_cmp(v6, v7) )    puts("GG!");  else    puts("TTTTTTTTTTql!");  return 0LL;}</code></pre><p>çœ‹åˆ°65537ï¼ŒåŠ ä¸ŠæŸ¥äº†__gmpz_powm()å‡½æ•°ï¼Œä¹Ÿç›¸å½“äº__mpz_powm()å‡½æ•°ï¼Œå¯ä»¥åˆ¤æ–­è¿™æ˜¯rsaåŠ å¯†</p><pre class="language-none"><code class="language-none">void mpz_powm (mpz_t rop, const mpz_t base, const mpz_t exp, const mpz_t mod) [Function]Set rop to base^exp mod mod.</code></pre><p> å…¶å®å°±æ˜¯è®¡ç®— base çš„ exp æ¬¡æ–¹ï¼Œå¹¶å¯¹ mod å–æ¨¡ï¼Œæœ€åå°†ç»“æœå†™å…¥ rop ä¸­ </p><p>å‰©ä¸‹çš„å°±æ˜¯è§£å‡ºpã€qï¼Œç„¶åå†™è„šæœ¬äº†</p><pre class="language-none"><code class="language-none">C=M^E mod NCæ˜¯å¯†æ–‡ï¼ŒMæ˜¯æ˜æ–‡ï¼ŒEæ˜¯å…¬é’¥ï¼ˆEå’Œ Ï†(N)äº’ä¸ºè´¨æ•°ï¼‰ï¼ŒNæ˜¯å…¬å…±æ¨¡æ•°ï¼ˆè´¨æ•° P ã€Qç›¸ä¹˜å¾—åˆ°Nï¼‰ï¼ŒMODå°±æ˜¯æ¨¡è¿ç®—M=C^D mod Næ±‚Dï¼šE * D % Ï†(N) = 1    Ï†(N) = (P-1)(Q-1)   </code></pre><p>2ã€rsa</p><p>é¢˜ç›®ç»™å‡ºäº†å…¬é’¥å’Œflag.encæ–‡ä»¶</p><pre class="language-none"><code class="language-none">(N,e)æ˜¯å…¬é’¥ï¼Œ (N, d)æ˜¯ç§é’¥</code></pre><p>å…¬é’¥å’Œå¯†é’¥ç”Ÿæˆ</p><pre class="language-none"><code class="language-none">4.1 æ±‚Næˆ‘ä»¬å‡†å¤‡ä¸¤ä¸ªå¾ˆå°å¯¹è´¨æ•°ï¼Œp ï¼ 17q ï¼ 19N ï¼ p ï¼Š q ï¼ 3234.2 æ±‚LL ï¼ lcmï¼ˆpï¼1ï¼Œ qï¼1ï¼‰ï¼ lcm(16ï¼Œ18ï¼‰ ï¼ 144144ä¸º16å’Œ18å¯¹æœ€å°å…¬å€æ•°4.3 æ±‚Eæ±‚Eå¿…é¡»è¦æ»¡è¶³2ä¸ªæ¡ä»¶ï¼š1 &lt; E &lt; L ï¼Œgcdï¼ˆEï¼ŒLï¼‰=1å³1 &lt; E &lt; 144ï¼Œgcdï¼ˆEï¼Œ144ï¼‰ ï¼ 1 #gcdï¼Œæœ€å¤§å…¬å› æ•°Eå’Œ144äº’ä¸ºè´¨æ•°ï¼Œ5æ˜¾ç„¶æ»¡è¶³ä¸Šè¿°2ä¸ªæ¡ä»¶æ•…E ï¼ 5        æ­¤æ—¶å…¬é’¥=(Eï¼ŒNï¼‰ï¼ ï¼ˆ5ï¼Œ323ï¼‰4.4 æ±‚Dæ±‚Dä¹Ÿå¿…é¡»æ»¡è¶³2ä¸ªæ¡ä»¶ï¼š1 &lt; D &lt; Lï¼ŒEï¼ŠD mod L ï¼ 1å³1 &lt; D &lt; 144ï¼Œ5 ï¼Š D mod 144 ï¼ 1æ˜¾ç„¶å½“Dï¼ 29 æ—¶æ»¡è¶³ä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶1 &lt; 29 &lt; 1445ï¼Š29 mod 144 ï¼ 145 mod 144 ï¼ 1æ­¤æ—¶ç§é’¥ï¼ï¼ˆDï¼ŒNï¼‰ï¼ï¼ˆ29ï¼Œ323ï¼‰</code></pre><p>ç§é’¥å’Œå…¬é’¥éƒ½å¯ä»¥æ‹¿å»è§£æ</p><p>è¿™é‡Œè§£æå¾—åˆ°</p><pre class="language-none"><code class="language-none">e = 65537n=86934482296048119190666062003494800588905656017203025617216654058378322103517(næ‹¿å»åˆ†è§£)p = 285960468890451637935629440372639283459q = 304008741604601924494328155975272418463</code></pre><p>ä»æ–‡ä»¶è¯»å–å…¬é’¥æˆ–è€…ç§é’¥</p><pre class="language-none"><code class="language-none">with open('private.pem', mode='rb') as privatefile:keydata = privatefile.read()#rb æ˜¯ä»¥äºŒè¿›åˆ¶å½¢å¼æ‰“å¼€æ–‡ä»¶privkey = rsa.PrivateKey.load_pkcs1(keydata)</code></pre><pre class="language-none"><code class="language-none">import gmpy2 import rsa  e = 65537n = 86934482296048119190666062003494800588905656017203025617216654058378322103517p = 285960468890451637935629440372639283459q = 304008741604601924494328155975272418463phin = (q-1)*(p-1)d = gmpy2.invert(e, phin)key = rsa.PrivateKey(n, e, int(d), p, q)#ç”Ÿæˆç§é’¥with open("D:\\new\\é¢˜ç›®\\output\\flag.enc", "rb+") as f:    f = f.read()    print(rsa.decrypt(f, key))</code></pre><h1 id="Maze"><a href="#Maze" class="headerlink" title="Maze"></a>Maze</h1><p>Mazeé¢˜ä¸€èˆ¬éƒ½éœ€è¦æ‰¾åˆ°å…¥å£ã€å‡ºå£è¿˜æœ‰ç§»åŠ¨æ–¹å‘</p><p>é¢˜ç›®â€”â€”unctf20201â€”easymaze</p><pre class="language-none"><code class="language-none">int __cdecl main(int argc, const char **argv, const char **envp){  __int64 *v3; // rax  char *v4; // rdi  unsigned __int64 v5; // rbx  const char *v6; // rdx  int v7; // eax  int v8; // er9  int v9; // er8  int v10; // edx  char v11; // cl  int v12; // ecx  int v13; // ecx  __int64 *v14; // rax  sub_1400011A0(argc, argv, envp);  dword_140006790[0] = 1;#æŠŠé¼ æ ‡æ”¾ä¸Šå»æ˜¾ç¤ºintå‹  dword_140006794 = 1;  dword_1400067B4 = 1;  dword_1400067CC = 1;  dword_1400067EC = 1;  dword_1400067F0 = 1;  dword_1400067D4 = 1;  dword_1400067D8 = 1;  dword_1400067F8 = 1;  dword_140006810 = 1;  dword_14000682C = 1;  dword_140006844 = 1;  dword_140006840 = 1;  dword_140006864 = 1;  dword_140006868 = 1;  dword_140006884 = 1;  dword_1400068A0 = 1;  dword_1400068BC = 1;  dword_1400068DC = 1;  dword_14000689C = 1;  v3 = sub_140001800(std::cout, (__int64)"Plz inpu7 the P4th :");  std::ostream::operator&lt;&lt;(v3, sub_1400019D0);  v4 = input;  v5 = -1i64;  sub_140001AA0(std::cin, -1i64, input);  do    ++v5;  while ( input[v5] );  if ( v5 &gt; 0x11 )  {    v6 = "to0 lon9!t0o long!";    goto LABEL_26;  }  if ( v5 &lt; 0x11 )  {    v6 = (const char *)&amp;unk_140003770;    goto LABEL_26;  }  v7 = dword_140006710;  v8 = 0;  v9 = dword_140006714;  v10 = dword_140006710;  do  {    v11 = *v4;    if ( *v4 == 'A' )      goto LABEL_21;    if ( v11 == 'W' )    {      ++v10;      v12 = v7 % 2;      ++v7;      goto LABEL_20;    }    if ( v11 == 'E' )    {      ++v10;      v13 = v7 % 2;      ++v7;LABEL_16:      dword_140006710 = v7;      if ( v13 )        goto LABEL_23;      goto LABEL_17;    }    if ( v11 != 'D' )    {      if ( v11 != 'X' )      {        if ( v11 != 'Z' )        {          v6 = "What the fuck did you give me?";          goto LABEL_26;        }        --v10;        v12 = v7 % 2;        --v7;LABEL_20:        dword_140006710 = v7;        if ( !v12 )          goto LABEL_23;LABEL_21:        --v9;        goto LABEL_22;      }      --v10;      v13 = v7 % 2;      --v7;      goto LABEL_16;    }LABEL_17:    ++v9;LABEL_22:    dword_140006714 = v9;LABEL_23:    ++v8;    ++v4;  }  while ( v8 &lt; v5 );  v6 = "Congratulations on this forced to get the right flag, you entered is the correct answer!";    if ( dword_140006790[7 * v7 + v9] != 1 )        v6 = "Try it again little unlucky!";LABEL_26:  v14 = sub_140001800(std::cout, (__int64)v6);  std::ostream::operator&lt;&lt;(v14, sub_1400019D0);  return 0;}</code></pre><p>åŠ¨è°ƒå°±å¯ä»¥æŠŠAWEDXZçš„ç§»åŠ¨å¼„å‡ºæ¥</p><p>åœ¨idaé‡Œé¢ddè¡¨ç¤ºå››ä¸ªå­—èŠ‚ï¼Œdbè¡¨ç¤ºä¸€ä¸ªå­—èŠ‚</p><pre class="language-none"><code class="language-none">data:00007FF673BF6794 dword_7FF673BF6794 dd 0                 ; DATA XREF: main+27â†‘w.data:00007FF673BF6798 dd 0.data:00007FF673BF679C db    0.data:00007FF673BF679D db    0.data:00007FF673BF679E db    0.data:00007FF673BF679F db    0.data:00007FF673BF67A0 db    0.data:00007FF673BF67A1 db    0.data:00007FF673BF67A2 db    0.data:00007FF673BF67A3 db    0.data:00007FF673BF67A4 db    0.data:00007FF673BF67A5 db    0.data:00007FF673BF67A6 db    0.data:00007FF673BF67A7 db    0</code></pre><p>è¦å¯¹ç€dbæŒ‰Dè½¬æ¢æ•°æ®ç±»å‹ï¼Œå…¨éƒ¨è½¬ä¸ºintå‹</p><h1 id="base64å˜è¡¨"><a href="#base64å˜è¡¨" class="headerlink" title="base64å˜è¡¨"></a>base64å˜è¡¨</h1><p>1ã€base64å˜è¡¨å®é™…ä¸Šå°±æ˜¯å°†base64ç¼–ç è¡¨è¿›è¡Œäº†ä¿®æ”¹</p><p>2ã€é¢˜ç›®â€”â€”nctf2021 shadowbringer</p><pre class="language-none"><code class="language-none">int __cdecl main(int argc, const char **argv, const char **envp){  char v4[16]; // [rsp+20h] [rbp-60h] BYREF  char v5[15]; // [rsp+30h] [rbp-50h] BYREF  char v6; // [rsp+3Fh] [rbp-41h] BYREF  char v7[16]; // [rsp+40h] [rbp-40h] BYREF  char v8[16]; // [rsp+50h] [rbp-30h] BYREF  char v9[16]; // [rsp+60h] [rbp-20h] BYREF  char v10[32]; // [rsp+70h] [rbp-10h] BYREF  _main();  youknowwhat();  std::string::string((std::string *)v5);  std::allocator&lt;char&gt;::allocator(&amp;v6);  std::string::string(v4, "U&gt;F2UsQXN`5sXMELT=:7M_2&lt;X]^1ThaWF0=KM?9IUhAsTM5:T==_Ns&amp;&lt;Vhb!", &amp;v6);  std::allocator&lt;char&gt;::~allocator(&amp;v6);  std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(printf_0, "Welcome.Please input your flag:\n");  std::operator&gt;&gt;&lt;char&gt;(scanf, (std::string *)v5);  std::string::string((std::string *)v8, (const std::string *)v5);    Emet(v7, v8);    std::string::operator=(v5, v7);  std::string::~string((std::string *)v7);  std::string::~string((std::string *)v8);  std::string::string((std::string *)v10, (const std::string *)v5);    Selch(v9, v10);    std::string::operator=(v5, v9);                 std::string::~string((std::string *)v9);  std::string::~string((std::string *)v10);  if ( (unsigned __int8)std::operator==&lt;char&gt;(v5, v4) )    std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(printf_0, "Right.");  else    std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(printf_0, "Wrong.");  std::string::~string((std::string *)v4);  std::string::~string((std::string *)v5);  return 0;}</code></pre><pre class="language-none"><code class="language-none">std::string *__fastcall Emet(std::string *a1, std::string *a2){  int i; // ebx  char *v3; // rax  unsigned __int64 v4; // rax  int j; // ebx  unsigned int v6; // eax  char *v7; // rax  unsigned __int64 v9; // [rsp+20h] [rbp-90h] BYREF  char v10; // [rsp+2Eh] [rbp-82h] BYREF  char v11; // [rsp+2Fh] [rbp-81h] BYREF  char v12[16]; // [rsp+30h] [rbp-80h] BYREF  char v13[16]; // [rsp+40h] [rbp-70h] BYREF  char v14[16]; // [rsp+50h] [rbp-60h] BYREF  char v15[16]; // [rsp+60h] [rbp-50h] BYREF  char v16[16]; // [rsp+70h] [rbp-40h] BYREF  char v17[16]; // [rsp+80h] [rbp-30h] BYREF  char v18[16]; // [rsp+90h] [rbp-20h] BYREF  char v19[16]; // [rsp+A0h] [rbp-10h] BYREF  std::allocator&lt;char&gt;::allocator(&amp;v10);  std::string::string(&amp;v9, &amp;unk_48A000, &amp;v10);  std::allocator&lt;char&gt;::~allocator(&amp;v10);  std::allocator&lt;char&gt;::allocator(&amp;v11);  std::string::string(a1, &amp;unk_48A000, &amp;v11);  std::allocator&lt;char&gt;::~allocator(&amp;v11);  for ( i = 0; i &lt; (unsigned __int64)std::string::size(a2); ++i )  {    v3 = (char *)std::string::operator[](a2, i);    std::bitset&lt;8ull&gt;::bitset(v14, (unsigned int)*v3);    std::bitset&lt;8ull&gt;::to_string(v13, v14);    std::operator+&lt;char&gt;(v12, &amp;v9, v13);    std::string::operator=(&amp;v9, v12);    std::string::~string((std::string *)v12);    std::string::~string((std::string *)v13);  }  while ( 1 )  {    v4 = std::string::size((std::string *)&amp;v9);    if ( v4 == 6 * (v4 / 6) )      break;    std::operator+&lt;char&gt;(v15, &amp;v9, 48i64);    std::string::operator=(&amp;v9, v15);    std::string::~string((std::string *)v15);  }  for ( j = 0; j &lt; (unsigned __int64)std::string::size((std::string *)&amp;v9); j += 6 )  {    std::string::substr((std::string *)v18, (unsigned __int64)&amp;v9, j);    std::bitset&lt;6ull&gt;::bitset&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(v17, v18, 0i64);    v6 = std::bitset&lt;6ull&gt;::to_ulong(v17);    v7 = (char *)std::string::operator[](&amp;hisoralce, v6);    std::operator+&lt;char&gt;(v16, a1, (unsigned int)*v7);    std::string::operator=(a1, v16);    std::string::~string((std::string *)v16);    std::string::~string((std::string *)v18);  }  while ( (std::string::size(a1) &amp; 3) != 0 )  {    std::operator+&lt;char&gt;(v19, a1, 33i64);    std::string::operator=(a1, v19);    std::string::~string((std::string *)v19);  }  std::string::~string((std::string *)&amp;v9);  return a1;}</code></pre><p>è¿™é‡Œçš„j+=6ï¼Œåƒæ˜¯base64ï¼Œè€Œ&amp;hisoraleæ˜¯æŒ‡é’ˆ</p><pre class="language-none"><code class="language-none">bss:00000000004AA030 hisoralce db  28h ; (                   ; DATA XREF: youknowwhat(void)+2Aâ†‘o.bss:00000000004AA030                                         ; youknowwhat(void)+40â†‘o ....bss:00000000004AA031 db  3Dh ; =.bss:00000000004AA032 db 0BBh.bss:00000000004AA033 db    0.bss:00000000004AA034 db    0.bss:00000000004AA035 db    0.bss:00000000004AA036 db    0.bss:00000000004AA037 db    0</code></pre><p>éœ€è¦å¯¹ç€dbæŒ‰dè½¬æ¢ç±»å‹ï¼Œæ‰èƒ½çœ‹åˆ°è¯¥åœ°å€å­˜å‚¨çš„å†…å®¹</p>]]></content>
      
      
      
        <tags>
            
            <tag> AD </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
