<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"gift1a.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="pyc花指令">
<meta property="og:type" content="article">
<meta property="og:title" content="pyc加花指令">
<meta property="og:url" content="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="pyc花指令">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644848858641.png">
<meta property="og:image" content="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644848986760.png">
<meta property="og:image" content="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849226023.png">
<meta property="og:image" content="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849421077.png">
<meta property="og:image" content="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849766935.png">
<meta property="og:image" content="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849849453.png">
<meta property="og:image" content="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849958666.png">
<meta property="article:published_time" content="2022-02-14T12:10:12.000Z">
<meta property="article:modified_time" content="2022-04-20T01:52:41.582Z">
<meta property="article:author" content="Gift1a">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644848858641.png">


<link rel="canonical" href="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/","path":"2022/02/14/pyc加花指令/","title":"pyc加花指令"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>pyc加花指令 | Hexo</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#VNCTF2022-BabyMaze"><span class="nav-number">1.</span> <span class="nav-text">VNCTF2022-BabyMaze</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Pyc%E5%AD%97%E8%8A%82%E7%A0%81%E9%98%85%E8%AF%BB-unctf2021-pytrade"><span class="nav-number">2.</span> <span class="nav-text">Pyc字节码阅读-unctf2021-pytrade</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Easy-Re"><span class="nav-number">3.</span> <span class="nav-text">Easy_Re</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Gift1a"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Gift1a</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">57</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Gift1a" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Gift1a" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://1.12.239.117:8090/" title="http:&#x2F;&#x2F;1.12.239.117:8090&#x2F;" rel="noopener" target="_blank">Fallwind</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gift1a.github.io/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Gift1a">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="pyc加花指令 | Hexo">
      <meta itemprop="description" content="pyc花指令">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          pyc加花指令
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-02-14 20:10:12" itemprop="dateCreated datePublished" datetime="2022-02-14T20:10:12+08:00">2022-02-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-04-20 09:52:41" itemprop="dateModified" datetime="2022-04-20T09:52:41+08:00">2022-04-20</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>8.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>8 分钟</span>
    </span>
</div>

            <div class="post-description">pyc花指令</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="VNCTF2022-BabyMaze"><a href="#VNCTF2022-BabyMaze" class="headerlink" title="VNCTF2022-BabyMaze"></a>VNCTF2022-BabyMaze</h1><p>pyc相关知识-<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/145811103">https://zhuanlan.zhihu.com/p/145811103</a></p>
<p>使用uncompyle6发现无法反编译，应该是添加了花指令</p>
<p>先查看字节码</p>
<p>脚本</p>
<pre class="language-python" data-language="python"><code class="language-python">import marshal, dis
f = open("D:\\new\\AD\\game\\vnctf2022\\re\\BabyMaze.pyc", "rb").read()
code = marshal.loads(f[16:]) #这边从16位开始取因为是python3 python2从8位开始取
dis.dis(code)</code></pre>

<p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644848858641.png"></p>
<p>发现这一段就是花指令</p>
<p>去python的包里面搜索opcode.h，找到对应的字节码</p>
<p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644848986760.png"></p>
<p>转为十六进制后去010editor修改，去掉即可</p>
<p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849226023.png"></p>
<p>但是发现还是不行，这是因为</p>
<p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849421077.png"></p>
<p>pyc文件有co_code，所以修改长度之后要修改它</p>
<p>先打印出来长度，然后计算后修改</p>
<p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849766935.png"></p>
<p>2030-6=7E8</p>
<p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849849453.png"></p>
<p>重新uncompyle6</p>
<p><img src="/2022/02/14/pyc%E5%8A%A0%E8%8A%B1%E6%8C%87%E4%BB%A4/1644849958666.png"></p>
<p>反编译成功，接下来就是maze图，打印出来之后手打</p>
<h1 id="Pyc字节码阅读-unctf2021-pytrade"><a href="#Pyc字节码阅读-unctf2021-pytrade" class="headerlink" title="Pyc字节码阅读-unctf2021-pytrade"></a>Pyc字节码阅读-unctf2021-pytrade</h1><p>得到两个txt文件，一个是py的字节码，一个是输出</p>
<p>对字节码进行分析</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/557cfe36f0f0">https://www.jianshu.com/p/557cfe36f0f0</a></p>
<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-246683.htm">https://bbs.pediy.com/thread-246683.htm</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/dis.html">https://docs.python.org/zh-cn/3/library/dis.html</a>  这是python3的</p>
<pre class="language-python" data-language="python"><code class="language-python">0 LOAD_CONST               1 ('XXXXXX')       //This is flag,try to figure it out ! Don't forget to fill it in flag{} !
             2 STORE_FAST               0 (flag)</code></pre>

<p>LOAD_CONST加载const变量，比如数值、字符串等，一般用于传给函数参数</p>
<p>STORE_FAST 一般用于保存值到局部变量</p>
<p>这句话意思是</p>
<pre class="language-none"><code class="language-none">flag='XXXXXXXX'</code></pre>

<p>第二段</p>
<pre class="language-python" data-language="python"><code class="language-python">4 LOAD_CONST               2 (0) const变量，一般用于传给函数的参数
             6 BUILD_LIST               1  创建列表
             8 LOAD_CONST               3 (18)   const变量  num=[0]*18
            10 BINARY_MULTIPLY    	
            12 STORE_FAST               1 (num) 保存值到局部变量中</code></pre>

<p>BINARY_MULTIPLY 是二元运算，即将栈顶的前两个元素取出进行计算，结果压回栈中 </p>
<p>BUILD_LIST 创建列表</p>
<pre class="language-none"><code class="language-none">num=[0]*18</code></pre>

<p>第三段</p>
<pre class="language-python" data-language="python"><code class="language-python">14 LOAD_CONST               2 (0)
             16 STORE_FAST               2 (k)</code></pre>

<pre class="language-python" data-language="python"><code class="language-python">k=0</code></pre>

<p>第四段</p>
<pre class="language-python" data-language="python"><code class="language-python">18 LOAD_GLOBAL              0 (range) 加载全局变量
             20 LOAD_GLOBAL              1 (len) 
             22 LOAD_FAST                0 (flag) 
             24 CALL_FUNCTION            1	调用一个函数，在此之前要先赋值 len(flag)
             26 CALL_FUNCTION            1  range(len(flag))
             28 GET_ITER		取迭代器
        &gt;&gt;   30 FOR_ITER               112 (to 144)  一直到144都是for循环
             32 STORE_FAST               3 (i) </code></pre>

<p> LOAD_GLOBAL 用来加载全局变量，包括指定函数名，类名，模块名等全局符号。当和函数搭配时，要注意有CALL_FUNCTION</p>
<p>LOAD_FAST一般加载局部变量的值，也就是读取值，用于计算或者函数调用传参等。这里调用完len之后，要使用其传值，这里传入flag</p>
<p>前半段意思是</p>
<pre class="language-python" data-language="python"><code class="language-python">range(len(flag))</code></pre>

<p>GET_ITER创建迭代器，一般是for循环</p>
<p>FOR_ITER(to 144)表示迭代器一直到144</p>
<p>STORE_FAST 创建局部变量，这里作为for循环的索引</p>
<pre class="language-python" data-language="python"><code class="language-python">for i in range(len(flag)):</code></pre>

<p>第五段</p>
<pre class="language-python" data-language="python"><code class="language-python">7          34 LOAD_GLOBAL              2 (ord) 			
            36 LOAD_FAST                0 (flag)
            38 LOAD_FAST                3 (i)
            40 BINARY_SUBSCR		索引运算
            42 CALL_FUNCTION            1	ord(flag[i])
            44 LOAD_FAST                3 (i)
            46 BINARY_ADD		+i
            48 LOAD_FAST                2 (k)	
            50 LOAD_CONST               4 (3)	
            52 BINARY_MODULO		//取模运算 k%3
            54 LOAD_CONST               5 (1) 
            56 BINARY_ADD		(k%3)+1
            58 BINARY_XOR		(ord(flag[i])+i)^(k%3+1)
            60 LOAD_FAST                1 (num)
            62 LOAD_FAST                3 (i)
            64 STORE_SUBSCR 		num[i]</code></pre>

<p>BINARY_SUBSCR下标 访问操作</p>
<p>BINARY_ADD也是二元运算，相加</p>
<p>BINARY_MODULO，二元运算取模</p>
<p>BINARY_XOR二元运算异或</p>
<p>STORE_SUBSCR下标访问操作</p>
<pre class="language-python" data-language="python"><code class="language-python">num[i]= (ord(flag[i]) + i) ^ (k % 3 + 1)</code></pre>

<p>第六段</p>
<pre class="language-python" data-language="python"><code class="language-python">8          66 LOAD_GLOBAL              2 (ord)
             68 LOAD_FAST                0 (flag)
             70 LOAD_GLOBAL              1 (len)
             72 LOAD_FAST                0 (flag)
             74 CALL_FUNCTION            1	len(flag)
             76 LOAD_FAST                3 (i)	len(flag)-i
             78 BINARY_SUBTRACT	
             80 LOAD_CONST               5 (1)
             82 BINARY_SUBTRACT	减法	len(flag)-i-1
             84 BINARY_SUBSCR		索引运算	flag[len(flag)-i-1]
             86 CALL_FUNCTION            1		ord(flag[len(flag)-i-1])
             88 LOAD_GLOBAL              1 (len)
             90 LOAD_FAST                0 (flag)
             92 CALL_FUNCTION            1	len(flag)
             94 BINARY_ADD		ord(flag[len(flag)-i-1])+len(flag)-i-1
             96 LOAD_FAST                3 (i)	
             98 BINARY_SUBTRACT
            100 LOAD_CONST               5 (1)
            102 BINARY_SUBTRACT
            104 LOAD_FAST                2 (k)
            106 LOAD_CONST               4 (3)
            108 BINARY_MODULO	k%3
            110 LOAD_CONST               5 (1)
            112 BINARY_ADD		k%3+1
            114 BINARY_XOR		ord(flag[len(flag)-i-1])+(len(flag)-i-1)^(k%3+1)
            116 LOAD_FAST                1 (num)
            118 LOAD_GLOBAL              1 (len)
            120 LOAD_FAST                0 (flag)	len(flag)
            122 CALL_FUNCTION            1
            124 LOAD_FAST                3 (i)
            126 BINARY_SUBTRACT	len(flag)-i
            128 LOAD_CONST               5 (1)	
            130 BINARY_SUBTRACT	len(flag)-i-1
            132 STORE_SUBSCR		num[len(flag)-i-1]=ord(flag[len(flag)-i-1])+(len(flag)-i-1)^(k%3+1)</code></pre>

<p>BINARY_SUBTRACT二元运算减法</p>
<pre class="language-python" data-language="python"><code class="language-python">num[len(flag)-i-1]=ord(flag[len(flag)-i-1])+(len(flag)-i-1)^(k%3+1)</code></pre>

<p>第七段</p>
<pre class="language-python" data-language="python"><code class="language-python">9         134 LOAD_FAST                2 (k)
            136 LOAD_CONST               5 (1)
            138 INPLACE_ADD	k++
            140 STORE_FAST               2 (k)
            142 JUMP_ABSOLUTE           30//循环结束
</code></pre>

<p>JUMP_ABSOLUTE绝对跳转，结束循环</p>
<p>INPLACE_ADD  计算结果可以被操作数引用的到，每一个 二元运算，都对应一个inplace 运算 </p>
<pre class="language-python" data-language="python"><code class="language-python">k+=1</code></pre>

<p>第八段</p>
<pre class="language-python" data-language="python"><code class="language-python">10     &gt;&gt;  144 LOAD_GLOBAL              3 (print)
            146 LOAD_FAST                1 (num)
            148 CALL_FUNCTION            1 print(num)
            150 POP_TOP
            152 LOAD_CONST               0 (None)
            154 RETURN_VALUE</code></pre>

<pre class="language-none"><code class="language-none">print(num)</code></pre>

<h1 id="Easy-Re"><a href="#Easy-Re" class="headerlink" title="Easy_Re"></a>Easy_Re</h1><p>python3.9，无法uncompyle6，使用pycdc翻译成字节码</p>
<pre class="language-python" data-language="python"><code class="language-python">main.pyc (Python 3.9)
[Code]
    File Name: main.py
    Object Name: &lt;module&gt;
    Arg Count: 0
    Pos Only Arg Count: 0
    KW Only Arg Count: 0
    Locals: 0
    Stack Size: 4
    Flags: 0x00000040 (CO_NOFREE)
    [Names]
        'base64'
        'encode'
        'enCodeAgain'
        'correct'
        'flag'
        'print'
        'input'
    [Var Names]
    [Free Vars]
    [Cell Vars]
    [Constants]
        0
        None
        [Code]
            File Name: main.py
            Object Name: encode
            Arg Count: 1
            Pos Only Arg Count: 0
            KW Only Arg Count: 0
            Locals: 4
            Stack Size: 5
            Flags: 0x00000043 (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)
            [Names]
                'chr'
                'base64'
                'b64encode'
                'encode'
            [Var Names]
                'message'
                's'
                'i'
                'x'
            [Free Vars]
            [Cell Vars]
            [Constants]
                None
                ''
                32
                16
                'utf-8'
 [Disassembly]
                0       LOAD_CONST              1: ''
                2       STORE_FAST              1: s       s=''
                4       LOAD_FAST               0: message
                6       GET_ITER                
                8       FOR_ITER                32 (to 42) for i in message:
                10      STORE_FAST              2: i   
                12      LOAD_FAST               2: i  
                14      LOAD_CONST              2: 32
                16      BINARY_XOR              		 i^32
                18      STORE_FAST              3: x	x=i^32
                20      LOAD_FAST               3: x	
                22      LOAD_CONST              3: 16
                24      BINARY_ADD              		x+16
                26      STORE_FAST              3: x	x=x+16
                28      LOAD_FAST               1: s	
                30      LOAD_GLOBAL             0: chr
                32      LOAD_FAST               3: x    
                34      CALL_FUNCTION           1  chr(x)
                36      INPLACE_ADD             s+chr(x)
                38      STORE_FAST              1: s	s=s+chr(x)
                40      JUMP_ABSOLUTE           8    循环结束
                42      LOAD_GLOBAL             1: base64
                44      LOAD_METHOD             2: b64encode	base64.b64
                46      LOAD_FAST               1: s		
                48      LOAD_METHOD             3: encode   LOAD_METHOD是加载类，CALL调用
                50      LOAD_CONST              4: 'utf-8' 
                52      CALL_METHOD             1  
                54      CALL_METHOD             1 base64.b64(s.encode('utf-8'))
                56      RETURN_VALUE            return  base64.b64(s.encode('utf-8'))
        'encode'
        [Code]
            File Name: main.py
            Object Name: enCodeAgain
            Arg Count: 2
            Pos Only Arg Count: 0
            KW Only Arg Count: 0
            Locals: 5
            Stack Size: 5
            Flags: 0x00000043 (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)
            [Names]
                'str'
                'range'
                'len'
            [Var Names]
                'string'
                'space'
                's'
                'i'
                'j'
            [Free Vars]
            [Cell Vars]
            [Constants]
                None
                ''
                'utf-8'
                0
            [Disassembly]
                0       LOAD_CONST              1: ''  
                2       STORE_FAST              2: s	s=''
                4       LOAD_GLOBAL             0: str	
                6       LOAD_FAST               0: string
                8       LOAD_CONST              2: 'utf-8' 
                10      CALL_FUNCTION           2//参数个数 str(string,'utf-8')
                12      STORE_FAST              0: string string=str(string,'utf-8')
                14      LOAD_GLOBAL             1: range 
                16      LOAD_CONST              3: 0
                18      LOAD_FAST               1: space
                20      CALL_FUNCTION           2 range(0,space)
                22      GET_ITER                //创建迭代器
                24      FOR_ITER                50 (to 76) 
                26      STORE_FAST              3: i	for i range(0,space):
                28      LOAD_GLOBAL             1: range 	
                30      LOAD_FAST               3: i
                32      LOAD_GLOBAL             2: len
                34      LOAD_FAST               0: string
                36      CALL_FUNCTION           1	len(string)
                38      LOAD_FAST               1: space
                40      CALL_FUNCTION           3 
                42      GET_ITER                
                44      FOR_ITER                28 (to 74)
                46      STORE_FAST              4: j  for j in range(i,len(string),space)
                48      LOAD_FAST               4: j 
                50      LOAD_GLOBAL             2: len
                52      LOAD_FAST               0: string
                54      CALL_FUNCTION           1  	len(string)
                56      COMPARE_OP              0 (&lt;)	if(j&lt;len(string))
                58      POP_JUMP_IF_FALSE       44	跳转
                60      LOAD_FAST               2: s	
                62      LOAD_FAST               0: string
                64      LOAD_FAST               4: j
                66      BINARY_SUBSCR           	string[j]
                68      INPLACE_ADD             
                70      STORE_FAST              2: s      s+=string[j]
                72      JUMP_ABSOLUTE           44	第二个循环
                74      JUMP_ABSOLUTE           24	第一个循环
                76      LOAD_FAST               2: s
                78      RETURN_VALUE             return s
        'enCodeAgain'
        'VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ='
        ''
        'Input flag:'
        'utf-8'
        2
        'correct'
        'wrong'
    [Disassembly]
        0       LOAD_CONST              0: 0
        2       LOAD_CONST              1: None
        4       IMPORT_NAME             0: base64	
        6       STORE_NAME              0: base64	import base64
        8       LOAD_CONST              2: &lt;CODE&gt; encode
        10      LOAD_CONST              3: 'encode' //函数
        12      MAKE_FUNCTION           0
        14      STORE_NAME              1: encode
        16      LOAD_CONST              4: &lt;CODE&gt; enCodeAgain
        18      LOAD_CONST              5: 'enCodeAgain'
        20      MAKE_FUNCTION           0	//第二个函数
        22      STORE_NAME              2: enCodeAgain
        24      LOAD_CONST              6: 'VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ='
        26      STORE_NAME              3: correct	correct=VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ=
        28      LOAD_CONST              7: ''
        30      STORE_NAME              4: flag	flag=''
        32      LOAD_NAME               5: print
        34      LOAD_CONST              8: 'Input flag:'	
        36      CALL_FUNCTION           1	print('Int flag:')
        38      POP_TOP                 
        40      LOAD_NAME               6: input
        42      CALL_FUNCTION           0	input()
        44      STORE_NAME              4: flag	flag=input()
        46      LOAD_NAME               4: flag		
        48      LOAD_METHOD             1: encode	
        50      LOAD_CONST              9: 'utf-8'
        52      CALL_METHOD             1
        54      STORE_NAME              4: flag	flag=flag.encode('utf-8')
        56      LOAD_NAME               5: print	
        58      LOAD_NAME               2: enCodeAgain
        60      LOAD_NAME               1: encode
        62      LOAD_NAME               4: flag
        64      CALL_FUNCTION           1	
        66      LOAD_CONST              10: 2 其中一个参数
        68      CALL_FUNCTION           2//两个参数
        70      CALL_FUNCTION           1	print(enCodeAgain(encodee(flag),2))
        72      POP_TOP                 	函数栈顶元素出栈
        74      LOAD_NAME               2: enCodeAgain
        76      LOAD_NAME               1: encode
        78      LOAD_NAME               4: flag
        80      CALL_FUNCTION           1
        82      LOAD_CONST              10: 2
        84      CALL_FUNCTION           2	(enCodeAgain(encodee(flag),2))
        86      LOAD_NAME               3: correct
        88      COMPARE_OP              2 (==)	//比较
        90      POP_JUMP_IF_FALSE       102		跳转
        92      LOAD_NAME               5: print	
        94      LOAD_CONST              11: 'correct'
        96      CALL_FUNCTION           1		print('correct')
        98      POP_TOP                 
        100     JUMP_FORWARD            8 (to 110)	结束
        102     LOAD_NAME               5: print
        104     LOAD_CONST              12: 'wrong'
        106     CALL_FUNCTION           1		print('wrong)
        108     POP_TOP                 
        110     LOAD_CONST              1: None
        112     RETURN_VALUE            
</code></pre>

<pre class="language-python" data-language="python"><code class="language-python">import base64


def encode(message):
    s = ''
    for i in message:
        x = i ^ 32
        x += 16
        s += chr(x)
        return (base64.b64encode(s.encode('utf-8')))


def enCodeAgain(string, space):
    s = ''
    string = str(string, 'utf-8')
    for i in range(0, space):
        for j in range(i, len(string), space):
            if j &lt; len(string):
                s += string[j]
    return s


correct = 'VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ='
flag = ''
print('Input flag:')
flag = input()
flag = flag.encode('utf-8')
print(enCodeAgain(encode(flag), 2))
if enCodeAgain(encode(flag), 2) == correct:
    print(correct)
else:
    print('wrong')
</code></pre>


    </div>

    
    
    

    <footer class="post-footer">
          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="/images/wechat_channel.jpg">
          <span class="icon">
            <i class="fab fa-weixin"></i>
          </span>

          <span class="label">WeChat</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Reverse/" rel="tag"># Reverse</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/02/13/hgame2022-week3-re/" rel="prev" title="hgame2022-week3-re">
                  <i class="fa fa-chevron-left"></i> hgame2022-week3-re
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/02/19/hgame-misc/" rel="next" title="hgame-misc">
                  hgame-misc <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gift1a</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">278k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">4:13</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  





  





<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body>
</html>
