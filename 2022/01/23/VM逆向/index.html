<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"gift1a.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.11.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Dasctf——EasyVm一开始有个花指令，是比较常见的永真跳转，先对call指令按u取消定义，将e8改为90，再重新弄成函数就可以了 先找到加密的函数  点进去看看  这里是base64变种，在最后加了一个异或操作，先把脚本写出来 #include&lt;stdio.h&gt; #include&lt;string.h&gt; char base64_table[] &#x3D; &quot;ABCDEFGHIJ">
<meta property="og:type" content="article">
<meta property="og:title" content="VM逆向">
<meta property="og:url" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Dasctf——EasyVm一开始有个花指令，是比较常见的永真跳转，先对call指令按u取消定义，将e8改为90，再重新弄成函数就可以了 先找到加密的函数  点进去看看  这里是base64变种，在最后加了一个异或操作，先把脚本写出来 #include&lt;stdio.h&gt; #include&lt;string.h&gt; char base64_table[] &#x3D; &quot;ABCDEFGHIJ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642951424173.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642951469199.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642951694407.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642953729321.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642953871966.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642955403773.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642955602049.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642955631076.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642955978948.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642955994447.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642956392630.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642956568041.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642956806744.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642957130761.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642957467393.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642957487310.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642987459030.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642988305784.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642988338522.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642988366450.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642988655617.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642988824766.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642989162099.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20220124125427.jpg">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645447619996.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645447726404.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645447904556.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645447995063.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645448145669.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645448615771.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645448764344.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645448880740.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645449458278.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645449560687.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645449886162.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645450099792.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645450235632.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645513351201.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645513742181.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645514228495.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645514299405.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645514469709.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645514666638.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645514774277.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645514918356.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645515061894.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645515342308.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645515472275.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645515606892.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645515758080.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645515807493.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645515866224.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645515954359.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645516003430.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645516131712.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645516166189.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645516207834.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645516848887.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645517151788.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645517394177.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645517670674.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645517727020.png">
<meta property="og:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1645518636756.png">
<meta property="article:published_time" content="2022-01-23T15:21:28.000Z">
<meta property="article:modified_time" content="2022-03-11T05:13:03.148Z">
<meta property="article:author" content="Gift1a">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/1642951424173.png">


<link rel="canonical" href="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/","path":"2022/01/23/VM逆向/","title":"VM逆向"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>VM逆向 | Hexo</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Dasctf%E2%80%94%E2%80%94EasyVm"><span class="nav-number">1.</span> <span class="nav-text">Dasctf——EasyVm</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hgame2022-week4-easyvm"><span class="nav-number">2.</span> <span class="nav-text">hgame2022-week4-easyvm</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E7%BB%88%E7%9A%84%E4%B8%80%E4%BA%9B%E6%95%B0%E6%8D%AE%E5%92%8C%E5%88%86%E7%BB%84%E5%92%8C%E8%84%9A%E6%9C%AC"><span class="nav-number">2.1.</span> <span class="nav-text">最终的一些数据和分组和脚本</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Gift1a</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">58</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gift1a.github.io/2022/01/23/VM%E9%80%86%E5%90%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Gift1a">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="VM逆向 | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          VM逆向
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-01-23 23:21:28" itemprop="dateCreated datePublished" datetime="2022-01-23T23:21:28+08:00">2022-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-03-11 13:13:03" itemprop="dateModified" datetime="2022-03-11T13:13:03+08:00">2022-03-11</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="Dasctf——EasyVm"><a href="#Dasctf——EasyVm" class="headerlink" title="Dasctf——EasyVm"></a>Dasctf——EasyVm</h1><p>一开始有个花指令，是比较常见的永真跳转，先对call指令按u取消定义，将e8改为90，再重新弄成函数就可以了</p>
<p>先找到加密的函数</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642951424173.png"></p>
<p>点进去看看</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642951469199.png"></p>
<p>这里是base64变种，在最后加了一个异或操作，先把脚本写出来</p>
<pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
char base64_table[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
int findIndex(char c, char b64_table[])
{
	for (int i = 0; i &lt; 64; ++i)
	{
		if (c == b64_table[i])
			return i;
	}
}
char* base64_decode(char code[], char str[], char b64_table[])
{
	char memstr[200] = { 0 };
	memcpy(memstr, code, strlen(code));
	int len = strlen(code);
	/*while (code[len] != '!' &amp;&amp; code[len] != 0)
	{
		len++;
	}*/
	for (int i = 0, i_ = 0; i &lt; len; i += 4, i_ += 3)
	{
		str[i_] = (findIndex(memstr[i]^0xa, b64_table) &lt;&lt; 2) | (findIndex(memstr[i + 1]^0xb, b64_table) &amp; 0x30) &gt;&gt; 4;
		str[i_ + 1] = (findIndex(memstr[i + 1]^0xb, b64_table) &amp; 0xf) &lt;&lt; 4 | (findIndex(memstr[i + 2]^0xc, b64_table) &amp; 0x3c) &gt;&gt; 2;
		str[i_ + 2] = (findIndex(memstr[i + 2]^0xc, b64_table) &amp; 0x03) &lt;&lt; 6 | (findIndex(memstr[i + 3]^0xd, b64_table));
	}
	int str_len = (len / 4) * 3 + len % 4;
	if (len % 4)
	{
		str_len -= 1;
	}
	str[str_len] = 0;
	return str;
}


int main()
{
	char code[100] = "";
	char decode[] = { 0 };
	base64_decode(code, decode, base64_table);
	printf("%s", decode);
	return 0;
}</code></pre>

<p>接下来就是vm的部分</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642951694407.png"></p>
<p>先看func函数的类型，是指针数组</p>
<p>这里需要结合动调看每条指令对应的操作</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642953729321.png"></p>
<p>在这里下断点之后F7进入函数</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642953871966.png"></p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642955403773.png"></p>
<p>这就是func数组存放的东西，因为是指针，所以要先按d转为dd才会显示</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642955602049.png"></p>
<p>先把指令提取出来</p>
<pre class="language-c" data-language="c"><code class="language-c">unsigned char ida_chars[] =
{
  0xCA, 0x00, 0x00, 0x00, 0x00, 0xCB, 0x00, 0x00, 0x00, 0x00,
  0xCC, 0xCF, 0xC9, 0xEE, 0x00, 0x00, 0x00, 0xCF, 0xD1, 0xD3,
  0x01, 0xFE, 0xC2, 0xD2, 0x39, 0x00, 0x00, 0x00, 0xD4, 0xEC,
  0xFF, 0x00
};</code></pre>

<p>F8单步调试</p>
<p>0xCA</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642955631076.png"></p>
<p>0xCB</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642955978948.png"></p>
<p>0xCC</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642955994447.png"></p>
<p>0xCF</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642956392630.png"></p>
<p>每执行完再进入func[2]都能知道当前位置，便于查看指令</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642956568041.png"></p>
<p>0xc9</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642956806744.png"></p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642957130761.png"></p>
<p>0xd1</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642957467393.png"></p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642957487310.png"></p>
<p>这里本来赋值为0，1，2，为了保持字符相等的情况，把 this[5]全部赋值为1</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642987459030.png"></p>
<p>0xd3</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642988305784.png"></p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642988338522.png"></p>
<p>0xc2</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642988366450.png"></p>
<p>0xd2</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642988655617.png"></p>
<p>长度判断</p>
<p>0xd4</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642988824766.png"></p>
<p>0xcc</p>
<p>接下来又回到0xcc，所以就能猜测是循环做了异或操作，然后判断</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1642989162099.png"></p>
<table>
<thead>
<tr>
<th>func[1]</th>
<th>指令集</th>
</tr>
</thead>
<tbody><tr>
<td>func[2]</td>
<td>加密后的flag的字符</td>
</tr>
<tr>
<td>func[3]</td>
<td>0</td>
</tr>
<tr>
<td>func[4]</td>
<td>索引</td>
</tr>
<tr>
<td>func[5]</td>
<td>判断字符相等</td>
</tr>
<tr>
<td>func[6]</td>
<td>对比的flag</td>
</tr>
<tr>
<td>func[7]</td>
<td>0</td>
</tr>
<tr>
<td>func[8]</td>
<td>加密后的字符串</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xca</td>
<td>先将this[1]指令后的数据存放到this[3]，然后往后跳转5，正好对应了下一条指令,一开始this[1]后一个数据为0，要先转为 dword</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xcb</td>
<td>先将this[1]指令后的数据存放到this[4]，然后往后跳转5，这也是下一条指令</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xcc</td>
<td>把this[2]先赋值为this[8]+this[4]，这里this[4]是个整数，所以猜测this[4]是索引，然后继续执行下一指令</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xcf</td>
<td>将this[3]和this[2]的值异或后存放在this[3],进入下一条指令</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xc9</td>
<td>先把this[1]下一个数据赋值给this[2],进入下一条指令，也就是0xee</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xcf</td>
<td>将this[3]和this[2]的值异或后存放在this[3],进入下一条指令</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xd1</td>
<td>根据this[4]的索引来进行字符比较，这里是调试过程，所以为了进行下一步，需要修改汇编指令</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xd3</td>
<td>v1是指针，解引用是v1下一个位置，也就是0x1，整个就是0xee，这时候然后指向下三个位置，也就是c2指令</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xc2</td>
<td>索引this[4]+1</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xd2</td>
<td>this[4]是索引，所以是判断是否结束，这里没结束，所以this[5]赋值为0</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>0xd4</td>
<td>ec+2==ee</td>
</tr>
</tbody></table>
<p>整个过程就是这样</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20220124125427.jpg"></p>
<p>因为偶数次的异或等于不变，所以只需对奇数次的进行异或即可</p>
<p>最终脚本</p>
<pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
char base64_table[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
int findIndex(char c, char b64_table[])
{
	for (int i = 0; i &lt; 64; ++i)
	{
		if (c == b64_table[i])
			return i;
	}
}
char* base64_decode(char code[], char str[], char b64_table[])
{
	char memstr[200] = { 0 };
	memcpy(memstr, code, strlen(code));
	int len = strlen(code);
	/*while (code[len] != '!' &amp;&amp; code[len] != 0)
	{
		len++;
	}*/
	for (int i = 0, i_ = 0; i &lt; len; i += 4, i_ += 3)
	{
		str[i_] = (findIndex(memstr[i], b64_table) &lt;&lt; 2) | (findIndex(memstr[i + 1], b64_table) &amp; 0x30) &gt;&gt; 4;
		str[i_ + 1] = (findIndex(memstr[i + 1], b64_table) &amp; 0xf) &lt;&lt; 4 | (findIndex(memstr[i + 2], b64_table) &amp; 0x3c) &gt;&gt; 2;
		str[i_ + 2] = (findIndex(memstr[i + 2], b64_table) &amp; 0x03) &lt;&lt; 6 | (findIndex(memstr[i + 3], b64_table));
	}
	int str_len = (len / 4) * 3 + len % 4;
	if (len % 4)
	{
		str_len -= 1;
	}
	str[str_len] = 0;
	return str;
}


int main()
{
	char s[] =
	{
	  190,  54, 172,  39, 153,  79, 222,  68, 238,  95,
	  218,  11, 181,  23, 184, 104, 194,  78, 156,  74,
	  225,  67, 240,  34, 138,  59, 136,  91, 229,  84,
	  255, 104, 213, 103, 212,   6, 173,  11, 216,  80,
	  249,  88, 224, 111, 197,  74, 253,  47, 132,  54,
	  133,  82, 251, 115, 215,  13,0
	};
	char s2[] = { 0 };
	for (int i = 0; i &lt; 56; i+=2)
	{
		s[i] ^= 0xee;
	}
	for (int i = 0; i &lt; 56; ++i)
	{
		s2[i] = s[i];
		for (int k = i; k &gt; 0; k--)
		{
			s2[i] ^= (s2[k - 1]);//该字符前面的全部都要异或上
		}
	}
	//printf("%s", s2);
	for (int i = 0; i &lt; 56; i = i + 4)
	{
		s2[i] ^= 0xA;
		s2[i + 1] ^= 0xB;
		s2[i + 2] ^= 0xC;
		s2[i + 3] ^= 0xD;
	}
	char decode[] = { 0 };
	base64_decode(s2, decode, base64_table);
	printf("%s", decode);

	return 0;
}</code></pre>

<h1 id="hgame2022-week4-easyvm"><a href="#hgame2022-week4-easyvm" class="headerlink" title="hgame2022-week4-easyvm"></a>hgame2022-week4-easyvm</h1><p>第一次尝试写解释器，跟着别人的大致思路的</p>
<p>首先VM就是模仿汇编，用指令代替汇编，用数据段来模拟寄存器和数据段，所以我们关键是要找到数据段和操作数、opcode，以及一些数据存放内容的含义</p>
<p>先来给寄存器重新命名</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645447619996.png"></p>
<p>根据main函数中switch可以找到类寄存器的位置，重命名</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645447726404.png"></p>
<p>从switch的v3可以知道，前面给v3赋值的就是操作数</p>
<p>r0[0]开始是0，所以操作指令第一个存储的位置是r0[109]，因为是int型，计算的时候×4，就可以找到地址</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645447904556.png"></p>
<p>按g跳转，使用lazyida dump下来</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645447995063.png"></p>
<p>接下来动调分析每条指令对应的汇编代码</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645448145669.png"></p>
<p>先++，再赋值给它，就相当于push指令的入栈操作，然后还有一个r4后移一位</p>
<table>
<thead>
<tr>
<th>push</th>
<th>data[r4++]</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645448615771.png"></p>
<p>先–，再赋值给r5，相当于pop操作</p>
<table>
<thead>
<tr>
<th>pop</th>
<th>r5</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645448764344.png"></p>
<p>又回到0x12，还是push，但是因为r4++，所以已经后移，我们根据计算也可以找到存储数据的地址并提取出数据</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645448880740.png"></p>
<p>回到汇编，这里的指令push了-5进入到堆栈，也就是寄存器下面的位置</p>
<table>
<thead>
<tr>
<th>push</th>
<th>data[r4++]</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645449458278.png"></p>
<table>
<thead>
<tr>
<th>pop</th>
<th>r6</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645449560687.png"></p>
<p>获取输入，并存储到a1中，这里的a1对应r3</p>
<table>
<thead>
<tr>
<th>getchar</th>
<th>r3</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645449886162.png"></p>
<p>熟悉的操作，把输入压入堆栈，记得栈顶往低处移动</p>
<table>
<thead>
<tr>
<th>push</th>
<th>r3</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645450099792.png"></p>
<p>这里的a1是r2</p>
<table>
<thead>
<tr>
<th>add</th>
<th>r2,1</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645450235632.png"></p>
<table>
<thead>
<tr>
<th>cmp</th>
<th>r3,r5</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>根据前面的pop r5可以知道此时r5是0A，而我们的输入被存入了r3，也就是对我们的输入字符进行判断，那么r8应该就对应ZF标志位</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645513351201.png"></p>
<p>验证了上面的想法，这里的a1是r6，也就是-5，指令跳转回去，相当于进行循环，输入完成后会有一个换行符，getchar会吸收，这里也就是结束我们的循环</p>
<table>
<thead>
<tr>
<th>jnz</th>
<th>r0-5</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>直接在下一条指令下断点，F9运行</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645513742181.png"></p>
<p>这里的a1是r2，用于记录输入长度，因为最后有一个回车符，所以要–</p>
<table>
<thead>
<tr>
<th>r2–</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>根据前面就可以先对数组进行注释</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514228495.png"></p>
<p>r4没写上去，是内存中存储的一段数据</p>
<p>继续往下走</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514299405.png"></p>
<p>将内存段的下一个数据入栈，也就是0x20</p>
<table>
<thead>
<tr>
<th>push</th>
<th>data[r4++]</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514469709.png"></p>
<table>
<thead>
<tr>
<th>pop</th>
<th>r5,这里懒得改了，可以点过去查看</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>接下来是0x12和0x9</p>
<table>
<thead>
<tr>
<th>push</th>
<th>data[r4++]</th>
</tr>
</thead>
<tbody><tr>
<td>pop</td>
<td>r6</td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514666638.png"></p>
<p>把r2的值赋给r3</p>
<table>
<thead>
<tr>
<th>mov</th>
<th>r3,r2</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514774277.png"></p>
<table>
<thead>
<tr>
<th>push</th>
<th>r3</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645514918356.png"></p>
<table>
<thead>
<tr>
<th>cmp</th>
<th>r3,r5</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>但是这次比较的是字符串的长度，也就是字符串长度是32</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515061894.png"></p>
<table>
<thead>
<tr>
<th>jnz</th>
<th>r0+r6</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>这里r6存放的是2f，正好对应结束，所以这段就相当于exit</p>
<p>下面是0x12和0x09</p>
<table>
<thead>
<tr>
<th>push</th>
<th>data[r4++]</th>
</tr>
</thead>
<tbody><tr>
<td>pop</td>
<td>r6</td>
</tr>
</tbody></table>
<p>0x12和0x0A</p>
<p>这是0x0a的代码</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515342308.png"></p>
<table>
<thead>
<tr>
<th>push</th>
<th>data[r4++]</th>
</tr>
</thead>
<tbody><tr>
<td>pop</td>
<td>r2</td>
</tr>
</tbody></table>
<p>0x13</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515472275.png"></p>
<p>r2此时为0，+9正好是堆栈的位置，也是存放我们输入数据的位置</p>
<table>
<thead>
<tr>
<th>mov</th>
<th>r3,stack[count]</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>从下面开始就是加密的部分了</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515606892.png"></p>
<table>
<thead>
<tr>
<th>push</th>
<th>data[r4++]</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x0B</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515758080.png"></p>
<table>
<thead>
<tr>
<th>pop</th>
<th>r7</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x15</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515807493.png"></p>
<table>
<thead>
<tr>
<th>add</th>
<th>r3,r3</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x03</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515866224.png"></p>
<table>
<thead>
<tr>
<th>xor</th>
<th>r3,r7</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645515954359.png"></p>
<p>把处理完的数据重新放入栈中</p>
<table>
<thead>
<tr>
<th>mov</th>
<th>stack[count],r3</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645516003430.png"></p>
<table>
<thead>
<tr>
<th>add</th>
<th>r2,1</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645516131712.png"></p>
<table>
<thead>
<tr>
<th>mov</th>
<th>r3,r2</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0xF</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645516166189.png"></p>
<table>
<thead>
<tr>
<th>cmp</th>
<th>r3,r5</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645516207834.png"></p>
<table>
<thead>
<tr>
<th>jnz</th>
<th>r0+r6</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>此时的r6是-10，也就是跳转回到前十条指令，这就是循环加密，现在就差最终的密文了，前面加密的部分直接运行过去</p>
<p>再次来到0x12</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645516848887.png"></p>
<table>
<thead>
<tr>
<th>push</th>
<th>data[r4++]</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0xA</p>
<table>
<thead>
<tr>
<th>pop</th>
<th>r2</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645517151788.png"></p>
<p>接下来是三个0x12</p>
<table>
<thead>
<tr>
<th>push</th>
<th>data[r4++]</th>
</tr>
</thead>
<tbody><tr>
<td>push</td>
<td>data[r4++]</td>
</tr>
<tr>
<td>push</td>
<td>data[r4++]</td>
</tr>
</tbody></table>
<p>到了0x08，此时我们的比较数据已经被压入栈中</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645517394177.png"></p>
<table>
<thead>
<tr>
<th>pop</th>
<th>r5</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x13，将处理完的值重新从堆栈中取出</p>
<table>
<thead>
<tr>
<th>mov</th>
<th>r3,satck[count]</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0xF</p>
<table>
<thead>
<tr>
<th>cmp</th>
<th>r3,r5</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x07</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645517670674.png"></p>
<table>
<thead>
<tr>
<th>pop</th>
<th>r3</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x04</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645517727020.png"></p>
<table>
<thead>
<tr>
<th>mov</th>
<th>stack[count],r3</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x09</p>
<table>
<thead>
<tr>
<th>pop</th>
<th>r6</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x0D</p>
<p>r6是0x15，加上之后正好exit，和前面类似，压入栈是因为待会需要多次使用</p>
<table>
<thead>
<tr>
<th>jnz</th>
<th>r0+r6</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>这里没有问题就会往下</p>
<p>0x09</p>
<table>
<thead>
<tr>
<th>pop</th>
<th>r6</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>此时把-17给到r6</p>
<p>0x08</p>
<table>
<thead>
<tr>
<th>pop</th>
<th>r5</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x05</p>
<table>
<thead>
<tr>
<th>push</th>
<th>r5</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x06</p>
<table>
<thead>
<tr>
<th>push</th>
<th>r6</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x04</p>
<table>
<thead>
<tr>
<th>push</th>
<th>r3</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x01</p>
<table>
<thead>
<tr>
<th>add</th>
<th>r2,1</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x00</p>
<table>
<thead>
<tr>
<th>mov</th>
<th>r3,r2</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0x0F//长度判断</p>
<table>
<thead>
<tr>
<th>cmp</th>
<th>r3,r5</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>0xd，重新进入循环</p>
<p><img src="/2022/01/23/VM%E9%80%86%E5%90%91/1645518636756.png"></p>
<h2 id="最终的一些数据和分组和脚本"><a href="#最终的一些数据和分组和脚本" class="headerlink" title="最终的一些数据和分组和脚本"></a>最终的一些数据和分组和脚本</h2><pre class="language-c" data-language="c"><code class="language-c">#include&lt;stdio.h&gt;
#include&lt;string.h&gt;

int main()
{
	int opcode[65] = {
    0x00000012, 0x00000008, 0x00000012, 0x00000009, 
	0x00000010, 0x00000004, 0x00000001, 0x0000000F, 0x0000000D, //接受我们的输入 
	0x00000002, 0x00000012, 0x00000008, 0x00000012, 0x00000009, 0x00000000, 0x00000004, 0x0000000F, 0x0000000D,//对flag进行存储操作，比较长度，因为getchar最后是32，所以flag长度为32 
	0x00000012, 0x00000009, 0x00000012, 0x0000000A, 0x00000013, 0x00000012, 0x0000000B, 0x00000015, 0x00000003, 0x00000014, 0x00000001, 0x00000000, 0x0000000F, 0x0000000D, //flag加密，flag[i]*2^3c存储的值 
    0x00000012, 0x0000000A, 0x00000012, 0x00000012, 0x00000012, 0x00000008, 0x00000013, 0x0000000F, 0x00000007, 0x00000004, 0x00000009, 0x0000000D, 0x00000009, 0x00000008, 0x00000005, 0x00000006, 0x00000004, 0x00000001, 0x00000000, 0x0000000F, 0x0000000D, 
	//字符串比较 
	0x00000012, 0x00000009, 0x00000012, 
    0x00000008, 0x00000012, 0x0000000A, 0x00000012, 0x00000007, 0x0000000F, 0x0000000C, 0x00000011, //打印 
    0x0000000E
};
	unsigned char xor_table[32]={
		0x5e,0x46,0x61,0x43,0x0e,0x53,0x49,0x1f,
		0x51,0x5e,0x36,0x37,0x29,0x41,0x63,0x3b,
		0x64,0x3b,0x15,0x18,0x5b,0x3e,0x22,0x50,
		0x46,0x5e,0x35,0x4e,0x43,0x23,0x60,0x3b
	};
	unsigned char enc[32]={
		0x8E, 0x88, 0xA3, 0x99, 0xC4, 0xA5, 0xC3, 0xDD,
		0x19, 0xEC, 0x6C, 0x9B, 0xF3, 0x1B, 0x8B, 0x5B,
		0x3E, 0x9B, 0xF1, 0x86, 0xF3, 0xF4, 0xA4, 0xF8,
		0xF8, 0x98, 0xAB, 0x86, 0x89, 0x61, 0x22, 0xC1
	};
	unsigned int data[83] = {
	//用于跳转和判断长度的数 
    0x0000000A, -5, 0x00000020, 0x0000002F, -10, 0x00000000, 
    //异或数据 
	0x0000005E, 0x00000046, 0x00000061, 0x00000043, 0x0000000E, 0x00000053, 0x00000049, 0x0000001F, 
	0x00000051, 0x0000005E, 0x00000036, 0x00000037, 0x00000029, 0x00000041, 0x00000063, 0x0000003B, 
	0x00000064, 0x0000003B, 0x00000015, 0x00000018, 0x0000005B, 0x0000003E, 0x00000022, 0x00000050, 
	0x00000046, 0x0000005E, 0x00000035, 0x0000004E, 0x00000043, 0x00000023, 0x00000060, 0x0000003B, 
	//用于跳转，以及赋值初始索引 
	0x00000000, -17, 0x00000015, 
	//密文 
	0x0000008E, 0x00000088, 0x000000A3, 0x00000099, 0x000000C4, 0x000000A5, 0x000000C3, 0x000000DD, 
	0x00000019, 0x000000EC, 0x0000006C, 0x0000009B, 0x000000F3, 0x0000001B, 0x0000008B, 0x0000005B, 
	0x0000003E, 0x0000009B, 0x000000F1, 0x00000086, 0x000000F3, 0x000000F4, 0x000000A4, 0x000000F8,
	0x000000F8, 0x00000098, 0x000000AB, 0x00000086, 0x00000089, 0x00000061, 0x00000022, 0x000000C1, 
	
	0x00000002, 0x00000000, -6, 0x00000073, 0x00000075, 0x00000063, 0x00000063, 
    0x00000065, 0x00000073, 0x00000073
};
	char flag[32]={0};
	for(int i=0;i&lt;32;++i)
	{
		enc[i]=(enc[i]^xor_table[i])/2;
	}
	printf("%s",enc);
	return 0;
}</code></pre>




    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Reverse/" rel="tag"># Reverse</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/01/22/%E5%AE%89%E5%8D%93%E7%9F%A5%E8%AF%86/" rel="prev" title="安卓知识">
                  <i class="fa fa-chevron-left"></i> 安卓知识
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/02/02/C%E8%AF%AD%E8%A8%80%E6%B1%87%E7%BC%962/" rel="next" title="C语言汇编2">
                  C语言汇编2 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gift1a</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body>
</html>
